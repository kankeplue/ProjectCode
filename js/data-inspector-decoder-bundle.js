/*! For license information please see data-inspector-decoder-bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={14352:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.userMarkerShader=t.thinLineShader=t.polygonShader=t.markerShader=t.circleCenterShader=void 0,n(i(39863),t),n(i(28072),t),n(i(99017),t),n(i(24762),t),n(i(64135),t),n(i(82246),t),n(i(42589),t),n(i(23086),t),n(i(81450),t),n(i(77288),t),n(i(51696),t),n(i(15928),t),n(i(25850),t),n(i(53592),t),n(i(49953),t),n(i(1210),t),n(i(7354),t),n(i(44710),t),n(i(95757),t);var o=i(50077);Object.defineProperty(t,"circleCenterShader",{enumerable:!0,get:function(){return o.default}}),n(i(47367),t);var a=i(14052);Object.defineProperty(t,"markerShader",{enumerable:!0,get:function(){return a.default}});var s=i(81058);Object.defineProperty(t,"polygonShader",{enumerable:!0,get:function(){return s.default}}),n(i(58097),t);var l=i(22275);Object.defineProperty(t,"thinLineShader",{enumerable:!0,get:function(){return l.default}});var c=i(78359);Object.defineProperty(t,"userMarkerShader",{enumerable:!0,get:function(){return c.default}}),n(i(60440),t),n(i(8386),t),n(i(87122),t),n(i(10010),t),n(i(53439),t),n(i(5867),t),n(i(1949),t),n(i(92533),t),n(i(31994),t),n(i(72558),t),n(i(59678),t),n(i(70900),t),n(i(62984),t),n(i(32797),t),n(i(72661),t),n(i(76919),t),n(i(54278),t),n(i(54903),t),n(i(49221),t),n(i(38233),t),n(i(89707),t),n(i(48209),t),n(i(55146),t),n(i(30860),t),n(i(19160),t),n(i(6308),t)},9445:(e,t,i)=>{"use strict";var r,n,o,a,s,l=i(62100),c=l.Reader,u=l.util,d=l.roots.default||(l.roots.default={});d.sdii=((s={}).here=((a={}).pb=((o={}).Tile=function(){function e(e){if(this.messages=[],this.refs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.tileId="",e.prototype.messages=u.emptyArray,e.prototype.refs=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Tile;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.tileId=e.string();break;case 2:r.messages&&r.messages.length||(r.messages=[]),r.messages.push(d.sdii.here.pb.MessageWrapper.decode(e,e.uint32()));break;case 3:r.refs&&r.refs.length||(r.refs=[]),r.refs.push(d.sdii.here.pb.MessageReference.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("tileId"))throw u.ProtocolError("missing required 'tileId'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Tile)return e;var t=new d.sdii.here.pb.Tile;if(null!=e.tileId&&(t.tileId=String(e.tileId)),e.messages){if(!Array.isArray(e.messages))throw TypeError(".sdii.here.pb.Tile.messages: array expected");t.messages=[];for(var i=0;i<e.messages.length;++i){if("object"!=typeof e.messages[i])throw TypeError(".sdii.here.pb.Tile.messages: object expected");t.messages[i]=d.sdii.here.pb.MessageWrapper.fromObject(e.messages[i])}}if(e.refs){if(!Array.isArray(e.refs))throw TypeError(".sdii.here.pb.Tile.refs: array expected");for(t.refs=[],i=0;i<e.refs.length;++i){if("object"!=typeof e.refs[i])throw TypeError(".sdii.here.pb.Tile.refs: object expected");t.refs[i]=d.sdii.here.pb.MessageReference.fromObject(e.refs[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.messages=[],i.refs=[]),t.defaults&&(i.tileId=""),null!=e.tileId&&e.hasOwnProperty("tileId")&&(i.tileId=e.tileId),e.messages&&e.messages.length){i.messages=[];for(var r=0;r<e.messages.length;++r)i.messages[r]=d.sdii.here.pb.MessageWrapper.toObject(e.messages[r],t)}if(e.refs&&e.refs.length)for(i.refs=[],r=0;r<e.refs.length;++r)i.refs[r]=d.sdii.here.pb.MessageReference.toObject(e.refs[r],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.MessageWrapper=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.messageId="",e.prototype.message=null,e.prototype.metadata=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.MessageWrapper;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.messageId=e.string();break;case 2:r.message=d.sdii.here.pb.Message.decode(e,e.uint32());break;case 3:r.metadata=d.sdii.here.pb.Metadata.decode(e,e.uint32());break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("messageId"))throw u.ProtocolError("missing required 'messageId'",{instance:r});if(!r.hasOwnProperty("message"))throw u.ProtocolError("missing required 'message'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MessageWrapper)return e;var t=new d.sdii.here.pb.MessageWrapper;if(null!=e.messageId&&(t.messageId=String(e.messageId)),null!=e.message){if("object"!=typeof e.message)throw TypeError(".sdii.here.pb.MessageWrapper.message: object expected");t.message=d.sdii.here.pb.Message.fromObject(e.message)}if(null!=e.metadata){if("object"!=typeof e.metadata)throw TypeError(".sdii.here.pb.MessageWrapper.metadata: object expected");t.metadata=d.sdii.here.pb.Metadata.fromObject(e.metadata)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.messageId="",i.message=null,i.metadata=null),null!=e.messageId&&e.hasOwnProperty("messageId")&&(i.messageId=e.messageId),null!=e.message&&e.hasOwnProperty("message")&&(i.message=d.sdii.here.pb.Message.toObject(e.message,t)),null!=e.metadata&&e.hasOwnProperty("metadata")&&(i.metadata=d.sdii.here.pb.Metadata.toObject(e.metadata,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.MessageReference=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.tileId="",e.prototype.messageId="",e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.MessageReference;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.tileId=e.string();break;case 2:r.messageId=e.string();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("tileId"))throw u.ProtocolError("missing required 'tileId'",{instance:r});if(!r.hasOwnProperty("messageId"))throw u.ProtocolError("missing required 'messageId'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MessageReference)return e;var t=new d.sdii.here.pb.MessageReference;return null!=e.tileId&&(t.tileId=String(e.tileId)),null!=e.messageId&&(t.messageId=String(e.messageId)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.tileId="",i.messageId=""),null!=e.tileId&&e.hasOwnProperty("tileId")&&(i.tileId=e.tileId),null!=e.messageId&&e.hasOwnProperty("messageId")&&(i.messageId=e.messageId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.Metadata=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.receivedTime=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.messageStartTime=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.messageEndTime=u.Long?u.Long.fromBits(0,0,!1):0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Metadata;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.receivedTime=e.int64();break;case 2:r.messageStartTime=e.int64();break;case 3:r.messageEndTime=e.int64();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("receivedTime"))throw u.ProtocolError("missing required 'receivedTime'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Metadata)return e;var t=new d.sdii.here.pb.Metadata;return null!=e.receivedTime&&(u.Long?(t.receivedTime=u.Long.fromValue(e.receivedTime)).unsigned=!1:"string"==typeof e.receivedTime?t.receivedTime=parseInt(e.receivedTime,10):"number"==typeof e.receivedTime?t.receivedTime=e.receivedTime:"object"==typeof e.receivedTime&&(t.receivedTime=new u.LongBits(e.receivedTime.low>>>0,e.receivedTime.high>>>0).toNumber())),null!=e.messageStartTime&&(u.Long?(t.messageStartTime=u.Long.fromValue(e.messageStartTime)).unsigned=!1:"string"==typeof e.messageStartTime?t.messageStartTime=parseInt(e.messageStartTime,10):"number"==typeof e.messageStartTime?t.messageStartTime=e.messageStartTime:"object"==typeof e.messageStartTime&&(t.messageStartTime=new u.LongBits(e.messageStartTime.low>>>0,e.messageStartTime.high>>>0).toNumber())),null!=e.messageEndTime&&(u.Long?(t.messageEndTime=u.Long.fromValue(e.messageEndTime)).unsigned=!1:"string"==typeof e.messageEndTime?t.messageEndTime=parseInt(e.messageEndTime,10):"number"==typeof e.messageEndTime?t.messageEndTime=e.messageEndTime:"object"==typeof e.messageEndTime&&(t.messageEndTime=new u.LongBits(e.messageEndTime.low>>>0,e.messageEndTime.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.receivedTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.receivedTime=t.longs===String?"0":0;u.Long?(r=new u.Long(0,0,!1),i.messageStartTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.messageStartTime=t.longs===String?"0":0,u.Long?(r=new u.Long(0,0,!1),i.messageEndTime=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.messageEndTime=t.longs===String?"0":0}return null!=e.receivedTime&&e.hasOwnProperty("receivedTime")&&("number"==typeof e.receivedTime?i.receivedTime=t.longs===String?String(e.receivedTime):e.receivedTime:i.receivedTime=t.longs===String?u.Long.prototype.toString.call(e.receivedTime):t.longs===Number?new u.LongBits(e.receivedTime.low>>>0,e.receivedTime.high>>>0).toNumber():e.receivedTime),null!=e.messageStartTime&&e.hasOwnProperty("messageStartTime")&&("number"==typeof e.messageStartTime?i.messageStartTime=t.longs===String?String(e.messageStartTime):e.messageStartTime:i.messageStartTime=t.longs===String?u.Long.prototype.toString.call(e.messageStartTime):t.longs===Number?new u.LongBits(e.messageStartTime.low>>>0,e.messageStartTime.high>>>0).toNumber():e.messageStartTime),null!=e.messageEndTime&&e.hasOwnProperty("messageEndTime")&&("number"==typeof e.messageEndTime?i.messageEndTime=t.longs===String?String(e.messageEndTime):e.messageEndTime:i.messageEndTime=t.longs===String?u.Long.prototype.toString.call(e.messageEndTime):t.longs===Number?new u.LongBits(e.messageEndTime.low>>>0,e.messageEndTime.high>>>0).toNumber():e.messageEndTime),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.Message=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.envelope=null,e.prototype.path=null,e.prototype.pathEvents=null,e.prototype.pathMedia=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Message;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.envelope=d.sdii.here.pb.Envelope.decode(e,e.uint32());break;case 2:r.path=d.sdii.here.pb.Path.decode(e,e.uint32());break;case 3:r.pathEvents=d.sdii.here.pb.PathEvents.decode(e,e.uint32());break;case 4:r.pathMedia=d.sdii.here.pb.PathMedia.decode(e,e.uint32());break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("envelope"))throw u.ProtocolError("missing required 'envelope'",{instance:r});if(!r.hasOwnProperty("path"))throw u.ProtocolError("missing required 'path'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Message)return e;var t=new d.sdii.here.pb.Message;if(null!=e.envelope){if("object"!=typeof e.envelope)throw TypeError(".sdii.here.pb.Message.envelope: object expected");t.envelope=d.sdii.here.pb.Envelope.fromObject(e.envelope)}if(null!=e.path){if("object"!=typeof e.path)throw TypeError(".sdii.here.pb.Message.path: object expected");t.path=d.sdii.here.pb.Path.fromObject(e.path)}if(null!=e.pathEvents){if("object"!=typeof e.pathEvents)throw TypeError(".sdii.here.pb.Message.pathEvents: object expected");t.pathEvents=d.sdii.here.pb.PathEvents.fromObject(e.pathEvents)}if(null!=e.pathMedia){if("object"!=typeof e.pathMedia)throw TypeError(".sdii.here.pb.Message.pathMedia: object expected");t.pathMedia=d.sdii.here.pb.PathMedia.fromObject(e.pathMedia)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.envelope=null,i.path=null,i.pathEvents=null,i.pathMedia=null),null!=e.envelope&&e.hasOwnProperty("envelope")&&(i.envelope=d.sdii.here.pb.Envelope.toObject(e.envelope,t)),null!=e.path&&e.hasOwnProperty("path")&&(i.path=d.sdii.here.pb.Path.toObject(e.path,t)),null!=e.pathEvents&&e.hasOwnProperty("pathEvents")&&(i.pathEvents=d.sdii.here.pb.PathEvents.toObject(e.pathEvents,t)),null!=e.pathMedia&&e.hasOwnProperty("pathMedia")&&(i.pathMedia=d.sdii.here.pb.PathMedia.toObject(e.pathMedia,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.KeyValuePairString=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.key="",e.prototype.value="",e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.KeyValuePairString;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("key"))throw u.ProtocolError("missing required 'key'",{instance:r});if(!r.hasOwnProperty("value"))throw u.ProtocolError("missing required 'value'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.KeyValuePairString)return e;var t=new d.sdii.here.pb.KeyValuePairString;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.key="",i.value=""),null!=e.key&&e.hasOwnProperty("key")&&(i.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(i.value=e.value),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.ExtensionContainer=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dataKey="",e.prototype.dataSpecification="",e.prototype.dataValue=u.newBuffer([]),e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ExtensionContainer;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.dataKey=e.string();break;case 2:r.dataSpecification=e.string();break;case 3:r.dataValue=e.bytes();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ExtensionContainer)return e;var t=new d.sdii.here.pb.ExtensionContainer;return null!=e.dataKey&&(t.dataKey=String(e.dataKey)),null!=e.dataSpecification&&(t.dataSpecification=String(e.dataSpecification)),null!=e.dataValue&&("string"==typeof e.dataValue?u.base64.decode(e.dataValue,t.dataValue=u.newBuffer(u.base64.length(e.dataValue)),0):e.dataValue.length&&(t.dataValue=e.dataValue)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.dataKey="",i.dataSpecification="",i.dataValue=t.bytes===String?"":[]),null!=e.dataKey&&e.hasOwnProperty("dataKey")&&(i.dataKey=e.dataKey),null!=e.dataSpecification&&e.hasOwnProperty("dataSpecification")&&(i.dataSpecification=e.dataSpecification),null!=e.dataValue&&e.hasOwnProperty("dataValue")&&(i.dataValue=t.bytes===String?u.base64.encode(e.dataValue,0,e.dataValue.length):t.bytes===Array?Array.prototype.slice.call(e.dataValue):e.dataValue),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.ProprietaryDataContainer=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ProprietaryDataContainer;e.pos<i;){var n=e.uint32();e.skipType(7&n)}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.ProprietaryDataContainer?e:new d.sdii.here.pb.ProprietaryDataContainer},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.Vector3D=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.longitudinalValue=0,e.prototype.lateralValue=0,e.prototype.verticalValue=0,e.prototype.longitudinalAccuracy=0,e.prototype.lateralAccuary=0,e.prototype.verticalAccuracy=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Vector3D;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.longitudinalValue=e.double();break;case 2:r.lateralValue=e.double();break;case 3:r.verticalValue=e.double();break;case 4:r.longitudinalAccuracy=e.double();break;case 5:r.lateralAccuary=e.double();break;case 6:r.verticalAccuracy=e.double();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("longitudinalValue"))throw u.ProtocolError("missing required 'longitudinalValue'",{instance:r});if(!r.hasOwnProperty("lateralValue"))throw u.ProtocolError("missing required 'lateralValue'",{instance:r});if(!r.hasOwnProperty("verticalValue"))throw u.ProtocolError("missing required 'verticalValue'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Vector3D)return e;var t=new d.sdii.here.pb.Vector3D;return null!=e.longitudinalValue&&(t.longitudinalValue=Number(e.longitudinalValue)),null!=e.lateralValue&&(t.lateralValue=Number(e.lateralValue)),null!=e.verticalValue&&(t.verticalValue=Number(e.verticalValue)),null!=e.longitudinalAccuracy&&(t.longitudinalAccuracy=Number(e.longitudinalAccuracy)),null!=e.lateralAccuary&&(t.lateralAccuary=Number(e.lateralAccuary)),null!=e.verticalAccuracy&&(t.verticalAccuracy=Number(e.verticalAccuracy)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.longitudinalValue=0,i.lateralValue=0,i.verticalValue=0,i.longitudinalAccuracy=0,i.lateralAccuary=0,i.verticalAccuracy=0),null!=e.longitudinalValue&&e.hasOwnProperty("longitudinalValue")&&(i.longitudinalValue=t.json&&!isFinite(e.longitudinalValue)?String(e.longitudinalValue):e.longitudinalValue),null!=e.lateralValue&&e.hasOwnProperty("lateralValue")&&(i.lateralValue=t.json&&!isFinite(e.lateralValue)?String(e.lateralValue):e.lateralValue),null!=e.verticalValue&&e.hasOwnProperty("verticalValue")&&(i.verticalValue=t.json&&!isFinite(e.verticalValue)?String(e.verticalValue):e.verticalValue),null!=e.longitudinalAccuracy&&e.hasOwnProperty("longitudinalAccuracy")&&(i.longitudinalAccuracy=t.json&&!isFinite(e.longitudinalAccuracy)?String(e.longitudinalAccuracy):e.longitudinalAccuracy),null!=e.lateralAccuary&&e.hasOwnProperty("lateralAccuary")&&(i.lateralAccuary=t.json&&!isFinite(e.lateralAccuary)?String(e.lateralAccuary):e.lateralAccuary),null!=e.verticalAccuracy&&e.hasOwnProperty("verticalAccuracy")&&(i.verticalAccuracy=t.json&&!isFinite(e.verticalAccuracy)?String(e.verticalAccuracy):e.verticalAccuracy),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.VehicleMetaData=function(){function e(e){if(this.vehicleSpecificMetaData=[],this.vehicleHeightDetail=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.vehicleTypeGeneric=0,e.prototype.vehicleSpecificMetaData=u.emptyArray,e.prototype.vehicleReferencePointDeltaAboveGround_m=0,e.prototype.curvatureAccuracy_1pm=0,e.prototype.slopeAccuracy_percent=0,e.prototype.vehicleLength_m=0,e.prototype.vehicleWidth_m=0,e.prototype.vehicleHeight_m=0,e.prototype.primaryFuelTankVolume=0,e.prototype.primaryFuelType=0,e.prototype.secondaryFuelTankVolume=0,e.prototype.secondaryFuelType=0,e.prototype.vehicleHeightDetail=u.emptyArray,e.prototype.GNSSPositionReferencePointOffset=null,e.prototype.RelativePositionReferencePointOffset=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleMetaData;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.vehicleTypeGeneric=e.int32();break;case 2:r.vehicleSpecificMetaData&&r.vehicleSpecificMetaData.length||(r.vehicleSpecificMetaData=[]),r.vehicleSpecificMetaData.push(d.sdii.here.pb.KeyValuePairString.decode(e,e.uint32()));break;case 3:r.vehicleReferencePointDeltaAboveGround_m=e.double();break;case 4:r.curvatureAccuracy_1pm=e.double();break;case 5:r.slopeAccuracy_percent=e.double();break;case 6:r.vehicleLength_m=e.double();break;case 7:r.vehicleWidth_m=e.double();break;case 8:r.vehicleHeight_m=e.double();break;case 9:r.primaryFuelTankVolume=e.double();break;case 10:r.primaryFuelType=e.int32();break;case 11:r.secondaryFuelTankVolume=e.double();break;case 12:r.secondaryFuelType=e.int32();break;case 13:r.vehicleHeightDetail&&r.vehicleHeightDetail.length||(r.vehicleHeightDetail=[]),r.vehicleHeightDetail.push(d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.decode(e,e.uint32()));break;case 14:r.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 15:r.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleMetaData)return e;var t=new d.sdii.here.pb.VehicleMetaData;switch(e.vehicleTypeGeneric){case"VEHICLE_TYPE_UNDEFINED":case 0:t.vehicleTypeGeneric=0;break;case"BUS":case 1:t.vehicleTypeGeneric=1;break;case"DELIVERY_TRUCK":case 2:t.vehicleTypeGeneric=2;break;case"EMERGENCY_VEHICLE":case 3:t.vehicleTypeGeneric=3;break;case"MOTORCYCLE":case 4:t.vehicleTypeGeneric=4;break;case"PASSENGER_CAR":case 5:t.vehicleTypeGeneric=5;break;case"TAXI":case 6:t.vehicleTypeGeneric=6;break;case"TRANSPORT_TRUCK":case 7:t.vehicleTypeGeneric=7;break;case"MOPED":case 8:t.vehicleTypeGeneric=8;break;case"TRAILER":case 9:t.vehicleTypeGeneric=9;break;case"TRAM":case 10:t.vehicleTypeGeneric=10;break;case"UNKNOWN_VEHICLE":case 11:t.vehicleTypeGeneric=11}if(e.vehicleSpecificMetaData){if(!Array.isArray(e.vehicleSpecificMetaData))throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleSpecificMetaData: array expected");t.vehicleSpecificMetaData=[];for(var i=0;i<e.vehicleSpecificMetaData.length;++i){if("object"!=typeof e.vehicleSpecificMetaData[i])throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleSpecificMetaData: object expected");t.vehicleSpecificMetaData[i]=d.sdii.here.pb.KeyValuePairString.fromObject(e.vehicleSpecificMetaData[i])}}switch(null!=e.vehicleReferencePointDeltaAboveGround_m&&(t.vehicleReferencePointDeltaAboveGround_m=Number(e.vehicleReferencePointDeltaAboveGround_m)),null!=e.curvatureAccuracy_1pm&&(t.curvatureAccuracy_1pm=Number(e.curvatureAccuracy_1pm)),null!=e.slopeAccuracy_percent&&(t.slopeAccuracy_percent=Number(e.slopeAccuracy_percent)),null!=e.vehicleLength_m&&(t.vehicleLength_m=Number(e.vehicleLength_m)),null!=e.vehicleWidth_m&&(t.vehicleWidth_m=Number(e.vehicleWidth_m)),null!=e.vehicleHeight_m&&(t.vehicleHeight_m=Number(e.vehicleHeight_m)),null!=e.primaryFuelTankVolume&&(t.primaryFuelTankVolume=Number(e.primaryFuelTankVolume)),e.primaryFuelType){case"FUEL_TYPE_UNDEFINED":case 0:t.primaryFuelType=0;break;case"FUEL_TYPE_OTHER":case 1:t.primaryFuelType=1;break;case"FUEL_TYPE_GASOLINE_L":case 2:t.primaryFuelType=2;break;case"FUEL_TYPE_DIESEL_L":case 3:t.primaryFuelType=3;break;case"FUEL_TYPE_AUTOGAS_KG":case 4:t.primaryFuelType=4;break;case"FUEL_TYPE_BATTERY_AH":case 5:t.primaryFuelType=5;break;case"FUEL_TYPE_HYDROGEN_KG":case 6:t.primaryFuelType=6}switch(null!=e.secondaryFuelTankVolume&&(t.secondaryFuelTankVolume=Number(e.secondaryFuelTankVolume)),e.secondaryFuelType){case"FUEL_TYPE_UNDEFINED":case 0:t.secondaryFuelType=0;break;case"FUEL_TYPE_OTHER":case 1:t.secondaryFuelType=1;break;case"FUEL_TYPE_GASOLINE_L":case 2:t.secondaryFuelType=2;break;case"FUEL_TYPE_DIESEL_L":case 3:t.secondaryFuelType=3;break;case"FUEL_TYPE_AUTOGAS_KG":case 4:t.secondaryFuelType=4;break;case"FUEL_TYPE_BATTERY_AH":case 5:t.secondaryFuelType=5;break;case"FUEL_TYPE_HYDROGEN_KG":case 6:t.secondaryFuelType=6}if(e.vehicleHeightDetail){if(!Array.isArray(e.vehicleHeightDetail))throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleHeightDetail: array expected");for(t.vehicleHeightDetail=[],i=0;i<e.vehicleHeightDetail.length;++i){if("object"!=typeof e.vehicleHeightDetail[i])throw TypeError(".sdii.here.pb.VehicleMetaData.vehicleHeightDetail: object expected");t.vehicleHeightDetail[i]=d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.fromObject(e.vehicleHeightDetail[i])}}if(null!=e.GNSSPositionReferencePointOffset){if("object"!=typeof e.GNSSPositionReferencePointOffset)throw TypeError(".sdii.here.pb.VehicleMetaData.GNSSPositionReferencePointOffset: object expected");t.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.fromObject(e.GNSSPositionReferencePointOffset)}if(null!=e.RelativePositionReferencePointOffset){if("object"!=typeof e.RelativePositionReferencePointOffset)throw TypeError(".sdii.here.pb.VehicleMetaData.RelativePositionReferencePointOffset: object expected");t.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.fromObject(e.RelativePositionReferencePointOffset)}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.vehicleSpecificMetaData=[],i.vehicleHeightDetail=[]),t.defaults&&(i.vehicleTypeGeneric=t.enums===String?"VEHICLE_TYPE_UNDEFINED":0,i.vehicleReferencePointDeltaAboveGround_m=0,i.curvatureAccuracy_1pm=0,i.slopeAccuracy_percent=0,i.vehicleLength_m=0,i.vehicleWidth_m=0,i.vehicleHeight_m=0,i.primaryFuelTankVolume=0,i.primaryFuelType=t.enums===String?"FUEL_TYPE_UNDEFINED":0,i.secondaryFuelTankVolume=0,i.secondaryFuelType=t.enums===String?"FUEL_TYPE_UNDEFINED":0,i.GNSSPositionReferencePointOffset=null,i.RelativePositionReferencePointOffset=null),null!=e.vehicleTypeGeneric&&e.hasOwnProperty("vehicleTypeGeneric")&&(i.vehicleTypeGeneric=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleTypeGenericEnum[e.vehicleTypeGeneric]:e.vehicleTypeGeneric),e.vehicleSpecificMetaData&&e.vehicleSpecificMetaData.length){i.vehicleSpecificMetaData=[];for(var r=0;r<e.vehicleSpecificMetaData.length;++r)i.vehicleSpecificMetaData[r]=d.sdii.here.pb.KeyValuePairString.toObject(e.vehicleSpecificMetaData[r],t)}if(null!=e.vehicleReferencePointDeltaAboveGround_m&&e.hasOwnProperty("vehicleReferencePointDeltaAboveGround_m")&&(i.vehicleReferencePointDeltaAboveGround_m=t.json&&!isFinite(e.vehicleReferencePointDeltaAboveGround_m)?String(e.vehicleReferencePointDeltaAboveGround_m):e.vehicleReferencePointDeltaAboveGround_m),null!=e.curvatureAccuracy_1pm&&e.hasOwnProperty("curvatureAccuracy_1pm")&&(i.curvatureAccuracy_1pm=t.json&&!isFinite(e.curvatureAccuracy_1pm)?String(e.curvatureAccuracy_1pm):e.curvatureAccuracy_1pm),null!=e.slopeAccuracy_percent&&e.hasOwnProperty("slopeAccuracy_percent")&&(i.slopeAccuracy_percent=t.json&&!isFinite(e.slopeAccuracy_percent)?String(e.slopeAccuracy_percent):e.slopeAccuracy_percent),null!=e.vehicleLength_m&&e.hasOwnProperty("vehicleLength_m")&&(i.vehicleLength_m=t.json&&!isFinite(e.vehicleLength_m)?String(e.vehicleLength_m):e.vehicleLength_m),null!=e.vehicleWidth_m&&e.hasOwnProperty("vehicleWidth_m")&&(i.vehicleWidth_m=t.json&&!isFinite(e.vehicleWidth_m)?String(e.vehicleWidth_m):e.vehicleWidth_m),null!=e.vehicleHeight_m&&e.hasOwnProperty("vehicleHeight_m")&&(i.vehicleHeight_m=t.json&&!isFinite(e.vehicleHeight_m)?String(e.vehicleHeight_m):e.vehicleHeight_m),null!=e.primaryFuelTankVolume&&e.hasOwnProperty("primaryFuelTankVolume")&&(i.primaryFuelTankVolume=t.json&&!isFinite(e.primaryFuelTankVolume)?String(e.primaryFuelTankVolume):e.primaryFuelTankVolume),null!=e.primaryFuelType&&e.hasOwnProperty("primaryFuelType")&&(i.primaryFuelType=t.enums===String?d.sdii.here.pb.VehicleMetaData.FuelTypeEnum[e.primaryFuelType]:e.primaryFuelType),null!=e.secondaryFuelTankVolume&&e.hasOwnProperty("secondaryFuelTankVolume")&&(i.secondaryFuelTankVolume=t.json&&!isFinite(e.secondaryFuelTankVolume)?String(e.secondaryFuelTankVolume):e.secondaryFuelTankVolume),null!=e.secondaryFuelType&&e.hasOwnProperty("secondaryFuelType")&&(i.secondaryFuelType=t.enums===String?d.sdii.here.pb.VehicleMetaData.FuelTypeEnum[e.secondaryFuelType]:e.secondaryFuelType),e.vehicleHeightDetail&&e.vehicleHeightDetail.length)for(i.vehicleHeightDetail=[],r=0;r<e.vehicleHeightDetail.length;++r)i.vehicleHeightDetail[r]=d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.toObject(e.vehicleHeightDetail[r],t);return null!=e.GNSSPositionReferencePointOffset&&e.hasOwnProperty("GNSSPositionReferencePointOffset")&&(i.GNSSPositionReferencePointOffset=d.sdii.here.pb.Vector3D.toObject(e.GNSSPositionReferencePointOffset,t)),null!=e.RelativePositionReferencePointOffset&&e.hasOwnProperty("RelativePositionReferencePointOffset")&&(i.RelativePositionReferencePointOffset=d.sdii.here.pb.Vector3D.toObject(e.RelativePositionReferencePointOffset,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.VehicleTypeGenericEnum=(t={},(i=Object.create(t))[t[0]="VEHICLE_TYPE_UNDEFINED"]=0,i[t[1]="BUS"]=1,i[t[2]="DELIVERY_TRUCK"]=2,i[t[3]="EMERGENCY_VEHICLE"]=3,i[t[4]="MOTORCYCLE"]=4,i[t[5]="PASSENGER_CAR"]=5,i[t[6]="TAXI"]=6,i[t[7]="TRANSPORT_TRUCK"]=7,i[t[8]="MOPED"]=8,i[t[9]="TRAILER"]=9,i[t[10]="TRAM"]=10,i[t[11]="UNKNOWN_VEHICLE"]=11,i),e.FuelTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="FUEL_TYPE_UNDEFINED"]=0,t[e[1]="FUEL_TYPE_OTHER"]=1,t[e[2]="FUEL_TYPE_GASOLINE_L"]=2,t[e[3]="FUEL_TYPE_DIESEL_L"]=3,t[e[4]="FUEL_TYPE_AUTOGAS_KG"]=4,t[e[5]="FUEL_TYPE_BATTERY_AH"]=5,t[e[6]="FUEL_TYPE_HYDROGEN_KG"]=6,t}(),e.VehicleHeightDetail=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.longitudinalVehicleHeightReferencePoint=0,e.prototype.lateralVehicleHeightReferencePoint=0,e.prototype.vehicleHeightValue_mm=u.Long?u.Long.fromBits(0,0,!1):0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.longitudinalVehicleHeightReferencePoint=e.int32();break;case 2:r.lateralVehicleHeightReferencePoint=e.int32();break;case 3:r.vehicleHeightValue_mm=e.int64();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail)return e;var t=new d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail;switch(e.longitudinalVehicleHeightReferencePoint){case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":case 0:t.longitudinalVehicleHeightReferencePoint=0;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_FRONT":case 1:t.longitudinalVehicleHeightReferencePoint=1;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE":case 2:t.longitudinalVehicleHeightReferencePoint=2;break;case"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_REAR":case 3:t.longitudinalVehicleHeightReferencePoint=3}switch(e.lateralVehicleHeightReferencePoint){case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":case 0:t.lateralVehicleHeightReferencePoint=0;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_LEFT":case 1:t.lateralVehicleHeightReferencePoint=1;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE":case 2:t.lateralVehicleHeightReferencePoint=2;break;case"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_RIGHT":case 3:t.lateralVehicleHeightReferencePoint=3}return null!=e.vehicleHeightValue_mm&&(u.Long?(t.vehicleHeightValue_mm=u.Long.fromValue(e.vehicleHeightValue_mm)).unsigned=!1:"string"==typeof e.vehicleHeightValue_mm?t.vehicleHeightValue_mm=parseInt(e.vehicleHeightValue_mm,10):"number"==typeof e.vehicleHeightValue_mm?t.vehicleHeightValue_mm=e.vehicleHeightValue_mm:"object"==typeof e.vehicleHeightValue_mm&&(t.vehicleHeightValue_mm=new u.LongBits(e.vehicleHeightValue_mm.low>>>0,e.vehicleHeightValue_mm.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults)if(i.longitudinalVehicleHeightReferencePoint=t.enums===String?"LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":0,i.lateralVehicleHeightReferencePoint=t.enums===String?"LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED":0,u.Long){var r=new u.Long(0,0,!1);i.vehicleHeightValue_mm=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.vehicleHeightValue_mm=t.longs===String?"0":0;return null!=e.longitudinalVehicleHeightReferencePoint&&e.hasOwnProperty("longitudinalVehicleHeightReferencePoint")&&(i.longitudinalVehicleHeightReferencePoint=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.LongitudinalVehicleHeightReferencePointEnum[e.longitudinalVehicleHeightReferencePoint]:e.longitudinalVehicleHeightReferencePoint),null!=e.lateralVehicleHeightReferencePoint&&e.hasOwnProperty("lateralVehicleHeightReferencePoint")&&(i.lateralVehicleHeightReferencePoint=t.enums===String?d.sdii.here.pb.VehicleMetaData.VehicleHeightDetail.LateralVehicleHeightReferencePointEnum[e.lateralVehicleHeightReferencePoint]:e.lateralVehicleHeightReferencePoint),null!=e.vehicleHeightValue_mm&&e.hasOwnProperty("vehicleHeightValue_mm")&&("number"==typeof e.vehicleHeightValue_mm?i.vehicleHeightValue_mm=t.longs===String?String(e.vehicleHeightValue_mm):e.vehicleHeightValue_mm:i.vehicleHeightValue_mm=t.longs===String?u.Long.prototype.toString.call(e.vehicleHeightValue_mm):t.longs===Number?new u.LongBits(e.vehicleHeightValue_mm.low>>>0,e.vehicleHeightValue_mm.high>>>0).toNumber():e.vehicleHeightValue_mm),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.LongitudinalVehicleHeightReferencePointEnum=function(){var e={},t=Object.create(e);return t[e[0]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED"]=0,t[e[1]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_FRONT"]=1,t[e[2]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE"]=2,t[e[3]="LONGITUDINAL_VEHICLE_HEIGHT_DETAIL_TYPE_REAR"]=3,t}(),e.LateralVehicleHeightReferencePointEnum=function(){var e={},t=Object.create(e);return t[e[0]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_UNDEFINED"]=0,t[e[1]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_LEFT"]=1,t[e[2]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_MIDDLE"]=2,t[e[3]="LATERAL_VEHICLE_HEIGHT_DETAIL_TYPE_RIGHT"]=3,t}(),e}(),e}(),o.Envelope=function(){function e(e){if(this.submissionConfigurationUUIDArray=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.version="",e.prototype.submitter="",e.prototype.vehicleMetaData=null,e.prototype.transientVehicleID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.vehicleProfileID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.transientEventID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.persistentDriverUUID="",e.prototype.persistentVehicleUUID="",e.prototype.transientVehicleUUID="",e.prototype.submissionConfigurationUUIDArray=u.emptyArray,e.prototype.mapProvider="",e.prototype.mapVersion="",e.prototype.mapStandard=0,e.prototype.transientEventUUID="",e.prototype.vehicleHeadUnitVersion="",e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Envelope;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.version=e.string();break;case 2:r.submitter=e.string();break;case 3:r.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.decode(e,e.uint32());break;case 4:r.transientVehicleID=e.int64();break;case 5:r.vehicleProfileID=e.int64();break;case 6:r.transientEventID=e.int64();break;case 7:r.persistentDriverUUID=e.string();break;case 8:r.persistentVehicleUUID=e.string();break;case 9:r.transientVehicleUUID=e.string();break;case 10:r.submissionConfigurationUUIDArray&&r.submissionConfigurationUUIDArray.length||(r.submissionConfigurationUUIDArray=[]),r.submissionConfigurationUUIDArray.push(e.string());break;case 11:r.mapProvider=e.string();break;case 12:r.mapVersion=e.string();break;case 13:r.mapStandard=e.int32();break;case 14:r.transientEventUUID=e.string();break;case 15:r.vehicleHeadUnitVersion=e.string();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("version"))throw u.ProtocolError("missing required 'version'",{instance:r});if(!r.hasOwnProperty("submitter"))throw u.ProtocolError("missing required 'submitter'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Envelope)return e;var t=new d.sdii.here.pb.Envelope;if(null!=e.version&&(t.version=String(e.version)),null!=e.submitter&&(t.submitter=String(e.submitter)),null!=e.vehicleMetaData){if("object"!=typeof e.vehicleMetaData)throw TypeError(".sdii.here.pb.Envelope.vehicleMetaData: object expected");t.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.fromObject(e.vehicleMetaData)}if(null!=e.transientVehicleID&&(u.Long?(t.transientVehicleID=u.Long.fromValue(e.transientVehicleID)).unsigned=!1:"string"==typeof e.transientVehicleID?t.transientVehicleID=parseInt(e.transientVehicleID,10):"number"==typeof e.transientVehicleID?t.transientVehicleID=e.transientVehicleID:"object"==typeof e.transientVehicleID&&(t.transientVehicleID=new u.LongBits(e.transientVehicleID.low>>>0,e.transientVehicleID.high>>>0).toNumber())),null!=e.vehicleProfileID&&(u.Long?(t.vehicleProfileID=u.Long.fromValue(e.vehicleProfileID)).unsigned=!1:"string"==typeof e.vehicleProfileID?t.vehicleProfileID=parseInt(e.vehicleProfileID,10):"number"==typeof e.vehicleProfileID?t.vehicleProfileID=e.vehicleProfileID:"object"==typeof e.vehicleProfileID&&(t.vehicleProfileID=new u.LongBits(e.vehicleProfileID.low>>>0,e.vehicleProfileID.high>>>0).toNumber())),null!=e.transientEventID&&(u.Long?(t.transientEventID=u.Long.fromValue(e.transientEventID)).unsigned=!1:"string"==typeof e.transientEventID?t.transientEventID=parseInt(e.transientEventID,10):"number"==typeof e.transientEventID?t.transientEventID=e.transientEventID:"object"==typeof e.transientEventID&&(t.transientEventID=new u.LongBits(e.transientEventID.low>>>0,e.transientEventID.high>>>0).toNumber())),null!=e.persistentDriverUUID&&(t.persistentDriverUUID=String(e.persistentDriverUUID)),null!=e.persistentVehicleUUID&&(t.persistentVehicleUUID=String(e.persistentVehicleUUID)),null!=e.transientVehicleUUID&&(t.transientVehicleUUID=String(e.transientVehicleUUID)),e.submissionConfigurationUUIDArray){if(!Array.isArray(e.submissionConfigurationUUIDArray))throw TypeError(".sdii.here.pb.Envelope.submissionConfigurationUUIDArray: array expected");t.submissionConfigurationUUIDArray=[];for(var i=0;i<e.submissionConfigurationUUIDArray.length;++i)t.submissionConfigurationUUIDArray[i]=String(e.submissionConfigurationUUIDArray[i])}switch(null!=e.mapProvider&&(t.mapProvider=String(e.mapProvider)),null!=e.mapVersion&&(t.mapVersion=String(e.mapVersion)),e.mapStandard){case"MAP_STANDARD_UNDEFINED":case 0:t.mapStandard=0;break;case"OTHER":case 1:t.mapStandard=1;break;case"NDS":case 2:t.mapStandard=2;break;case"GDF":case 3:t.mapStandard=3;break;case"RDF":case 4:t.mapStandard=4;break;case"HERE_HDMAP":case 5:t.mapStandard=5}return null!=e.transientEventUUID&&(t.transientEventUUID=String(e.transientEventUUID)),null!=e.vehicleHeadUnitVersion&&(t.vehicleHeadUnitVersion=String(e.vehicleHeadUnitVersion)),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.submissionConfigurationUUIDArray=[]),t.defaults){if(i.version="",i.submitter="",i.vehicleMetaData=null,u.Long){var r=new u.Long(0,0,!1);i.transientVehicleID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.transientVehicleID=t.longs===String?"0":0;u.Long?(r=new u.Long(0,0,!1),i.vehicleProfileID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.vehicleProfileID=t.longs===String?"0":0,u.Long?(r=new u.Long(0,0,!1),i.transientEventID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.transientEventID=t.longs===String?"0":0,i.persistentDriverUUID="",i.persistentVehicleUUID="",i.transientVehicleUUID="",i.mapProvider="",i.mapVersion="",i.mapStandard=t.enums===String?"MAP_STANDARD_UNDEFINED":0,i.transientEventUUID="",i.vehicleHeadUnitVersion=""}if(null!=e.version&&e.hasOwnProperty("version")&&(i.version=e.version),null!=e.submitter&&e.hasOwnProperty("submitter")&&(i.submitter=e.submitter),null!=e.vehicleMetaData&&e.hasOwnProperty("vehicleMetaData")&&(i.vehicleMetaData=d.sdii.here.pb.VehicleMetaData.toObject(e.vehicleMetaData,t)),null!=e.transientVehicleID&&e.hasOwnProperty("transientVehicleID")&&("number"==typeof e.transientVehicleID?i.transientVehicleID=t.longs===String?String(e.transientVehicleID):e.transientVehicleID:i.transientVehicleID=t.longs===String?u.Long.prototype.toString.call(e.transientVehicleID):t.longs===Number?new u.LongBits(e.transientVehicleID.low>>>0,e.transientVehicleID.high>>>0).toNumber():e.transientVehicleID),null!=e.vehicleProfileID&&e.hasOwnProperty("vehicleProfileID")&&("number"==typeof e.vehicleProfileID?i.vehicleProfileID=t.longs===String?String(e.vehicleProfileID):e.vehicleProfileID:i.vehicleProfileID=t.longs===String?u.Long.prototype.toString.call(e.vehicleProfileID):t.longs===Number?new u.LongBits(e.vehicleProfileID.low>>>0,e.vehicleProfileID.high>>>0).toNumber():e.vehicleProfileID),null!=e.transientEventID&&e.hasOwnProperty("transientEventID")&&("number"==typeof e.transientEventID?i.transientEventID=t.longs===String?String(e.transientEventID):e.transientEventID:i.transientEventID=t.longs===String?u.Long.prototype.toString.call(e.transientEventID):t.longs===Number?new u.LongBits(e.transientEventID.low>>>0,e.transientEventID.high>>>0).toNumber():e.transientEventID),null!=e.persistentDriverUUID&&e.hasOwnProperty("persistentDriverUUID")&&(i.persistentDriverUUID=e.persistentDriverUUID),null!=e.persistentVehicleUUID&&e.hasOwnProperty("persistentVehicleUUID")&&(i.persistentVehicleUUID=e.persistentVehicleUUID),null!=e.transientVehicleUUID&&e.hasOwnProperty("transientVehicleUUID")&&(i.transientVehicleUUID=e.transientVehicleUUID),e.submissionConfigurationUUIDArray&&e.submissionConfigurationUUIDArray.length){i.submissionConfigurationUUIDArray=[];for(var n=0;n<e.submissionConfigurationUUIDArray.length;++n)i.submissionConfigurationUUIDArray[n]=e.submissionConfigurationUUIDArray[n]}return null!=e.mapProvider&&e.hasOwnProperty("mapProvider")&&(i.mapProvider=e.mapProvider),null!=e.mapVersion&&e.hasOwnProperty("mapVersion")&&(i.mapVersion=e.mapVersion),null!=e.mapStandard&&e.hasOwnProperty("mapStandard")&&(i.mapStandard=t.enums===String?d.sdii.here.pb.Envelope.MapStandardEnum[e.mapStandard]:e.mapStandard),null!=e.transientEventUUID&&e.hasOwnProperty("transientEventUUID")&&(i.transientEventUUID=e.transientEventUUID),null!=e.vehicleHeadUnitVersion&&e.hasOwnProperty("vehicleHeadUnitVersion")&&(i.vehicleHeadUnitVersion=e.vehicleHeadUnitVersion),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.MapStandardEnum=(t={},(i=Object.create(t))[t[0]="MAP_STANDARD_UNDEFINED"]=0,i[t[1]="OTHER"]=1,i[t[2]="NDS"]=2,i[t[3]="GDF"]=3,i[t[4]="RDF"]=4,i[t[5]="HERE_HDMAP"]=5,i),e}(),o.PositionEstimate=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionType=0,e.prototype.interpolatedPoint=!1,e.prototype.longitude_deg=0,e.prototype.latitude_deg=0,e.prototype.horizontalAccuracy_m=0,e.prototype.altitude_m=0,e.prototype.heading_deg=0,e.prototype.speed_mps=0,e.prototype.altitudeAccuracy_m=0,e.prototype.headingAccuracy_deg=0,e.prototype.speedAccuracy_mps=0,e.prototype.speedDetectionType=0,e.prototype.headingDetectionType=0,e.prototype.vehicleReferencedOrientationVector_rad=null,e.prototype.currentLaneEstimate=0,e.prototype.mapMatchedLinkID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mapMatchedLinkIDConfidence_percent=0,e.prototype.mapMatchedLinkIDOffset_m=0,e.prototype.laneCountDirection=0,e.prototype.currentLaneEstimateConfidence_percent=0,e.prototype.firstPointAfterFixLoss=!1,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PositionEstimate;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.positionType=e.int32();break;case 3:r.interpolatedPoint=e.bool();break;case 4:r.longitude_deg=e.double();break;case 5:r.latitude_deg=e.double();break;case 6:r.horizontalAccuracy_m=e.double();break;case 7:r.altitude_m=e.double();break;case 8:r.heading_deg=e.double();break;case 9:r.speed_mps=e.double();break;case 10:r.altitudeAccuracy_m=e.double();break;case 11:r.headingAccuracy_deg=e.double();break;case 12:r.speedAccuracy_mps=e.double();break;case 13:r.speedDetectionType=e.int32();break;case 14:r.headingDetectionType=e.int32();break;case 15:r.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 16:r.currentLaneEstimate=e.int32();break;case 17:r.mapMatchedLinkID=e.int64();break;case 18:r.mapMatchedLinkIDConfidence_percent=e.int32();break;case 19:r.mapMatchedLinkIDOffset_m=e.double();break;case 20:r.laneCountDirection=e.int32();break;case 21:r.currentLaneEstimateConfidence_percent=e.int32();break;case 22:r.firstPointAfterFixLoss=e.bool();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});if(!r.hasOwnProperty("positionType"))throw u.ProtocolError("missing required 'positionType'",{instance:r});if(!r.hasOwnProperty("longitude_deg"))throw u.ProtocolError("missing required 'longitude_deg'",{instance:r});if(!r.hasOwnProperty("latitude_deg"))throw u.ProtocolError("missing required 'latitude_deg'",{instance:r});if(!r.hasOwnProperty("horizontalAccuracy_m"))throw u.ProtocolError("missing required 'horizontalAccuracy_m'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PositionEstimate)return e;var t=new d.sdii.here.pb.PositionEstimate;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.positionType){case"POSITION_TYPE_UNDEFINED":case 0:t.positionType=0;break;case"RAW_GPS":case 1:t.positionType=1;break;case"FILTERED":case 2:t.positionType=2;break;case"MAP_MATCHED_REGULAR_MAP":case 3:t.positionType=3;break;case"MAP_MATCHED_HD_MAP":case 4:t.positionType=4;break;case"MAP_MATCHED_HD_MAP_LANE":case 5:t.positionType=5}switch(null!=e.interpolatedPoint&&(t.interpolatedPoint=Boolean(e.interpolatedPoint)),null!=e.longitude_deg&&(t.longitude_deg=Number(e.longitude_deg)),null!=e.latitude_deg&&(t.latitude_deg=Number(e.latitude_deg)),null!=e.horizontalAccuracy_m&&(t.horizontalAccuracy_m=Number(e.horizontalAccuracy_m)),null!=e.altitude_m&&(t.altitude_m=Number(e.altitude_m)),null!=e.heading_deg&&(t.heading_deg=Number(e.heading_deg)),null!=e.speed_mps&&(t.speed_mps=Number(e.speed_mps)),null!=e.altitudeAccuracy_m&&(t.altitudeAccuracy_m=Number(e.altitudeAccuracy_m)),null!=e.headingAccuracy_deg&&(t.headingAccuracy_deg=Number(e.headingAccuracy_deg)),null!=e.speedAccuracy_mps&&(t.speedAccuracy_mps=Number(e.speedAccuracy_mps)),e.speedDetectionType){case"SPEED_DETECTION_UNDEFINED":case 0:t.speedDetectionType=0;break;case"SPEED_RAW_GPS":case 1:t.speedDetectionType=1;break;case"SPEED_WHEEL_TICKS":case 2:t.speedDetectionType=2;break;case"SPEED_RADAR_SONAR":case 3:t.speedDetectionType=3;break;case"SPEED_FILTERED":case 4:t.speedDetectionType=4}switch(e.headingDetectionType){case"HEADING_DETECTION_UNDEFINED":case 0:t.headingDetectionType=0;break;case"HEADING_RAW_GPS":case 1:t.headingDetectionType=1;break;case"HEADING_MAGNETIC_SENSOR":case 2:t.headingDetectionType=2;break;case"HEADING_MULTI_SENSOR_FUSION":case 3:t.headingDetectionType=3;break;case"HEADING_BY_MAP":case 4:t.headingDetectionType=4}if(null!=e.vehicleReferencedOrientationVector_rad){if("object"!=typeof e.vehicleReferencedOrientationVector_rad)throw TypeError(".sdii.here.pb.PositionEstimate.vehicleReferencedOrientationVector_rad: object expected");t.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.fromObject(e.vehicleReferencedOrientationVector_rad)}switch(null!=e.currentLaneEstimate&&(t.currentLaneEstimate=0|e.currentLaneEstimate),null!=e.mapMatchedLinkID&&(u.Long?(t.mapMatchedLinkID=u.Long.fromValue(e.mapMatchedLinkID)).unsigned=!1:"string"==typeof e.mapMatchedLinkID?t.mapMatchedLinkID=parseInt(e.mapMatchedLinkID,10):"number"==typeof e.mapMatchedLinkID?t.mapMatchedLinkID=e.mapMatchedLinkID:"object"==typeof e.mapMatchedLinkID&&(t.mapMatchedLinkID=new u.LongBits(e.mapMatchedLinkID.low>>>0,e.mapMatchedLinkID.high>>>0).toNumber())),null!=e.mapMatchedLinkIDConfidence_percent&&(t.mapMatchedLinkIDConfidence_percent=0|e.mapMatchedLinkIDConfidence_percent),null!=e.mapMatchedLinkIDOffset_m&&(t.mapMatchedLinkIDOffset_m=Number(e.mapMatchedLinkIDOffset_m)),e.laneCountDirection){case"LANE_COUNT_DIRECTION_UNDEFINED":case 0:t.laneCountDirection=0;break;case"LANE_COUNT_DIRECTION_FROM_LEFT":case 1:t.laneCountDirection=1;break;case"LANE_COUNT_DIRECTION_FROM_RIGHT":case 2:t.laneCountDirection=2}if(null!=e.currentLaneEstimateConfidence_percent&&(t.currentLaneEstimateConfidence_percent=0|e.currentLaneEstimateConfidence_percent),null!=e.firstPointAfterFixLoss&&(t.firstPointAfterFixLoss=Boolean(e.firstPointAfterFixLoss)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.PositionEstimate.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.PositionEstimate.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.positionType=t.enums===String?"POSITION_TYPE_UNDEFINED":0,i.interpolatedPoint=!1,i.longitude_deg=0,i.latitude_deg=0,i.horizontalAccuracy_m=0,i.altitude_m=0,i.heading_deg=0,i.speed_mps=0,i.altitudeAccuracy_m=0,i.headingAccuracy_deg=0,i.speedAccuracy_mps=0,i.speedDetectionType=t.enums===String?"SPEED_DETECTION_UNDEFINED":0,i.headingDetectionType=t.enums===String?"HEADING_DETECTION_UNDEFINED":0,i.vehicleReferencedOrientationVector_rad=null,i.currentLaneEstimate=0,u.Long?(r=new u.Long(0,0,!1),i.mapMatchedLinkID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mapMatchedLinkID=t.longs===String?"0":0,i.mapMatchedLinkIDConfidence_percent=0,i.mapMatchedLinkIDOffset_m=0,i.laneCountDirection=t.enums===String?"LANE_COUNT_DIRECTION_UNDEFINED":0,i.currentLaneEstimateConfidence_percent=0,i.firstPointAfterFixLoss=!1}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionType&&e.hasOwnProperty("positionType")&&(i.positionType=t.enums===String?d.sdii.here.pb.PositionEstimate.PositionTypeEnum[e.positionType]:e.positionType),null!=e.interpolatedPoint&&e.hasOwnProperty("interpolatedPoint")&&(i.interpolatedPoint=e.interpolatedPoint),null!=e.longitude_deg&&e.hasOwnProperty("longitude_deg")&&(i.longitude_deg=t.json&&!isFinite(e.longitude_deg)?String(e.longitude_deg):e.longitude_deg),null!=e.latitude_deg&&e.hasOwnProperty("latitude_deg")&&(i.latitude_deg=t.json&&!isFinite(e.latitude_deg)?String(e.latitude_deg):e.latitude_deg),null!=e.horizontalAccuracy_m&&e.hasOwnProperty("horizontalAccuracy_m")&&(i.horizontalAccuracy_m=t.json&&!isFinite(e.horizontalAccuracy_m)?String(e.horizontalAccuracy_m):e.horizontalAccuracy_m),null!=e.altitude_m&&e.hasOwnProperty("altitude_m")&&(i.altitude_m=t.json&&!isFinite(e.altitude_m)?String(e.altitude_m):e.altitude_m),null!=e.heading_deg&&e.hasOwnProperty("heading_deg")&&(i.heading_deg=t.json&&!isFinite(e.heading_deg)?String(e.heading_deg):e.heading_deg),null!=e.speed_mps&&e.hasOwnProperty("speed_mps")&&(i.speed_mps=t.json&&!isFinite(e.speed_mps)?String(e.speed_mps):e.speed_mps),null!=e.altitudeAccuracy_m&&e.hasOwnProperty("altitudeAccuracy_m")&&(i.altitudeAccuracy_m=t.json&&!isFinite(e.altitudeAccuracy_m)?String(e.altitudeAccuracy_m):e.altitudeAccuracy_m),null!=e.headingAccuracy_deg&&e.hasOwnProperty("headingAccuracy_deg")&&(i.headingAccuracy_deg=t.json&&!isFinite(e.headingAccuracy_deg)?String(e.headingAccuracy_deg):e.headingAccuracy_deg),null!=e.speedAccuracy_mps&&e.hasOwnProperty("speedAccuracy_mps")&&(i.speedAccuracy_mps=t.json&&!isFinite(e.speedAccuracy_mps)?String(e.speedAccuracy_mps):e.speedAccuracy_mps),null!=e.speedDetectionType&&e.hasOwnProperty("speedDetectionType")&&(i.speedDetectionType=t.enums===String?d.sdii.here.pb.PositionEstimate.SpeedDetectionEnum[e.speedDetectionType]:e.speedDetectionType),null!=e.headingDetectionType&&e.hasOwnProperty("headingDetectionType")&&(i.headingDetectionType=t.enums===String?d.sdii.here.pb.PositionEstimate.HeadingDetectionEnum[e.headingDetectionType]:e.headingDetectionType),null!=e.vehicleReferencedOrientationVector_rad&&e.hasOwnProperty("vehicleReferencedOrientationVector_rad")&&(i.vehicleReferencedOrientationVector_rad=d.sdii.here.pb.Vector3D.toObject(e.vehicleReferencedOrientationVector_rad,t)),null!=e.currentLaneEstimate&&e.hasOwnProperty("currentLaneEstimate")&&(i.currentLaneEstimate=e.currentLaneEstimate),null!=e.mapMatchedLinkID&&e.hasOwnProperty("mapMatchedLinkID")&&("number"==typeof e.mapMatchedLinkID?i.mapMatchedLinkID=t.longs===String?String(e.mapMatchedLinkID):e.mapMatchedLinkID:i.mapMatchedLinkID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedLinkID):t.longs===Number?new u.LongBits(e.mapMatchedLinkID.low>>>0,e.mapMatchedLinkID.high>>>0).toNumber():e.mapMatchedLinkID),null!=e.mapMatchedLinkIDConfidence_percent&&e.hasOwnProperty("mapMatchedLinkIDConfidence_percent")&&(i.mapMatchedLinkIDConfidence_percent=e.mapMatchedLinkIDConfidence_percent),null!=e.mapMatchedLinkIDOffset_m&&e.hasOwnProperty("mapMatchedLinkIDOffset_m")&&(i.mapMatchedLinkIDOffset_m=t.json&&!isFinite(e.mapMatchedLinkIDOffset_m)?String(e.mapMatchedLinkIDOffset_m):e.mapMatchedLinkIDOffset_m),null!=e.laneCountDirection&&e.hasOwnProperty("laneCountDirection")&&(i.laneCountDirection=t.enums===String?d.sdii.here.pb.PositionEstimate.LaneCountDirectionEnum[e.laneCountDirection]:e.laneCountDirection),null!=e.currentLaneEstimateConfidence_percent&&e.hasOwnProperty("currentLaneEstimateConfidence_percent")&&(i.currentLaneEstimateConfidence_percent=e.currentLaneEstimateConfidence_percent),null!=e.firstPointAfterFixLoss&&e.hasOwnProperty("firstPointAfterFixLoss")&&(i.firstPointAfterFixLoss=e.firstPointAfterFixLoss),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.PositionTypeEnum=(t={},(i=Object.create(t))[t[0]="POSITION_TYPE_UNDEFINED"]=0,i[t[1]="RAW_GPS"]=1,i[t[2]="FILTERED"]=2,i[t[3]="MAP_MATCHED_REGULAR_MAP"]=3,i[t[4]="MAP_MATCHED_HD_MAP"]=4,i[t[5]="MAP_MATCHED_HD_MAP_LANE"]=5,i),e.SpeedDetectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="SPEED_DETECTION_UNDEFINED"]=0,t[e[1]="SPEED_RAW_GPS"]=1,t[e[2]="SPEED_WHEEL_TICKS"]=2,t[e[3]="SPEED_RADAR_SONAR"]=3,t[e[4]="SPEED_FILTERED"]=4,t}(),e.HeadingDetectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="HEADING_DETECTION_UNDEFINED"]=0,t[e[1]="HEADING_RAW_GPS"]=1,t[e[2]="HEADING_MAGNETIC_SENSOR"]=2,t[e[3]="HEADING_MULTI_SENSOR_FUSION"]=3,t[e[4]="HEADING_BY_MAP"]=4,t}(),e.LaneCountDirectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_COUNT_DIRECTION_UNDEFINED"]=0,t[e[1]="LANE_COUNT_DIRECTION_FROM_LEFT"]=1,t[e[2]="LANE_COUNT_DIRECTION_FROM_RIGHT"]=2,t}(),e}(),o.PathSegment=function(){function e(e){if(this.positionEstimate=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.positionEstimate=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PathSegment;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.positionEstimate&&r.positionEstimate.length||(r.positionEstimate=[]),r.positionEstimate.push(d.sdii.here.pb.PositionEstimate.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathSegment)return e;var t=new d.sdii.here.pb.PathSegment;if(e.positionEstimate){if(!Array.isArray(e.positionEstimate))throw TypeError(".sdii.here.pb.PathSegment.positionEstimate: array expected");t.positionEstimate=[];for(var i=0;i<e.positionEstimate.length;++i){if("object"!=typeof e.positionEstimate[i])throw TypeError(".sdii.here.pb.PathSegment.positionEstimate: object expected");t.positionEstimate[i]=d.sdii.here.pb.PositionEstimate.fromObject(e.positionEstimate[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.positionEstimate=[]),e.positionEstimate&&e.positionEstimate.length){i.positionEstimate=[];for(var r=0;r<e.positionEstimate.length;++r)i.positionEstimate[r]=d.sdii.here.pb.PositionEstimate.toObject(e.positionEstimate[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.Path=function(){function e(e){if(this.positionEstimate=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.positionEstimate=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.Path;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.positionEstimate&&r.positionEstimate.length||(r.positionEstimate=[]),r.positionEstimate.push(d.sdii.here.pb.PositionEstimate.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.Path)return e;var t=new d.sdii.here.pb.Path;if(e.positionEstimate){if(!Array.isArray(e.positionEstimate))throw TypeError(".sdii.here.pb.Path.positionEstimate: array expected");t.positionEstimate=[];for(var i=0;i<e.positionEstimate.length;++i){if("object"!=typeof e.positionEstimate[i])throw TypeError(".sdii.here.pb.Path.positionEstimate: object expected");t.positionEstimate[i]=d.sdii.here.pb.PositionEstimate.fromObject(e.positionEstimate[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.positionEstimate=[]),e.positionEstimate&&e.positionEstimate.length){i.positionEstimate=[];for(var r=0;r<e.positionEstimate.length;++r)i.positionEstimate[r]=d.sdii.here.pb.PositionEstimate.toObject(e.positionEstimate[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.WheelReferenceBitfield=(r={},(n=Object.create(r))[r[1]="frontAxleLeft"]=1,n[r[2]="frontAxleRight"]=2,n[r[4]="rearAxleLeft"]=4,n[r[8]="rearAxleRight"]=8,n),o.VehicleStatus=function(){function e(e){if(this.doorStates=[],this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.transmissionMode=0,e.prototype.lightStateBitfield=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.wiperState=0,e.prototype.temperatureExternal_cel=0,e.prototype.wiperSpeed_wpm=0,e.prototype.driveWheelReference=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.chassisClearance_m=0,e.prototype.mileage_km=0,e.prototype.primaryFuelState=0,e.prototype.primaryFuelStateAccuracy=0,e.prototype.estimatedPrimaryRange_km=0,e.prototype.secondaryFuelState=0,e.prototype.secondaryFuelStateAccuracy=0,e.prototype.estimatedSecondaryRange_km=0,e.prototype.maintenanceLightState=1,e.prototype.currentGear=0,e.prototype.ignitionState=0,e.prototype.engineState=0,e.prototype.doorStates=u.emptyArray,e.prototype.ventilationState=null,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleStatus;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.transmissionMode=e.int32();break;case 3:r.lightStateBitfield=e.int64();break;case 4:r.wiperState=e.int32();break;case 5:r.temperatureExternal_cel=e.double();break;case 6:r.wiperSpeed_wpm=e.int32();break;case 7:r.driveWheelReference=e.int64();break;case 8:r.chassisClearance_m=e.double();break;case 9:r.mileage_km=e.double();break;case 10:r.primaryFuelState=e.double();break;case 11:r.primaryFuelStateAccuracy=e.double();break;case 12:r.estimatedPrimaryRange_km=e.double();break;case 13:r.secondaryFuelState=e.double();break;case 14:r.secondaryFuelStateAccuracy=e.double();break;case 15:r.estimatedSecondaryRange_km=e.double();break;case 16:r.maintenanceLightState=e.int32();break;case 17:r.currentGear=e.uint32();break;case 18:r.ignitionState=e.int32();break;case 19:r.engineState=e.int32();break;case 20:r.doorStates&&r.doorStates.length||(r.doorStates=[]),r.doorStates.push(d.sdii.here.pb.VehicleStatus.DoorStateMessage.decode(e,e.uint32()));break;case 21:r.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.decode(e,e.uint32());break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus)return e;var t=new d.sdii.here.pb.VehicleStatus;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.transmissionMode){case"TRANSMISSION_MODE_UNDEFINED":case 0:t.transmissionMode=0;break;case"PARK":case 1:t.transmissionMode=1;break;case"COASTING":case 2:t.transmissionMode=2;break;case"DRIVE":case 3:t.transmissionMode=3;break;case"REVERSE":case 4:t.transmissionMode=4}switch(null!=e.lightStateBitfield&&(u.Long?(t.lightStateBitfield=u.Long.fromValue(e.lightStateBitfield)).unsigned=!1:"string"==typeof e.lightStateBitfield?t.lightStateBitfield=parseInt(e.lightStateBitfield,10):"number"==typeof e.lightStateBitfield?t.lightStateBitfield=e.lightStateBitfield:"object"==typeof e.lightStateBitfield&&(t.lightStateBitfield=new u.LongBits(e.lightStateBitfield.low>>>0,e.lightStateBitfield.high>>>0).toNumber())),e.wiperState){case"WIPER_STATE_UNDEFINED":case 0:t.wiperState=0;break;case"WIPING_OFF":case 1:t.wiperState=1;break;case"WIPING_SLOW":case 2:t.wiperState=2;break;case"WIPING_MEDIUM":case 3:t.wiperState=3;break;case"WIPING_FAST":case 4:t.wiperState=4;break;case"WIPING_INTERVALL":case 5:t.wiperState=5}switch(null!=e.temperatureExternal_cel&&(t.temperatureExternal_cel=Number(e.temperatureExternal_cel)),null!=e.wiperSpeed_wpm&&(t.wiperSpeed_wpm=0|e.wiperSpeed_wpm),null!=e.driveWheelReference&&(u.Long?(t.driveWheelReference=u.Long.fromValue(e.driveWheelReference)).unsigned=!1:"string"==typeof e.driveWheelReference?t.driveWheelReference=parseInt(e.driveWheelReference,10):"number"==typeof e.driveWheelReference?t.driveWheelReference=e.driveWheelReference:"object"==typeof e.driveWheelReference&&(t.driveWheelReference=new u.LongBits(e.driveWheelReference.low>>>0,e.driveWheelReference.high>>>0).toNumber())),null!=e.chassisClearance_m&&(t.chassisClearance_m=Number(e.chassisClearance_m)),null!=e.mileage_km&&(t.mileage_km=Number(e.mileage_km)),null!=e.primaryFuelState&&(t.primaryFuelState=Number(e.primaryFuelState)),null!=e.primaryFuelStateAccuracy&&(t.primaryFuelStateAccuracy=Number(e.primaryFuelStateAccuracy)),null!=e.estimatedPrimaryRange_km&&(t.estimatedPrimaryRange_km=Number(e.estimatedPrimaryRange_km)),null!=e.secondaryFuelState&&(t.secondaryFuelState=Number(e.secondaryFuelState)),null!=e.secondaryFuelStateAccuracy&&(t.secondaryFuelStateAccuracy=Number(e.secondaryFuelStateAccuracy)),null!=e.estimatedSecondaryRange_km&&(t.estimatedSecondaryRange_km=Number(e.estimatedSecondaryRange_km)),e.maintenanceLightState){case"WARNING_ENGINE_CONTROL":case 1:t.maintenanceLightState=1;break;case"WARNING_OIL_PRESSURE":case 2:t.maintenanceLightState=2;break;case"WARNING_COOLANT_TEMP":case 4:t.maintenanceLightState=4;break;case"WARNING_VEHICLE_SERVICE":case 8:t.maintenanceLightState=8;break;case"WARNING_BATTERY_CHARGING":case 16:t.maintenanceLightState=16;break;case"WARNING_TIRE_PRESSURE":case 32:t.maintenanceLightState=32;break;case"WARNING_LAMP_OUT":case 64:t.maintenanceLightState=64;break;case"WARNING_OTHER_HIGH_PRIO":case 128:t.maintenanceLightState=128;break;case"WARNING_OTHER_LOW_PRIO":case 256:t.maintenanceLightState=256}switch(null!=e.currentGear&&(t.currentGear=e.currentGear>>>0),e.ignitionState){case"IGNITION_STATE_UNDEFINED":case 0:t.ignitionState=0;break;case"IGNITION_OFF":case 1:t.ignitionState=1;break;case"IGNITION_ON":case 2:t.ignitionState=2}switch(e.engineState){case"ENGINE_STATE_UNDEFINED":case 0:t.engineState=0;break;case"ENGINE_OFF":case 1:t.engineState=1;break;case"ENGINE_ECO_OFF":case 2:t.engineState=2;break;case"ENGINE_SET":case 3:t.engineState=3;break;case"ENGINE_RUN":case 4:t.engineState=4}if(e.doorStates){if(!Array.isArray(e.doorStates))throw TypeError(".sdii.here.pb.VehicleStatus.doorStates: array expected");t.doorStates=[];for(var i=0;i<e.doorStates.length;++i){if("object"!=typeof e.doorStates[i])throw TypeError(".sdii.here.pb.VehicleStatus.doorStates: object expected");t.doorStates[i]=d.sdii.here.pb.VehicleStatus.DoorStateMessage.fromObject(e.doorStates[i])}}if(null!=e.ventilationState){if("object"!=typeof e.ventilationState)throw TypeError(".sdii.here.pb.VehicleStatus.ventilationState: object expected");t.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.fromObject(e.ventilationState)}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleStatus.extensionContainer: array expected");for(t.extensionContainer=[],i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.VehicleStatus.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.doorStates=[],i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.transmissionMode=t.enums===String?"TRANSMISSION_MODE_UNDEFINED":0,u.Long?(r=new u.Long(0,0,!1),i.lightStateBitfield=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.lightStateBitfield=t.longs===String?"0":0,i.wiperState=t.enums===String?"WIPER_STATE_UNDEFINED":0,i.temperatureExternal_cel=0,i.wiperSpeed_wpm=0,u.Long?(r=new u.Long(0,0,!1),i.driveWheelReference=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.driveWheelReference=t.longs===String?"0":0,i.chassisClearance_m=0,i.mileage_km=0,i.primaryFuelState=0,i.primaryFuelStateAccuracy=0,i.estimatedPrimaryRange_km=0,i.secondaryFuelState=0,i.secondaryFuelStateAccuracy=0,i.estimatedSecondaryRange_km=0,i.maintenanceLightState=t.enums===String?"WARNING_ENGINE_CONTROL":1,i.currentGear=0,i.ignitionState=t.enums===String?"IGNITION_STATE_UNDEFINED":0,i.engineState=t.enums===String?"ENGINE_STATE_UNDEFINED":0,i.ventilationState=null}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.transmissionMode&&e.hasOwnProperty("transmissionMode")&&(i.transmissionMode=t.enums===String?d.sdii.here.pb.VehicleStatus.TransmissionModeEnum[e.transmissionMode]:e.transmissionMode),null!=e.lightStateBitfield&&e.hasOwnProperty("lightStateBitfield")&&("number"==typeof e.lightStateBitfield?i.lightStateBitfield=t.longs===String?String(e.lightStateBitfield):e.lightStateBitfield:i.lightStateBitfield=t.longs===String?u.Long.prototype.toString.call(e.lightStateBitfield):t.longs===Number?new u.LongBits(e.lightStateBitfield.low>>>0,e.lightStateBitfield.high>>>0).toNumber():e.lightStateBitfield),null!=e.wiperState&&e.hasOwnProperty("wiperState")&&(i.wiperState=t.enums===String?d.sdii.here.pb.VehicleStatus.WiperStateEnum[e.wiperState]:e.wiperState),null!=e.temperatureExternal_cel&&e.hasOwnProperty("temperatureExternal_cel")&&(i.temperatureExternal_cel=t.json&&!isFinite(e.temperatureExternal_cel)?String(e.temperatureExternal_cel):e.temperatureExternal_cel),null!=e.wiperSpeed_wpm&&e.hasOwnProperty("wiperSpeed_wpm")&&(i.wiperSpeed_wpm=e.wiperSpeed_wpm),null!=e.driveWheelReference&&e.hasOwnProperty("driveWheelReference")&&("number"==typeof e.driveWheelReference?i.driveWheelReference=t.longs===String?String(e.driveWheelReference):e.driveWheelReference:i.driveWheelReference=t.longs===String?u.Long.prototype.toString.call(e.driveWheelReference):t.longs===Number?new u.LongBits(e.driveWheelReference.low>>>0,e.driveWheelReference.high>>>0).toNumber():e.driveWheelReference),null!=e.chassisClearance_m&&e.hasOwnProperty("chassisClearance_m")&&(i.chassisClearance_m=t.json&&!isFinite(e.chassisClearance_m)?String(e.chassisClearance_m):e.chassisClearance_m),null!=e.mileage_km&&e.hasOwnProperty("mileage_km")&&(i.mileage_km=t.json&&!isFinite(e.mileage_km)?String(e.mileage_km):e.mileage_km),null!=e.primaryFuelState&&e.hasOwnProperty("primaryFuelState")&&(i.primaryFuelState=t.json&&!isFinite(e.primaryFuelState)?String(e.primaryFuelState):e.primaryFuelState),null!=e.primaryFuelStateAccuracy&&e.hasOwnProperty("primaryFuelStateAccuracy")&&(i.primaryFuelStateAccuracy=t.json&&!isFinite(e.primaryFuelStateAccuracy)?String(e.primaryFuelStateAccuracy):e.primaryFuelStateAccuracy),null!=e.estimatedPrimaryRange_km&&e.hasOwnProperty("estimatedPrimaryRange_km")&&(i.estimatedPrimaryRange_km=t.json&&!isFinite(e.estimatedPrimaryRange_km)?String(e.estimatedPrimaryRange_km):e.estimatedPrimaryRange_km),null!=e.secondaryFuelState&&e.hasOwnProperty("secondaryFuelState")&&(i.secondaryFuelState=t.json&&!isFinite(e.secondaryFuelState)?String(e.secondaryFuelState):e.secondaryFuelState),null!=e.secondaryFuelStateAccuracy&&e.hasOwnProperty("secondaryFuelStateAccuracy")&&(i.secondaryFuelStateAccuracy=t.json&&!isFinite(e.secondaryFuelStateAccuracy)?String(e.secondaryFuelStateAccuracy):e.secondaryFuelStateAccuracy),null!=e.estimatedSecondaryRange_km&&e.hasOwnProperty("estimatedSecondaryRange_km")&&(i.estimatedSecondaryRange_km=t.json&&!isFinite(e.estimatedSecondaryRange_km)?String(e.estimatedSecondaryRange_km):e.estimatedSecondaryRange_km),null!=e.maintenanceLightState&&e.hasOwnProperty("maintenanceLightState")&&(i.maintenanceLightState=t.enums===String?d.sdii.here.pb.VehicleStatus.MaintenanceLightStateBitfield[e.maintenanceLightState]:e.maintenanceLightState),null!=e.currentGear&&e.hasOwnProperty("currentGear")&&(i.currentGear=e.currentGear),null!=e.ignitionState&&e.hasOwnProperty("ignitionState")&&(i.ignitionState=t.enums===String?d.sdii.here.pb.VehicleStatus.IgnitionStateEnum[e.ignitionState]:e.ignitionState),null!=e.engineState&&e.hasOwnProperty("engineState")&&(i.engineState=t.enums===String?d.sdii.here.pb.VehicleStatus.EngineStateEnum[e.engineState]:e.engineState),e.doorStates&&e.doorStates.length){i.doorStates=[];for(var n=0;n<e.doorStates.length;++n)i.doorStates[n]=d.sdii.here.pb.VehicleStatus.DoorStateMessage.toObject(e.doorStates[n],t)}if(null!=e.ventilationState&&e.hasOwnProperty("ventilationState")&&(i.ventilationState=d.sdii.here.pb.VehicleStatus.VentilationStateMessage.toObject(e.ventilationState,t)),e.extensionContainer&&e.extensionContainer.length)for(i.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.TransmissionModeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRANSMISSION_MODE_UNDEFINED"]=0,t[e[1]="PARK"]=1,t[e[2]="COASTING"]=2,t[e[3]="DRIVE"]=3,t[e[4]="REVERSE"]=4,t}(),e.LightStateBitfield=function(){var e={},t=Object.create(e);return t[e[1]="LOWBEAMS"]=1,t[e[2]="HIGHBEAMS"]=2,t[e[4]="FOGLAMP_FRONT"]=4,t[e[8]="FOGLAMP_REAR"]=8,t[e[16]="HAZARD"]=16,t[e[32]="LEFT_TURN"]=32,t[e[64]="RIGHT_TURN"]=64,t}(),e.WiperStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="WIPER_STATE_UNDEFINED"]=0,t[e[1]="WIPING_OFF"]=1,t[e[2]="WIPING_SLOW"]=2,t[e[3]="WIPING_MEDIUM"]=3,t[e[4]="WIPING_FAST"]=4,t[e[5]="WIPING_INTERVALL"]=5,t}(),e.MaintenanceLightStateBitfield=function(){var e={},t=Object.create(e);return t[e[1]="WARNING_ENGINE_CONTROL"]=1,t[e[2]="WARNING_OIL_PRESSURE"]=2,t[e[4]="WARNING_COOLANT_TEMP"]=4,t[e[8]="WARNING_VEHICLE_SERVICE"]=8,t[e[16]="WARNING_BATTERY_CHARGING"]=16,t[e[32]="WARNING_TIRE_PRESSURE"]=32,t[e[64]="WARNING_LAMP_OUT"]=64,t[e[128]="WARNING_OTHER_HIGH_PRIO"]=128,t[e[256]="WARNING_OTHER_LOW_PRIO"]=256,t}(),e.IgnitionStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="IGNITION_STATE_UNDEFINED"]=0,t[e[1]="IGNITION_OFF"]=1,t[e[2]="IGNITION_ON"]=2,t}(),e.EngineStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="ENGINE_STATE_UNDEFINED"]=0,t[e[1]="ENGINE_OFF"]=1,t[e[2]="ENGINE_ECO_OFF"]=2,t[e[3]="ENGINE_SET"]=3,t[e[4]="ENGINE_RUN"]=4,t}(),e.DoorStateMessage=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.door=0,e.prototype.state=0,e.prototype.lock=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleStatus.DoorStateMessage;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.door=e.int32();break;case 2:r.state=e.int32();break;case 3:r.lock=e.int32();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("door"))throw u.ProtocolError("missing required 'door'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus.DoorStateMessage)return e;var t=new d.sdii.here.pb.VehicleStatus.DoorStateMessage;switch(e.door){case"DOOR_IDENTIFICATION_UNDEFINED":case 0:t.door=0;break;case"DOOR_IDENTIFICATION_FRONT_LEFT":case 1:t.door=1;break;case"DOOR_IDENTIFICATION_FRONT_RIGHT":case 2:t.door=2;break;case"DOOR_IDENTIFICATION_REAR_LEFT":case 3:t.door=3;break;case"DOOR_IDENTIFICATION_REAR_RIGHT":case 4:t.door=4;break;case"DOOR_IDENTIFICATION_OTHER_LEFT":case 5:t.door=5;break;case"DOOR_IDENTIFICATION_OTHER_RIGHT":case 6:t.door=6;break;case"DOOR_IDENTIFICATION_TRUNK":case 10:t.door=10;break;case"DOOR_IDENTIFICATION_ENGINE_DOOR":case 20:t.door=20;break;case"DOOR_IDENTIFICATION_FUEL_ENTRY":case 21:t.door=21;break;case"DOOR_IDENTIFICATION_OTHER_MAINTENANCE":case 22:t.door=22}switch(e.state){case"DOOR_STATE_UNDEFINED":case 0:t.state=0;break;case"DOOR_STATE_OPEN":case 1:t.state=1;break;case"DOOR_STATE_CLOSE":case 2:t.state=2}switch(e.lock){case"DOOR_LOCK_STATE_UNDEFINED":case 0:t.lock=0;break;case"DOOR_LOCK_STATE_UNLOCKED":case 1:t.lock=1;break;case"DOOR_LOCK_STATE_LOCKED":case 2:t.lock=2;break;case"DOOR_LOCK_STATE_NO_LOCK":case 3:t.lock=3;break;case"DOOR_LOCK_STATE_AUTO_LOCKED":case 4:t.lock=4}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.door=t.enums===String?"DOOR_IDENTIFICATION_UNDEFINED":0,i.state=t.enums===String?"DOOR_STATE_UNDEFINED":0,i.lock=t.enums===String?"DOOR_LOCK_STATE_UNDEFINED":0),null!=e.door&&e.hasOwnProperty("door")&&(i.door=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorIdentificationEnum[e.door]:e.door),null!=e.state&&e.hasOwnProperty("state")&&(i.state=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorStateEnum[e.state]:e.state),null!=e.lock&&e.hasOwnProperty("lock")&&(i.lock=t.enums===String?d.sdii.here.pb.VehicleStatus.DoorStateMessage.DoorLockStateEnum[e.lock]:e.lock),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.DoorIdentificationEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_IDENTIFICATION_UNDEFINED"]=0,t[e[1]="DOOR_IDENTIFICATION_FRONT_LEFT"]=1,t[e[2]="DOOR_IDENTIFICATION_FRONT_RIGHT"]=2,t[e[3]="DOOR_IDENTIFICATION_REAR_LEFT"]=3,t[e[4]="DOOR_IDENTIFICATION_REAR_RIGHT"]=4,t[e[5]="DOOR_IDENTIFICATION_OTHER_LEFT"]=5,t[e[6]="DOOR_IDENTIFICATION_OTHER_RIGHT"]=6,t[e[10]="DOOR_IDENTIFICATION_TRUNK"]=10,t[e[20]="DOOR_IDENTIFICATION_ENGINE_DOOR"]=20,t[e[21]="DOOR_IDENTIFICATION_FUEL_ENTRY"]=21,t[e[22]="DOOR_IDENTIFICATION_OTHER_MAINTENANCE"]=22,t}(),e.DoorStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_STATE_UNDEFINED"]=0,t[e[1]="DOOR_STATE_OPEN"]=1,t[e[2]="DOOR_STATE_CLOSE"]=2,t}(),e.DoorLockStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="DOOR_LOCK_STATE_UNDEFINED"]=0,t[e[1]="DOOR_LOCK_STATE_UNLOCKED"]=1,t[e[2]="DOOR_LOCK_STATE_LOCKED"]=2,t[e[3]="DOOR_LOCK_STATE_NO_LOCK"]=3,t[e[4]="DOOR_LOCK_STATE_AUTO_LOCKED"]=4,t}(),e}(),e.VentilationStateMessage=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.mainVentilationState=0,e.prototype.mainVentilationSetting=0,e.prototype.circulationSetting=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleStatus.VentilationStateMessage;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.mainVentilationState=e.int32();break;case 2:r.mainVentilationSetting=e.int32();break;case 3:r.circulationSetting=e.int32();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleStatus.VentilationStateMessage)return e;var t=new d.sdii.here.pb.VehicleStatus.VentilationStateMessage;switch(e.mainVentilationState){case"VENTILATION_STATE_UNDEFINED":case 0:t.mainVentilationState=0;break;case"VENTILATION_STATE_ON":case 1:t.mainVentilationState=1;break;case"VENTILATION_STATE_OFF":case 2:t.mainVentilationState=2}switch(e.mainVentilationSetting){case"VENTILATION_SETTING_UNDEFINED":case 0:t.mainVentilationSetting=0;break;case"VENTILATION_SETTING_AUTOMATIC":case 1:t.mainVentilationSetting=1;break;case"VENTILATION_SETTING_MANUAL":case 2:t.mainVentilationSetting=2}switch(e.circulationSetting){case"CIRCULATION_SETTING_UNDEFINED":case 0:t.circulationSetting=0;break;case"CIRCULATION_SETTING_OFF":case 1:t.circulationSetting=1;break;case"CIRCULATION_SETTING_ON":case 2:t.circulationSetting=2}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.mainVentilationState=t.enums===String?"VENTILATION_STATE_UNDEFINED":0,i.mainVentilationSetting=t.enums===String?"VENTILATION_SETTING_UNDEFINED":0,i.circulationSetting=t.enums===String?"CIRCULATION_SETTING_UNDEFINED":0),null!=e.mainVentilationState&&e.hasOwnProperty("mainVentilationState")&&(i.mainVentilationState=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.VentilationStateEnum[e.mainVentilationState]:e.mainVentilationState),null!=e.mainVentilationSetting&&e.hasOwnProperty("mainVentilationSetting")&&(i.mainVentilationSetting=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.VentilationSettingEnum[e.mainVentilationSetting]:e.mainVentilationSetting),null!=e.circulationSetting&&e.hasOwnProperty("circulationSetting")&&(i.circulationSetting=t.enums===String?d.sdii.here.pb.VehicleStatus.VentilationStateMessage.CirculationSettingEnum[e.circulationSetting]:e.circulationSetting),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.VentilationStateEnum=function(){var e={},t=Object.create(e);return t[e[0]="VENTILATION_STATE_UNDEFINED"]=0,t[e[1]="VENTILATION_STATE_ON"]=1,t[e[2]="VENTILATION_STATE_OFF"]=2,t}(),e.VentilationSettingEnum=function(){var e={},t=Object.create(e);return t[e[0]="VENTILATION_SETTING_UNDEFINED"]=0,t[e[1]="VENTILATION_SETTING_AUTOMATIC"]=1,t[e[2]="VENTILATION_SETTING_MANUAL"]=2,t}(),e.CirculationSettingEnum=function(){var e={},t=Object.create(e);return t[e[0]="CIRCULATION_SETTING_UNDEFINED"]=0,t[e[1]="CIRCULATION_SETTING_OFF"]=1,t[e[2]="CIRCULATION_SETTING_ON"]=2,t}(),e}(),e}(),o.VehicleDynamics=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.curvature_1pm=0,e.prototype.slope_percent=0,e.prototype.curvatureAccuracy_1pm=0,e.prototype.slopeAccuracy_percent=0,e.prototype.averageSuspensionTravel_mm=0,e.prototype.averageAccelerationVector_mps2=null,e.prototype.averageRotationRateVector_omega=null,e.prototype.averageSuspensionTravelAccuracy_mm=0,e.prototype.bankAngle_percent=0,e.prototype.steeringWheelAngle_deg=0,e.prototype.steeringWheelAngleAccuracy_deg=0,e.prototype.steeringWheelAngleChange_degPerSec=0,e.prototype.steeringWheelAngleChangeAccuracy_degPerSec=0,e.prototype.accelerationPedalPosition_percent=0,e.prototype.brakePedalPosition_percent=0,e.prototype.engineSpeed_rpm=0,e.prototype.engineTorque_nm=0,e.prototype.brakeTorque_nm=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleDynamics;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.curvature_1pm=e.double();break;case 3:r.slope_percent=e.double();break;case 4:r.curvatureAccuracy_1pm=e.double();break;case 5:r.slopeAccuracy_percent=e.double();break;case 6:r.averageSuspensionTravel_mm=e.int32();break;case 7:r.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:r.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 9:r.averageSuspensionTravelAccuracy_mm=e.int32();break;case 10:r.bankAngle_percent=e.double();break;case 100:r.steeringWheelAngle_deg=e.int32();break;case 101:r.steeringWheelAngleAccuracy_deg=e.int32();break;case 102:r.steeringWheelAngleChange_degPerSec=e.int32();break;case 103:r.steeringWheelAngleChangeAccuracy_degPerSec=e.int32();break;case 104:r.accelerationPedalPosition_percent=e.int32();break;case 105:r.brakePedalPosition_percent=e.int32();break;case 200:r.engineSpeed_rpm=e.int32();break;case 201:r.engineTorque_nm=e.int32();break;case 202:r.brakeTorque_nm=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleDynamics)return e;var t=new d.sdii.here.pb.VehicleDynamics;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.curvature_1pm&&(t.curvature_1pm=Number(e.curvature_1pm)),null!=e.slope_percent&&(t.slope_percent=Number(e.slope_percent)),null!=e.curvatureAccuracy_1pm&&(t.curvatureAccuracy_1pm=Number(e.curvatureAccuracy_1pm)),null!=e.slopeAccuracy_percent&&(t.slopeAccuracy_percent=Number(e.slopeAccuracy_percent)),null!=e.averageSuspensionTravel_mm&&(t.averageSuspensionTravel_mm=0|e.averageSuspensionTravel_mm),null!=e.averageAccelerationVector_mps2){if("object"!=typeof e.averageAccelerationVector_mps2)throw TypeError(".sdii.here.pb.VehicleDynamics.averageAccelerationVector_mps2: object expected");t.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.averageAccelerationVector_mps2)}if(null!=e.averageRotationRateVector_omega){if("object"!=typeof e.averageRotationRateVector_omega)throw TypeError(".sdii.here.pb.VehicleDynamics.averageRotationRateVector_omega: object expected");t.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.fromObject(e.averageRotationRateVector_omega)}if(null!=e.averageSuspensionTravelAccuracy_mm&&(t.averageSuspensionTravelAccuracy_mm=0|e.averageSuspensionTravelAccuracy_mm),null!=e.bankAngle_percent&&(t.bankAngle_percent=Number(e.bankAngle_percent)),null!=e.steeringWheelAngle_deg&&(t.steeringWheelAngle_deg=0|e.steeringWheelAngle_deg),null!=e.steeringWheelAngleAccuracy_deg&&(t.steeringWheelAngleAccuracy_deg=0|e.steeringWheelAngleAccuracy_deg),null!=e.steeringWheelAngleChange_degPerSec&&(t.steeringWheelAngleChange_degPerSec=0|e.steeringWheelAngleChange_degPerSec),null!=e.steeringWheelAngleChangeAccuracy_degPerSec&&(t.steeringWheelAngleChangeAccuracy_degPerSec=0|e.steeringWheelAngleChangeAccuracy_degPerSec),null!=e.accelerationPedalPosition_percent&&(t.accelerationPedalPosition_percent=0|e.accelerationPedalPosition_percent),null!=e.brakePedalPosition_percent&&(t.brakePedalPosition_percent=0|e.brakePedalPosition_percent),null!=e.engineSpeed_rpm&&(t.engineSpeed_rpm=0|e.engineSpeed_rpm),null!=e.engineTorque_nm&&(t.engineTorque_nm=0|e.engineTorque_nm),null!=e.brakeTorque_nm&&(t.brakeTorque_nm=0|e.brakeTorque_nm),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleDynamics.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.VehicleDynamics.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.curvature_1pm=0,i.slope_percent=0,i.curvatureAccuracy_1pm=0,i.slopeAccuracy_percent=0,i.averageSuspensionTravel_mm=0,i.averageAccelerationVector_mps2=null,i.averageRotationRateVector_omega=null,i.averageSuspensionTravelAccuracy_mm=0,i.bankAngle_percent=0,i.steeringWheelAngle_deg=0,i.steeringWheelAngleAccuracy_deg=0,i.steeringWheelAngleChange_degPerSec=0,i.steeringWheelAngleChangeAccuracy_degPerSec=0,i.accelerationPedalPosition_percent=0,i.brakePedalPosition_percent=0,i.engineSpeed_rpm=0,i.engineTorque_nm=0,i.brakeTorque_nm=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.curvature_1pm&&e.hasOwnProperty("curvature_1pm")&&(i.curvature_1pm=t.json&&!isFinite(e.curvature_1pm)?String(e.curvature_1pm):e.curvature_1pm),null!=e.slope_percent&&e.hasOwnProperty("slope_percent")&&(i.slope_percent=t.json&&!isFinite(e.slope_percent)?String(e.slope_percent):e.slope_percent),null!=e.curvatureAccuracy_1pm&&e.hasOwnProperty("curvatureAccuracy_1pm")&&(i.curvatureAccuracy_1pm=t.json&&!isFinite(e.curvatureAccuracy_1pm)?String(e.curvatureAccuracy_1pm):e.curvatureAccuracy_1pm),null!=e.slopeAccuracy_percent&&e.hasOwnProperty("slopeAccuracy_percent")&&(i.slopeAccuracy_percent=t.json&&!isFinite(e.slopeAccuracy_percent)?String(e.slopeAccuracy_percent):e.slopeAccuracy_percent),null!=e.averageSuspensionTravel_mm&&e.hasOwnProperty("averageSuspensionTravel_mm")&&(i.averageSuspensionTravel_mm=e.averageSuspensionTravel_mm),null!=e.averageAccelerationVector_mps2&&e.hasOwnProperty("averageAccelerationVector_mps2")&&(i.averageAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.averageAccelerationVector_mps2,t)),null!=e.averageRotationRateVector_omega&&e.hasOwnProperty("averageRotationRateVector_omega")&&(i.averageRotationRateVector_omega=d.sdii.here.pb.Vector3D.toObject(e.averageRotationRateVector_omega,t)),null!=e.averageSuspensionTravelAccuracy_mm&&e.hasOwnProperty("averageSuspensionTravelAccuracy_mm")&&(i.averageSuspensionTravelAccuracy_mm=e.averageSuspensionTravelAccuracy_mm),null!=e.bankAngle_percent&&e.hasOwnProperty("bankAngle_percent")&&(i.bankAngle_percent=t.json&&!isFinite(e.bankAngle_percent)?String(e.bankAngle_percent):e.bankAngle_percent),null!=e.steeringWheelAngle_deg&&e.hasOwnProperty("steeringWheelAngle_deg")&&(i.steeringWheelAngle_deg=e.steeringWheelAngle_deg),null!=e.steeringWheelAngleAccuracy_deg&&e.hasOwnProperty("steeringWheelAngleAccuracy_deg")&&(i.steeringWheelAngleAccuracy_deg=e.steeringWheelAngleAccuracy_deg),null!=e.steeringWheelAngleChange_degPerSec&&e.hasOwnProperty("steeringWheelAngleChange_degPerSec")&&(i.steeringWheelAngleChange_degPerSec=e.steeringWheelAngleChange_degPerSec),null!=e.steeringWheelAngleChangeAccuracy_degPerSec&&e.hasOwnProperty("steeringWheelAngleChangeAccuracy_degPerSec")&&(i.steeringWheelAngleChangeAccuracy_degPerSec=e.steeringWheelAngleChangeAccuracy_degPerSec),null!=e.accelerationPedalPosition_percent&&e.hasOwnProperty("accelerationPedalPosition_percent")&&(i.accelerationPedalPosition_percent=e.accelerationPedalPosition_percent),null!=e.brakePedalPosition_percent&&e.hasOwnProperty("brakePedalPosition_percent")&&(i.brakePedalPosition_percent=e.brakePedalPosition_percent),null!=e.engineSpeed_rpm&&e.hasOwnProperty("engineSpeed_rpm")&&(i.engineSpeed_rpm=e.engineSpeed_rpm),null!=e.engineTorque_nm&&e.hasOwnProperty("engineTorque_nm")&&(i.engineTorque_nm=e.engineTorque_nm),null!=e.brakeTorque_nm&&e.hasOwnProperty("brakeTorque_nm")&&(i.brakeTorque_nm=e.brakeTorque_nm),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.PositionOffset=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.lateralOffset_m=0,e.prototype.lateralOffsetSimple=0,e.prototype.longitudinalOffset_m=0,e.prototype.longitudinalOffsetSimple=0,e.prototype.verticalOffset_m=0,e.prototype.verticalOffsetSimple=0,e.prototype.lateralOffsetAccuracy_m=0,e.prototype.longitudinalOffsetAccuracy_m=0,e.prototype.verticalOffsetAccuracy_m=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PositionOffset;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.lateralOffset_m=e.double();break;case 2:r.lateralOffsetSimple=e.int32();break;case 3:r.longitudinalOffset_m=e.double();break;case 4:r.longitudinalOffsetSimple=e.int32();break;case 5:r.verticalOffset_m=e.double();break;case 6:r.verticalOffsetSimple=e.int32();break;case 7:r.lateralOffsetAccuracy_m=e.double();break;case 8:r.longitudinalOffsetAccuracy_m=e.double();break;case 9:r.verticalOffsetAccuracy_m=e.double();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PositionOffset)return e;var t=new d.sdii.here.pb.PositionOffset;switch(null!=e.lateralOffset_m&&(t.lateralOffset_m=Number(e.lateralOffset_m)),e.lateralOffsetSimple){case"LATERAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.lateralOffsetSimple=0;break;case"LATERAL_OFFSET_SIMPLE_LEFT":case 1:t.lateralOffsetSimple=1;break;case"LATERAL_OFFSET_SIMPLE_MIDDLE":case 2:t.lateralOffsetSimple=2;break;case"LATERAL_OFFSET_SIMPLE_RIGHT":case 3:t.lateralOffsetSimple=3}switch(null!=e.longitudinalOffset_m&&(t.longitudinalOffset_m=Number(e.longitudinalOffset_m)),e.longitudinalOffsetSimple){case"LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.longitudinalOffsetSimple=0;break;case"LONGITUDINAL_OFFSET_SIMPLE_FRONT":case 1:t.longitudinalOffsetSimple=1;break;case"LONGITUDINAL_OFFSET_SIMPLE_CENTER":case 2:t.longitudinalOffsetSimple=2;break;case"LONGITUDINAL_OFFSET_SIMPLE_BACK":case 3:t.longitudinalOffsetSimple=3}switch(null!=e.verticalOffset_m&&(t.verticalOffset_m=Number(e.verticalOffset_m)),e.verticalOffsetSimple){case"VERTICAL_OFFSET_SIMPLE_UNDEFINED":case 0:t.verticalOffsetSimple=0;break;case"VERTICAL_OFFSET_SIMPLE_ABOVE":case 1:t.verticalOffsetSimple=1;break;case"VERTICAL_OFFSET_SIMPLE_AT_LEVEL":case 2:t.verticalOffsetSimple=2;break;case"VERTICAL_OFFSET_SIMPLE_BELOW":case 3:t.verticalOffsetSimple=3}return null!=e.lateralOffsetAccuracy_m&&(t.lateralOffsetAccuracy_m=Number(e.lateralOffsetAccuracy_m)),null!=e.longitudinalOffsetAccuracy_m&&(t.longitudinalOffsetAccuracy_m=Number(e.longitudinalOffsetAccuracy_m)),null!=e.verticalOffsetAccuracy_m&&(t.verticalOffsetAccuracy_m=Number(e.verticalOffsetAccuracy_m)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.lateralOffset_m=0,i.lateralOffsetSimple=t.enums===String?"LATERAL_OFFSET_SIMPLE_UNDEFINED":0,i.longitudinalOffset_m=0,i.longitudinalOffsetSimple=t.enums===String?"LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED":0,i.verticalOffset_m=0,i.verticalOffsetSimple=t.enums===String?"VERTICAL_OFFSET_SIMPLE_UNDEFINED":0,i.lateralOffsetAccuracy_m=0,i.longitudinalOffsetAccuracy_m=0,i.verticalOffsetAccuracy_m=0),null!=e.lateralOffset_m&&e.hasOwnProperty("lateralOffset_m")&&(i.lateralOffset_m=t.json&&!isFinite(e.lateralOffset_m)?String(e.lateralOffset_m):e.lateralOffset_m),null!=e.lateralOffsetSimple&&e.hasOwnProperty("lateralOffsetSimple")&&(i.lateralOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.LateralOffsetSimpleEnum[e.lateralOffsetSimple]:e.lateralOffsetSimple),null!=e.longitudinalOffset_m&&e.hasOwnProperty("longitudinalOffset_m")&&(i.longitudinalOffset_m=t.json&&!isFinite(e.longitudinalOffset_m)?String(e.longitudinalOffset_m):e.longitudinalOffset_m),null!=e.longitudinalOffsetSimple&&e.hasOwnProperty("longitudinalOffsetSimple")&&(i.longitudinalOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.LongitudinalOffsetSimpleEnum[e.longitudinalOffsetSimple]:e.longitudinalOffsetSimple),null!=e.verticalOffset_m&&e.hasOwnProperty("verticalOffset_m")&&(i.verticalOffset_m=t.json&&!isFinite(e.verticalOffset_m)?String(e.verticalOffset_m):e.verticalOffset_m),null!=e.verticalOffsetSimple&&e.hasOwnProperty("verticalOffsetSimple")&&(i.verticalOffsetSimple=t.enums===String?d.sdii.here.pb.PositionOffset.VerticalOffsetSimpleEnum[e.verticalOffsetSimple]:e.verticalOffsetSimple),null!=e.lateralOffsetAccuracy_m&&e.hasOwnProperty("lateralOffsetAccuracy_m")&&(i.lateralOffsetAccuracy_m=t.json&&!isFinite(e.lateralOffsetAccuracy_m)?String(e.lateralOffsetAccuracy_m):e.lateralOffsetAccuracy_m),null!=e.longitudinalOffsetAccuracy_m&&e.hasOwnProperty("longitudinalOffsetAccuracy_m")&&(i.longitudinalOffsetAccuracy_m=t.json&&!isFinite(e.longitudinalOffsetAccuracy_m)?String(e.longitudinalOffsetAccuracy_m):e.longitudinalOffsetAccuracy_m),null!=e.verticalOffsetAccuracy_m&&e.hasOwnProperty("verticalOffsetAccuracy_m")&&(i.verticalOffsetAccuracy_m=t.json&&!isFinite(e.verticalOffsetAccuracy_m)?String(e.verticalOffsetAccuracy_m):e.verticalOffsetAccuracy_m),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.LateralOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="LATERAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="LATERAL_OFFSET_SIMPLE_LEFT"]=1,t[e[2]="LATERAL_OFFSET_SIMPLE_MIDDLE"]=2,t[e[3]="LATERAL_OFFSET_SIMPLE_RIGHT"]=3,t}(),e.LongitudinalOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="LONGITUDINAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="LONGITUDINAL_OFFSET_SIMPLE_FRONT"]=1,t[e[2]="LONGITUDINAL_OFFSET_SIMPLE_CENTER"]=2,t[e[3]="LONGITUDINAL_OFFSET_SIMPLE_BACK"]=3,t}(),e.VerticalOffsetSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="VERTICAL_OFFSET_SIMPLE_UNDEFINED"]=0,t[e[1]="VERTICAL_OFFSET_SIMPLE_ABOVE"]=1,t[e[2]="VERTICAL_OFFSET_SIMPLE_AT_LEVEL"]=2,t[e[3]="VERTICAL_OFFSET_SIMPLE_BELOW"]=3,t}(),e}(),o.SignRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.roadSignType=0,e.prototype.roadSignPermanency=0,e.prototype.roadSignValue="",e.prototype.roadSignDependencies=0,e.prototype.roadSignValidity=0,e.prototype.roadSignValidityValue=0,e.prototype.roadSignRecognitionType=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.signRecognitionConfidence_percent=0,e.prototype.mapMatchedSignID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.unspecifiedSignType="",e.prototype.size3D=null,e.prototype.signShape=0,e.prototype.rotation=null,e.prototype.roadSignDependencyText="",e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.SignRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:r.roadSignType=e.int32();break;case 4:r.roadSignPermanency=e.int32();break;case 5:r.roadSignValue=e.string();break;case 6:r.roadSignDependencies=e.int32();break;case 7:r.roadSignValidity=e.int32();break;case 8:r.roadSignValidityValue=e.double();break;case 9:r.roadSignRecognitionType=e.int32();break;case 10:r.detectedObjectID=e.int64();break;case 11:r.mediaID=e.int64();break;case 12:r.signRecognitionConfidence_percent=e.int32();break;case 13:r.mapMatchedSignID=e.int64();break;case 14:r.unspecifiedSignType=e.string();break;case 15:r.size3D=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 16:r.signShape=e.int32();break;case 17:r.rotation=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 18:r.roadSignDependencyText=e.string();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});if(!r.hasOwnProperty("roadSignType"))throw u.ProtocolError("missing required 'roadSignType'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SignRecognition)return e;var t=new d.sdii.here.pb.SignRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.SignRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.roadSignType){case"ROAD_SIGN_TYPE_UNDEFINED":case 0:t.roadSignType=0;break;case"SPEED_LIMIT_START":case 1:t.roadSignType=1;break;case"SPEED_LIMIT_END":case 2:t.roadSignType=2;break;case"NO_OVERTAKING_PASSENGER_CARS_START":case 3:t.roadSignType=3;break;case"NO_OVERTAKING_PASSENGER_CARS_END":case 4:t.roadSignType=4;break;case"NO_OVERTAKING_TRUCKS_START":case 5:t.roadSignType=5;break;case"NO_OVERTAKING_TRUCKS_END":case 6:t.roadSignType=6;break;case"ALL_RESTRICTIONS_END":case 7:t.roadSignType=7;break;case"CITY_START":case 8:t.roadSignType=8;break;case"CITY_END":case 9:t.roadSignType=9;break;case"MOTORWAY_START":case 10:t.roadSignType=10;break;case"MOTORWAY_END":case 11:t.roadSignType=11;break;case"CONSTRUCTION_START":case 12:t.roadSignType=12;break;case"CONSTRUCTION_END":case 13:t.roadSignType=13;break;case"PROTECTED_OVERTAKING_EXTRALANE":case 14:t.roadSignType=14;break;case"PROTECTED_OVERTAKING_EXTRALANE_RIGHTSIDE":case 15:t.roadSignType=15;break;case"PROTECTED_OVERTAKING_EXTRALANE_LEFTSIDE":case 16:t.roadSignType=16;break;case"LANE_MERGE_RIGHT":case 17:t.roadSignType=17;break;case"LANE_MERGE_LEFT":case 18:t.roadSignType=18;break;case"LANE_MERGE_CENTER":case 19:t.roadSignType=19;break;case"RAILWAY_CROSSING_PROTECTED":case 20:t.roadSignType=20;break;case"RAILWAY_CROSSING_UNPROTECTED":case 21:t.roadSignType=21;break;case"ROAD_NARROWS":case 22:t.roadSignType=22;break;case"SHARP_CURVE":case 23:t.roadSignType=23;break;case"SHARP_CURVE_LEFT":case 24:t.roadSignType=24;break;case"SHARP_CURVE_RIGHT":case 25:t.roadSignType=25;break;case"WINDING_ROAD_STARTING_LEFT":case 26:t.roadSignType=26;break;case"WINDING_ROAD_STARTING_RIGHT":case 27:t.roadSignType=27;break;case"STEEP_HILL":case 28:t.roadSignType=28;break;case"STEEP_HILL_UPWARDS":case 29:t.roadSignType=29;break;case"STEEP_HILL_DOWNWARDS":case 30:t.roadSignType=30;break;case"STOP_SIGN":case 31:t.roadSignType=31;break;case"LATERAL_WIND":case 32:t.roadSignType=32;break;case"GENERAL_WARNING":case 33:t.roadSignType=33;break;case"RISK_OF_GROUNDING":case 34:t.roadSignType=34;break;case"ANIMAL_CROSSING":case 35:t.roadSignType=35;break;case"ICY_CONDITIONS":case 36:t.roadSignType=36;break;case"SLIPPERY_ROAD":case 37:t.roadSignType=37;break;case"FALLING_ROCKS":case 38:t.roadSignType=38;break;case"SCHOOL_ZONE":case 39:t.roadSignType=39;break;case"TRAMWAY_CROSSING":case 40:t.roadSignType=40;break;case"CONGESTION_HAZARD":case 41:t.roadSignType=41;break;case"ACCIDENT_HAZARD":case 42:t.roadSignType=42;break;case"PRIORITY_OVER_ONCOMING_TRAFFIC":case 43:t.roadSignType=43;break;case"YIELD_TO_ONCOMING_TRAFFIC":case 44:t.roadSignType=44;break;case"PREFERENCE_ROAD_START":case 45:t.roadSignType=45;break;case"PREFERENCE_ROAD_END":case 46:t.roadSignType=46;break;case"TRAFFIC_CALMING_START":case 47:t.roadSignType=47;break;case"TRAFFIC_CALMING_END":case 48:t.roadSignType=48;break;case"ENVIRONMENTAL_AREA_START":case 49:t.roadSignType=49;break;case"ENVIRONMENTAL_AREA_END":case 50:t.roadSignType=50;break;case"GIVE_WAY":case 51:t.roadSignType=51;break;case"ROUNDABOUT_INTERSECTION":case 52:t.roadSignType=52;break;case"MANDATORY_TURN_RIGHT_ONLY":case 53:t.roadSignType=53;break;case"MANDATORY_TURN_LEFT_ONLY":case 54:t.roadSignType=54;break;case"MANDATORY_TURN_STRAIGHT_ONLY":case 55:t.roadSignType=55;break;case"NO_ENTRY":case 56:t.roadSignType=56;break;case"ADVISORY_SPEED":case 57:t.roadSignType=57;break;case"HIGH_OCCUPANCY_VEHICLE_LANE":case 58:t.roadSignType=58;break;case"SHOULDER_OPEN_FOR_TRAFFIC":case 59:t.roadSignType=59;break;case"SHOULDER_CLOSE_FOR_TRAFFIC":case 60:t.roadSignType=60;break;case"LANE_CLOSED":case 61:t.roadSignType=61;break;case"PEDESTRIAN_CROSSING":case 62:t.roadSignType=62;break;case"RAILWAY_CROSSING_GENERAL":case 63:t.roadSignType=63}switch(e.roadSignPermanency){case"ROAD_SIGN_PERMANENCY_UNDEFINED":case 0:t.roadSignPermanency=0;break;case"STATIC":case 1:t.roadSignPermanency=1;break;case"VARIABLE":case 2:t.roadSignPermanency=2;break;case"VARIABLE_DEACTIVATED":case 3:t.roadSignPermanency=3}switch(null!=e.roadSignValue&&(t.roadSignValue=String(e.roadSignValue)),e.roadSignDependencies){case"ROAD_SIGN_DEPENDENCY_UNDEFINED":case 0:t.roadSignDependencies=0;break;case"RAIN":case 1:t.roadSignDependencies=1;break;case"SNOW":case 2:t.roadSignDependencies=2;break;case"TIME":case 3:t.roadSignDependencies=3;break;case"SEASON":case 4:t.roadSignDependencies=4;break;case"FOG":case 5:t.roadSignDependencies=5;break;case"SCHOOL":case 6:t.roadSignDependencies=6;break;case"TRUCKS":case 7:t.roadSignDependencies=7;break;case"TRAILER":case 8:t.roadSignDependencies=8;break;case"PASSENGER_CARS_WITH_TRAILER":case 9:t.roadSignDependencies=9;break;case"TRUCKS_WITH_TRAILER":case 10:t.roadSignDependencies=10;break;case"EXCEPT_TRACTOR":case 11:t.roadSignDependencies=11;break;case"BUS":case 12:t.roadSignDependencies=12;break;case"OTHER_DEPENDENCY_AS_TEXT":case 100:t.roadSignDependencies=100}switch(e.roadSignValidity){case"ROAD_SIGN_VALIDITY_UNDEFINED":case 0:t.roadSignValidity=0;break;case"STARTING_IN":case 1:t.roadSignValidity=1;break;case"VALID_FOR":case 2:t.roadSignValidity=2;break;case"IN_RIGHT_DIRECTION":case 3:t.roadSignValidity=3;break;case"IN_LEFT_DIRECTION":case 4:t.roadSignValidity=4;break;case"ZONE":case 5:t.roadSignValidity=5;break;case"BEGIN_OF_VALIDITY":case 6:t.roadSignValidity=6;break;case"END_OF_VALIDITY":case 7:t.roadSignValidity=7}switch(null!=e.roadSignValidityValue&&(t.roadSignValidityValue=Number(e.roadSignValidityValue)),e.roadSignRecognitionType){case"ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED":case 0:t.roadSignRecognitionType=0;break;case"SIGN_DETECTED":case 1:t.roadSignRecognitionType=1;break;case"SIGN_NOT_DETECTED":case 2:t.roadSignRecognitionType=2;break;case"SIGN_TEMPORARY_INVALIDATED":case 3:t.roadSignRecognitionType=3;break;case"SIGN_MISMATCHED":case 4:t.roadSignRecognitionType=4}if(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),null!=e.signRecognitionConfidence_percent&&(t.signRecognitionConfidence_percent=0|e.signRecognitionConfidence_percent),null!=e.mapMatchedSignID&&(u.Long?(t.mapMatchedSignID=u.Long.fromValue(e.mapMatchedSignID)).unsigned=!1:"string"==typeof e.mapMatchedSignID?t.mapMatchedSignID=parseInt(e.mapMatchedSignID,10):"number"==typeof e.mapMatchedSignID?t.mapMatchedSignID=e.mapMatchedSignID:"object"==typeof e.mapMatchedSignID&&(t.mapMatchedSignID=new u.LongBits(e.mapMatchedSignID.low>>>0,e.mapMatchedSignID.high>>>0).toNumber())),null!=e.unspecifiedSignType&&(t.unspecifiedSignType=String(e.unspecifiedSignType)),null!=e.size3D){if("object"!=typeof e.size3D)throw TypeError(".sdii.here.pb.SignRecognition.size3D: object expected");t.size3D=d.sdii.here.pb.Vector3D.fromObject(e.size3D)}switch(e.signShape){case"ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED":case 0:t.signShape=0;break;case"RECTANGLE":case 1:t.signShape=1;break;case"SQUARE":case 2:t.signShape=2;break;case"TRIANGLE_UP":case 3:t.signShape=3;break;case"TRIANGLE_DOWN":case 4:t.signShape=4;break;case"DIAMOND":case 5:t.signShape=5;break;case"HEXAGON":case 6:t.signShape=6;break;case"CIRCLE":case 7:t.signShape=7}if(null!=e.rotation){if("object"!=typeof e.rotation)throw TypeError(".sdii.here.pb.SignRecognition.rotation: object expected");t.rotation=d.sdii.here.pb.Vector3D.fromObject(e.rotation)}if(null!=e.roadSignDependencyText&&(t.roadSignDependencyText=String(e.roadSignDependencyText)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.SignRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.SignRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.positionOffset=null,i.roadSignType=t.enums===String?"ROAD_SIGN_TYPE_UNDEFINED":0,i.roadSignPermanency=t.enums===String?"ROAD_SIGN_PERMANENCY_UNDEFINED":0,i.roadSignValue="",i.roadSignDependencies=t.enums===String?"ROAD_SIGN_DEPENDENCY_UNDEFINED":0,i.roadSignValidity=t.enums===String?"ROAD_SIGN_VALIDITY_UNDEFINED":0,i.roadSignValidityValue=0,i.roadSignRecognitionType=t.enums===String?"ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED":0,u.Long?(r=new u.Long(0,0,!1),i.detectedObjectID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.detectedObjectID=t.longs===String?"0":0,u.Long?(r=new u.Long(0,0,!1),i.mediaID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mediaID=t.longs===String?"0":0,i.signRecognitionConfidence_percent=0,u.Long?(r=new u.Long(0,0,!1),i.mapMatchedSignID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mapMatchedSignID=t.longs===String?"0":0,i.unspecifiedSignType="",i.size3D=null,i.signShape=t.enums===String?"ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED":0,i.rotation=null,i.roadSignDependencyText=""}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(i.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.roadSignType&&e.hasOwnProperty("roadSignType")&&(i.roadSignType=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignTypeEnum[e.roadSignType]:e.roadSignType),null!=e.roadSignPermanency&&e.hasOwnProperty("roadSignPermanency")&&(i.roadSignPermanency=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignPermanencyEnum[e.roadSignPermanency]:e.roadSignPermanency),null!=e.roadSignValue&&e.hasOwnProperty("roadSignValue")&&(i.roadSignValue=e.roadSignValue),null!=e.roadSignDependencies&&e.hasOwnProperty("roadSignDependencies")&&(i.roadSignDependencies=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignDependenciesEnum[e.roadSignDependencies]:e.roadSignDependencies),null!=e.roadSignValidity&&e.hasOwnProperty("roadSignValidity")&&(i.roadSignValidity=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignValidityEnum[e.roadSignValidity]:e.roadSignValidity),null!=e.roadSignValidityValue&&e.hasOwnProperty("roadSignValidityValue")&&(i.roadSignValidityValue=t.json&&!isFinite(e.roadSignValidityValue)?String(e.roadSignValidityValue):e.roadSignValidityValue),null!=e.roadSignRecognitionType&&e.hasOwnProperty("roadSignRecognitionType")&&(i.roadSignRecognitionType=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignRecognitionTypeEnum[e.roadSignRecognitionType]:e.roadSignRecognitionType),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?i.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:i.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?i.mediaID=t.longs===String?String(e.mediaID):e.mediaID:i.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.signRecognitionConfidence_percent&&e.hasOwnProperty("signRecognitionConfidence_percent")&&(i.signRecognitionConfidence_percent=e.signRecognitionConfidence_percent),null!=e.mapMatchedSignID&&e.hasOwnProperty("mapMatchedSignID")&&("number"==typeof e.mapMatchedSignID?i.mapMatchedSignID=t.longs===String?String(e.mapMatchedSignID):e.mapMatchedSignID:i.mapMatchedSignID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedSignID):t.longs===Number?new u.LongBits(e.mapMatchedSignID.low>>>0,e.mapMatchedSignID.high>>>0).toNumber():e.mapMatchedSignID),null!=e.unspecifiedSignType&&e.hasOwnProperty("unspecifiedSignType")&&(i.unspecifiedSignType=e.unspecifiedSignType),null!=e.size3D&&e.hasOwnProperty("size3D")&&(i.size3D=d.sdii.here.pb.Vector3D.toObject(e.size3D,t)),null!=e.signShape&&e.hasOwnProperty("signShape")&&(i.signShape=t.enums===String?d.sdii.here.pb.SignRecognition.RoadSignRecognitionShapeEnum[e.signShape]:e.signShape),null!=e.rotation&&e.hasOwnProperty("rotation")&&(i.rotation=d.sdii.here.pb.Vector3D.toObject(e.rotation,t)),null!=e.roadSignDependencyText&&e.hasOwnProperty("roadSignDependencyText")&&(i.roadSignDependencyText=e.roadSignDependencyText),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.RoadSignTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_TYPE_UNDEFINED"]=0,t[e[1]="SPEED_LIMIT_START"]=1,t[e[2]="SPEED_LIMIT_END"]=2,t[e[3]="NO_OVERTAKING_PASSENGER_CARS_START"]=3,t[e[4]="NO_OVERTAKING_PASSENGER_CARS_END"]=4,t[e[5]="NO_OVERTAKING_TRUCKS_START"]=5,t[e[6]="NO_OVERTAKING_TRUCKS_END"]=6,t[e[7]="ALL_RESTRICTIONS_END"]=7,t[e[8]="CITY_START"]=8,t[e[9]="CITY_END"]=9,t[e[10]="MOTORWAY_START"]=10,t[e[11]="MOTORWAY_END"]=11,t[e[12]="CONSTRUCTION_START"]=12,t[e[13]="CONSTRUCTION_END"]=13,t[e[14]="PROTECTED_OVERTAKING_EXTRALANE"]=14,t[e[15]="PROTECTED_OVERTAKING_EXTRALANE_RIGHTSIDE"]=15,t[e[16]="PROTECTED_OVERTAKING_EXTRALANE_LEFTSIDE"]=16,t[e[17]="LANE_MERGE_RIGHT"]=17,t[e[18]="LANE_MERGE_LEFT"]=18,t[e[19]="LANE_MERGE_CENTER"]=19,t[e[20]="RAILWAY_CROSSING_PROTECTED"]=20,t[e[21]="RAILWAY_CROSSING_UNPROTECTED"]=21,t[e[22]="ROAD_NARROWS"]=22,t[e[23]="SHARP_CURVE"]=23,t[e[24]="SHARP_CURVE_LEFT"]=24,t[e[25]="SHARP_CURVE_RIGHT"]=25,t[e[26]="WINDING_ROAD_STARTING_LEFT"]=26,t[e[27]="WINDING_ROAD_STARTING_RIGHT"]=27,t[e[28]="STEEP_HILL"]=28,t[e[29]="STEEP_HILL_UPWARDS"]=29,t[e[30]="STEEP_HILL_DOWNWARDS"]=30,t[e[31]="STOP_SIGN"]=31,t[e[32]="LATERAL_WIND"]=32,t[e[33]="GENERAL_WARNING"]=33,t[e[34]="RISK_OF_GROUNDING"]=34,t[e[35]="ANIMAL_CROSSING"]=35,t[e[36]="ICY_CONDITIONS"]=36,t[e[37]="SLIPPERY_ROAD"]=37,t[e[38]="FALLING_ROCKS"]=38,t[e[39]="SCHOOL_ZONE"]=39,t[e[40]="TRAMWAY_CROSSING"]=40,t[e[41]="CONGESTION_HAZARD"]=41,t[e[42]="ACCIDENT_HAZARD"]=42,t[e[43]="PRIORITY_OVER_ONCOMING_TRAFFIC"]=43,t[e[44]="YIELD_TO_ONCOMING_TRAFFIC"]=44,t[e[45]="PREFERENCE_ROAD_START"]=45,t[e[46]="PREFERENCE_ROAD_END"]=46,t[e[47]="TRAFFIC_CALMING_START"]=47,t[e[48]="TRAFFIC_CALMING_END"]=48,t[e[49]="ENVIRONMENTAL_AREA_START"]=49,t[e[50]="ENVIRONMENTAL_AREA_END"]=50,t[e[51]="GIVE_WAY"]=51,t[e[52]="ROUNDABOUT_INTERSECTION"]=52,t[e[53]="MANDATORY_TURN_RIGHT_ONLY"]=53,t[e[54]="MANDATORY_TURN_LEFT_ONLY"]=54,t[e[55]="MANDATORY_TURN_STRAIGHT_ONLY"]=55,t[e[56]="NO_ENTRY"]=56,t[e[57]="ADVISORY_SPEED"]=57,t[e[58]="HIGH_OCCUPANCY_VEHICLE_LANE"]=58,t[e[59]="SHOULDER_OPEN_FOR_TRAFFIC"]=59,t[e[60]="SHOULDER_CLOSE_FOR_TRAFFIC"]=60,t[e[61]="LANE_CLOSED"]=61,t[e[62]="PEDESTRIAN_CROSSING"]=62,t[e[63]="RAILWAY_CROSSING_GENERAL"]=63,t}(),e.RoadSignPermanencyEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_PERMANENCY_UNDEFINED"]=0,t[e[1]="STATIC"]=1,t[e[2]="VARIABLE"]=2,t[e[3]="VARIABLE_DEACTIVATED"]=3,t}(),e.RoadSignDependenciesEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_DEPENDENCY_UNDEFINED"]=0,t[e[1]="RAIN"]=1,t[e[2]="SNOW"]=2,t[e[3]="TIME"]=3,t[e[4]="SEASON"]=4,t[e[5]="FOG"]=5,t[e[6]="SCHOOL"]=6,t[e[7]="TRUCKS"]=7,t[e[8]="TRAILER"]=8,t[e[9]="PASSENGER_CARS_WITH_TRAILER"]=9,t[e[10]="TRUCKS_WITH_TRAILER"]=10,t[e[11]="EXCEPT_TRACTOR"]=11,t[e[12]="BUS"]=12,t[e[100]="OTHER_DEPENDENCY_AS_TEXT"]=100,t}(),e.RoadSignValidityEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_VALIDITY_UNDEFINED"]=0,t[e[1]="STARTING_IN"]=1,t[e[2]="VALID_FOR"]=2,t[e[3]="IN_RIGHT_DIRECTION"]=3,t[e[4]="IN_LEFT_DIRECTION"]=4,t[e[5]="ZONE"]=5,t[e[6]="BEGIN_OF_VALIDITY"]=6,t[e[7]="END_OF_VALIDITY"]=7,t}(),e.RoadSignRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="SIGN_DETECTED"]=1,t[e[2]="SIGN_NOT_DETECTED"]=2,t[e[3]="SIGN_TEMPORARY_INVALIDATED"]=3,t[e[4]="SIGN_MISMATCHED"]=4,t}(),e.RoadSignRecognitionShapeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SIGN_RECOGNITION_SHAPE_UNDEFINED"]=0,t[e[1]="RECTANGLE"]=1,t[e[2]="SQUARE"]=2,t[e[3]="TRIANGLE_UP"]=3,t[e[4]="TRIANGLE_DOWN"]=4,t[e[5]="DIAMOND"]=5,t[e[6]="HEXAGON"]=6,t[e[7]="CIRCLE"]=7,t}(),e}(),o.LaneBoundaryRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.laneBoundaryType=0,e.prototype.laneBoundaryColor=0,e.prototype.curvature_1pm=0,e.prototype.laneMarkerWidth_mm=0,e.prototype.laneMarkerWidthAccuracy_mm=0,e.prototype.laneDeclination_deg=0,e.prototype.laneDeclinationAccuracy_deg=0,e.prototype.laneBoundaryTypeConfidence_percent=0,e.prototype.mapMatchedLaneID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.laneBoundaryRecognitionType=0,e.prototype.laneBoundaryRecognitionChange=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.verticalCurvature_1pm=0,e.prototype.verticalCurvatureAccuracy_1pm=0,e.prototype.laneBoundaryPositionReference=0,e.prototype.laneBoundaryEgoLaneReference=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.LaneBoundaryRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:r.laneBoundaryType=e.int32();break;case 4:r.laneBoundaryColor=e.int32();break;case 5:r.curvature_1pm=e.double();break;case 6:r.laneMarkerWidth_mm=e.int32();break;case 7:r.laneMarkerWidthAccuracy_mm=e.int32();break;case 8:r.laneDeclination_deg=e.double();break;case 9:r.laneDeclinationAccuracy_deg=e.double();break;case 10:r.laneBoundaryTypeConfidence_percent=e.int32();break;case 11:r.mapMatchedLaneID=e.int64();break;case 12:r.laneBoundaryRecognitionType=e.int32();break;case 13:r.laneBoundaryRecognitionChange=e.int32();break;case 14:r.detectedObjectID=e.int64();break;case 15:r.verticalCurvature_1pm=e.double();break;case 16:r.verticalCurvatureAccuracy_1pm=e.double();break;case 17:r.laneBoundaryPositionReference=e.int32();break;case 18:r.laneBoundaryEgoLaneReference=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});if(!r.hasOwnProperty("positionOffset"))throw u.ProtocolError("missing required 'positionOffset'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LaneBoundaryRecognition)return e;var t=new d.sdii.here.pb.LaneBoundaryRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.laneBoundaryType){case"LANE_BOUNDARY_TYPE_UNDEFINED":case 0:t.laneBoundaryType=0;break;case"SINGLE_SOLID_PAINT":case 1:t.laneBoundaryType=1;break;case"DOUBLE_SOLID_PAINT":case 2:t.laneBoundaryType=2;break;case"LONG_DASHED_PAINT":case 3:t.laneBoundaryType=3;break;case"SHORT_DASHED_PAINT":case 4:t.laneBoundaryType=4;break;case"SHADED_AREA_PAINT":case 5:t.laneBoundaryType=5;break;case"DASHED_BLOCKS":case 6:t.laneBoundaryType=6;break;case"DOUBLE_LINE_DASHED_SOLID_PAINT":case 7:t.laneBoundaryType=7;break;case"DOUBLE_LINE_SOLID_DASHED_PAINT":case 8:t.laneBoundaryType=8;break;case"PHYSICAL_DIVIDER":case 9:t.laneBoundaryType=9;break;case"DOUBLE_DASHED_LINES":case 10:t.laneBoundaryType=10}switch(e.laneBoundaryColor){case"LANE_BOUNDARY_COLOR_UNDEFINED":case 0:t.laneBoundaryColor=0;break;case"WHITE":case 1:t.laneBoundaryColor=1;break;case"YELLOW":case 2:t.laneBoundaryColor=2;break;case"BLUE":case 3:t.laneBoundaryColor=3;break;case"RED":case 4:t.laneBoundaryColor=4}switch(null!=e.curvature_1pm&&(t.curvature_1pm=Number(e.curvature_1pm)),null!=e.laneMarkerWidth_mm&&(t.laneMarkerWidth_mm=0|e.laneMarkerWidth_mm),null!=e.laneMarkerWidthAccuracy_mm&&(t.laneMarkerWidthAccuracy_mm=0|e.laneMarkerWidthAccuracy_mm),null!=e.laneDeclination_deg&&(t.laneDeclination_deg=Number(e.laneDeclination_deg)),null!=e.laneDeclinationAccuracy_deg&&(t.laneDeclinationAccuracy_deg=Number(e.laneDeclinationAccuracy_deg)),null!=e.laneBoundaryTypeConfidence_percent&&(t.laneBoundaryTypeConfidence_percent=0|e.laneBoundaryTypeConfidence_percent),null!=e.mapMatchedLaneID&&(u.Long?(t.mapMatchedLaneID=u.Long.fromValue(e.mapMatchedLaneID)).unsigned=!1:"string"==typeof e.mapMatchedLaneID?t.mapMatchedLaneID=parseInt(e.mapMatchedLaneID,10):"number"==typeof e.mapMatchedLaneID?t.mapMatchedLaneID=e.mapMatchedLaneID:"object"==typeof e.mapMatchedLaneID&&(t.mapMatchedLaneID=new u.LongBits(e.mapMatchedLaneID.low>>>0,e.mapMatchedLaneID.high>>>0).toNumber())),e.laneBoundaryRecognitionType){case"LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED":case 0:t.laneBoundaryRecognitionType=0;break;case"LANE_DETECTED":case 1:t.laneBoundaryRecognitionType=1;break;case"LANE_NOT_DETECTED":case 2:t.laneBoundaryRecognitionType=2}switch(e.laneBoundaryRecognitionChange){case"LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED":case 0:t.laneBoundaryRecognitionChange=0;break;case"LANE_BOUNDARY_START":case 1:t.laneBoundaryRecognitionChange=1;break;case"LANE_BOUNDARY_END":case 2:t.laneBoundaryRecognitionChange=2}switch(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.verticalCurvature_1pm&&(t.verticalCurvature_1pm=Number(e.verticalCurvature_1pm)),null!=e.verticalCurvatureAccuracy_1pm&&(t.verticalCurvatureAccuracy_1pm=Number(e.verticalCurvatureAccuracy_1pm)),e.laneBoundaryPositionReference){case"LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED":case 0:t.laneBoundaryPositionReference=0;break;case"LANE_BOUNDARY_POSITION_REFERENCE_INNER":case 1:t.laneBoundaryPositionReference=1;break;case"LANE_BOUNDARY_POSITION_REFERENCE_MIDDLE":case 2:t.laneBoundaryPositionReference=2;break;case"LANE_BOUNDARY_POSITION_REFERENCE_OUTER":case 3:t.laneBoundaryPositionReference=3}switch(e.laneBoundaryEgoLaneReference){case"LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED":case 0:t.laneBoundaryEgoLaneReference=0;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE":case 1:t.laneBoundaryEgoLaneReference=1;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_LEFT":case 2:t.laneBoundaryEgoLaneReference=2;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_RIGHT":case 3:t.laneBoundaryEgoLaneReference=3;break;case"LANE_BOUNDARY_EGO_LANE_REFERENCE_FALSE":case 4:t.laneBoundaryEgoLaneReference=4}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.LaneBoundaryRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.positionOffset=null,i.laneBoundaryType=t.enums===String?"LANE_BOUNDARY_TYPE_UNDEFINED":0,i.laneBoundaryColor=t.enums===String?"LANE_BOUNDARY_COLOR_UNDEFINED":0,i.curvature_1pm=0,i.laneMarkerWidth_mm=0,i.laneMarkerWidthAccuracy_mm=0,i.laneDeclination_deg=0,i.laneDeclinationAccuracy_deg=0,i.laneBoundaryTypeConfidence_percent=0,u.Long?(r=new u.Long(0,0,!1),i.mapMatchedLaneID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mapMatchedLaneID=t.longs===String?"0":0,i.laneBoundaryRecognitionType=t.enums===String?"LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED":0,i.laneBoundaryRecognitionChange=t.enums===String?"LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED":0,u.Long?(r=new u.Long(0,0,!1),i.detectedObjectID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.detectedObjectID=t.longs===String?"0":0,i.verticalCurvature_1pm=0,i.verticalCurvatureAccuracy_1pm=0,i.laneBoundaryPositionReference=t.enums===String?"LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED":0,i.laneBoundaryEgoLaneReference=t.enums===String?"LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(i.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.laneBoundaryType&&e.hasOwnProperty("laneBoundaryType")&&(i.laneBoundaryType=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryTypeEnum[e.laneBoundaryType]:e.laneBoundaryType),null!=e.laneBoundaryColor&&e.hasOwnProperty("laneBoundaryColor")&&(i.laneBoundaryColor=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryColorEnum[e.laneBoundaryColor]:e.laneBoundaryColor),null!=e.curvature_1pm&&e.hasOwnProperty("curvature_1pm")&&(i.curvature_1pm=t.json&&!isFinite(e.curvature_1pm)?String(e.curvature_1pm):e.curvature_1pm),null!=e.laneMarkerWidth_mm&&e.hasOwnProperty("laneMarkerWidth_mm")&&(i.laneMarkerWidth_mm=e.laneMarkerWidth_mm),null!=e.laneMarkerWidthAccuracy_mm&&e.hasOwnProperty("laneMarkerWidthAccuracy_mm")&&(i.laneMarkerWidthAccuracy_mm=e.laneMarkerWidthAccuracy_mm),null!=e.laneDeclination_deg&&e.hasOwnProperty("laneDeclination_deg")&&(i.laneDeclination_deg=t.json&&!isFinite(e.laneDeclination_deg)?String(e.laneDeclination_deg):e.laneDeclination_deg),null!=e.laneDeclinationAccuracy_deg&&e.hasOwnProperty("laneDeclinationAccuracy_deg")&&(i.laneDeclinationAccuracy_deg=t.json&&!isFinite(e.laneDeclinationAccuracy_deg)?String(e.laneDeclinationAccuracy_deg):e.laneDeclinationAccuracy_deg),null!=e.laneBoundaryTypeConfidence_percent&&e.hasOwnProperty("laneBoundaryTypeConfidence_percent")&&(i.laneBoundaryTypeConfidence_percent=e.laneBoundaryTypeConfidence_percent),null!=e.mapMatchedLaneID&&e.hasOwnProperty("mapMatchedLaneID")&&("number"==typeof e.mapMatchedLaneID?i.mapMatchedLaneID=t.longs===String?String(e.mapMatchedLaneID):e.mapMatchedLaneID:i.mapMatchedLaneID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedLaneID):t.longs===Number?new u.LongBits(e.mapMatchedLaneID.low>>>0,e.mapMatchedLaneID.high>>>0).toNumber():e.mapMatchedLaneID),null!=e.laneBoundaryRecognitionType&&e.hasOwnProperty("laneBoundaryRecognitionType")&&(i.laneBoundaryRecognitionType=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryRecognitionTypeEnum[e.laneBoundaryRecognitionType]:e.laneBoundaryRecognitionType),null!=e.laneBoundaryRecognitionChange&&e.hasOwnProperty("laneBoundaryRecognitionChange")&&(i.laneBoundaryRecognitionChange=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryRecognitionChangeEnum[e.laneBoundaryRecognitionChange]:e.laneBoundaryRecognitionChange),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?i.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:i.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.verticalCurvature_1pm&&e.hasOwnProperty("verticalCurvature_1pm")&&(i.verticalCurvature_1pm=t.json&&!isFinite(e.verticalCurvature_1pm)?String(e.verticalCurvature_1pm):e.verticalCurvature_1pm),null!=e.verticalCurvatureAccuracy_1pm&&e.hasOwnProperty("verticalCurvatureAccuracy_1pm")&&(i.verticalCurvatureAccuracy_1pm=t.json&&!isFinite(e.verticalCurvatureAccuracy_1pm)?String(e.verticalCurvatureAccuracy_1pm):e.verticalCurvatureAccuracy_1pm),null!=e.laneBoundaryPositionReference&&e.hasOwnProperty("laneBoundaryPositionReference")&&(i.laneBoundaryPositionReference=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryPositionReferenceEnum[e.laneBoundaryPositionReference]:e.laneBoundaryPositionReference),null!=e.laneBoundaryEgoLaneReference&&e.hasOwnProperty("laneBoundaryEgoLaneReference")&&(i.laneBoundaryEgoLaneReference=t.enums===String?d.sdii.here.pb.LaneBoundaryRecognition.LaneBoundaryEgoLaneReferenceEnum[e.laneBoundaryEgoLaneReference]:e.laneBoundaryEgoLaneReference),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.LaneBoundaryTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_TYPE_UNDEFINED"]=0,t[e[1]="SINGLE_SOLID_PAINT"]=1,t[e[2]="DOUBLE_SOLID_PAINT"]=2,t[e[3]="LONG_DASHED_PAINT"]=3,t[e[4]="SHORT_DASHED_PAINT"]=4,t[e[5]="SHADED_AREA_PAINT"]=5,t[e[6]="DASHED_BLOCKS"]=6,t[e[7]="DOUBLE_LINE_DASHED_SOLID_PAINT"]=7,t[e[8]="DOUBLE_LINE_SOLID_DASHED_PAINT"]=8,t[e[9]="PHYSICAL_DIVIDER"]=9,t[e[10]="DOUBLE_DASHED_LINES"]=10,t}(),e.LaneBoundaryColorEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_COLOR_UNDEFINED"]=0,t[e[1]="WHITE"]=1,t[e[2]="YELLOW"]=2,t[e[3]="BLUE"]=3,t[e[4]="RED"]=4,t}(),e.LaneBoundaryRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="LANE_DETECTED"]=1,t[e[2]="LANE_NOT_DETECTED"]=2,t}(),e.LaneBoundaryRecognitionChangeEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_RECOGNITION_CHANGE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_START"]=1,t[e[2]="LANE_BOUNDARY_END"]=2,t}(),e.LaneBoundaryPositionReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_POSITION_REFERENCE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_POSITION_REFERENCE_INNER"]=1,t[e[2]="LANE_BOUNDARY_POSITION_REFERENCE_MIDDLE"]=2,t[e[3]="LANE_BOUNDARY_POSITION_REFERENCE_OUTER"]=3,t}(),e.LaneBoundaryEgoLaneReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="LANE_BOUNDARY_EGO_LANE_REFERENCE_UNDEFINED"]=0,t[e[1]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE"]=1,t[e[2]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_LEFT"]=2,t[e[3]="LANE_BOUNDARY_EGO_LANE_REFERENCE_TRUE_RIGHT"]=3,t[e[4]="LANE_BOUNDARY_EGO_LANE_REFERENCE_FALSE"]=4,t}(),e}(),o.TireSlippageEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.TireSlippageEvent;e.pos<i;){var n=e.uint32();e.skipType(7&n)}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.TireSlippageEvent?e:new d.sdii.here.pb.TireSlippageEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.CrashDetectedEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.vehicleIsDrivable=!1,e.prototype.airbagsDeployed=!1,e.prototype.eCallActivated=!1,e.prototype.vehicleIsObstacleOnRoad=!1,e.prototype.maxAccelerationVector_mps2=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.CrashDetectedEvent;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.vehicleIsDrivable=e.bool();break;case 2:r.airbagsDeployed=e.bool();break;case 3:r.eCallActivated=e.bool();break;case 4:r.vehicleIsObstacleOnRoad=e.bool();break;case 5:r.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.CrashDetectedEvent)return e;var t=new d.sdii.here.pb.CrashDetectedEvent;if(null!=e.vehicleIsDrivable&&(t.vehicleIsDrivable=Boolean(e.vehicleIsDrivable)),null!=e.airbagsDeployed&&(t.airbagsDeployed=Boolean(e.airbagsDeployed)),null!=e.eCallActivated&&(t.eCallActivated=Boolean(e.eCallActivated)),null!=e.vehicleIsObstacleOnRoad&&(t.vehicleIsObstacleOnRoad=Boolean(e.vehicleIsObstacleOnRoad)),null!=e.maxAccelerationVector_mps2){if("object"!=typeof e.maxAccelerationVector_mps2)throw TypeError(".sdii.here.pb.CrashDetectedEvent.maxAccelerationVector_mps2: object expected");t.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.maxAccelerationVector_mps2)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.vehicleIsDrivable=!1,i.airbagsDeployed=!1,i.eCallActivated=!1,i.vehicleIsObstacleOnRoad=!1,i.maxAccelerationVector_mps2=null),null!=e.vehicleIsDrivable&&e.hasOwnProperty("vehicleIsDrivable")&&(i.vehicleIsDrivable=e.vehicleIsDrivable),null!=e.airbagsDeployed&&e.hasOwnProperty("airbagsDeployed")&&(i.airbagsDeployed=e.airbagsDeployed),null!=e.eCallActivated&&e.hasOwnProperty("eCallActivated")&&(i.eCallActivated=e.eCallActivated),null!=e.vehicleIsObstacleOnRoad&&e.hasOwnProperty("vehicleIsObstacleOnRoad")&&(i.vehicleIsObstacleOnRoad=e.vehicleIsObstacleOnRoad),null!=e.maxAccelerationVector_mps2&&e.hasOwnProperty("maxAccelerationVector_mps2")&&(i.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.maxAccelerationVector_mps2,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.EmergencyBrakingEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.maxAccelerationVector_mps2=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.EmergencyBrakingEvent;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.EmergencyBrakingEvent)return e;var t=new d.sdii.here.pb.EmergencyBrakingEvent;if(null!=e.maxAccelerationVector_mps2){if("object"!=typeof e.maxAccelerationVector_mps2)throw TypeError(".sdii.here.pb.EmergencyBrakingEvent.maxAccelerationVector_mps2: object expected");t.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.maxAccelerationVector_mps2)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.maxAccelerationVector_mps2=null),null!=e.maxAccelerationVector_mps2&&e.hasOwnProperty("maxAccelerationVector_mps2")&&(i.maxAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.maxAccelerationVector_mps2,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.DynamicStabilityControlEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.DynamicStabilityControlEvent;e.pos<i;){var n=e.uint32();e.skipType(7&n)}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.DynamicStabilityControlEvent?e:new d.sdii.here.pb.DynamicStabilityControlEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.AntiLockBrakingSystemEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.AntiLockBrakingSystemEvent;e.pos<i;){var n=e.uint32();e.skipType(7&n)}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){return e instanceof d.sdii.here.pb.AntiLockBrakingSystemEvent?e:new d.sdii.here.pb.AntiLockBrakingSystemEvent},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.ElectronicStabilityControlEvent=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.antiSlipActionEvent=!1,e.prototype.antiLockActionEvent=!1,e.prototype.electronicStabilityControlEvent=!1,e.prototype.requestedAccelerationVector_mps2=null,e.prototype.requestedRotationRateVector_omega=null,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ElectronicStabilityControlEvent;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.antiSlipActionEvent=e.bool();break;case 2:r.antiLockActionEvent=e.bool();break;case 3:r.electronicStabilityControlEvent=e.bool();break;case 4:r.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:r.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ElectronicStabilityControlEvent)return e;var t=new d.sdii.here.pb.ElectronicStabilityControlEvent;if(null!=e.antiSlipActionEvent&&(t.antiSlipActionEvent=Boolean(e.antiSlipActionEvent)),null!=e.antiLockActionEvent&&(t.antiLockActionEvent=Boolean(e.antiLockActionEvent)),null!=e.electronicStabilityControlEvent&&(t.electronicStabilityControlEvent=Boolean(e.electronicStabilityControlEvent)),null!=e.requestedAccelerationVector_mps2){if("object"!=typeof e.requestedAccelerationVector_mps2)throw TypeError(".sdii.here.pb.ElectronicStabilityControlEvent.requestedAccelerationVector_mps2: object expected");t.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.fromObject(e.requestedAccelerationVector_mps2)}if(null!=e.requestedRotationRateVector_omega){if("object"!=typeof e.requestedRotationRateVector_omega)throw TypeError(".sdii.here.pb.ElectronicStabilityControlEvent.requestedRotationRateVector_omega: object expected");t.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.fromObject(e.requestedRotationRateVector_omega)}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.antiSlipActionEvent=!1,i.antiLockActionEvent=!1,i.electronicStabilityControlEvent=!1,i.requestedAccelerationVector_mps2=null,i.requestedRotationRateVector_omega=null),null!=e.antiSlipActionEvent&&e.hasOwnProperty("antiSlipActionEvent")&&(i.antiSlipActionEvent=e.antiSlipActionEvent),null!=e.antiLockActionEvent&&e.hasOwnProperty("antiLockActionEvent")&&(i.antiLockActionEvent=e.antiLockActionEvent),null!=e.electronicStabilityControlEvent&&e.hasOwnProperty("electronicStabilityControlEvent")&&(i.electronicStabilityControlEvent=e.electronicStabilityControlEvent),null!=e.requestedAccelerationVector_mps2&&e.hasOwnProperty("requestedAccelerationVector_mps2")&&(i.requestedAccelerationVector_mps2=d.sdii.here.pb.Vector3D.toObject(e.requestedAccelerationVector_mps2,t)),null!=e.requestedRotationRateVector_omega&&e.hasOwnProperty("requestedRotationRateVector_omega")&&(i.requestedRotationRateVector_omega=d.sdii.here.pb.Vector3D.toObject(e.requestedRotationRateVector_omega,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.ExceptionalVehicleState=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.tireSlippage=null,e.prototype.crashDetected=null,e.prototype.emergencyBraking=null,e.prototype.dynamicStabilityControl=null,e.prototype.antiLockBrakingSystem=null,e.prototype.electronicStabilityControl=null,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ExceptionalVehicleState;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.tireSlippage=d.sdii.here.pb.TireSlippageEvent.decode(e,e.uint32());break;case 3:r.crashDetected=d.sdii.here.pb.CrashDetectedEvent.decode(e,e.uint32());break;case 4:r.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.decode(e,e.uint32());break;case 5:r.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.decode(e,e.uint32());break;case 6:r.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.decode(e,e.uint32());break;case 7:r.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.decode(e,e.uint32());break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ExceptionalVehicleState)return e;var t=new d.sdii.here.pb.ExceptionalVehicleState;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.tireSlippage){if("object"!=typeof e.tireSlippage)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.tireSlippage: object expected");t.tireSlippage=d.sdii.here.pb.TireSlippageEvent.fromObject(e.tireSlippage)}if(null!=e.crashDetected){if("object"!=typeof e.crashDetected)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.crashDetected: object expected");t.crashDetected=d.sdii.here.pb.CrashDetectedEvent.fromObject(e.crashDetected)}if(null!=e.emergencyBraking){if("object"!=typeof e.emergencyBraking)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.emergencyBraking: object expected");t.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.fromObject(e.emergencyBraking)}if(null!=e.dynamicStabilityControl){if("object"!=typeof e.dynamicStabilityControl)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.dynamicStabilityControl: object expected");t.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.fromObject(e.dynamicStabilityControl)}if(null!=e.antiLockBrakingSystem){if("object"!=typeof e.antiLockBrakingSystem)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.antiLockBrakingSystem: object expected");t.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.fromObject(e.antiLockBrakingSystem)}if(null!=e.electronicStabilityControl){if("object"!=typeof e.electronicStabilityControl)throw TypeError(".sdii.here.pb.ExceptionalVehicleState.electronicStabilityControl: object expected");t.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.fromObject(e.electronicStabilityControl)}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ExceptionalVehicleState.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.ExceptionalVehicleState.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.tireSlippage=null,i.crashDetected=null,i.emergencyBraking=null,i.dynamicStabilityControl=null,i.antiLockBrakingSystem=null,i.electronicStabilityControl=null}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.tireSlippage&&e.hasOwnProperty("tireSlippage")&&(i.tireSlippage=d.sdii.here.pb.TireSlippageEvent.toObject(e.tireSlippage,t)),null!=e.crashDetected&&e.hasOwnProperty("crashDetected")&&(i.crashDetected=d.sdii.here.pb.CrashDetectedEvent.toObject(e.crashDetected,t)),null!=e.emergencyBraking&&e.hasOwnProperty("emergencyBraking")&&(i.emergencyBraking=d.sdii.here.pb.EmergencyBrakingEvent.toObject(e.emergencyBraking,t)),null!=e.dynamicStabilityControl&&e.hasOwnProperty("dynamicStabilityControl")&&(i.dynamicStabilityControl=d.sdii.here.pb.DynamicStabilityControlEvent.toObject(e.dynamicStabilityControl,t)),null!=e.antiLockBrakingSystem&&e.hasOwnProperty("antiLockBrakingSystem")&&(i.antiLockBrakingSystem=d.sdii.here.pb.AntiLockBrakingSystemEvent.toObject(e.antiLockBrakingSystem,t)),null!=e.electronicStabilityControl&&e.hasOwnProperty("electronicStabilityControl")&&(i.electronicStabilityControl=d.sdii.here.pb.ElectronicStabilityControlEvent.toObject(e.electronicStabilityControl,t)),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.ProprietaryInfo=function(){function e(e){if(this.keyValuePairs=[],this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.keyValuePairs=u.emptyArray,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ProprietaryInfo;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.keyValuePairs&&r.keyValuePairs.length||(r.keyValuePairs=[]),r.keyValuePairs.push(d.sdii.here.pb.KeyValuePairString.decode(e,e.uint32()));break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ProprietaryInfo)return e;var t=new d.sdii.here.pb.ProprietaryInfo;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.keyValuePairs){if(!Array.isArray(e.keyValuePairs))throw TypeError(".sdii.here.pb.ProprietaryInfo.keyValuePairs: array expected");t.keyValuePairs=[];for(var i=0;i<e.keyValuePairs.length;++i){if("object"!=typeof e.keyValuePairs[i])throw TypeError(".sdii.here.pb.ProprietaryInfo.keyValuePairs: object expected");t.keyValuePairs[i]=d.sdii.here.pb.KeyValuePairString.fromObject(e.keyValuePairs[i])}}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ProprietaryInfo.extensionContainer: array expected");for(t.extensionContainer=[],i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.ProprietaryInfo.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.keyValuePairs=[],i.extensionContainer=[]),t.defaults)if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),e.keyValuePairs&&e.keyValuePairs.length){i.keyValuePairs=[];for(var n=0;n<e.keyValuePairs.length;++n)i.keyValuePairs[n]=d.sdii.here.pb.KeyValuePairString.toObject(e.keyValuePairs[n],t)}if(e.extensionContainer&&e.extensionContainer.length)for(i.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.EnvironmentStatus=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.lightConditions=0,e.prototype.externalAirTemperature_DegC=0,e.prototype.externalAirTemperatureAccuracy_DegC=0,e.prototype.precipitation=0,e.prototype.visibleDistance_m=0,e.prototype.roadSurfaceTemperature_DegC=0,e.prototype.roadSurfaceTemperatureAccuracy_DegC=0,e.prototype.roadSurfaceType=0,e.prototype.airPressure_Pa=0,e.prototype.airHumidity_percent=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.EnvironmentStatus;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.lightConditions=e.int32();break;case 3:r.externalAirTemperature_DegC=e.double();break;case 4:r.externalAirTemperatureAccuracy_DegC=e.double();break;case 5:r.precipitation=e.int32();break;case 6:r.visibleDistance_m=e.double();break;case 7:r.roadSurfaceTemperature_DegC=e.double();break;case 8:r.roadSurfaceTemperatureAccuracy_DegC=e.double();break;case 9:r.roadSurfaceType=e.int32();break;case 10:r.airPressure_Pa=e.int32();break;case 11:r.airHumidity_percent=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.EnvironmentStatus)return e;var t=new d.sdii.here.pb.EnvironmentStatus;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.lightConditions){case"LIGHT_CONDITIONS_UNDEFINED":case 0:t.lightConditions=0;break;case"GENERAL_DAYLIGHT":case 1:t.lightConditions=1;break;case"GENERAL_DARK":case 2:t.lightConditions=2;break;case"DAYLIGHT_SUN":case 3:t.lightConditions=3;break;case"DAYLIGHT_CLOUD":case 4:t.lightConditions=4;break;case"DUSK_OR_DAWN":case 5:t.lightConditions=5;break;case"NIGHT_LUMINATED":case 6:t.lightConditions=6;break;case"NIGHT_DARK":case 7:t.lightConditions=7}switch(null!=e.externalAirTemperature_DegC&&(t.externalAirTemperature_DegC=Number(e.externalAirTemperature_DegC)),null!=e.externalAirTemperatureAccuracy_DegC&&(t.externalAirTemperatureAccuracy_DegC=Number(e.externalAirTemperatureAccuracy_DegC)),e.precipitation){case"PRECIPITATION_TYPE_UNDEFINED":case 0:t.precipitation=0;break;case"NONE":case 1:t.precipitation=1;break;case"RAIN":case 2:t.precipitation=2;break;case"HAIL":case 3:t.precipitation=3;break;case"SNOW":case 4:t.precipitation=4}switch(null!=e.visibleDistance_m&&(t.visibleDistance_m=Number(e.visibleDistance_m)),null!=e.roadSurfaceTemperature_DegC&&(t.roadSurfaceTemperature_DegC=Number(e.roadSurfaceTemperature_DegC)),null!=e.roadSurfaceTemperatureAccuracy_DegC&&(t.roadSurfaceTemperatureAccuracy_DegC=Number(e.roadSurfaceTemperatureAccuracy_DegC)),e.roadSurfaceType){case"ROAD_SURFACE_TYPE_UNDEFINED":case 0:t.roadSurfaceType=0;break;case"ASPHALT":case 1:t.roadSurfaceType=1;break;case"CONCRETE":case 2:t.roadSurfaceType=2;break;case"PAVED":case 3:t.roadSurfaceType=3;break;case"GRAVEL":case 4:t.roadSurfaceType=4;break;case"ICEORSNOW":case 5:t.roadSurfaceType=5;break;case"UNKNOWN":case 6:t.roadSurfaceType=6}if(null!=e.airPressure_Pa&&(t.airPressure_Pa=0|e.airPressure_Pa),null!=e.airHumidity_percent&&(t.airHumidity_percent=0|e.airHumidity_percent),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.EnvironmentStatus.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.EnvironmentStatus.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.lightConditions=t.enums===String?"LIGHT_CONDITIONS_UNDEFINED":0,i.externalAirTemperature_DegC=0,i.externalAirTemperatureAccuracy_DegC=0,i.precipitation=t.enums===String?"PRECIPITATION_TYPE_UNDEFINED":0,i.visibleDistance_m=0,i.roadSurfaceTemperature_DegC=0,i.roadSurfaceTemperatureAccuracy_DegC=0,i.roadSurfaceType=t.enums===String?"ROAD_SURFACE_TYPE_UNDEFINED":0,i.airPressure_Pa=0,i.airHumidity_percent=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.lightConditions&&e.hasOwnProperty("lightConditions")&&(i.lightConditions=t.enums===String?d.sdii.here.pb.EnvironmentStatus.LightConditionsEnum[e.lightConditions]:e.lightConditions),null!=e.externalAirTemperature_DegC&&e.hasOwnProperty("externalAirTemperature_DegC")&&(i.externalAirTemperature_DegC=t.json&&!isFinite(e.externalAirTemperature_DegC)?String(e.externalAirTemperature_DegC):e.externalAirTemperature_DegC),null!=e.externalAirTemperatureAccuracy_DegC&&e.hasOwnProperty("externalAirTemperatureAccuracy_DegC")&&(i.externalAirTemperatureAccuracy_DegC=t.json&&!isFinite(e.externalAirTemperatureAccuracy_DegC)?String(e.externalAirTemperatureAccuracy_DegC):e.externalAirTemperatureAccuracy_DegC),null!=e.precipitation&&e.hasOwnProperty("precipitation")&&(i.precipitation=t.enums===String?d.sdii.here.pb.EnvironmentStatus.PrecipitationEnum[e.precipitation]:e.precipitation),null!=e.visibleDistance_m&&e.hasOwnProperty("visibleDistance_m")&&(i.visibleDistance_m=t.json&&!isFinite(e.visibleDistance_m)?String(e.visibleDistance_m):e.visibleDistance_m),null!=e.roadSurfaceTemperature_DegC&&e.hasOwnProperty("roadSurfaceTemperature_DegC")&&(i.roadSurfaceTemperature_DegC=t.json&&!isFinite(e.roadSurfaceTemperature_DegC)?String(e.roadSurfaceTemperature_DegC):e.roadSurfaceTemperature_DegC),null!=e.roadSurfaceTemperatureAccuracy_DegC&&e.hasOwnProperty("roadSurfaceTemperatureAccuracy_DegC")&&(i.roadSurfaceTemperatureAccuracy_DegC=t.json&&!isFinite(e.roadSurfaceTemperatureAccuracy_DegC)?String(e.roadSurfaceTemperatureAccuracy_DegC):e.roadSurfaceTemperatureAccuracy_DegC),null!=e.roadSurfaceType&&e.hasOwnProperty("roadSurfaceType")&&(i.roadSurfaceType=t.enums===String?d.sdii.here.pb.EnvironmentStatus.RoadSurfaceTypeEnum[e.roadSurfaceType]:e.roadSurfaceType),null!=e.airPressure_Pa&&e.hasOwnProperty("airPressure_Pa")&&(i.airPressure_Pa=e.airPressure_Pa),null!=e.airHumidity_percent&&e.hasOwnProperty("airHumidity_percent")&&(i.airHumidity_percent=e.airHumidity_percent),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.LightConditionsEnum=function(){var e={},t=Object.create(e);return t[e[0]="LIGHT_CONDITIONS_UNDEFINED"]=0,t[e[1]="GENERAL_DAYLIGHT"]=1,t[e[2]="GENERAL_DARK"]=2,t[e[3]="DAYLIGHT_SUN"]=3,t[e[4]="DAYLIGHT_CLOUD"]=4,t[e[5]="DUSK_OR_DAWN"]=5,t[e[6]="NIGHT_LUMINATED"]=6,t[e[7]="NIGHT_DARK"]=7,t}(),e.PrecipitationEnum=function(){var e={},t=Object.create(e);return t[e[0]="PRECIPITATION_TYPE_UNDEFINED"]=0,t[e[1]="NONE"]=1,t[e[2]="RAIN"]=2,t[e[3]="HAIL"]=3,t[e[4]="SNOW"]=4,t}(),e.RoadSurfaceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_SURFACE_TYPE_UNDEFINED"]=0,t[e[1]="ASPHALT"]=1,t[e[2]="CONCRETE"]=2,t[e[3]="PAVED"]=3,t[e[4]="GRAVEL"]=4,t[e[5]="ICEORSNOW"]=5,t[e[6]="UNKNOWN"]=6,t}(),e}(),o.ObjectDetection=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=null,e.prototype.movingVector_mps=null,e.prototype.objectType=0,e.prototype.objectSizeVector_m=null,e.prototype.objectSizeAccuracyVector_m=null,e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.objectSurfaceType=0,e.prototype.objectSurfaceMaterialType=0,e.prototype.mapMatchedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.objectRecognitionType=0,e.prototype.objectCount=0,e.prototype.objectRecognitionMatchType=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ObjectDetection;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.detectedObjectID=e.int64();break;case 3:r.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 4:r.movingVector_mps=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:r.objectType=e.int32();break;case 6:r.objectSizeVector_m=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 7:r.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:r.mediaID=e.int64();break;case 9:r.objectSurfaceType=e.int32();break;case 10:r.objectSurfaceMaterialType=e.int32();break;case 11:r.mapMatchedObjectID=e.int64();break;case 12:r.objectRecognitionType=e.int32();break;case 13:r.objectCount=e.int32();break;case 14:r.objectRecognitionMatchType=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ObjectDetection)return e;var t=new d.sdii.here.pb.ObjectDetection;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.ObjectDetection.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}if(null!=e.movingVector_mps){if("object"!=typeof e.movingVector_mps)throw TypeError(".sdii.here.pb.ObjectDetection.movingVector_mps: object expected");t.movingVector_mps=d.sdii.here.pb.Vector3D.fromObject(e.movingVector_mps)}switch(e.objectType){case"OBJECT_TYPE_UNDEFINED":case 0:t.objectType=0;break;case"MOVING_GENERAL":case 1:t.objectType=1;break;case"STATIC_GENERAL":case 2:t.objectType=2;break;case"STATIC_GENERAL_VERTICAL":case 3:t.objectType=3;break;case"STATIC_GENERAL_TRANSVERSAL":case 4:t.objectType=4;break;case"STATIC_GENERAL_LATERAL":case 5:t.objectType=5;break;case"MOVING_VEHICLE":case 6:t.objectType=6;break;case"MOVING_TRUCK":case 7:t.objectType=7;break;case"MOVING_BIKE":case 8:t.objectType=8;break;case"MOVING_PERSON":case 9:t.objectType=9;break;case"STATIC_BRIDGE":case 10:t.objectType=10;break;case"STATIC_TUNNEL":case 11:t.objectType=11;break;case"STATIC_POLE":case 12:t.objectType=12;break;case"STATIC_BAR":case 13:t.objectType=13;break;case"STATIC_TREE":case 14:t.objectType=14;break;case"STATIC_WALL":case 15:t.objectType=15;break;case"STATIC_BOLLARD":case 16:t.objectType=16;break;case"STATIC_GUIDERAIL":case 17:t.objectType=17;break;case"STATIC_TRAFFICISLAND":case 18:t.objectType=18;break;case"STATIC_SIGN":case 19:t.objectType=19;break;case"STATIC_TRAFFIC_LIGHT":case 20:t.objectType=20}if(null!=e.objectSizeVector_m){if("object"!=typeof e.objectSizeVector_m)throw TypeError(".sdii.here.pb.ObjectDetection.objectSizeVector_m: object expected");t.objectSizeVector_m=d.sdii.here.pb.Vector3D.fromObject(e.objectSizeVector_m)}if(null!=e.objectSizeAccuracyVector_m){if("object"!=typeof e.objectSizeAccuracyVector_m)throw TypeError(".sdii.here.pb.ObjectDetection.objectSizeAccuracyVector_m: object expected");t.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.fromObject(e.objectSizeAccuracyVector_m)}switch(null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),e.objectSurfaceType){case"OBJECT_SURFACE_UNDEFINED":case 0:t.objectSurfaceType=0;break;case"UNKNOWN_SURFACE":case 1:t.objectSurfaceType=1;break;case"FLAT":case 2:t.objectSurfaceType=2;break;case"ROUGH":case 3:t.objectSurfaceType=3}switch(e.objectSurfaceMaterialType){case"OBJECT_SURFACE_MATERIAL_UNDEFINED":case 0:t.objectSurfaceMaterialType=0;break;case"UNKNOWN_MATERIAL":case 1:t.objectSurfaceMaterialType=1;break;case"STONE":case 2:t.objectSurfaceMaterialType=2;break;case"ASPHALT":case 3:t.objectSurfaceMaterialType=3;break;case"ORGANIC":case 4:t.objectSurfaceMaterialType=4;break;case"METALLIC":case 5:t.objectSurfaceMaterialType=5;break;case"PLASTIC":case 6:t.objectSurfaceMaterialType=6;break;case"WOOD":case 7:t.objectSurfaceMaterialType=7}switch(null!=e.mapMatchedObjectID&&(u.Long?(t.mapMatchedObjectID=u.Long.fromValue(e.mapMatchedObjectID)).unsigned=!1:"string"==typeof e.mapMatchedObjectID?t.mapMatchedObjectID=parseInt(e.mapMatchedObjectID,10):"number"==typeof e.mapMatchedObjectID?t.mapMatchedObjectID=e.mapMatchedObjectID:"object"==typeof e.mapMatchedObjectID&&(t.mapMatchedObjectID=new u.LongBits(e.mapMatchedObjectID.low>>>0,e.mapMatchedObjectID.high>>>0).toNumber())),e.objectRecognitionType){case"OBJECT_RECOGNITION_TYPE_UNDEFINED":case 0:t.objectRecognitionType=0;break;case"OBJECT_DETECTED":case 1:t.objectRecognitionType=1;break;case"OBJECT_NOT_DETECTED":case 2:t.objectRecognitionType=2}switch(null!=e.objectCount&&(t.objectCount=0|e.objectCount),e.objectRecognitionMatchType){case"OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED":case 0:t.objectRecognitionMatchType=0;break;case"OBJECT_MATCHED":case 1:t.objectRecognitionMatchType=1;break;case"OBJECT_NOT_MATCHED":case 2:t.objectRecognitionMatchType=2}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ObjectDetection.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.ObjectDetection.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;u.Long?(r=new u.Long(0,0,!1),i.detectedObjectID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.detectedObjectID=t.longs===String?"0":0,i.positionOffset=null,i.movingVector_mps=null,i.objectType=t.enums===String?"OBJECT_TYPE_UNDEFINED":0,i.objectSizeVector_m=null,i.objectSizeAccuracyVector_m=null,u.Long?(r=new u.Long(0,0,!1),i.mediaID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mediaID=t.longs===String?"0":0,i.objectSurfaceType=t.enums===String?"OBJECT_SURFACE_UNDEFINED":0,i.objectSurfaceMaterialType=t.enums===String?"OBJECT_SURFACE_MATERIAL_UNDEFINED":0,u.Long?(r=new u.Long(0,0,!1),i.mapMatchedObjectID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mapMatchedObjectID=t.longs===String?"0":0,i.objectRecognitionType=t.enums===String?"OBJECT_RECOGNITION_TYPE_UNDEFINED":0,i.objectCount=0,i.objectRecognitionMatchType=t.enums===String?"OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?i.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:i.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(i.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.movingVector_mps&&e.hasOwnProperty("movingVector_mps")&&(i.movingVector_mps=d.sdii.here.pb.Vector3D.toObject(e.movingVector_mps,t)),null!=e.objectType&&e.hasOwnProperty("objectType")&&(i.objectType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectTypeEnum[e.objectType]:e.objectType),null!=e.objectSizeVector_m&&e.hasOwnProperty("objectSizeVector_m")&&(i.objectSizeVector_m=d.sdii.here.pb.Vector3D.toObject(e.objectSizeVector_m,t)),null!=e.objectSizeAccuracyVector_m&&e.hasOwnProperty("objectSizeAccuracyVector_m")&&(i.objectSizeAccuracyVector_m=d.sdii.here.pb.Vector3D.toObject(e.objectSizeAccuracyVector_m,t)),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?i.mediaID=t.longs===String?String(e.mediaID):e.mediaID:i.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.objectSurfaceType&&e.hasOwnProperty("objectSurfaceType")&&(i.objectSurfaceType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectSurfaceTypeEnum[e.objectSurfaceType]:e.objectSurfaceType),null!=e.objectSurfaceMaterialType&&e.hasOwnProperty("objectSurfaceMaterialType")&&(i.objectSurfaceMaterialType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectSurfaceMaterialTypeEnum[e.objectSurfaceMaterialType]:e.objectSurfaceMaterialType),null!=e.mapMatchedObjectID&&e.hasOwnProperty("mapMatchedObjectID")&&("number"==typeof e.mapMatchedObjectID?i.mapMatchedObjectID=t.longs===String?String(e.mapMatchedObjectID):e.mapMatchedObjectID:i.mapMatchedObjectID=t.longs===String?u.Long.prototype.toString.call(e.mapMatchedObjectID):t.longs===Number?new u.LongBits(e.mapMatchedObjectID.low>>>0,e.mapMatchedObjectID.high>>>0).toNumber():e.mapMatchedObjectID),null!=e.objectRecognitionType&&e.hasOwnProperty("objectRecognitionType")&&(i.objectRecognitionType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectRecognitionTypeEnum[e.objectRecognitionType]:e.objectRecognitionType),null!=e.objectCount&&e.hasOwnProperty("objectCount")&&(i.objectCount=e.objectCount),null!=e.objectRecognitionMatchType&&e.hasOwnProperty("objectRecognitionMatchType")&&(i.objectRecognitionMatchType=t.enums===String?d.sdii.here.pb.ObjectDetection.ObjectRecognitionMatchTypeEnum[e.objectRecognitionMatchType]:e.objectRecognitionMatchType),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.ObjectTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_TYPE_UNDEFINED"]=0,t[e[1]="MOVING_GENERAL"]=1,t[e[2]="STATIC_GENERAL"]=2,t[e[3]="STATIC_GENERAL_VERTICAL"]=3,t[e[4]="STATIC_GENERAL_TRANSVERSAL"]=4,t[e[5]="STATIC_GENERAL_LATERAL"]=5,t[e[6]="MOVING_VEHICLE"]=6,t[e[7]="MOVING_TRUCK"]=7,t[e[8]="MOVING_BIKE"]=8,t[e[9]="MOVING_PERSON"]=9,t[e[10]="STATIC_BRIDGE"]=10,t[e[11]="STATIC_TUNNEL"]=11,t[e[12]="STATIC_POLE"]=12,t[e[13]="STATIC_BAR"]=13,t[e[14]="STATIC_TREE"]=14,t[e[15]="STATIC_WALL"]=15,t[e[16]="STATIC_BOLLARD"]=16,t[e[17]="STATIC_GUIDERAIL"]=17,t[e[18]="STATIC_TRAFFICISLAND"]=18,t[e[19]="STATIC_SIGN"]=19,t[e[20]="STATIC_TRAFFIC_LIGHT"]=20,t}(),e.ObjectSurfaceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_SURFACE_UNDEFINED"]=0,t[e[1]="UNKNOWN_SURFACE"]=1,t[e[2]="FLAT"]=2,t[e[3]="ROUGH"]=3,t}(),e.ObjectSurfaceMaterialTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_SURFACE_MATERIAL_UNDEFINED"]=0,t[e[1]="UNKNOWN_MATERIAL"]=1,t[e[2]="STONE"]=2,t[e[3]="ASPHALT"]=3,t[e[4]="ORGANIC"]=4,t[e[5]="METALLIC"]=5,t[e[6]="PLASTIC"]=6,t[e[7]="WOOD"]=7,t}(),e.ObjectRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_RECOGNITION_TYPE_UNDEFINED"]=0,t[e[1]="OBJECT_DETECTED"]=1,t[e[2]="OBJECT_NOT_DETECTED"]=2,t}(),e.ObjectRecognitionMatchTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="OBJECT_RECOGNITION_MATCH_TYPE_UNDEFINED"]=0,t[e[1]="OBJECT_MATCHED"]=1,t[e[2]="OBJECT_NOT_MATCHED"]=2,t}(),e}(),o.ADServiceAndSensorState=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.adSpeedControl=!1,e.prototype.adBrakeControl=!1,e.prototype.adSteeringControl=!1,e.prototype.adConnectionAvailable=!1,e.prototype.sensorObjectRecognition=!1,e.prototype.sensorSignRecognition=!1,e.prototype.sensorLaneRecognition=!1,e.prototype.sensorRoadSurface=!1,e.prototype.sensorEnvironment=!1,e.prototype.sensorParkingPilotAvailable=!1,e.prototype.sensorParkingSpotAvailable=!1,e.prototype.sensorParkingSpotEnabled=!1,e.prototype.adParkingPilotEnabled=!1,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.ADServiceAndSensorState;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.adSpeedControl=e.bool();break;case 3:r.adBrakeControl=e.bool();break;case 4:r.adSteeringControl=e.bool();break;case 5:r.adConnectionAvailable=e.bool();break;case 6:r.sensorObjectRecognition=e.bool();break;case 7:r.sensorSignRecognition=e.bool();break;case 8:r.sensorLaneRecognition=e.bool();break;case 9:r.sensorRoadSurface=e.bool();break;case 10:r.sensorEnvironment=e.bool();break;case 11:r.sensorParkingPilotAvailable=e.bool();break;case 12:r.sensorParkingSpotAvailable=e.bool();break;case 13:r.sensorParkingSpotEnabled=e.bool();break;case 101:r.adParkingPilotEnabled=e.bool();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.ADServiceAndSensorState)return e;var t=new d.sdii.here.pb.ADServiceAndSensorState;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.adSpeedControl&&(t.adSpeedControl=Boolean(e.adSpeedControl)),null!=e.adBrakeControl&&(t.adBrakeControl=Boolean(e.adBrakeControl)),null!=e.adSteeringControl&&(t.adSteeringControl=Boolean(e.adSteeringControl)),null!=e.adConnectionAvailable&&(t.adConnectionAvailable=Boolean(e.adConnectionAvailable)),null!=e.sensorObjectRecognition&&(t.sensorObjectRecognition=Boolean(e.sensorObjectRecognition)),null!=e.sensorSignRecognition&&(t.sensorSignRecognition=Boolean(e.sensorSignRecognition)),null!=e.sensorLaneRecognition&&(t.sensorLaneRecognition=Boolean(e.sensorLaneRecognition)),null!=e.sensorRoadSurface&&(t.sensorRoadSurface=Boolean(e.sensorRoadSurface)),null!=e.sensorEnvironment&&(t.sensorEnvironment=Boolean(e.sensorEnvironment)),null!=e.sensorParkingPilotAvailable&&(t.sensorParkingPilotAvailable=Boolean(e.sensorParkingPilotAvailable)),null!=e.sensorParkingSpotAvailable&&(t.sensorParkingSpotAvailable=Boolean(e.sensorParkingSpotAvailable)),null!=e.sensorParkingSpotEnabled&&(t.sensorParkingSpotEnabled=Boolean(e.sensorParkingSpotEnabled)),null!=e.adParkingPilotEnabled&&(t.adParkingPilotEnabled=Boolean(e.adParkingPilotEnabled)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.ADServiceAndSensorState.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.ADServiceAndSensorState.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.adSpeedControl=!1,i.adBrakeControl=!1,i.adSteeringControl=!1,i.adConnectionAvailable=!1,i.sensorObjectRecognition=!1,i.sensorSignRecognition=!1,i.sensorLaneRecognition=!1,i.sensorRoadSurface=!1,i.sensorEnvironment=!1,i.sensorParkingPilotAvailable=!1,i.sensorParkingSpotAvailable=!1,i.sensorParkingSpotEnabled=!1,i.adParkingPilotEnabled=!1}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.adSpeedControl&&e.hasOwnProperty("adSpeedControl")&&(i.adSpeedControl=e.adSpeedControl),null!=e.adBrakeControl&&e.hasOwnProperty("adBrakeControl")&&(i.adBrakeControl=e.adBrakeControl),null!=e.adSteeringControl&&e.hasOwnProperty("adSteeringControl")&&(i.adSteeringControl=e.adSteeringControl),null!=e.adConnectionAvailable&&e.hasOwnProperty("adConnectionAvailable")&&(i.adConnectionAvailable=e.adConnectionAvailable),null!=e.sensorObjectRecognition&&e.hasOwnProperty("sensorObjectRecognition")&&(i.sensorObjectRecognition=e.sensorObjectRecognition),null!=e.sensorSignRecognition&&e.hasOwnProperty("sensorSignRecognition")&&(i.sensorSignRecognition=e.sensorSignRecognition),null!=e.sensorLaneRecognition&&e.hasOwnProperty("sensorLaneRecognition")&&(i.sensorLaneRecognition=e.sensorLaneRecognition),null!=e.sensorRoadSurface&&e.hasOwnProperty("sensorRoadSurface")&&(i.sensorRoadSurface=e.sensorRoadSurface),null!=e.sensorEnvironment&&e.hasOwnProperty("sensorEnvironment")&&(i.sensorEnvironment=e.sensorEnvironment),null!=e.sensorParkingPilotAvailable&&e.hasOwnProperty("sensorParkingPilotAvailable")&&(i.sensorParkingPilotAvailable=e.sensorParkingPilotAvailable),null!=e.sensorParkingSpotAvailable&&e.hasOwnProperty("sensorParkingSpotAvailable")&&(i.sensorParkingSpotAvailable=e.sensorParkingSpotAvailable),null!=e.sensorParkingSpotEnabled&&e.hasOwnProperty("sensorParkingSpotEnabled")&&(i.sensorParkingSpotEnabled=e.sensorParkingSpotEnabled),null!=e.adParkingPilotEnabled&&e.hasOwnProperty("adParkingPilotEnabled")&&(i.adParkingPilotEnabled=e.adParkingPilotEnabled),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.SpecificObservedEventSubCauseEnum=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t;return e.prototype.trafficConditionSubCause=0,e.prototype.accidentSubCause=0,e.prototype.roadworksSubCause=0,e.prototype.adverseWeatherCondition_AdhesionSubCause=0,e.prototype.hazardousLocation_SurfaceConditionSubCause=0,e.prototype.hazardousLocation_ObstacleOnTheRoadSubCause=0,e.prototype.hazardousLocation_AnimalOnTheRoadSubCause=0,e.prototype.humanPresenceOnTheRoadSubCause=0,e.prototype.wrongWayDrivingSubCause=0,e.prototype.rescueAndRecoveryWorkInProgressSubCause=0,e.prototype.adverseWeatherCondition_ExtremeWeatherConditionSubCause=0,e.prototype.adverseWeatherCondition_VisibilitySubCause=0,e.prototype.adverseWeatherCondition_PrecipitationSubCause=0,e.prototype.slowVehicleSubCause=0,e.prototype.dangerousEndOfQueueSubCause=0,e.prototype.vehicleBreakdownSubCause=0,e.prototype.postCrashSubCause=0,e.prototype.humanProblemSubCause=0,e.prototype.stationaryVehicleSubCause=0,e.prototype.emergencyVehicleApproachingSubCause=0,e.prototype.hazardousLocation_DangerousCurveSubCause=0,e.prototype.collisionRiskSubCause=0,e.prototype.signalViolationSubCauseCodeSubCause=0,e.prototype.dangerousSituationSubCause=0,Object.defineProperty(e.prototype,"subcause",{get:u.oneOfGetter(t=["trafficConditionSubCause","accidentSubCause","roadworksSubCause","adverseWeatherCondition_AdhesionSubCause","hazardousLocation_SurfaceConditionSubCause","hazardousLocation_ObstacleOnTheRoadSubCause","hazardousLocation_AnimalOnTheRoadSubCause","humanPresenceOnTheRoadSubCause","wrongWayDrivingSubCause","rescueAndRecoveryWorkInProgressSubCause","adverseWeatherCondition_ExtremeWeatherConditionSubCause","adverseWeatherCondition_VisibilitySubCause","adverseWeatherCondition_PrecipitationSubCause","slowVehicleSubCause","dangerousEndOfQueueSubCause","vehicleBreakdownSubCause","postCrashSubCause","humanProblemSubCause","stationaryVehicleSubCause","emergencyVehicleApproachingSubCause","hazardousLocation_DangerousCurveSubCause","collisionRiskSubCause","signalViolationSubCauseCodeSubCause","dangerousSituationSubCause"]),set:u.oneOfSetter(t)}),e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.SpecificObservedEventSubCauseEnum;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.trafficConditionSubCause=e.int32();break;case 2:r.accidentSubCause=e.int32();break;case 3:r.roadworksSubCause=e.int32();break;case 6:r.adverseWeatherCondition_AdhesionSubCause=e.int32();break;case 9:r.hazardousLocation_SurfaceConditionSubCause=e.int32();break;case 10:r.hazardousLocation_ObstacleOnTheRoadSubCause=e.int32();break;case 11:r.hazardousLocation_AnimalOnTheRoadSubCause=e.int32();break;case 12:r.humanPresenceOnTheRoadSubCause=e.int32();break;case 14:r.wrongWayDrivingSubCause=e.int32();break;case 15:r.rescueAndRecoveryWorkInProgressSubCause=e.int32();break;case 17:r.adverseWeatherCondition_ExtremeWeatherConditionSubCause=e.int32();break;case 18:r.adverseWeatherCondition_VisibilitySubCause=e.int32();break;case 19:r.adverseWeatherCondition_PrecipitationSubCause=e.int32();break;case 26:r.slowVehicleSubCause=e.int32();break;case 27:r.dangerousEndOfQueueSubCause=e.int32();break;case 91:r.vehicleBreakdownSubCause=e.int32();break;case 92:r.postCrashSubCause=e.int32();break;case 93:r.humanProblemSubCause=e.int32();break;case 94:r.stationaryVehicleSubCause=e.int32();break;case 95:r.emergencyVehicleApproachingSubCause=e.int32();break;case 96:r.hazardousLocation_DangerousCurveSubCause=e.int32();break;case 97:r.collisionRiskSubCause=e.int32();break;case 98:r.signalViolationSubCauseCodeSubCause=e.int32();break;case 99:r.dangerousSituationSubCause=e.int32();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SpecificObservedEventSubCauseEnum)return e;var t=new d.sdii.here.pb.SpecificObservedEventSubCauseEnum;switch(e.trafficConditionSubCause){case"unavailableTrafficConditionSubCause":case 0:t.trafficConditionSubCause=0;break;case"increasedVolumeOfTraffic":case 1:t.trafficConditionSubCause=1;break;case"trafficJamSlowlyIncreasing":case 2:t.trafficConditionSubCause=2;break;case"trafficJamIncreasing":case 3:t.trafficConditionSubCause=3;break;case"trafficJamStronglyIncreasing":case 4:t.trafficConditionSubCause=4;break;case"trafficStationary":case 5:t.trafficConditionSubCause=5;break;case"trafficJamSlightlyDecreasing":case 6:t.trafficConditionSubCause=6;break;case"trafficJamDecreasing":case 7:t.trafficConditionSubCause=7;break;case"trafficJamStronglyDecreasing":case 8:t.trafficConditionSubCause=8}switch(e.accidentSubCause){case"unavailableAccidentSubCause":case 0:t.accidentSubCause=0;break;case"multiVehicleAccident":case 1:t.accidentSubCause=1;break;case"heavyAccident":case 2:t.accidentSubCause=2;break;case"accidentInvolvingLorry":case 3:t.accidentSubCause=3;break;case"accidentInvolvingBus":case 4:t.accidentSubCause=4;break;case"accidentInvolvingHazardousMaterials":case 5:t.accidentSubCause=5;break;case"accidentOnOppositeLane":case 6:t.accidentSubCause=6;break;case"unsecuredAccident":case 7:t.accidentSubCause=7;break;case"assistanceRequested":case 8:t.accidentSubCause=8}switch(e.roadworksSubCause){case"unavailableRoadworksSubCause":case 0:t.roadworksSubCause=0;break;case"majorRoadWorks":case 1:t.roadworksSubCause=1;break;case"roadMarkingWork":case 2:t.roadworksSubCause=2;break;case"slowMovingRoadMaintenance":case 3:t.roadworksSubCause=3;break;case"shortTermStationaryRoadworks":case 4:t.roadworksSubCause=4;break;case"streetCleaning":case 5:t.roadworksSubCause=5;break;case"winterService":case 6:t.roadworksSubCause=6}switch(e.adverseWeatherCondition_AdhesionSubCause){case"unavailableAdverseWeatherCondition_AdhesionSubCause":case 0:t.adverseWeatherCondition_AdhesionSubCause=0;break;case"heavyFrostOnRoad":case 1:t.adverseWeatherCondition_AdhesionSubCause=1;break;case"fuelOnRoad":case 2:t.adverseWeatherCondition_AdhesionSubCause=2;break;case"mudOnRoad":case 3:t.adverseWeatherCondition_AdhesionSubCause=3;break;case"snowOnRoad":case 4:t.adverseWeatherCondition_AdhesionSubCause=4;break;case"iceOnRoad":case 5:t.adverseWeatherCondition_AdhesionSubCause=5;break;case"blackIceOnRoad":case 6:t.adverseWeatherCondition_AdhesionSubCause=6;break;case"oilOnRoad":case 7:t.adverseWeatherCondition_AdhesionSubCause=7;break;case"looseChippings":case 8:t.adverseWeatherCondition_AdhesionSubCause=8;break;case"instantBlackIce":case 9:t.adverseWeatherCondition_AdhesionSubCause=9;break;case"roadsSalted":case 10:t.adverseWeatherCondition_AdhesionSubCause=10}switch(e.hazardousLocation_SurfaceConditionSubCause){case"unavailableHazardousLocation_SurfaceConditionSubCause":case 0:t.hazardousLocation_SurfaceConditionSubCause=0;break;case"rockfalls":case 1:t.hazardousLocation_SurfaceConditionSubCause=1;break;case"earthquakeDamage":case 2:t.hazardousLocation_SurfaceConditionSubCause=2;break;case"sewerCollapse":case 3:t.hazardousLocation_SurfaceConditionSubCause=3;break;case"subsidence":case 4:t.hazardousLocation_SurfaceConditionSubCause=4;break;case"snowDrifts":case 5:t.hazardousLocation_SurfaceConditionSubCause=5;break;case"stormDamage":case 6:t.hazardousLocation_SurfaceConditionSubCause=6;break;case"burstPipe":case 7:t.hazardousLocation_SurfaceConditionSubCause=7;break;case"volcanoEruption":case 8:t.hazardousLocation_SurfaceConditionSubCause=8;break;case"fallingIce":case 9:t.hazardousLocation_SurfaceConditionSubCause=9}switch(e.hazardousLocation_ObstacleOnTheRoadSubCause){case"unavailableHazardousLocation_ObstacleOnTheRoadSubCause":case 0:t.hazardousLocation_ObstacleOnTheRoadSubCause=0;break;case"shedload":case 1:t.hazardousLocation_ObstacleOnTheRoadSubCause=1;break;case"partsOfVehicles":case 2:t.hazardousLocation_ObstacleOnTheRoadSubCause=2;break;case"partsOfTyres":case 3:t.hazardousLocation_ObstacleOnTheRoadSubCause=3;break;case"bigObjects":case 4:t.hazardousLocation_ObstacleOnTheRoadSubCause=4;break;case"fallenTrees":case 5:t.hazardousLocation_ObstacleOnTheRoadSubCause=5;break;case"hubCaps":case 6:t.hazardousLocation_ObstacleOnTheRoadSubCause=6;break;case"waitingVehicles":case 7:t.hazardousLocation_ObstacleOnTheRoadSubCause=7}switch(e.hazardousLocation_AnimalOnTheRoadSubCause){case"unavailableHazardousLocation_AnimalOnTheRoadSubCause":case 0:t.hazardousLocation_AnimalOnTheRoadSubCause=0;break;case"wildAnimals":case 1:t.hazardousLocation_AnimalOnTheRoadSubCause=1;break;case"herdOfAnimals":case 2:t.hazardousLocation_AnimalOnTheRoadSubCause=2;break;case"smallAnimals":case 3:t.hazardousLocation_AnimalOnTheRoadSubCause=3;break;case"largeAnimals":case 4:t.hazardousLocation_AnimalOnTheRoadSubCause=4}switch(e.humanPresenceOnTheRoadSubCause){case"unavailableHumanPresenceOnTheRoadSubCause":case 0:t.humanPresenceOnTheRoadSubCause=0;break;case"childrenOnRoadway":case 1:t.humanPresenceOnTheRoadSubCause=1;break;case"cyclistOnRoadway":case 2:t.humanPresenceOnTheRoadSubCause=2;break;case"motorcyclistOnRoadway":case 3:t.humanPresenceOnTheRoadSubCause=3}switch(e.wrongWayDrivingSubCause){case"unavailableWrongWayDrivingSubCause":case 0:t.wrongWayDrivingSubCause=0;break;case"wrongLane":case 1:t.wrongWayDrivingSubCause=1;break;case"wrongDirection":case 2:t.wrongWayDrivingSubCause=2}switch(e.rescueAndRecoveryWorkInProgressSubCause){case"unavailableRescueAndRecoveryWorkInProgressSubCause":case 0:t.rescueAndRecoveryWorkInProgressSubCause=0;break;case"emergencyVehicles":case 1:t.rescueAndRecoveryWorkInProgressSubCause=1;break;case"rescueHelicopterLanding":case 2:t.rescueAndRecoveryWorkInProgressSubCause=2;break;case"policeActivityOngoing":case 3:t.rescueAndRecoveryWorkInProgressSubCause=3;break;case"medicalEmergencyOngoing":case 4:t.rescueAndRecoveryWorkInProgressSubCause=4;break;case"childAbductionInProgress":case 5:t.rescueAndRecoveryWorkInProgressSubCause=5}switch(e.adverseWeatherCondition_ExtremeWeatherConditionSubCause){case"unavailableAdverseWeatherCondition_ExtremeWeatherConditionSubCause":case 0:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=0;break;case"strongWinds":case 1:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=1;break;case"damagingHail":case 2:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=2;break;case"hurricane":case 3:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=3;break;case"thunderstorm":case 4:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=4;break;case"tornado":case 5:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=5;break;case"blizzard":case 6:t.adverseWeatherCondition_ExtremeWeatherConditionSubCause=6}switch(e.adverseWeatherCondition_VisibilitySubCause){case"unavailableAdverseWeatherCondition_VisibilitySubCause":case 0:t.adverseWeatherCondition_VisibilitySubCause=0;break;case"fog":case 1:t.adverseWeatherCondition_VisibilitySubCause=1;break;case"smoke":case 2:t.adverseWeatherCondition_VisibilitySubCause=2;break;case"heavySnowFallVisibility":case 3:t.adverseWeatherCondition_VisibilitySubCause=3;break;case"heavyRainVisibility":case 4:t.adverseWeatherCondition_VisibilitySubCause=4;break;case"heavyHail":case 5:t.adverseWeatherCondition_VisibilitySubCause=5;break;case"lowSunGlare":case 6:t.adverseWeatherCondition_VisibilitySubCause=6;break;case"sandstorms":case 7:t.adverseWeatherCondition_VisibilitySubCause=7;break;case"swarmsOfInsects":case 8:t.adverseWeatherCondition_VisibilitySubCause=8}switch(e.adverseWeatherCondition_PrecipitationSubCause){case"unavailableAdverseWeatherCondition_PrecipitationSubCause":case 0:t.adverseWeatherCondition_PrecipitationSubCause=0;break;case"heavyRainPrecipitation":case 1:t.adverseWeatherCondition_PrecipitationSubCause=1;break;case"heavySnowFallPrecipitation":case 2:t.adverseWeatherCondition_PrecipitationSubCause=2;break;case"softHail":case 3:t.adverseWeatherCondition_PrecipitationSubCause=3}switch(e.slowVehicleSubCause){case"unavailableSlowVehicleSubCause":case 0:t.slowVehicleSubCause=0;break;case"maintenanceVehicle":case 1:t.slowVehicleSubCause=1;break;case"vehiclesSlowingToLookAtAccident":case 2:t.slowVehicleSubCause=2;break;case"abnormalLoad":case 3:t.slowVehicleSubCause=3;break;case"abnormalWideLoad":case 4:t.slowVehicleSubCause=4;break;case"convoy":case 5:t.slowVehicleSubCause=5;break;case"snowplough":case 6:t.slowVehicleSubCause=6;break;case"deicing":case 7:t.slowVehicleSubCause=7;break;case"saltingVehicles":case 8:t.slowVehicleSubCause=8}switch(e.dangerousEndOfQueueSubCause){case"unavailableDangerousEndOfQueueSubCause":case 0:t.dangerousEndOfQueueSubCause=0;break;case"suddenEndOfQueue":case 1:t.dangerousEndOfQueueSubCause=1;break;case"queueOverHill":case 2:t.dangerousEndOfQueueSubCause=2;break;case"queueAroundBend":case 3:t.dangerousEndOfQueueSubCause=3;break;case"queueInTunnel":case 4:t.dangerousEndOfQueueSubCause=4}switch(e.vehicleBreakdownSubCause){case"unavailableVehicleBreakdownSubCause":case 0:t.vehicleBreakdownSubCause=0;break;case"lackOfFuel":case 1:t.vehicleBreakdownSubCause=1;break;case"lackOfBatteryPower":case 2:t.vehicleBreakdownSubCause=2;break;case"engineProblem":case 3:t.vehicleBreakdownSubCause=3;break;case"transmissionProblem":case 4:t.vehicleBreakdownSubCause=4;break;case"engineCoolingProblem":case 5:t.vehicleBreakdownSubCause=5;break;case"brakingSystemProblem":case 6:t.vehicleBreakdownSubCause=6;break;case"steeringProblem":case 7:t.vehicleBreakdownSubCause=7;break;case"tyrePuncture":case 8:t.vehicleBreakdownSubCause=8}switch(e.postCrashSubCause){case"unavailablePostCrashSubCause":case 0:t.postCrashSubCause=0;break;case"accidentWithoutECallTriggered":case 1:t.postCrashSubCause=1;break;case"accidentWithECallManuallyTriggered":case 2:t.postCrashSubCause=2;break;case"accidentWithECallAutomaticallyTriggered":case 3:t.postCrashSubCause=3;break;case"accidentWithECallTriggeredWithoutAccessToCellularNetwork":case 4:t.postCrashSubCause=4}switch(e.humanProblemSubCause){case"unavailableHumanProblemSubCause":case 0:t.humanProblemSubCause=0;break;case"glycemiaProblem":case 1:t.humanProblemSubCause=1;break;case"heartProblem":case 2:t.humanProblemSubCause=2}switch(e.stationaryVehicleSubCause){case"unavailableStationaryVehicleSubCause":case 0:t.stationaryVehicleSubCause=0;break;case"humanProblem":case 1:t.stationaryVehicleSubCause=1;break;case"vehicleBreakdown":case 2:t.stationaryVehicleSubCause=2;break;case"postCrash":case 3:t.stationaryVehicleSubCause=3;break;case"publicTransportStop":case 4:t.stationaryVehicleSubCause=4;break;case"carryingDangerousGoods":case 5:t.stationaryVehicleSubCause=5}switch(e.emergencyVehicleApproachingSubCause){case"unavailableEmergencyVehicleApproachingSubCause":case 0:t.emergencyVehicleApproachingSubCause=0;break;case"emergencyVehicleApproaching":case 1:t.emergencyVehicleApproachingSubCause=1;break;case"prioritizedVehicleApproaching":case 2:t.emergencyVehicleApproachingSubCause=2}switch(e.hazardousLocation_DangerousCurveSubCause){case"unavailableHazardousLocation_DangerousCurveSubCause":case 0:t.hazardousLocation_DangerousCurveSubCause=0;break;case"dangerousLeftTurnCurve":case 1:t.hazardousLocation_DangerousCurveSubCause=1;break;case"dangerousRightTurnCurve":case 2:t.hazardousLocation_DangerousCurveSubCause=2;break;case"multipleCurvesStartingWithUnknownTurningDirection":case 3:t.hazardousLocation_DangerousCurveSubCause=3;break;case"multipleCurvesStartingWithLeftTurn":case 4:t.hazardousLocation_DangerousCurveSubCause=4;break;case"multipleCurvesStartingWithRightTurn":case 5:t.hazardousLocation_DangerousCurveSubCause=5}switch(e.collisionRiskSubCause){case"unavailableCollisionRiskSubCause":case 0:t.collisionRiskSubCause=0;break;case"longitudinalCollisionRisk":case 1:t.collisionRiskSubCause=1;break;case"crossingCollisionRisk":case 2:t.collisionRiskSubCause=2;break;case"lateralCollisionRisk":case 3:t.collisionRiskSubCause=3;break;case"vulnerableRoadUser":case 4:t.collisionRiskSubCause=4}switch(e.signalViolationSubCauseCodeSubCause){case"unavailableSignalViolationSubCauseCodeSubCause":case 0:t.signalViolationSubCauseCodeSubCause=0;break;case"stopSignViolation":case 1:t.signalViolationSubCauseCodeSubCause=1;break;case"trafficLightViolation":case 2:t.signalViolationSubCauseCodeSubCause=2;break;case"turningRegulationViolation":case 3:t.signalViolationSubCauseCodeSubCause=3}switch(e.dangerousSituationSubCause){case"unavailableDangerousSituationSubCause":case 0:t.dangerousSituationSubCause=0;break;case"emergencyElectronicBrakeEngaged":case 1:t.dangerousSituationSubCause=1;break;case"preCrashSystemEngaged":case 2:t.dangerousSituationSubCause=2;break;case"espEngaged":case 3:t.dangerousSituationSubCause=3;break;case"absEngaged":case 4:t.dangerousSituationSubCause=4;break;case"aebEngaged":case 5:t.dangerousSituationSubCause=5;break;case"brakeWarningEngaged":case 6:t.dangerousSituationSubCause=6;break;case"collisionRiskWarningEngaged":case 7:t.dangerousSituationSubCause=7}return t},e.toObject=function(e,t){t||(t={});var i={};return null!=e.trafficConditionSubCause&&e.hasOwnProperty("trafficConditionSubCause")&&(i.trafficConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.TrafficConditionSubCauseEnum[e.trafficConditionSubCause]:e.trafficConditionSubCause,t.oneofs&&(i.subcause="trafficConditionSubCause")),null!=e.accidentSubCause&&e.hasOwnProperty("accidentSubCause")&&(i.accidentSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AccidentSubCauseEnum[e.accidentSubCause]:e.accidentSubCause,t.oneofs&&(i.subcause="accidentSubCause")),null!=e.roadworksSubCause&&e.hasOwnProperty("roadworksSubCause")&&(i.roadworksSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.RoadworksSubCauseEnum[e.roadworksSubCause]:e.roadworksSubCause,t.oneofs&&(i.subcause="roadworksSubCause")),null!=e.adverseWeatherCondition_AdhesionSubCause&&e.hasOwnProperty("adverseWeatherCondition_AdhesionSubCause")&&(i.adverseWeatherCondition_AdhesionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_AdhesionSubCauseEnum[e.adverseWeatherCondition_AdhesionSubCause]:e.adverseWeatherCondition_AdhesionSubCause,t.oneofs&&(i.subcause="adverseWeatherCondition_AdhesionSubCause")),null!=e.hazardousLocation_SurfaceConditionSubCause&&e.hasOwnProperty("hazardousLocation_SurfaceConditionSubCause")&&(i.hazardousLocation_SurfaceConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_SurfaceConditionSubCauseCode[e.hazardousLocation_SurfaceConditionSubCause]:e.hazardousLocation_SurfaceConditionSubCause,t.oneofs&&(i.subcause="hazardousLocation_SurfaceConditionSubCause")),null!=e.hazardousLocation_ObstacleOnTheRoadSubCause&&e.hasOwnProperty("hazardousLocation_ObstacleOnTheRoadSubCause")&&(i.hazardousLocation_ObstacleOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_ObstacleOnTheRoadSubCauseCode[e.hazardousLocation_ObstacleOnTheRoadSubCause]:e.hazardousLocation_ObstacleOnTheRoadSubCause,t.oneofs&&(i.subcause="hazardousLocation_ObstacleOnTheRoadSubCause")),null!=e.hazardousLocation_AnimalOnTheRoadSubCause&&e.hasOwnProperty("hazardousLocation_AnimalOnTheRoadSubCause")&&(i.hazardousLocation_AnimalOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_AnimalOnTheRoadSubCauseCode[e.hazardousLocation_AnimalOnTheRoadSubCause]:e.hazardousLocation_AnimalOnTheRoadSubCause,t.oneofs&&(i.subcause="hazardousLocation_AnimalOnTheRoadSubCause")),null!=e.humanPresenceOnTheRoadSubCause&&e.hasOwnProperty("humanPresenceOnTheRoadSubCause")&&(i.humanPresenceOnTheRoadSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HumanPresenceOnTheRoadSubCauseCode[e.humanPresenceOnTheRoadSubCause]:e.humanPresenceOnTheRoadSubCause,t.oneofs&&(i.subcause="humanPresenceOnTheRoadSubCause")),null!=e.wrongWayDrivingSubCause&&e.hasOwnProperty("wrongWayDrivingSubCause")&&(i.wrongWayDrivingSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.WrongWayDrivingSubCauseCode[e.wrongWayDrivingSubCause]:e.wrongWayDrivingSubCause,t.oneofs&&(i.subcause="wrongWayDrivingSubCause")),null!=e.rescueAndRecoveryWorkInProgressSubCause&&e.hasOwnProperty("rescueAndRecoveryWorkInProgressSubCause")&&(i.rescueAndRecoveryWorkInProgressSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.RescueAndRecoveryWorkInProgressSubCauseCode[e.rescueAndRecoveryWorkInProgressSubCause]:e.rescueAndRecoveryWorkInProgressSubCause,t.oneofs&&(i.subcause="rescueAndRecoveryWorkInProgressSubCause")),null!=e.adverseWeatherCondition_ExtremeWeatherConditionSubCause&&e.hasOwnProperty("adverseWeatherCondition_ExtremeWeatherConditionSubCause")&&(i.adverseWeatherCondition_ExtremeWeatherConditionSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_ExtremeWeatherConditionSubCauseCode[e.adverseWeatherCondition_ExtremeWeatherConditionSubCause]:e.adverseWeatherCondition_ExtremeWeatherConditionSubCause,t.oneofs&&(i.subcause="adverseWeatherCondition_ExtremeWeatherConditionSubCause")),null!=e.adverseWeatherCondition_VisibilitySubCause&&e.hasOwnProperty("adverseWeatherCondition_VisibilitySubCause")&&(i.adverseWeatherCondition_VisibilitySubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_VisibilitySubCauseCode[e.adverseWeatherCondition_VisibilitySubCause]:e.adverseWeatherCondition_VisibilitySubCause,t.oneofs&&(i.subcause="adverseWeatherCondition_VisibilitySubCause")),null!=e.adverseWeatherCondition_PrecipitationSubCause&&e.hasOwnProperty("adverseWeatherCondition_PrecipitationSubCause")&&(i.adverseWeatherCondition_PrecipitationSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.AdverseWeatherCondition_PrecipitationSubCauseCode[e.adverseWeatherCondition_PrecipitationSubCause]:e.adverseWeatherCondition_PrecipitationSubCause,t.oneofs&&(i.subcause="adverseWeatherCondition_PrecipitationSubCause")),null!=e.slowVehicleSubCause&&e.hasOwnProperty("slowVehicleSubCause")&&(i.slowVehicleSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.SlowVehicleSubCauseCode[e.slowVehicleSubCause]:e.slowVehicleSubCause,t.oneofs&&(i.subcause="slowVehicleSubCause")),null!=e.dangerousEndOfQueueSubCause&&e.hasOwnProperty("dangerousEndOfQueueSubCause")&&(i.dangerousEndOfQueueSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.DangerousEndOfQueueSubCauseCode[e.dangerousEndOfQueueSubCause]:e.dangerousEndOfQueueSubCause,t.oneofs&&(i.subcause="dangerousEndOfQueueSubCause")),null!=e.vehicleBreakdownSubCause&&e.hasOwnProperty("vehicleBreakdownSubCause")&&(i.vehicleBreakdownSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.VehicleBreakdownSubCauseCode[e.vehicleBreakdownSubCause]:e.vehicleBreakdownSubCause,t.oneofs&&(i.subcause="vehicleBreakdownSubCause")),null!=e.postCrashSubCause&&e.hasOwnProperty("postCrashSubCause")&&(i.postCrashSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.PostCrashSubCauseCode[e.postCrashSubCause]:e.postCrashSubCause,t.oneofs&&(i.subcause="postCrashSubCause")),null!=e.humanProblemSubCause&&e.hasOwnProperty("humanProblemSubCause")&&(i.humanProblemSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HumanProblemSubCauseCode[e.humanProblemSubCause]:e.humanProblemSubCause,t.oneofs&&(i.subcause="humanProblemSubCause")),null!=e.stationaryVehicleSubCause&&e.hasOwnProperty("stationaryVehicleSubCause")&&(i.stationaryVehicleSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.StationaryVehicleSubCauseCode[e.stationaryVehicleSubCause]:e.stationaryVehicleSubCause,t.oneofs&&(i.subcause="stationaryVehicleSubCause")),null!=e.emergencyVehicleApproachingSubCause&&e.hasOwnProperty("emergencyVehicleApproachingSubCause")&&(i.emergencyVehicleApproachingSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.EmergencyVehicleApproachingSubCauseCode[e.emergencyVehicleApproachingSubCause]:e.emergencyVehicleApproachingSubCause,t.oneofs&&(i.subcause="emergencyVehicleApproachingSubCause")),null!=e.hazardousLocation_DangerousCurveSubCause&&e.hasOwnProperty("hazardousLocation_DangerousCurveSubCause")&&(i.hazardousLocation_DangerousCurveSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.HazardousLocation_DangerousCurveSubCauseCode[e.hazardousLocation_DangerousCurveSubCause]:e.hazardousLocation_DangerousCurveSubCause,t.oneofs&&(i.subcause="hazardousLocation_DangerousCurveSubCause")),null!=e.collisionRiskSubCause&&e.hasOwnProperty("collisionRiskSubCause")&&(i.collisionRiskSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.CollisionRiskSubCauseCode[e.collisionRiskSubCause]:e.collisionRiskSubCause,t.oneofs&&(i.subcause="collisionRiskSubCause")),null!=e.signalViolationSubCauseCodeSubCause&&e.hasOwnProperty("signalViolationSubCauseCodeSubCause")&&(i.signalViolationSubCauseCodeSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.SignalViolationSubCauseCode[e.signalViolationSubCauseCodeSubCause]:e.signalViolationSubCauseCodeSubCause,t.oneofs&&(i.subcause="signalViolationSubCauseCodeSubCause")),null!=e.dangerousSituationSubCause&&e.hasOwnProperty("dangerousSituationSubCause")&&(i.dangerousSituationSubCause=t.enums===String?d.sdii.here.pb.SpecificObservedEventSubCauseEnum.DangerousSituationSubCauseCode[e.dangerousSituationSubCause]:e.dangerousSituationSubCause,t.oneofs&&(i.subcause="dangerousSituationSubCause")),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.TrafficConditionSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableTrafficConditionSubCause"]=0,t[e[1]="increasedVolumeOfTraffic"]=1,t[e[2]="trafficJamSlowlyIncreasing"]=2,t[e[3]="trafficJamIncreasing"]=3,t[e[4]="trafficJamStronglyIncreasing"]=4,t[e[5]="trafficStationary"]=5,t[e[6]="trafficJamSlightlyDecreasing"]=6,t[e[7]="trafficJamDecreasing"]=7,t[e[8]="trafficJamStronglyDecreasing"]=8,t}(),e.AccidentSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAccidentSubCause"]=0,t[e[1]="multiVehicleAccident"]=1,t[e[2]="heavyAccident"]=2,t[e[3]="accidentInvolvingLorry"]=3,t[e[4]="accidentInvolvingBus"]=4,t[e[5]="accidentInvolvingHazardousMaterials"]=5,t[e[6]="accidentOnOppositeLane"]=6,t[e[7]="unsecuredAccident"]=7,t[e[8]="assistanceRequested"]=8,t}(),e.RoadworksSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableRoadworksSubCause"]=0,t[e[1]="majorRoadWorks"]=1,t[e[2]="roadMarkingWork"]=2,t[e[3]="slowMovingRoadMaintenance"]=3,t[e[4]="shortTermStationaryRoadworks"]=4,t[e[5]="streetCleaning"]=5,t[e[6]="winterService"]=6,t}(),e.AdverseWeatherCondition_AdhesionSubCauseEnum=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_AdhesionSubCause"]=0,t[e[1]="heavyFrostOnRoad"]=1,t[e[2]="fuelOnRoad"]=2,t[e[3]="mudOnRoad"]=3,t[e[4]="snowOnRoad"]=4,t[e[5]="iceOnRoad"]=5,t[e[6]="blackIceOnRoad"]=6,t[e[7]="oilOnRoad"]=7,t[e[8]="looseChippings"]=8,t[e[9]="instantBlackIce"]=9,t[e[10]="roadsSalted"]=10,t}(),e.HazardousLocation_SurfaceConditionSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_SurfaceConditionSubCause"]=0,t[e[1]="rockfalls"]=1,t[e[2]="earthquakeDamage"]=2,t[e[3]="sewerCollapse"]=3,t[e[4]="subsidence"]=4,t[e[5]="snowDrifts"]=5,t[e[6]="stormDamage"]=6,t[e[7]="burstPipe"]=7,t[e[8]="volcanoEruption"]=8,t[e[9]="fallingIce"]=9,t}(),e.HazardousLocation_ObstacleOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_ObstacleOnTheRoadSubCause"]=0,t[e[1]="shedload"]=1,t[e[2]="partsOfVehicles"]=2,t[e[3]="partsOfTyres"]=3,t[e[4]="bigObjects"]=4,t[e[5]="fallenTrees"]=5,t[e[6]="hubCaps"]=6,t[e[7]="waitingVehicles"]=7,t}(),e.HazardousLocation_AnimalOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_AnimalOnTheRoadSubCause"]=0,t[e[1]="wildAnimals"]=1,t[e[2]="herdOfAnimals"]=2,t[e[3]="smallAnimals"]=3,t[e[4]="largeAnimals"]=4,t}(),e.HumanPresenceOnTheRoadSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHumanPresenceOnTheRoadSubCause"]=0,t[e[1]="childrenOnRoadway"]=1,t[e[2]="cyclistOnRoadway"]=2,t[e[3]="motorcyclistOnRoadway"]=3,t}(),e.WrongWayDrivingSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableWrongWayDrivingSubCause"]=0,t[e[1]="wrongLane"]=1,t[e[2]="wrongDirection"]=2,t}(),e.RescueAndRecoveryWorkInProgressSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableRescueAndRecoveryWorkInProgressSubCause"]=0,t[e[1]="emergencyVehicles"]=1,t[e[2]="rescueHelicopterLanding"]=2,t[e[3]="policeActivityOngoing"]=3,t[e[4]="medicalEmergencyOngoing"]=4,t[e[5]="childAbductionInProgress"]=5,t}(),e.AdverseWeatherCondition_ExtremeWeatherConditionSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_ExtremeWeatherConditionSubCause"]=0,t[e[1]="strongWinds"]=1,t[e[2]="damagingHail"]=2,t[e[3]="hurricane"]=3,t[e[4]="thunderstorm"]=4,t[e[5]="tornado"]=5,t[e[6]="blizzard"]=6,t}(),e.AdverseWeatherCondition_VisibilitySubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_VisibilitySubCause"]=0,t[e[1]="fog"]=1,t[e[2]="smoke"]=2,t[e[3]="heavySnowFallVisibility"]=3,t[e[4]="heavyRainVisibility"]=4,t[e[5]="heavyHail"]=5,t[e[6]="lowSunGlare"]=6,t[e[7]="sandstorms"]=7,t[e[8]="swarmsOfInsects"]=8,t}(),e.AdverseWeatherCondition_PrecipitationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableAdverseWeatherCondition_PrecipitationSubCause"]=0,t[e[1]="heavyRainPrecipitation"]=1,t[e[2]="heavySnowFallPrecipitation"]=2,t[e[3]="softHail"]=3,t}(),e.SlowVehicleSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableSlowVehicleSubCause"]=0,t[e[1]="maintenanceVehicle"]=1,t[e[2]="vehiclesSlowingToLookAtAccident"]=2,t[e[3]="abnormalLoad"]=3,t[e[4]="abnormalWideLoad"]=4,t[e[5]="convoy"]=5,t[e[6]="snowplough"]=6,t[e[7]="deicing"]=7,t[e[8]="saltingVehicles"]=8,t}(),e.DangerousEndOfQueueSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableDangerousEndOfQueueSubCause"]=0,t[e[1]="suddenEndOfQueue"]=1,t[e[2]="queueOverHill"]=2,t[e[3]="queueAroundBend"]=3,t[e[4]="queueInTunnel"]=4,t}(),e.VehicleBreakdownSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableVehicleBreakdownSubCause"]=0,t[e[1]="lackOfFuel"]=1,t[e[2]="lackOfBatteryPower"]=2,t[e[3]="engineProblem"]=3,t[e[4]="transmissionProblem"]=4,t[e[5]="engineCoolingProblem"]=5,t[e[6]="brakingSystemProblem"]=6,t[e[7]="steeringProblem"]=7,t[e[8]="tyrePuncture"]=8,t}(),e.PostCrashSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailablePostCrashSubCause"]=0,t[e[1]="accidentWithoutECallTriggered"]=1,t[e[2]="accidentWithECallManuallyTriggered"]=2,t[e[3]="accidentWithECallAutomaticallyTriggered"]=3,t[e[4]="accidentWithECallTriggeredWithoutAccessToCellularNetwork"]=4,t}(),e.HumanProblemSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHumanProblemSubCause"]=0,t[e[1]="glycemiaProblem"]=1,t[e[2]="heartProblem"]=2,t}(),e.StationaryVehicleSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableStationaryVehicleSubCause"]=0,t[e[1]="humanProblem"]=1,t[e[2]="vehicleBreakdown"]=2,t[e[3]="postCrash"]=3,t[e[4]="publicTransportStop"]=4,t[e[5]="carryingDangerousGoods"]=5,t}(),e.EmergencyVehicleApproachingSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableEmergencyVehicleApproachingSubCause"]=0,t[e[1]="emergencyVehicleApproaching"]=1,t[e[2]="prioritizedVehicleApproaching"]=2,t}(),e.HazardousLocation_DangerousCurveSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableHazardousLocation_DangerousCurveSubCause"]=0,t[e[1]="dangerousLeftTurnCurve"]=1,t[e[2]="dangerousRightTurnCurve"]=2,t[e[3]="multipleCurvesStartingWithUnknownTurningDirection"]=3,t[e[4]="multipleCurvesStartingWithLeftTurn"]=4,t[e[5]="multipleCurvesStartingWithRightTurn"]=5,t}(),e.CollisionRiskSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableCollisionRiskSubCause"]=0,t[e[1]="longitudinalCollisionRisk"]=1,t[e[2]="crossingCollisionRisk"]=2,t[e[3]="lateralCollisionRisk"]=3,t[e[4]="vulnerableRoadUser"]=4,t}(),e.SignalViolationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableSignalViolationSubCauseCodeSubCause"]=0,t[e[1]="stopSignViolation"]=1,t[e[2]="trafficLightViolation"]=2,t[e[3]="turningRegulationViolation"]=3,t}(),e.DangerousSituationSubCauseCode=function(){var e={},t=Object.create(e);return t[e[0]="unavailableDangerousSituationSubCause"]=0,t[e[1]="emergencyElectronicBrakeEngaged"]=1,t[e[2]="preCrashSystemEngaged"]=2,t[e[3]="espEngaged"]=3,t[e[4]="absEngaged"]=4,t[e[5]="aebEngaged"]=5,t[e[6]="brakeWarningEngaged"]=6,t[e[7]="collisionRiskWarningEngaged"]=7,t}(),e}(),o.SpecificObservedEvent=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.cause=1,e.prototype.subcause=null,e.prototype.relevanceTrafficDirection=0,e.prototype.relevanceEventReference=0,e.prototype.relevanceDistance=0,e.prototype.eventTimeToLive=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.specificObservedEventConfidence_percent=0,e.prototype.negotiationFlag=0,e.prototype.eventID="",e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.SpecificObservedEvent;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.cause=e.int32();break;case 3:r.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.decode(e,e.uint32());break;case 4:r.relevanceTrafficDirection=e.int32();break;case 5:r.relevanceEventReference=e.int32();break;case 6:r.relevanceDistance=e.int32();break;case 7:r.eventTimeToLive=e.int64();break;case 8:r.specificObservedEventConfidence_percent=e.int32();break;case 9:r.negotiationFlag=e.int32();break;case 10:r.eventID=e.string();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.SpecificObservedEvent)return e;var t=new d.sdii.here.pb.SpecificObservedEvent;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.cause){case"trafficCondition":case 1:t.cause=1;break;case"accident":case 2:t.cause=2;break;case"roadWorks":case 3:t.cause=3;break;case"adverseWeatherCondition_Adhesion":case 6:t.cause=6;break;case"hazardousLocation_SurfaceCondition":case 9:t.cause=9;break;case"hazardousLocation_ObstacleOnTheRoad":case 10:t.cause=10;break;case"hazardousLocation_AnimalOnTheRoad":case 11:t.cause=11;break;case"humanPresenceOnTheRoad":case 12:t.cause=12;break;case"wrongWayDriving":case 14:t.cause=14;break;case"rescueAndRecoveryWorkInProgress":case 15:t.cause=15;break;case"adverseWeatherCondition_ExtremeWeatherCondition":case 17:t.cause=17;break;case"adverseWeatherCondition_Visibility":case 18:t.cause=18;break;case"adverseWeatherCondition_Precipitation":case 19:t.cause=19;break;case"slowVehicle":case 26:t.cause=26;break;case"dangerousEndOfQueue":case 27:t.cause=27;break;case"vehicleBreakdown":case 91:t.cause=91;break;case"postCrash":case 92:t.cause=92;break;case"humanProblem":case 93:t.cause=93;break;case"stationaryVehicle":case 94:t.cause=94;break;case"emergencyVehicleApproaching":case 95:t.cause=95;break;case"hazardousLocation_DangerousCurve":case 96:t.cause=96;break;case"collisionRisk":case 97:t.cause=97;break;case"signalViolation":case 98:t.cause=98;break;case"dangerousSituation":case 99:t.cause=99}if(null!=e.subcause){if("object"!=typeof e.subcause)throw TypeError(".sdii.here.pb.SpecificObservedEvent.subcause: object expected");t.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.fromObject(e.subcause)}switch(e.relevanceTrafficDirection){case"allTrafficDirections":case 0:t.relevanceTrafficDirection=0;break;case"sameTraffic":case 1:t.relevanceTrafficDirection=1;break;case"oppositeTraffic":case 2:t.relevanceTrafficDirection=2}switch(e.relevanceEventReference){case"allStreamsTraffic":case 0:t.relevanceEventReference=0;break;case"upStreamTraffic":case 1:t.relevanceEventReference=1;break;case"downStreamTraffic":case 2:t.relevanceEventReference=2}switch(e.relevanceDistance){case"lessThan50M":case 0:t.relevanceDistance=0;break;case"lessThan100M":case 1:t.relevanceDistance=1;break;case"lessThan200M":case 2:t.relevanceDistance=2;break;case"lessThan500M":case 3:t.relevanceDistance=3;break;case"lessThan1000M":case 4:t.relevanceDistance=4;break;case"lessThan5KM":case 5:t.relevanceDistance=5;break;case"lessThan10KM":case 6:t.relevanceDistance=6;break;case"over10KM":case 7:t.relevanceDistance=7}switch(null!=e.eventTimeToLive&&(u.Long?(t.eventTimeToLive=u.Long.fromValue(e.eventTimeToLive)).unsigned=!1:"string"==typeof e.eventTimeToLive?t.eventTimeToLive=parseInt(e.eventTimeToLive,10):"number"==typeof e.eventTimeToLive?t.eventTimeToLive=e.eventTimeToLive:"object"==typeof e.eventTimeToLive&&(t.eventTimeToLive=new u.LongBits(e.eventTimeToLive.low>>>0,e.eventTimeToLive.high>>>0).toNumber())),null!=e.specificObservedEventConfidence_percent&&(t.specificObservedEventConfidence_percent=0|e.specificObservedEventConfidence_percent),e.negotiationFlag){case"NEGOTIATION_TYPE_UNDEFINED":case 0:t.negotiationFlag=0;break;case"NEGOTIATION_TYPE_SUPPORT":case 1:t.negotiationFlag=1;break;case"NEGOTIATION_TYPE_CONTRADICT":case 2:t.negotiationFlag=2;break;case"NEGOTIATION_TYPE_CANCEL":case 3:t.negotiationFlag=3}if(null!=e.eventID&&(t.eventID=String(e.eventID)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.SpecificObservedEvent.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.SpecificObservedEvent.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.cause=t.enums===String?"trafficCondition":1,i.subcause=null,i.relevanceTrafficDirection=t.enums===String?"allTrafficDirections":0,i.relevanceEventReference=t.enums===String?"allStreamsTraffic":0,i.relevanceDistance=t.enums===String?"lessThan50M":0,u.Long?(r=new u.Long(0,0,!1),i.eventTimeToLive=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.eventTimeToLive=t.longs===String?"0":0,i.specificObservedEventConfidence_percent=0,i.negotiationFlag=t.enums===String?"NEGOTIATION_TYPE_UNDEFINED":0,i.eventID=""}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.cause&&e.hasOwnProperty("cause")&&(i.cause=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.SpecificObservedEventCauseEnum[e.cause]:e.cause),null!=e.subcause&&e.hasOwnProperty("subcause")&&(i.subcause=d.sdii.here.pb.SpecificObservedEventSubCauseEnum.toObject(e.subcause,t)),null!=e.relevanceTrafficDirection&&e.hasOwnProperty("relevanceTrafficDirection")&&(i.relevanceTrafficDirection=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceTrafficDirectionEnum[e.relevanceTrafficDirection]:e.relevanceTrafficDirection),null!=e.relevanceEventReference&&e.hasOwnProperty("relevanceEventReference")&&(i.relevanceEventReference=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceEventReferenceEnum[e.relevanceEventReference]:e.relevanceEventReference),null!=e.relevanceDistance&&e.hasOwnProperty("relevanceDistance")&&(i.relevanceDistance=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.RelevanceDistance[e.relevanceDistance]:e.relevanceDistance),null!=e.eventTimeToLive&&e.hasOwnProperty("eventTimeToLive")&&("number"==typeof e.eventTimeToLive?i.eventTimeToLive=t.longs===String?String(e.eventTimeToLive):e.eventTimeToLive:i.eventTimeToLive=t.longs===String?u.Long.prototype.toString.call(e.eventTimeToLive):t.longs===Number?new u.LongBits(e.eventTimeToLive.low>>>0,e.eventTimeToLive.high>>>0).toNumber():e.eventTimeToLive),null!=e.specificObservedEventConfidence_percent&&e.hasOwnProperty("specificObservedEventConfidence_percent")&&(i.specificObservedEventConfidence_percent=e.specificObservedEventConfidence_percent),null!=e.negotiationFlag&&e.hasOwnProperty("negotiationFlag")&&(i.negotiationFlag=t.enums===String?d.sdii.here.pb.SpecificObservedEvent.NegotiationTypeEnum[e.negotiationFlag]:e.negotiationFlag),null!=e.eventID&&e.hasOwnProperty("eventID")&&(i.eventID=e.eventID),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.SpecificObservedEventCauseEnum=function(){var e={},t=Object.create(e);return t[e[1]="trafficCondition"]=1,t[e[2]="accident"]=2,t[e[3]="roadWorks"]=3,t[e[6]="adverseWeatherCondition_Adhesion"]=6,t[e[9]="hazardousLocation_SurfaceCondition"]=9,t[e[10]="hazardousLocation_ObstacleOnTheRoad"]=10,t[e[11]="hazardousLocation_AnimalOnTheRoad"]=11,t[e[12]="humanPresenceOnTheRoad"]=12,t[e[14]="wrongWayDriving"]=14,t[e[15]="rescueAndRecoveryWorkInProgress"]=15,t[e[17]="adverseWeatherCondition_ExtremeWeatherCondition"]=17,t[e[18]="adverseWeatherCondition_Visibility"]=18,t[e[19]="adverseWeatherCondition_Precipitation"]=19,t[e[26]="slowVehicle"]=26,t[e[27]="dangerousEndOfQueue"]=27,t[e[91]="vehicleBreakdown"]=91,t[e[92]="postCrash"]=92,t[e[93]="humanProblem"]=93,t[e[94]="stationaryVehicle"]=94,t[e[95]="emergencyVehicleApproaching"]=95,t[e[96]="hazardousLocation_DangerousCurve"]=96,t[e[97]="collisionRisk"]=97,t[e[98]="signalViolation"]=98,t[e[99]="dangerousSituation"]=99,t}(),e.RelevanceTrafficDirectionEnum=function(){var e={},t=Object.create(e);return t[e[0]="allTrafficDirections"]=0,t[e[1]="sameTraffic"]=1,t[e[2]="oppositeTraffic"]=2,t}(),e.RelevanceEventReferenceEnum=function(){var e={},t=Object.create(e);return t[e[0]="allStreamsTraffic"]=0,t[e[1]="upStreamTraffic"]=1,t[e[2]="downStreamTraffic"]=2,t}(),e.RelevanceDistance=function(){var e={},t=Object.create(e);return t[e[0]="lessThan50M"]=0,t[e[1]="lessThan100M"]=1,t[e[2]="lessThan200M"]=2,t[e[3]="lessThan500M"]=3,t[e[4]="lessThan1000M"]=4,t[e[5]="lessThan5KM"]=5,t[e[6]="lessThan10KM"]=6,t[e[7]="over10KM"]=7,t}(),e.NegotiationTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="NEGOTIATION_TYPE_UNDEFINED"]=0,t[e[1]="NEGOTIATION_TYPE_SUPPORT"]=1,t[e[2]="NEGOTIATION_TYPE_CONTRADICT"]=2,t[e[3]="NEGOTIATION_TYPE_CANCEL"]=3,t}(),e}(),o.RoadCondition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadRoughnessSegmentLevel=0,e.prototype.roadRoughnessSegmentDuration_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadRoughnessSegmentLength_m=0,e.prototype.roadRoughnessLocalEvent=!1,e.prototype.roadRoughnessLateralPosition=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.RoadCondition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.roadRoughnessSegmentLevel=e.int32();break;case 3:r.roadRoughnessSegmentDuration_ms=e.int64();break;case 4:r.roadRoughnessSegmentLength_m=e.int32();break;case 5:r.roadRoughnessLocalEvent=e.bool();break;case 6:r.roadRoughnessLateralPosition=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadCondition)return e;var t=new d.sdii.here.pb.RoadCondition;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.roadRoughnessSegmentLevel&&(t.roadRoughnessSegmentLevel=0|e.roadRoughnessSegmentLevel),null!=e.roadRoughnessSegmentDuration_ms&&(u.Long?(t.roadRoughnessSegmentDuration_ms=u.Long.fromValue(e.roadRoughnessSegmentDuration_ms)).unsigned=!1:"string"==typeof e.roadRoughnessSegmentDuration_ms?t.roadRoughnessSegmentDuration_ms=parseInt(e.roadRoughnessSegmentDuration_ms,10):"number"==typeof e.roadRoughnessSegmentDuration_ms?t.roadRoughnessSegmentDuration_ms=e.roadRoughnessSegmentDuration_ms:"object"==typeof e.roadRoughnessSegmentDuration_ms&&(t.roadRoughnessSegmentDuration_ms=new u.LongBits(e.roadRoughnessSegmentDuration_ms.low>>>0,e.roadRoughnessSegmentDuration_ms.high>>>0).toNumber())),null!=e.roadRoughnessSegmentLength_m&&(t.roadRoughnessSegmentLength_m=0|e.roadRoughnessSegmentLength_m),null!=e.roadRoughnessLocalEvent&&(t.roadRoughnessLocalEvent=Boolean(e.roadRoughnessLocalEvent)),e.roadRoughnessLateralPosition){case"bothSidesOfVehicle":case 0:t.roadRoughnessLateralPosition=0;break;case"leftSideOfVehicle":case 1:t.roadRoughnessLateralPosition=1;break;case"rightSideOfVehicle":case 2:t.roadRoughnessLateralPosition=2}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadCondition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.RoadCondition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.roadRoughnessSegmentLevel=0,u.Long?(r=new u.Long(0,0,!1),i.roadRoughnessSegmentDuration_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.roadRoughnessSegmentDuration_ms=t.longs===String?"0":0,i.roadRoughnessSegmentLength_m=0,i.roadRoughnessLocalEvent=!1,i.roadRoughnessLateralPosition=t.enums===String?"bothSidesOfVehicle":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.roadRoughnessSegmentLevel&&e.hasOwnProperty("roadRoughnessSegmentLevel")&&(i.roadRoughnessSegmentLevel=e.roadRoughnessSegmentLevel),null!=e.roadRoughnessSegmentDuration_ms&&e.hasOwnProperty("roadRoughnessSegmentDuration_ms")&&("number"==typeof e.roadRoughnessSegmentDuration_ms?i.roadRoughnessSegmentDuration_ms=t.longs===String?String(e.roadRoughnessSegmentDuration_ms):e.roadRoughnessSegmentDuration_ms:i.roadRoughnessSegmentDuration_ms=t.longs===String?u.Long.prototype.toString.call(e.roadRoughnessSegmentDuration_ms):t.longs===Number?new u.LongBits(e.roadRoughnessSegmentDuration_ms.low>>>0,e.roadRoughnessSegmentDuration_ms.high>>>0).toNumber():e.roadRoughnessSegmentDuration_ms),null!=e.roadRoughnessSegmentLength_m&&e.hasOwnProperty("roadRoughnessSegmentLength_m")&&(i.roadRoughnessSegmentLength_m=e.roadRoughnessSegmentLength_m),null!=e.roadRoughnessLocalEvent&&e.hasOwnProperty("roadRoughnessLocalEvent")&&(i.roadRoughnessLocalEvent=e.roadRoughnessLocalEvent),null!=e.roadRoughnessLateralPosition&&e.hasOwnProperty("roadRoughnessLateralPosition")&&(i.roadRoughnessLateralPosition=t.enums===String?d.sdii.here.pb.RoadCondition.RoadRoughnessLateralPositionEnum[e.roadRoughnessLateralPosition]:e.roadRoughnessLateralPosition),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.RoadRoughnessLateralPositionEnum=function(){var e={},t=Object.create(e);return t[e[0]="bothSidesOfVehicle"]=0,t[e[1]="leftSideOfVehicle"]=1,t[e[2]="rightSideOfVehicle"]=2,t}(),e}(),o.RoadBoundaryRecognition=function(){function e(e){if(this.positionOffset=[],this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.positionOffset=u.emptyArray,e.prototype.roadBoundaryType=0,e.prototype.roadBoundaryRecognitionType=0,e.prototype.roadBoundaryChangeType=0,e.prototype.detectedObjectID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.RoadBoundaryRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.positionOffset&&r.positionOffset.length||(r.positionOffset=[]),r.positionOffset.push(d.sdii.here.pb.PositionOffset.decode(e,e.uint32()));break;case 3:r.roadBoundaryType=e.int32();break;case 4:r.roadBoundaryRecognitionType=e.int32();break;case 5:r.roadBoundaryChangeType=e.int32();break;case 6:r.detectedObjectID=e.int64();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadBoundaryRecognition)return e;var t=new d.sdii.here.pb.RoadBoundaryRecognition;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.positionOffset){if(!Array.isArray(e.positionOffset))throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.positionOffset: array expected");t.positionOffset=[];for(var i=0;i<e.positionOffset.length;++i){if("object"!=typeof e.positionOffset[i])throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.positionOffset: object expected");t.positionOffset[i]=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset[i])}}switch(e.roadBoundaryType){case"ROAD_BOUNDARY_TYPE_UNDEFINED":case 0:t.roadBoundaryType=0;break;case"GENERAL_UNPASSABLE":case 1:t.roadBoundaryType=1;break;case"GENERAL_PASSABLE":case 2:t.roadBoundaryType=2;break;case"PASSABLE_FREESPACE":case 3:t.roadBoundaryType=3;break;case"PASSABLE_GREENFIELD":case 4:t.roadBoundaryType=4;break;case"PASSABLE_PAVEMENT":case 5:t.roadBoundaryType=5;break;case"UNPASSABLE_WALL":case 6:t.roadBoundaryType=6;break;case"UNPASSABLE_GUARDRAIL":case 7:t.roadBoundaryType=7;break;case"UNPASSABLE_DIVIDER":case 8:t.roadBoundaryType=8;break;case"UNPASSABLE_CURBSTONE":case 9:t.roadBoundaryType=9;break;case"UNPASSABLE_PARKINGVEHICLE":case 10:t.roadBoundaryType=10;break;case"UNPASSABLE_PARKINGVEHICLE_DIAGONAL":case 11:t.roadBoundaryType=11;break;case"PASSABLE_FREEPARKINGSPACE":case 12:t.roadBoundaryType=12}switch(e.roadBoundaryRecognitionType){case"ROAD_BOUNDARY_UNDEFINED":case 0:t.roadBoundaryRecognitionType=0;break;case"ROAD_BOUNDARY_DETECTED":case 1:t.roadBoundaryRecognitionType=1;break;case"ROAD_BOUNDARY_NOT_DETECTED":case 2:t.roadBoundaryRecognitionType=2}switch(e.roadBoundaryChangeType){case"ROAD_BOUNDARY_CHANGE_UNDEFINED":case 0:t.roadBoundaryChangeType=0;break;case"ROAD_BOUNDARY_START":case 1:t.roadBoundaryChangeType=1;break;case"ROAD_BOUNDARY_END":case 2:t.roadBoundaryChangeType=2}if(null!=e.detectedObjectID&&(u.Long?(t.detectedObjectID=u.Long.fromValue(e.detectedObjectID)).unsigned=!1:"string"==typeof e.detectedObjectID?t.detectedObjectID=parseInt(e.detectedObjectID,10):"number"==typeof e.detectedObjectID?t.detectedObjectID=e.detectedObjectID:"object"==typeof e.detectedObjectID&&(t.detectedObjectID=new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber())),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.extensionContainer: array expected");for(t.extensionContainer=[],i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.RoadBoundaryRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.positionOffset=[],i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.roadBoundaryType=t.enums===String?"ROAD_BOUNDARY_TYPE_UNDEFINED":0,i.roadBoundaryRecognitionType=t.enums===String?"ROAD_BOUNDARY_UNDEFINED":0,i.roadBoundaryChangeType=t.enums===String?"ROAD_BOUNDARY_CHANGE_UNDEFINED":0,u.Long?(r=new u.Long(0,0,!1),i.detectedObjectID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.detectedObjectID=t.longs===String?"0":0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),e.positionOffset&&e.positionOffset.length){i.positionOffset=[];for(var n=0;n<e.positionOffset.length;++n)i.positionOffset[n]=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset[n],t)}if(null!=e.roadBoundaryType&&e.hasOwnProperty("roadBoundaryType")&&(i.roadBoundaryType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryTypeEnum[e.roadBoundaryType]:e.roadBoundaryType),null!=e.roadBoundaryRecognitionType&&e.hasOwnProperty("roadBoundaryRecognitionType")&&(i.roadBoundaryRecognitionType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryRecognitionTypeEnum[e.roadBoundaryRecognitionType]:e.roadBoundaryRecognitionType),null!=e.roadBoundaryChangeType&&e.hasOwnProperty("roadBoundaryChangeType")&&(i.roadBoundaryChangeType=t.enums===String?d.sdii.here.pb.RoadBoundaryRecognition.RoadBoundaryChangeTypeEnum[e.roadBoundaryChangeType]:e.roadBoundaryChangeType),null!=e.detectedObjectID&&e.hasOwnProperty("detectedObjectID")&&("number"==typeof e.detectedObjectID?i.detectedObjectID=t.longs===String?String(e.detectedObjectID):e.detectedObjectID:i.detectedObjectID=t.longs===String?u.Long.prototype.toString.call(e.detectedObjectID):t.longs===Number?new u.LongBits(e.detectedObjectID.low>>>0,e.detectedObjectID.high>>>0).toNumber():e.detectedObjectID),e.extensionContainer&&e.extensionContainer.length)for(i.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.RoadBoundaryTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_TYPE_UNDEFINED"]=0,t[e[1]="GENERAL_UNPASSABLE"]=1,t[e[2]="GENERAL_PASSABLE"]=2,t[e[3]="PASSABLE_FREESPACE"]=3,t[e[4]="PASSABLE_GREENFIELD"]=4,t[e[5]="PASSABLE_PAVEMENT"]=5,t[e[6]="UNPASSABLE_WALL"]=6,t[e[7]="UNPASSABLE_GUARDRAIL"]=7,t[e[8]="UNPASSABLE_DIVIDER"]=8,t[e[9]="UNPASSABLE_CURBSTONE"]=9,t[e[10]="UNPASSABLE_PARKINGVEHICLE"]=10,t[e[11]="UNPASSABLE_PARKINGVEHICLE_DIAGONAL"]=11,t[e[12]="PASSABLE_FREEPARKINGSPACE"]=12,t}(),e.RoadBoundaryRecognitionTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_UNDEFINED"]=0,t[e[1]="ROAD_BOUNDARY_DETECTED"]=1,t[e[2]="ROAD_BOUNDARY_NOT_DETECTED"]=2,t}(),e.RoadBoundaryChangeTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_BOUNDARY_CHANGE_UNDEFINED"]=0,t[e[1]="ROAD_BOUNDARY_START"]=1,t[e[2]="ROAD_BOUNDARY_END"]=2,t}(),e}(),o.VehicleManeuverEvent=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.vehicleManeuverType=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.VehicleManeuverEvent;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timestampUTC_ms=e.int64();break;case 2:r.vehicleManeuverType=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.VehicleManeuverEvent)return e;var t=new d.sdii.here.pb.VehicleManeuverEvent;switch(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.vehicleManeuverType){case"VEHICLE_MANEUVER_TYPE_UNDEFINED":case 0:t.vehicleManeuverType=0;break;case"LANE_CHANGE":case 1:t.vehicleManeuverType=1;break;case"LANE_CHANGE_RIGHT":case 2:t.vehicleManeuverType=2;break;case"LANE_CHANGE_LEFT":case 3:t.vehicleManeuverType=3;break;case"PARKED_IN":case 11:t.vehicleManeuverType=11;break;case"PARKED_IN_LATERAL":case 12:t.vehicleManeuverType=12;break;case"PARKED_IN_DIAGONAL":case 13:t.vehicleManeuverType=13;break;case"PARKED_IN_LONGITUDINAL":case 14:t.vehicleManeuverType=14;break;case"PARKED_OUT":case 15:t.vehicleManeuverType=15}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.VehicleManeuverEvent.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.VehicleManeuverEvent.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timestampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timestampUTC_ms=t.longs===String?"0":0;i.vehicleManeuverType=t.enums===String?"VEHICLE_MANEUVER_TYPE_UNDEFINED":0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?i.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:i.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),null!=e.vehicleManeuverType&&e.hasOwnProperty("vehicleManeuverType")&&(i.vehicleManeuverType=t.enums===String?d.sdii.here.pb.VehicleManeuverEvent.VehicleManeuverTypeEvent[e.vehicleManeuverType]:e.vehicleManeuverType),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.VehicleManeuverTypeEvent=function(){var e={},t=Object.create(e);return t[e[0]="VEHICLE_MANEUVER_TYPE_UNDEFINED"]=0,t[e[1]="LANE_CHANGE"]=1,t[e[2]="LANE_CHANGE_RIGHT"]=2,t[e[3]="LANE_CHANGE_LEFT"]=3,t[e[11]="PARKED_IN"]=11,t[e[12]="PARKED_IN_LATERAL"]=12,t[e[13]="PARKED_IN_DIAGONAL"]=13,t[e[14]="PARKED_IN_LONGITUDINAL"]=14,t[e[15]="PARKED_OUT"]=15,t}(),e}(),o.LocalizationInformation=function(){function e(e){if(this.usedLocalizationSystems=[],this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.usedLocalizationSystems=u.emptyArray,e.prototype.enhancedByDeadReconning=!1,e.prototype.enhancedByMapLocalization=!1,e.prototype.HDOP=0,e.prototype.VDOP=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.LocalizationInformation;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timestampUTC_ms=e.int64();break;case 2:r.usedLocalizationSystems&&r.usedLocalizationSystems.length||(r.usedLocalizationSystems=[]),r.usedLocalizationSystems.push(d.sdii.here.pb.LocalizationInformation.PositioningSystem.decode(e,e.uint32()));break;case 3:r.enhancedByDeadReconning=e.bool();break;case 4:r.enhancedByMapLocalization=e.bool();break;case 5:r.HDOP=e.double();break;case 6:r.VDOP=e.double();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LocalizationInformation)return e;var t=new d.sdii.here.pb.LocalizationInformation;if(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.usedLocalizationSystems){if(!Array.isArray(e.usedLocalizationSystems))throw TypeError(".sdii.here.pb.LocalizationInformation.usedLocalizationSystems: array expected");t.usedLocalizationSystems=[];for(var i=0;i<e.usedLocalizationSystems.length;++i){if("object"!=typeof e.usedLocalizationSystems[i])throw TypeError(".sdii.here.pb.LocalizationInformation.usedLocalizationSystems: object expected");t.usedLocalizationSystems[i]=d.sdii.here.pb.LocalizationInformation.PositioningSystem.fromObject(e.usedLocalizationSystems[i])}}if(null!=e.enhancedByDeadReconning&&(t.enhancedByDeadReconning=Boolean(e.enhancedByDeadReconning)),null!=e.enhancedByMapLocalization&&(t.enhancedByMapLocalization=Boolean(e.enhancedByMapLocalization)),null!=e.HDOP&&(t.HDOP=Number(e.HDOP)),null!=e.VDOP&&(t.VDOP=Number(e.VDOP)),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.LocalizationInformation.extensionContainer: array expected");for(t.extensionContainer=[],i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.LocalizationInformation.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.usedLocalizationSystems=[],i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timestampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timestampUTC_ms=t.longs===String?"0":0;i.enhancedByDeadReconning=!1,i.enhancedByMapLocalization=!1,i.HDOP=0,i.VDOP=0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?i.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:i.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),e.usedLocalizationSystems&&e.usedLocalizationSystems.length){i.usedLocalizationSystems=[];for(var n=0;n<e.usedLocalizationSystems.length;++n)i.usedLocalizationSystems[n]=d.sdii.here.pb.LocalizationInformation.PositioningSystem.toObject(e.usedLocalizationSystems[n],t)}if(null!=e.enhancedByDeadReconning&&e.hasOwnProperty("enhancedByDeadReconning")&&(i.enhancedByDeadReconning=e.enhancedByDeadReconning),null!=e.enhancedByMapLocalization&&e.hasOwnProperty("enhancedByMapLocalization")&&(i.enhancedByMapLocalization=e.enhancedByMapLocalization),null!=e.HDOP&&e.hasOwnProperty("HDOP")&&(i.HDOP=t.json&&!isFinite(e.HDOP)?String(e.HDOP):e.HDOP),null!=e.VDOP&&e.hasOwnProperty("VDOP")&&(i.VDOP=t.json&&!isFinite(e.VDOP)?String(e.VDOP):e.VDOP),e.extensionContainer&&e.extensionContainer.length)for(i.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.PositioningSystem=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.positioningSystem=0,e.prototype.gnssFix=0,e.prototype.numberOfSatellites=0,e.prototype.enhancedByCellOrWifi=!1,e.prototype.enhancedByDifferentialSignal=!1,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.LocalizationInformation.PositioningSystem;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.positioningSystem=e.int32();break;case 2:r.gnssFix=e.int32();break;case 3:r.numberOfSatellites=e.int32();break;case 4:r.enhancedByCellOrWifi=e.bool();break;case 5:r.enhancedByDifferentialSignal=e.bool();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.LocalizationInformation.PositioningSystem)return e;var t=new d.sdii.here.pb.LocalizationInformation.PositioningSystem;switch(e.positioningSystem){case"POSITIONING_SYSTEM_TYPE_UNDEFINED":case 0:t.positioningSystem=0;break;case"POSITIONING_SYSTEM_TYPE_OTHER":case 1:t.positioningSystem=1;break;case"POSITIONING_SYSTEM_TYPE_GPS":case 2:t.positioningSystem=2;break;case"POSITIONING_SYSTEM_TYPE_GLONASS":case 3:t.positioningSystem=3;break;case"POSITIONING_SYSTEM_TYPE_GALLILEO":case 4:t.positioningSystem=4;break;case"POSITIONING_SYSTEM_TYPE_IRNSS":case 5:t.positioningSystem=5;break;case"POSITIONING_SYSTEM_TYPE_BeiDou":case 6:t.positioningSystem=6}switch(e.gnssFix){case"GNSS_FIX_UNDEFINED":case 0:t.gnssFix=0;break;case"GNSS_FIX_NO":case 1:t.gnssFix=1;break;case"GNSS_FIX_2D":case 2:t.gnssFix=2;break;case"GNSS_FIX_3D":case 3:t.gnssFix=3}return null!=e.numberOfSatellites&&(t.numberOfSatellites=0|e.numberOfSatellites),null!=e.enhancedByCellOrWifi&&(t.enhancedByCellOrWifi=Boolean(e.enhancedByCellOrWifi)),null!=e.enhancedByDifferentialSignal&&(t.enhancedByDifferentialSignal=Boolean(e.enhancedByDifferentialSignal)),t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.positioningSystem=t.enums===String?"POSITIONING_SYSTEM_TYPE_UNDEFINED":0,i.gnssFix=t.enums===String?"GNSS_FIX_UNDEFINED":0,i.numberOfSatellites=0,i.enhancedByCellOrWifi=!1,i.enhancedByDifferentialSignal=!1),null!=e.positioningSystem&&e.hasOwnProperty("positioningSystem")&&(i.positioningSystem=t.enums===String?d.sdii.here.pb.LocalizationInformation.PositioningSystem.PositioningSystemTypeEnum[e.positioningSystem]:e.positioningSystem),null!=e.gnssFix&&e.hasOwnProperty("gnssFix")&&(i.gnssFix=t.enums===String?d.sdii.here.pb.LocalizationInformation.PositioningSystem.GNSSFixEnum[e.gnssFix]:e.gnssFix),null!=e.numberOfSatellites&&e.hasOwnProperty("numberOfSatellites")&&(i.numberOfSatellites=e.numberOfSatellites),null!=e.enhancedByCellOrWifi&&e.hasOwnProperty("enhancedByCellOrWifi")&&(i.enhancedByCellOrWifi=e.enhancedByCellOrWifi),null!=e.enhancedByDifferentialSignal&&e.hasOwnProperty("enhancedByDifferentialSignal")&&(i.enhancedByDifferentialSignal=e.enhancedByDifferentialSignal),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.PositioningSystemTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="POSITIONING_SYSTEM_TYPE_UNDEFINED"]=0,t[e[1]="POSITIONING_SYSTEM_TYPE_OTHER"]=1,t[e[2]="POSITIONING_SYSTEM_TYPE_GPS"]=2,t[e[3]="POSITIONING_SYSTEM_TYPE_GLONASS"]=3,t[e[4]="POSITIONING_SYSTEM_TYPE_GALLILEO"]=4,t[e[5]="POSITIONING_SYSTEM_TYPE_IRNSS"]=5,t[e[6]="POSITIONING_SYSTEM_TYPE_BeiDou"]=6,t}(),e.GNSSFixEnum=function(){var e={},t=Object.create(e);return t[e[0]="GNSS_FIX_UNDEFINED"]=0,t[e[1]="GNSS_FIX_NO"]=1,t[e[2]="GNSS_FIX_2D"]=2,t[e[3]="GNSS_FIX_3D"]=3,t}(),e}(),e}(),o.RoadAttributeRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timestampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.roadAttribute=0,e.prototype.roadLaneCount_count=0,e.prototype.roadLaneCountConfidence_percentage=0,e.prototype.roadLaneDetectionCount_count=0,e.prototype.roadAttributeReference=0,e.prototype.referencedValue_m=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.RoadAttributeRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timestampUTC_ms=e.int64();break;case 2:r.roadAttribute=e.int32();break;case 3:r.roadLaneCount_count=e.int32();break;case 4:r.roadLaneCountConfidence_percentage=e.int32();break;case 5:r.roadLaneDetectionCount_count=e.int32();break;case 100:r.roadAttributeReference=e.int32();break;case 101:r.referencedValue_m=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timestampUTC_ms"))throw u.ProtocolError("missing required 'timestampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadAttributeRecognition)return e;var t=new d.sdii.here.pb.RoadAttributeRecognition;switch(null!=e.timestampUTC_ms&&(u.Long?(t.timestampUTC_ms=u.Long.fromValue(e.timestampUTC_ms)).unsigned=!1:"string"==typeof e.timestampUTC_ms?t.timestampUTC_ms=parseInt(e.timestampUTC_ms,10):"number"==typeof e.timestampUTC_ms?t.timestampUTC_ms=e.timestampUTC_ms:"object"==typeof e.timestampUTC_ms&&(t.timestampUTC_ms=new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber())),e.roadAttribute){case"ROAD_ATTRIBUTE_UNDEFINED":case 0:t.roadAttribute=0;break;case"ROAD_ATTRIBUTE_MOTORWAY":case 1:t.roadAttribute=1;break;case"ROAD_ATTRIBUTE_ONE_WAY_TRAFFIC":case 2:t.roadAttribute=2;break;case"ROAD_ATTRIBUTE_TWO_WAY_TRAFFIC":case 3:t.roadAttribute=3;break;case"ROAD_ATTRIBUTE_TUNNEL":case 20:t.roadAttribute=20;break;case"ROAD_ATTRIBUTE_BRIDGE":case 21:t.roadAttribute=21;break;case"ROAD_ATTRIBUTE_ARTIFICIAL_ILLUMINATION":case 22:t.roadAttribute=22;break;case"ROAD_ATTRIBUTE_ROAD_WORKS":case 23:t.roadAttribute=23;break;case"ROAD_ATTRIBUTE_ROAD_WORKS_NARROW_LANES":case 24:t.roadAttribute=24;break;case"ROAD_ATTRIBUTE_LANE_START_RIGHT_SIDE":case 50:t.roadAttribute=50;break;case"ROAD_ATTRIBUTE_LANE_START_LEFT_SIDE":case 51:t.roadAttribute=51;break;case"ROAD_ATTRIBUTE_LANE_END_RIGHT_SIDE":case 52:t.roadAttribute=52;break;case"ROAD_ATTRIBUTE_LANE_END_LEFT_SIDE":case 53:t.roadAttribute=53;break;case"ROAD_ATTRIBUTE_LANE_SPLIT_MIDDLE":case 54:t.roadAttribute=54;break;case"ROAD_ATTRIBUTE_LANE_MERGE_MIDDLE":case 55:t.roadAttribute=55;break;case"ROAD_ATTRIBUTE_CROSS_WALK":case 56:t.roadAttribute=56}switch(null!=e.roadLaneCount_count&&(t.roadLaneCount_count=0|e.roadLaneCount_count),null!=e.roadLaneCountConfidence_percentage&&(t.roadLaneCountConfidence_percentage=0|e.roadLaneCountConfidence_percentage),null!=e.roadLaneDetectionCount_count&&(t.roadLaneDetectionCount_count=0|e.roadLaneDetectionCount_count),e.roadAttributeReference){case"REFERENCE_TYPE_UNDEFINED":case 0:t.roadAttributeReference=0;break;case"SINGLE_RECOGNITION":case 1:t.roadAttributeReference=1;break;case"STARTED_BEFORE":case 2:t.roadAttributeReference=2;break;case"ENDED_BEFORE":case 3:t.roadAttributeReference=3}if(null!=e.referencedValue_m&&(t.referencedValue_m=0|e.referencedValue_m),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadAttributeRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.RoadAttributeRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timestampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timestampUTC_ms=t.longs===String?"0":0;i.roadAttribute=t.enums===String?"ROAD_ATTRIBUTE_UNDEFINED":0,i.roadLaneCount_count=0,i.roadLaneCountConfidence_percentage=0,i.roadLaneDetectionCount_count=0,i.roadAttributeReference=t.enums===String?"REFERENCE_TYPE_UNDEFINED":0,i.referencedValue_m=0}if(null!=e.timestampUTC_ms&&e.hasOwnProperty("timestampUTC_ms")&&("number"==typeof e.timestampUTC_ms?i.timestampUTC_ms=t.longs===String?String(e.timestampUTC_ms):e.timestampUTC_ms:i.timestampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timestampUTC_ms):t.longs===Number?new u.LongBits(e.timestampUTC_ms.low>>>0,e.timestampUTC_ms.high>>>0).toNumber():e.timestampUTC_ms),null!=e.roadAttribute&&e.hasOwnProperty("roadAttribute")&&(i.roadAttribute=t.enums===String?d.sdii.here.pb.RoadAttributeRecognition.RoadAttributeTypeEnum[e.roadAttribute]:e.roadAttribute),null!=e.roadLaneCount_count&&e.hasOwnProperty("roadLaneCount_count")&&(i.roadLaneCount_count=e.roadLaneCount_count),null!=e.roadLaneCountConfidence_percentage&&e.hasOwnProperty("roadLaneCountConfidence_percentage")&&(i.roadLaneCountConfidence_percentage=e.roadLaneCountConfidence_percentage),null!=e.roadLaneDetectionCount_count&&e.hasOwnProperty("roadLaneDetectionCount_count")&&(i.roadLaneDetectionCount_count=e.roadLaneDetectionCount_count),null!=e.roadAttributeReference&&e.hasOwnProperty("roadAttributeReference")&&(i.roadAttributeReference=t.enums===String?d.sdii.here.pb.RoadAttributeRecognition.ReferenceTypeEnum[e.roadAttributeReference]:e.roadAttributeReference),null!=e.referencedValue_m&&e.hasOwnProperty("referencedValue_m")&&(i.referencedValue_m=e.referencedValue_m),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.RoadAttributeTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_ATTRIBUTE_UNDEFINED"]=0,t[e[1]="ROAD_ATTRIBUTE_MOTORWAY"]=1,t[e[2]="ROAD_ATTRIBUTE_ONE_WAY_TRAFFIC"]=2,t[e[3]="ROAD_ATTRIBUTE_TWO_WAY_TRAFFIC"]=3,t[e[20]="ROAD_ATTRIBUTE_TUNNEL"]=20,t[e[21]="ROAD_ATTRIBUTE_BRIDGE"]=21,t[e[22]="ROAD_ATTRIBUTE_ARTIFICIAL_ILLUMINATION"]=22,t[e[23]="ROAD_ATTRIBUTE_ROAD_WORKS"]=23,t[e[24]="ROAD_ATTRIBUTE_ROAD_WORKS_NARROW_LANES"]=24,t[e[50]="ROAD_ATTRIBUTE_LANE_START_RIGHT_SIDE"]=50,t[e[51]="ROAD_ATTRIBUTE_LANE_START_LEFT_SIDE"]=51,t[e[52]="ROAD_ATTRIBUTE_LANE_END_RIGHT_SIDE"]=52,t[e[53]="ROAD_ATTRIBUTE_LANE_END_LEFT_SIDE"]=53,t[e[54]="ROAD_ATTRIBUTE_LANE_SPLIT_MIDDLE"]=54,t[e[55]="ROAD_ATTRIBUTE_LANE_MERGE_MIDDLE"]=55,t[e[56]="ROAD_ATTRIBUTE_CROSS_WALK"]=56,t}(),e.ReferenceTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="REFERENCE_TYPE_UNDEFINED"]=0,t[e[1]="SINGLE_RECOGNITION"]=1,t[e[2]="STARTED_BEFORE"]=2,t[e[3]="ENDED_BEFORE"]=3,t}(),e}(),o.PassengerEnvironment=function(){function e(e){if(this.passengerSeatUsage=[],this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.generalPassengerCount=0,e.prototype.passengerSeatUsage=u.emptyArray,e.prototype.currentMediaSource=0,e.prototype.radioFrequency_MHz=0,e.prototype.navigationSearchDestination="",e.prototype.navigationDestinationLongitude_deg=0,e.prototype.navigationDestinationLatitude_deg=0,e.prototype.navigationOriginLongitude_deg=0,e.prototype.navigationOriginLatitude_deg=0,e.prototype.navigationAndRouting_ETA_ms=0,e.prototype.navigationAndRouting_ETT_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.routingSelectionPathType=0,e.prototype.extensionContainer=u.emptyArray,e.prototype.timeDriving_min=0,e.prototype.mostRecentParkingTime_min=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PassengerEnvironment;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.generalPassengerCount=e.int32();break;case 3:r.passengerSeatUsage&&r.passengerSeatUsage.length||(r.passengerSeatUsage=[]),r.passengerSeatUsage.push(d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.decode(e,e.uint32()));break;case 100:r.currentMediaSource=e.int32();break;case 101:r.radioFrequency_MHz=e.double();break;case 200:r.navigationSearchDestination=e.string();break;case 201:r.navigationDestinationLongitude_deg=e.double();break;case 202:r.navigationDestinationLatitude_deg=e.double();break;case 203:r.navigationOriginLongitude_deg=e.double();break;case 204:r.navigationOriginLatitude_deg=e.double();break;case 205:r.navigationAndRouting_ETA_ms=e.double();break;case 206:r.navigationAndRouting_ETT_ms=e.int64();break;case 207:r.routingSelectionPathType=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;case 300:r.timeDriving_min=e.int32();break;case 301:r.mostRecentParkingTime_min=e.int32();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PassengerEnvironment)return e;var t=new d.sdii.here.pb.PassengerEnvironment;if(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),null!=e.generalPassengerCount&&(t.generalPassengerCount=0|e.generalPassengerCount),e.passengerSeatUsage){if(!Array.isArray(e.passengerSeatUsage))throw TypeError(".sdii.here.pb.PassengerEnvironment.passengerSeatUsage: array expected");t.passengerSeatUsage=[];for(var i=0;i<e.passengerSeatUsage.length;++i){if("object"!=typeof e.passengerSeatUsage[i])throw TypeError(".sdii.here.pb.PassengerEnvironment.passengerSeatUsage: object expected");t.passengerSeatUsage[i]=d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.fromObject(e.passengerSeatUsage[i])}}switch(e.currentMediaSource){case"MEDIA_SOURCE_UNDEFINED":case 0:t.currentMediaSource=0;break;case"MEDIA_SOURCE_OFF":case 1:t.currentMediaSource=1;break;case"MEDIA_SOURCE_RADIO":case 2:t.currentMediaSource=2;break;case"MEDIA_SOURCE_EXTERNAL_SOURCE":case 3:t.currentMediaSource=3}switch(null!=e.radioFrequency_MHz&&(t.radioFrequency_MHz=Number(e.radioFrequency_MHz)),null!=e.navigationSearchDestination&&(t.navigationSearchDestination=String(e.navigationSearchDestination)),null!=e.navigationDestinationLongitude_deg&&(t.navigationDestinationLongitude_deg=Number(e.navigationDestinationLongitude_deg)),null!=e.navigationDestinationLatitude_deg&&(t.navigationDestinationLatitude_deg=Number(e.navigationDestinationLatitude_deg)),null!=e.navigationOriginLongitude_deg&&(t.navigationOriginLongitude_deg=Number(e.navigationOriginLongitude_deg)),null!=e.navigationOriginLatitude_deg&&(t.navigationOriginLatitude_deg=Number(e.navigationOriginLatitude_deg)),null!=e.navigationAndRouting_ETA_ms&&(t.navigationAndRouting_ETA_ms=Number(e.navigationAndRouting_ETA_ms)),null!=e.navigationAndRouting_ETT_ms&&(u.Long?(t.navigationAndRouting_ETT_ms=u.Long.fromValue(e.navigationAndRouting_ETT_ms)).unsigned=!1:"string"==typeof e.navigationAndRouting_ETT_ms?t.navigationAndRouting_ETT_ms=parseInt(e.navigationAndRouting_ETT_ms,10):"number"==typeof e.navigationAndRouting_ETT_ms?t.navigationAndRouting_ETT_ms=e.navigationAndRouting_ETT_ms:"object"==typeof e.navigationAndRouting_ETT_ms&&(t.navigationAndRouting_ETT_ms=new u.LongBits(e.navigationAndRouting_ETT_ms.low>>>0,e.navigationAndRouting_ETT_ms.high>>>0).toNumber())),e.routingSelectionPathType){case"ROUTING_SELECTED_PATH_TYPE_UNDEFINED":case 0:t.routingSelectionPathType=0;break;case"ROUTING_SELECTED_PATH_TYPE_SHORTEST":case 1:t.routingSelectionPathType=1;break;case"ROUTING_SELECTED_PATH_TYPE_FASTEST":case 2:t.routingSelectionPathType=2;break;case"ROUTING_SELECTED_PATH_TYPE_ECONOMIC":case 3:t.routingSelectionPathType=3}if(e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.PassengerEnvironment.extensionContainer: array expected");for(t.extensionContainer=[],i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.PassengerEnvironment.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return null!=e.timeDriving_min&&(t.timeDriving_min=0|e.timeDriving_min),null!=e.mostRecentParkingTime_min&&(t.mostRecentParkingTime_min=0|e.mostRecentParkingTime_min),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.passengerSeatUsage=[],i.extensionContainer=[]),t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.generalPassengerCount=0,i.currentMediaSource=t.enums===String?"MEDIA_SOURCE_UNDEFINED":0,i.radioFrequency_MHz=0,i.navigationSearchDestination="",i.navigationDestinationLongitude_deg=0,i.navigationDestinationLatitude_deg=0,i.navigationOriginLongitude_deg=0,i.navigationOriginLatitude_deg=0,i.navigationAndRouting_ETA_ms=0,u.Long?(r=new u.Long(0,0,!1),i.navigationAndRouting_ETT_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.navigationAndRouting_ETT_ms=t.longs===String?"0":0,i.routingSelectionPathType=t.enums===String?"ROUTING_SELECTED_PATH_TYPE_UNDEFINED":0,i.timeDriving_min=0,i.mostRecentParkingTime_min=0}if(null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.generalPassengerCount&&e.hasOwnProperty("generalPassengerCount")&&(i.generalPassengerCount=e.generalPassengerCount),e.passengerSeatUsage&&e.passengerSeatUsage.length){i.passengerSeatUsage=[];for(var n=0;n<e.passengerSeatUsage.length;++n)i.passengerSeatUsage[n]=d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.toObject(e.passengerSeatUsage[n],t)}if(null!=e.currentMediaSource&&e.hasOwnProperty("currentMediaSource")&&(i.currentMediaSource=t.enums===String?d.sdii.here.pb.PassengerEnvironment.MediaSourceEnum[e.currentMediaSource]:e.currentMediaSource),null!=e.radioFrequency_MHz&&e.hasOwnProperty("radioFrequency_MHz")&&(i.radioFrequency_MHz=t.json&&!isFinite(e.radioFrequency_MHz)?String(e.radioFrequency_MHz):e.radioFrequency_MHz),null!=e.navigationSearchDestination&&e.hasOwnProperty("navigationSearchDestination")&&(i.navigationSearchDestination=e.navigationSearchDestination),null!=e.navigationDestinationLongitude_deg&&e.hasOwnProperty("navigationDestinationLongitude_deg")&&(i.navigationDestinationLongitude_deg=t.json&&!isFinite(e.navigationDestinationLongitude_deg)?String(e.navigationDestinationLongitude_deg):e.navigationDestinationLongitude_deg),null!=e.navigationDestinationLatitude_deg&&e.hasOwnProperty("navigationDestinationLatitude_deg")&&(i.navigationDestinationLatitude_deg=t.json&&!isFinite(e.navigationDestinationLatitude_deg)?String(e.navigationDestinationLatitude_deg):e.navigationDestinationLatitude_deg),null!=e.navigationOriginLongitude_deg&&e.hasOwnProperty("navigationOriginLongitude_deg")&&(i.navigationOriginLongitude_deg=t.json&&!isFinite(e.navigationOriginLongitude_deg)?String(e.navigationOriginLongitude_deg):e.navigationOriginLongitude_deg),null!=e.navigationOriginLatitude_deg&&e.hasOwnProperty("navigationOriginLatitude_deg")&&(i.navigationOriginLatitude_deg=t.json&&!isFinite(e.navigationOriginLatitude_deg)?String(e.navigationOriginLatitude_deg):e.navigationOriginLatitude_deg),null!=e.navigationAndRouting_ETA_ms&&e.hasOwnProperty("navigationAndRouting_ETA_ms")&&(i.navigationAndRouting_ETA_ms=t.json&&!isFinite(e.navigationAndRouting_ETA_ms)?String(e.navigationAndRouting_ETA_ms):e.navigationAndRouting_ETA_ms),null!=e.navigationAndRouting_ETT_ms&&e.hasOwnProperty("navigationAndRouting_ETT_ms")&&("number"==typeof e.navigationAndRouting_ETT_ms?i.navigationAndRouting_ETT_ms=t.longs===String?String(e.navigationAndRouting_ETT_ms):e.navigationAndRouting_ETT_ms:i.navigationAndRouting_ETT_ms=t.longs===String?u.Long.prototype.toString.call(e.navigationAndRouting_ETT_ms):t.longs===Number?new u.LongBits(e.navigationAndRouting_ETT_ms.low>>>0,e.navigationAndRouting_ETT_ms.high>>>0).toNumber():e.navigationAndRouting_ETT_ms),null!=e.routingSelectionPathType&&e.hasOwnProperty("routingSelectionPathType")&&(i.routingSelectionPathType=t.enums===String?d.sdii.here.pb.PassengerEnvironment.RoutingSelectionPathTypeEnum[e.routingSelectionPathType]:e.routingSelectionPathType),e.extensionContainer&&e.extensionContainer.length)for(i.extensionContainer=[],n=0;n<e.extensionContainer.length;++n)i.extensionContainer[n]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[n],t);return null!=e.timeDriving_min&&e.hasOwnProperty("timeDriving_min")&&(i.timeDriving_min=e.timeDriving_min),null!=e.mostRecentParkingTime_min&&e.hasOwnProperty("mostRecentParkingTime_min")&&(i.mostRecentParkingTime_min=e.mostRecentParkingTime_min),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.PassengerSeatUsage=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.simpleSeatRow=0,e.prototype.simpleSeatColumn=0,e.prototype.seatRowNumber=0,e.prototype.seatColumnNumber=0,e.prototype.seatUsage=0,e.prototype.seatOccupancyType=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.simpleSeatRow=e.int32();break;case 2:r.simpleSeatColumn=e.int32();break;case 3:r.seatRowNumber=e.int32();break;case 4:r.seatColumnNumber=e.int32();break;case 5:r.seatUsage=e.int32();break;case 6:r.seatOccupancyType=e.int32();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage)return e;var t=new d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage;switch(e.simpleSeatRow){case"PASSENGER_SEAT_ROW_UNDEFINED":case 0:t.simpleSeatRow=0;break;case"PASSENGER_SEAT_ROW_FRONT":case 1:t.simpleSeatRow=1;break;case"PASSENGER_SEAT_ROW_MIDDLE":case 2:t.simpleSeatRow=2;break;case"PASSENGER_SEAT_ROW_REAR":case 3:t.simpleSeatRow=3}switch(e.simpleSeatColumn){case"PASSENGER_SEAT_COLUMN_UNDEFINED":case 0:t.simpleSeatColumn=0;break;case"PASSENGER_SEAT_COLUMN_LEFT":case 1:t.simpleSeatColumn=1;break;case"PASSENGER_SEAT_COLUMN_MIDDLE":case 2:t.simpleSeatColumn=2;break;case"PASSENGER_SEAT_COLUMN_RIGHT":case 3:t.simpleSeatColumn=3}switch(null!=e.seatRowNumber&&(t.seatRowNumber=0|e.seatRowNumber),null!=e.seatColumnNumber&&(t.seatColumnNumber=0|e.seatColumnNumber),e.seatUsage){case"PASSENGER_SEAT_USAGE_UNDEFINED":case 0:t.seatUsage=0;break;case"PASSENGER_SEAT_USAGE_FREE":case 1:t.seatUsage=1;break;case"PASSENGER_SEAT_USAGE_OCCUPIED":case 2:t.seatUsage=2}switch(e.seatOccupancyType){case"PASSENGER_OCCUPANCY_TYPE_UNDEFINED":case 0:t.seatOccupancyType=0;break;case"PASSENGER_OCCUPANCY_LIGHT_WEIGHT":case 1:t.seatOccupancyType=1;break;case"PASSENGER_OCCUPANCY_HEAVY_WEIGHT":case 2:t.seatOccupancyType=2;break;case"PASSENGER_OCCUPANCY_CHILD_SAEFTY_SEAT":case 3:t.seatOccupancyType=3;break;case"PASSENGER_OCCUPANCY_BABY_CARRIER":case 4:t.seatOccupancyType=4}return t},e.toObject=function(e,t){t||(t={});var i={};return t.defaults&&(i.simpleSeatRow=t.enums===String?"PASSENGER_SEAT_ROW_UNDEFINED":0,i.simpleSeatColumn=t.enums===String?"PASSENGER_SEAT_COLUMN_UNDEFINED":0,i.seatRowNumber=0,i.seatColumnNumber=0,i.seatUsage=t.enums===String?"PASSENGER_SEAT_USAGE_UNDEFINED":0,i.seatOccupancyType=t.enums===String?"PASSENGER_OCCUPANCY_TYPE_UNDEFINED":0),null!=e.simpleSeatRow&&e.hasOwnProperty("simpleSeatRow")&&(i.simpleSeatRow=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatRowSimpleEnum[e.simpleSeatRow]:e.simpleSeatRow),null!=e.simpleSeatColumn&&e.hasOwnProperty("simpleSeatColumn")&&(i.simpleSeatColumn=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatColumnSimpleEnum[e.simpleSeatColumn]:e.simpleSeatColumn),null!=e.seatRowNumber&&e.hasOwnProperty("seatRowNumber")&&(i.seatRowNumber=e.seatRowNumber),null!=e.seatColumnNumber&&e.hasOwnProperty("seatColumnNumber")&&(i.seatColumnNumber=e.seatColumnNumber),null!=e.seatUsage&&e.hasOwnProperty("seatUsage")&&(i.seatUsage=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerSeatUsageEnum[e.seatUsage]:e.seatUsage),null!=e.seatOccupancyType&&e.hasOwnProperty("seatOccupancyType")&&(i.seatOccupancyType=t.enums===String?d.sdii.here.pb.PassengerEnvironment.PassengerSeatUsage.PassengerOccupancyTypeEnum[e.seatOccupancyType]:e.seatOccupancyType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.PassengerSeatRowSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_ROW_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_ROW_FRONT"]=1,t[e[2]="PASSENGER_SEAT_ROW_MIDDLE"]=2,t[e[3]="PASSENGER_SEAT_ROW_REAR"]=3,t}(),e.PassengerSeatColumnSimpleEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_COLUMN_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_COLUMN_LEFT"]=1,t[e[2]="PASSENGER_SEAT_COLUMN_MIDDLE"]=2,t[e[3]="PASSENGER_SEAT_COLUMN_RIGHT"]=3,t}(),e.PassengerSeatUsageEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_SEAT_USAGE_UNDEFINED"]=0,t[e[1]="PASSENGER_SEAT_USAGE_FREE"]=1,t[e[2]="PASSENGER_SEAT_USAGE_OCCUPIED"]=2,t}(),e.PassengerOccupancyTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="PASSENGER_OCCUPANCY_TYPE_UNDEFINED"]=0,t[e[1]="PASSENGER_OCCUPANCY_LIGHT_WEIGHT"]=1,t[e[2]="PASSENGER_OCCUPANCY_HEAVY_WEIGHT"]=2,t[e[3]="PASSENGER_OCCUPANCY_CHILD_SAEFTY_SEAT"]=3,t[e[4]="PASSENGER_OCCUPANCY_BABY_CARRIER"]=4,t}(),e}(),e.MediaSourceEnum=function(){var e={},t=Object.create(e);return t[e[0]="MEDIA_SOURCE_UNDEFINED"]=0,t[e[1]="MEDIA_SOURCE_OFF"]=1,t[e[2]="MEDIA_SOURCE_RADIO"]=2,t[e[3]="MEDIA_SOURCE_EXTERNAL_SOURCE"]=3,t}(),e.RoutingSelectionPathTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROUTING_SELECTED_PATH_TYPE_UNDEFINED"]=0,t[e[1]="ROUTING_SELECTED_PATH_TYPE_SHORTEST"]=1,t[e[2]="ROUTING_SELECTED_PATH_TYPE_FASTEST"]=2,t[e[3]="ROUTING_SELECTED_PATH_TYPE_ECONOMIC"]=3,t}(),e}(),o.RoadMarkingRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=0,e.prototype.roadMarkingType=0,e.prototype.positionOffset=null,e.prototype.laneMarkingSize=null,e.prototype.laneReferenceID=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.RoadMarkingRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.double();break;case 2:r.roadMarkingType=e.int32();break;case 3:r.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 4:r.laneMarkingSize=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 5:r.laneReferenceID=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.RoadMarkingRecognition)return e;var t=new d.sdii.here.pb.RoadMarkingRecognition;switch(null!=e.timeStampUTC_ms&&(t.timeStampUTC_ms=Number(e.timeStampUTC_ms)),e.roadMarkingType){case"ROAD_MARKING_TYPE_UNDEFINED":case 0:t.roadMarkingType=0;break;case"ROAD_MARKING_TYPE_ARROW_LEFT":case 1:t.roadMarkingType=1;break;case"ROAD_RKING_TYPE_ARROW_STRAIGHT_LEFT":case 2:t.roadMarkingType=2;break;case"ROAD_MARKING_TYPE_ARROW_STRAIGHT":case 3:t.roadMarkingType=3;break;case"ROAD_MARKING_TYPE_ARROW_STRAIGHT_RIGHT":case 4:t.roadMarkingType=4;break;case"ROAD_MARKING_TYPE_ARROW_RIGHT":case 5:t.roadMarkingType=5;break;case"ROAD_MARKING_TYPE_ARROW_UNDEFINED":case 6:t.roadMarkingType=6}if(null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.RoadMarkingRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}if(null!=e.laneMarkingSize){if("object"!=typeof e.laneMarkingSize)throw TypeError(".sdii.here.pb.RoadMarkingRecognition.laneMarkingSize: object expected");t.laneMarkingSize=d.sdii.here.pb.Vector3D.fromObject(e.laneMarkingSize)}if(null!=e.laneReferenceID&&(t.laneReferenceID=0|e.laneReferenceID),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.RoadMarkingRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.RoadMarkingRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults&&(i.timeStampUTC_ms=0,i.roadMarkingType=t.enums===String?"ROAD_MARKING_TYPE_UNDEFINED":0,i.positionOffset=null,i.laneMarkingSize=null,i.laneReferenceID=0),null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&(i.timeStampUTC_ms=t.json&&!isFinite(e.timeStampUTC_ms)?String(e.timeStampUTC_ms):e.timeStampUTC_ms),null!=e.roadMarkingType&&e.hasOwnProperty("roadMarkingType")&&(i.roadMarkingType=t.enums===String?d.sdii.here.pb.RoadMarkingRecognition.RoadMarkingTypeEnum[e.roadMarkingType]:e.roadMarkingType),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(i.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.laneMarkingSize&&e.hasOwnProperty("laneMarkingSize")&&(i.laneMarkingSize=d.sdii.here.pb.Vector3D.toObject(e.laneMarkingSize,t)),null!=e.laneReferenceID&&e.hasOwnProperty("laneReferenceID")&&(i.laneReferenceID=e.laneReferenceID),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r)i.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.RoadMarkingTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="ROAD_MARKING_TYPE_UNDEFINED"]=0,t[e[1]="ROAD_MARKING_TYPE_ARROW_LEFT"]=1,t[e[2]="ROAD_RKING_TYPE_ARROW_STRAIGHT_LEFT"]=2,t[e[3]="ROAD_MARKING_TYPE_ARROW_STRAIGHT"]=3,t[e[4]="ROAD_MARKING_TYPE_ARROW_STRAIGHT_RIGHT"]=4,t[e[5]="ROAD_MARKING_TYPE_ARROW_RIGHT"]=5,t[e[6]="ROAD_MARKING_TYPE_ARROW_UNDEFINED"]=6,t}(),e}(),o.TrafficSignalHeadRecognition=function(){function e(e){if(this.extensionContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=0,e.prototype.positionOffset=null,e.prototype.trafficSignalDesignType=0,e.prototype.trafficSignalHeadOrientationType=0,e.prototype.trafficSignalLightColorBitfield=0,e.prototype.laneReferenceID=0,e.prototype.objectReferenceID=0,e.prototype.extensionContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.TrafficSignalHeadRecognition;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.double();break;case 2:r.positionOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 3:r.trafficSignalDesignType=e.int32();break;case 4:r.trafficSignalHeadOrientationType=e.int32();break;case 5:r.trafficSignalLightColorBitfield=e.int32();break;case 6:r.laneReferenceID=e.int32();break;case 7:r.objectReferenceID=e.int32();break;case 250:r.extensionContainer&&r.extensionContainer.length||(r.extensionContainer=[]),r.extensionContainer.push(d.sdii.here.pb.ExtensionContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.TrafficSignalHeadRecognition)return e;var t=new d.sdii.here.pb.TrafficSignalHeadRecognition;if(null!=e.timeStampUTC_ms&&(t.timeStampUTC_ms=Number(e.timeStampUTC_ms)),null!=e.positionOffset){if("object"!=typeof e.positionOffset)throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.positionOffset: object expected");t.positionOffset=d.sdii.here.pb.PositionOffset.fromObject(e.positionOffset)}switch(e.trafficSignalDesignType){case"TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED":case 0:t.trafficSignalDesignType=0;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_UNKNOWN":case 1:t.trafficSignalDesignType=1;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOWGREEN":case 2:t.trafficSignalDesignType=2;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOW":case 3:t.trafficSignalDesignType=3;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_3LIGHTS":case 4:t.trafficSignalDesignType=4;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_2LIGHTS":case 5:t.trafficSignalDesignType=5;break;case"TRAFFIC_SIGNAL_HEAD_TYPE_2YELLOWLIGHTS":case 6:t.trafficSignalDesignType=6}switch(e.trafficSignalHeadOrientationType){case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED":case 0:t.trafficSignalHeadOrientationType=0;break;case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_VERTICAL":case 1:t.trafficSignalHeadOrientationType=1;break;case"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_HORIZONTAL":case 2:t.trafficSignalHeadOrientationType=2}if(null!=e.trafficSignalLightColorBitfield&&(t.trafficSignalLightColorBitfield=0|e.trafficSignalLightColorBitfield),null!=e.laneReferenceID&&(t.laneReferenceID=0|e.laneReferenceID),null!=e.objectReferenceID&&(t.objectReferenceID=0|e.objectReferenceID),e.extensionContainer){if(!Array.isArray(e.extensionContainer))throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.extensionContainer: array expected");t.extensionContainer=[];for(var i=0;i<e.extensionContainer.length;++i){if("object"!=typeof e.extensionContainer[i])throw TypeError(".sdii.here.pb.TrafficSignalHeadRecognition.extensionContainer: object expected");t.extensionContainer[i]=d.sdii.here.pb.ExtensionContainer.fromObject(e.extensionContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.extensionContainer=[]),t.defaults&&(i.timeStampUTC_ms=0,i.positionOffset=null,i.trafficSignalDesignType=t.enums===String?"TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED":0,i.trafficSignalHeadOrientationType=t.enums===String?"TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED":0,i.trafficSignalLightColorBitfield=0,i.laneReferenceID=0,i.objectReferenceID=0),null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&(i.timeStampUTC_ms=t.json&&!isFinite(e.timeStampUTC_ms)?String(e.timeStampUTC_ms):e.timeStampUTC_ms),null!=e.positionOffset&&e.hasOwnProperty("positionOffset")&&(i.positionOffset=d.sdii.here.pb.PositionOffset.toObject(e.positionOffset,t)),null!=e.trafficSignalDesignType&&e.hasOwnProperty("trafficSignalDesignType")&&(i.trafficSignalDesignType=t.enums===String?d.sdii.here.pb.TrafficSignalHeadRecognition.TrafficSignalHeadDesignTypeEnum[e.trafficSignalDesignType]:e.trafficSignalDesignType),null!=e.trafficSignalHeadOrientationType&&e.hasOwnProperty("trafficSignalHeadOrientationType")&&(i.trafficSignalHeadOrientationType=t.enums===String?d.sdii.here.pb.TrafficSignalHeadRecognition.TrafficSignalHeadOrientationTypeEnum[e.trafficSignalHeadOrientationType]:e.trafficSignalHeadOrientationType),null!=e.trafficSignalLightColorBitfield&&e.hasOwnProperty("trafficSignalLightColorBitfield")&&(i.trafficSignalLightColorBitfield=e.trafficSignalLightColorBitfield),null!=e.laneReferenceID&&e.hasOwnProperty("laneReferenceID")&&(i.laneReferenceID=e.laneReferenceID),null!=e.objectReferenceID&&e.hasOwnProperty("objectReferenceID")&&(i.objectReferenceID=e.objectReferenceID),e.extensionContainer&&e.extensionContainer.length){i.extensionContainer=[];for(var r=0;r<e.extensionContainer.length;++r)i.extensionContainer[r]=d.sdii.here.pb.ExtensionContainer.toObject(e.extensionContainer[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.TrafficSignalHeadDesignTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRAFFIC_SIGNAL_HEAD_TYPE_UNDEFINED"]=0,t[e[1]="TRAFFIC_SIGNAL_HEAD_TYPE_UNKNOWN"]=1,t[e[2]="TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOWGREEN"]=2,t[e[3]="TRAFFIC_SIGNAL_HEAD_TYPE_REDYELLOW"]=3,t[e[4]="TRAFFIC_SIGNAL_HEAD_TYPE_3LIGHTS"]=4,t[e[5]="TRAFFIC_SIGNAL_HEAD_TYPE_2LIGHTS"]=5,t[e[6]="TRAFFIC_SIGNAL_HEAD_TYPE_2YELLOWLIGHTS"]=6,t}(),e.TrafficSignalHeadOrientationTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_UNDEFINED"]=0,t[e[1]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_VERTICAL"]=1,t[e[2]="TRAFFIC_SIGNAL_HEAD_ORIENTATION_TYPE_HORIZONTAL"]=2,t}(),e}(),o.PathEvents=function(){function e(e){if(this.vehicleStatus=[],this.vehicleDynamics=[],this.signRecognition=[],this.laneBoundaryRecognition=[],this.exceptionalVehicleState=[],this.proprietaryInfo=[],this.environmentStatus=[],this.objectDetection=[],this.adServiceAndSensorState=[],this.specificObservedEvent=[],this.roadCondition=[],this.roadBoundaryRecognition=[],this.vehicleManeuver=[],this.localizationInformation=[],this.roadAttributerecognition=[],this.passengerEnvironment=[],this.roadMarkingRecognition=[],this.trafficSignalHeadDetection=[],this.proprietaryDataContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.vehicleStatus=u.emptyArray,e.prototype.vehicleDynamics=u.emptyArray,e.prototype.signRecognition=u.emptyArray,e.prototype.laneBoundaryRecognition=u.emptyArray,e.prototype.exceptionalVehicleState=u.emptyArray,e.prototype.proprietaryInfo=u.emptyArray,e.prototype.environmentStatus=u.emptyArray,e.prototype.objectDetection=u.emptyArray,e.prototype.adServiceAndSensorState=u.emptyArray,e.prototype.specificObservedEvent=u.emptyArray,e.prototype.roadCondition=u.emptyArray,e.prototype.roadBoundaryRecognition=u.emptyArray,e.prototype.vehicleManeuver=u.emptyArray,e.prototype.localizationInformation=u.emptyArray,e.prototype.roadAttributerecognition=u.emptyArray,e.prototype.passengerEnvironment=u.emptyArray,e.prototype.roadMarkingRecognition=u.emptyArray,e.prototype.trafficSignalHeadDetection=u.emptyArray,e.prototype.proprietaryDataContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PathEvents;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.vehicleStatus&&r.vehicleStatus.length||(r.vehicleStatus=[]),r.vehicleStatus.push(d.sdii.here.pb.VehicleStatus.decode(e,e.uint32()));break;case 2:r.vehicleDynamics&&r.vehicleDynamics.length||(r.vehicleDynamics=[]),r.vehicleDynamics.push(d.sdii.here.pb.VehicleDynamics.decode(e,e.uint32()));break;case 3:r.signRecognition&&r.signRecognition.length||(r.signRecognition=[]),r.signRecognition.push(d.sdii.here.pb.SignRecognition.decode(e,e.uint32()));break;case 4:r.laneBoundaryRecognition&&r.laneBoundaryRecognition.length||(r.laneBoundaryRecognition=[]),r.laneBoundaryRecognition.push(d.sdii.here.pb.LaneBoundaryRecognition.decode(e,e.uint32()));break;case 5:r.exceptionalVehicleState&&r.exceptionalVehicleState.length||(r.exceptionalVehicleState=[]),r.exceptionalVehicleState.push(d.sdii.here.pb.ExceptionalVehicleState.decode(e,e.uint32()));break;case 6:r.proprietaryInfo&&r.proprietaryInfo.length||(r.proprietaryInfo=[]),r.proprietaryInfo.push(d.sdii.here.pb.ProprietaryInfo.decode(e,e.uint32()));break;case 7:r.environmentStatus&&r.environmentStatus.length||(r.environmentStatus=[]),r.environmentStatus.push(d.sdii.here.pb.EnvironmentStatus.decode(e,e.uint32()));break;case 8:r.objectDetection&&r.objectDetection.length||(r.objectDetection=[]),r.objectDetection.push(d.sdii.here.pb.ObjectDetection.decode(e,e.uint32()));break;case 9:r.adServiceAndSensorState&&r.adServiceAndSensorState.length||(r.adServiceAndSensorState=[]),r.adServiceAndSensorState.push(d.sdii.here.pb.ADServiceAndSensorState.decode(e,e.uint32()));break;case 10:r.specificObservedEvent&&r.specificObservedEvent.length||(r.specificObservedEvent=[]),r.specificObservedEvent.push(d.sdii.here.pb.SpecificObservedEvent.decode(e,e.uint32()));break;case 11:r.roadCondition&&r.roadCondition.length||(r.roadCondition=[]),r.roadCondition.push(d.sdii.here.pb.RoadCondition.decode(e,e.uint32()));break;case 12:r.roadBoundaryRecognition&&r.roadBoundaryRecognition.length||(r.roadBoundaryRecognition=[]),r.roadBoundaryRecognition.push(d.sdii.here.pb.RoadBoundaryRecognition.decode(e,e.uint32()));break;case 13:r.vehicleManeuver&&r.vehicleManeuver.length||(r.vehicleManeuver=[]),r.vehicleManeuver.push(d.sdii.here.pb.VehicleManeuverEvent.decode(e,e.uint32()));break;case 14:r.localizationInformation&&r.localizationInformation.length||(r.localizationInformation=[]),r.localizationInformation.push(d.sdii.here.pb.LocalizationInformation.decode(e,e.uint32()));break;case 15:r.roadAttributerecognition&&r.roadAttributerecognition.length||(r.roadAttributerecognition=[]),r.roadAttributerecognition.push(d.sdii.here.pb.RoadAttributeRecognition.decode(e,e.uint32()));break;case 16:r.passengerEnvironment&&r.passengerEnvironment.length||(r.passengerEnvironment=[]),r.passengerEnvironment.push(d.sdii.here.pb.PassengerEnvironment.decode(e,e.uint32()));break;case 17:r.roadMarkingRecognition&&r.roadMarkingRecognition.length||(r.roadMarkingRecognition=[]),r.roadMarkingRecognition.push(d.sdii.here.pb.RoadMarkingRecognition.decode(e,e.uint32()));break;case 18:r.trafficSignalHeadDetection&&r.trafficSignalHeadDetection.length||(r.trafficSignalHeadDetection=[]),r.trafficSignalHeadDetection.push(d.sdii.here.pb.TrafficSignalHeadRecognition.decode(e,e.uint32()));break;case 250:r.proprietaryDataContainer&&r.proprietaryDataContainer.length||(r.proprietaryDataContainer=[]),r.proprietaryDataContainer.push(d.sdii.here.pb.ProprietaryDataContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathEvents)return e;var t=new d.sdii.here.pb.PathEvents;if(e.vehicleStatus){if(!Array.isArray(e.vehicleStatus))throw TypeError(".sdii.here.pb.PathEvents.vehicleStatus: array expected");t.vehicleStatus=[];for(var i=0;i<e.vehicleStatus.length;++i){if("object"!=typeof e.vehicleStatus[i])throw TypeError(".sdii.here.pb.PathEvents.vehicleStatus: object expected");t.vehicleStatus[i]=d.sdii.here.pb.VehicleStatus.fromObject(e.vehicleStatus[i])}}if(e.vehicleDynamics){if(!Array.isArray(e.vehicleDynamics))throw TypeError(".sdii.here.pb.PathEvents.vehicleDynamics: array expected");for(t.vehicleDynamics=[],i=0;i<e.vehicleDynamics.length;++i){if("object"!=typeof e.vehicleDynamics[i])throw TypeError(".sdii.here.pb.PathEvents.vehicleDynamics: object expected");t.vehicleDynamics[i]=d.sdii.here.pb.VehicleDynamics.fromObject(e.vehicleDynamics[i])}}if(e.signRecognition){if(!Array.isArray(e.signRecognition))throw TypeError(".sdii.here.pb.PathEvents.signRecognition: array expected");for(t.signRecognition=[],i=0;i<e.signRecognition.length;++i){if("object"!=typeof e.signRecognition[i])throw TypeError(".sdii.here.pb.PathEvents.signRecognition: object expected");t.signRecognition[i]=d.sdii.here.pb.SignRecognition.fromObject(e.signRecognition[i])}}if(e.laneBoundaryRecognition){if(!Array.isArray(e.laneBoundaryRecognition))throw TypeError(".sdii.here.pb.PathEvents.laneBoundaryRecognition: array expected");for(t.laneBoundaryRecognition=[],i=0;i<e.laneBoundaryRecognition.length;++i){if("object"!=typeof e.laneBoundaryRecognition[i])throw TypeError(".sdii.here.pb.PathEvents.laneBoundaryRecognition: object expected");t.laneBoundaryRecognition[i]=d.sdii.here.pb.LaneBoundaryRecognition.fromObject(e.laneBoundaryRecognition[i])}}if(e.exceptionalVehicleState){if(!Array.isArray(e.exceptionalVehicleState))throw TypeError(".sdii.here.pb.PathEvents.exceptionalVehicleState: array expected");for(t.exceptionalVehicleState=[],i=0;i<e.exceptionalVehicleState.length;++i){if("object"!=typeof e.exceptionalVehicleState[i])throw TypeError(".sdii.here.pb.PathEvents.exceptionalVehicleState: object expected");t.exceptionalVehicleState[i]=d.sdii.here.pb.ExceptionalVehicleState.fromObject(e.exceptionalVehicleState[i])}}if(e.proprietaryInfo){if(!Array.isArray(e.proprietaryInfo))throw TypeError(".sdii.here.pb.PathEvents.proprietaryInfo: array expected");for(t.proprietaryInfo=[],i=0;i<e.proprietaryInfo.length;++i){if("object"!=typeof e.proprietaryInfo[i])throw TypeError(".sdii.here.pb.PathEvents.proprietaryInfo: object expected");t.proprietaryInfo[i]=d.sdii.here.pb.ProprietaryInfo.fromObject(e.proprietaryInfo[i])}}if(e.environmentStatus){if(!Array.isArray(e.environmentStatus))throw TypeError(".sdii.here.pb.PathEvents.environmentStatus: array expected");for(t.environmentStatus=[],i=0;i<e.environmentStatus.length;++i){if("object"!=typeof e.environmentStatus[i])throw TypeError(".sdii.here.pb.PathEvents.environmentStatus: object expected");t.environmentStatus[i]=d.sdii.here.pb.EnvironmentStatus.fromObject(e.environmentStatus[i])}}if(e.objectDetection){if(!Array.isArray(e.objectDetection))throw TypeError(".sdii.here.pb.PathEvents.objectDetection: array expected");for(t.objectDetection=[],i=0;i<e.objectDetection.length;++i){if("object"!=typeof e.objectDetection[i])throw TypeError(".sdii.here.pb.PathEvents.objectDetection: object expected");t.objectDetection[i]=d.sdii.here.pb.ObjectDetection.fromObject(e.objectDetection[i])}}if(e.adServiceAndSensorState){if(!Array.isArray(e.adServiceAndSensorState))throw TypeError(".sdii.here.pb.PathEvents.adServiceAndSensorState: array expected");for(t.adServiceAndSensorState=[],i=0;i<e.adServiceAndSensorState.length;++i){if("object"!=typeof e.adServiceAndSensorState[i])throw TypeError(".sdii.here.pb.PathEvents.adServiceAndSensorState: object expected");t.adServiceAndSensorState[i]=d.sdii.here.pb.ADServiceAndSensorState.fromObject(e.adServiceAndSensorState[i])}}if(e.specificObservedEvent){if(!Array.isArray(e.specificObservedEvent))throw TypeError(".sdii.here.pb.PathEvents.specificObservedEvent: array expected");for(t.specificObservedEvent=[],i=0;i<e.specificObservedEvent.length;++i){if("object"!=typeof e.specificObservedEvent[i])throw TypeError(".sdii.here.pb.PathEvents.specificObservedEvent: object expected");t.specificObservedEvent[i]=d.sdii.here.pb.SpecificObservedEvent.fromObject(e.specificObservedEvent[i])}}if(e.roadCondition){if(!Array.isArray(e.roadCondition))throw TypeError(".sdii.here.pb.PathEvents.roadCondition: array expected");for(t.roadCondition=[],i=0;i<e.roadCondition.length;++i){if("object"!=typeof e.roadCondition[i])throw TypeError(".sdii.here.pb.PathEvents.roadCondition: object expected");t.roadCondition[i]=d.sdii.here.pb.RoadCondition.fromObject(e.roadCondition[i])}}if(e.roadBoundaryRecognition){if(!Array.isArray(e.roadBoundaryRecognition))throw TypeError(".sdii.here.pb.PathEvents.roadBoundaryRecognition: array expected");for(t.roadBoundaryRecognition=[],i=0;i<e.roadBoundaryRecognition.length;++i){if("object"!=typeof e.roadBoundaryRecognition[i])throw TypeError(".sdii.here.pb.PathEvents.roadBoundaryRecognition: object expected");t.roadBoundaryRecognition[i]=d.sdii.here.pb.RoadBoundaryRecognition.fromObject(e.roadBoundaryRecognition[i])}}if(e.vehicleManeuver){if(!Array.isArray(e.vehicleManeuver))throw TypeError(".sdii.here.pb.PathEvents.vehicleManeuver: array expected");for(t.vehicleManeuver=[],i=0;i<e.vehicleManeuver.length;++i){if("object"!=typeof e.vehicleManeuver[i])throw TypeError(".sdii.here.pb.PathEvents.vehicleManeuver: object expected");t.vehicleManeuver[i]=d.sdii.here.pb.VehicleManeuverEvent.fromObject(e.vehicleManeuver[i])}}if(e.localizationInformation){if(!Array.isArray(e.localizationInformation))throw TypeError(".sdii.here.pb.PathEvents.localizationInformation: array expected");for(t.localizationInformation=[],i=0;i<e.localizationInformation.length;++i){if("object"!=typeof e.localizationInformation[i])throw TypeError(".sdii.here.pb.PathEvents.localizationInformation: object expected");t.localizationInformation[i]=d.sdii.here.pb.LocalizationInformation.fromObject(e.localizationInformation[i])}}if(e.roadAttributerecognition){if(!Array.isArray(e.roadAttributerecognition))throw TypeError(".sdii.here.pb.PathEvents.roadAttributerecognition: array expected");for(t.roadAttributerecognition=[],i=0;i<e.roadAttributerecognition.length;++i){if("object"!=typeof e.roadAttributerecognition[i])throw TypeError(".sdii.here.pb.PathEvents.roadAttributerecognition: object expected");t.roadAttributerecognition[i]=d.sdii.here.pb.RoadAttributeRecognition.fromObject(e.roadAttributerecognition[i])}}if(e.passengerEnvironment){if(!Array.isArray(e.passengerEnvironment))throw TypeError(".sdii.here.pb.PathEvents.passengerEnvironment: array expected");for(t.passengerEnvironment=[],i=0;i<e.passengerEnvironment.length;++i){if("object"!=typeof e.passengerEnvironment[i])throw TypeError(".sdii.here.pb.PathEvents.passengerEnvironment: object expected");t.passengerEnvironment[i]=d.sdii.here.pb.PassengerEnvironment.fromObject(e.passengerEnvironment[i])}}if(e.roadMarkingRecognition){if(!Array.isArray(e.roadMarkingRecognition))throw TypeError(".sdii.here.pb.PathEvents.roadMarkingRecognition: array expected");for(t.roadMarkingRecognition=[],i=0;i<e.roadMarkingRecognition.length;++i){if("object"!=typeof e.roadMarkingRecognition[i])throw TypeError(".sdii.here.pb.PathEvents.roadMarkingRecognition: object expected");t.roadMarkingRecognition[i]=d.sdii.here.pb.RoadMarkingRecognition.fromObject(e.roadMarkingRecognition[i])}}if(e.trafficSignalHeadDetection){if(!Array.isArray(e.trafficSignalHeadDetection))throw TypeError(".sdii.here.pb.PathEvents.trafficSignalHeadDetection: array expected");for(t.trafficSignalHeadDetection=[],i=0;i<e.trafficSignalHeadDetection.length;++i){if("object"!=typeof e.trafficSignalHeadDetection[i])throw TypeError(".sdii.here.pb.PathEvents.trafficSignalHeadDetection: object expected");t.trafficSignalHeadDetection[i]=d.sdii.here.pb.TrafficSignalHeadRecognition.fromObject(e.trafficSignalHeadDetection[i])}}if(e.proprietaryDataContainer){if(!Array.isArray(e.proprietaryDataContainer))throw TypeError(".sdii.here.pb.PathEvents.proprietaryDataContainer: array expected");for(t.proprietaryDataContainer=[],i=0;i<e.proprietaryDataContainer.length;++i){if("object"!=typeof e.proprietaryDataContainer[i])throw TypeError(".sdii.here.pb.PathEvents.proprietaryDataContainer: object expected");t.proprietaryDataContainer[i]=d.sdii.here.pb.ProprietaryDataContainer.fromObject(e.proprietaryDataContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.vehicleStatus=[],i.vehicleDynamics=[],i.signRecognition=[],i.laneBoundaryRecognition=[],i.exceptionalVehicleState=[],i.proprietaryInfo=[],i.environmentStatus=[],i.objectDetection=[],i.adServiceAndSensorState=[],i.specificObservedEvent=[],i.roadCondition=[],i.roadBoundaryRecognition=[],i.vehicleManeuver=[],i.localizationInformation=[],i.roadAttributerecognition=[],i.passengerEnvironment=[],i.roadMarkingRecognition=[],i.trafficSignalHeadDetection=[],i.proprietaryDataContainer=[]),e.vehicleStatus&&e.vehicleStatus.length){i.vehicleStatus=[];for(var r=0;r<e.vehicleStatus.length;++r)i.vehicleStatus[r]=d.sdii.here.pb.VehicleStatus.toObject(e.vehicleStatus[r],t)}if(e.vehicleDynamics&&e.vehicleDynamics.length)for(i.vehicleDynamics=[],r=0;r<e.vehicleDynamics.length;++r)i.vehicleDynamics[r]=d.sdii.here.pb.VehicleDynamics.toObject(e.vehicleDynamics[r],t);if(e.signRecognition&&e.signRecognition.length)for(i.signRecognition=[],r=0;r<e.signRecognition.length;++r)i.signRecognition[r]=d.sdii.here.pb.SignRecognition.toObject(e.signRecognition[r],t);if(e.laneBoundaryRecognition&&e.laneBoundaryRecognition.length)for(i.laneBoundaryRecognition=[],r=0;r<e.laneBoundaryRecognition.length;++r)i.laneBoundaryRecognition[r]=d.sdii.here.pb.LaneBoundaryRecognition.toObject(e.laneBoundaryRecognition[r],t);if(e.exceptionalVehicleState&&e.exceptionalVehicleState.length)for(i.exceptionalVehicleState=[],r=0;r<e.exceptionalVehicleState.length;++r)i.exceptionalVehicleState[r]=d.sdii.here.pb.ExceptionalVehicleState.toObject(e.exceptionalVehicleState[r],t);if(e.proprietaryInfo&&e.proprietaryInfo.length)for(i.proprietaryInfo=[],r=0;r<e.proprietaryInfo.length;++r)i.proprietaryInfo[r]=d.sdii.here.pb.ProprietaryInfo.toObject(e.proprietaryInfo[r],t);if(e.environmentStatus&&e.environmentStatus.length)for(i.environmentStatus=[],r=0;r<e.environmentStatus.length;++r)i.environmentStatus[r]=d.sdii.here.pb.EnvironmentStatus.toObject(e.environmentStatus[r],t);if(e.objectDetection&&e.objectDetection.length)for(i.objectDetection=[],r=0;r<e.objectDetection.length;++r)i.objectDetection[r]=d.sdii.here.pb.ObjectDetection.toObject(e.objectDetection[r],t);if(e.adServiceAndSensorState&&e.adServiceAndSensorState.length)for(i.adServiceAndSensorState=[],r=0;r<e.adServiceAndSensorState.length;++r)i.adServiceAndSensorState[r]=d.sdii.here.pb.ADServiceAndSensorState.toObject(e.adServiceAndSensorState[r],t);if(e.specificObservedEvent&&e.specificObservedEvent.length)for(i.specificObservedEvent=[],r=0;r<e.specificObservedEvent.length;++r)i.specificObservedEvent[r]=d.sdii.here.pb.SpecificObservedEvent.toObject(e.specificObservedEvent[r],t);if(e.roadCondition&&e.roadCondition.length)for(i.roadCondition=[],r=0;r<e.roadCondition.length;++r)i.roadCondition[r]=d.sdii.here.pb.RoadCondition.toObject(e.roadCondition[r],t);if(e.roadBoundaryRecognition&&e.roadBoundaryRecognition.length)for(i.roadBoundaryRecognition=[],r=0;r<e.roadBoundaryRecognition.length;++r)i.roadBoundaryRecognition[r]=d.sdii.here.pb.RoadBoundaryRecognition.toObject(e.roadBoundaryRecognition[r],t);if(e.vehicleManeuver&&e.vehicleManeuver.length)for(i.vehicleManeuver=[],r=0;r<e.vehicleManeuver.length;++r)i.vehicleManeuver[r]=d.sdii.here.pb.VehicleManeuverEvent.toObject(e.vehicleManeuver[r],t);if(e.localizationInformation&&e.localizationInformation.length)for(i.localizationInformation=[],r=0;r<e.localizationInformation.length;++r)i.localizationInformation[r]=d.sdii.here.pb.LocalizationInformation.toObject(e.localizationInformation[r],t);if(e.roadAttributerecognition&&e.roadAttributerecognition.length)for(i.roadAttributerecognition=[],r=0;r<e.roadAttributerecognition.length;++r)i.roadAttributerecognition[r]=d.sdii.here.pb.RoadAttributeRecognition.toObject(e.roadAttributerecognition[r],t);if(e.passengerEnvironment&&e.passengerEnvironment.length)for(i.passengerEnvironment=[],r=0;r<e.passengerEnvironment.length;++r)i.passengerEnvironment[r]=d.sdii.here.pb.PassengerEnvironment.toObject(e.passengerEnvironment[r],t);if(e.roadMarkingRecognition&&e.roadMarkingRecognition.length)for(i.roadMarkingRecognition=[],r=0;r<e.roadMarkingRecognition.length;++r)i.roadMarkingRecognition[r]=d.sdii.here.pb.RoadMarkingRecognition.toObject(e.roadMarkingRecognition[r],t);if(e.trafficSignalHeadDetection&&e.trafficSignalHeadDetection.length)for(i.trafficSignalHeadDetection=[],r=0;r<e.trafficSignalHeadDetection.length;++r)i.trafficSignalHeadDetection[r]=d.sdii.here.pb.TrafficSignalHeadRecognition.toObject(e.trafficSignalHeadDetection[r],t);if(e.proprietaryDataContainer&&e.proprietaryDataContainer.length)for(i.proprietaryDataContainer=[],r=0;r<e.proprietaryDataContainer.length;++r)i.proprietaryDataContainer[r]=d.sdii.here.pb.ProprietaryDataContainer.toObject(e.proprietaryDataContainer[r],t);return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o.MediaContainer=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.timeStampUTC_ms=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.mediaType=0,e.prototype.mediaFormat="",e.prototype.mediaContent=u.newBuffer([]),e.prototype.mediaID=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.sensorOffset=null,e.prototype.sensorDirection=null,e.prototype.duration_s=0,e.prototype.verticalViewingAngle_deg=0,e.prototype.horizontalViewingAngle_deg=0,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.MediaContainer;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.timeStampUTC_ms=e.int64();break;case 2:r.mediaType=e.int32();break;case 3:r.mediaFormat=e.string();break;case 4:r.mediaContent=e.bytes();break;case 5:r.mediaID=e.int64();break;case 6:r.sensorOffset=d.sdii.here.pb.PositionOffset.decode(e,e.uint32());break;case 7:r.sensorDirection=d.sdii.here.pb.Vector3D.decode(e,e.uint32());break;case 8:r.duration_s=e.int32();break;case 9:r.verticalViewingAngle_deg=e.double();break;case 10:r.horizontalViewingAngle_deg=e.double();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("timeStampUTC_ms"))throw u.ProtocolError("missing required 'timeStampUTC_ms'",{instance:r});if(!r.hasOwnProperty("mediaType"))throw u.ProtocolError("missing required 'mediaType'",{instance:r});if(!r.hasOwnProperty("mediaFormat"))throw u.ProtocolError("missing required 'mediaFormat'",{instance:r});if(!r.hasOwnProperty("mediaContent"))throw u.ProtocolError("missing required 'mediaContent'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.MediaContainer)return e;var t=new d.sdii.here.pb.MediaContainer;switch(null!=e.timeStampUTC_ms&&(u.Long?(t.timeStampUTC_ms=u.Long.fromValue(e.timeStampUTC_ms)).unsigned=!1:"string"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=parseInt(e.timeStampUTC_ms,10):"number"==typeof e.timeStampUTC_ms?t.timeStampUTC_ms=e.timeStampUTC_ms:"object"==typeof e.timeStampUTC_ms&&(t.timeStampUTC_ms=new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber())),e.mediaType){case"MEDIA_TYPE_UNDEFINED":case 0:t.mediaType=0;break;case"OTHER":case 1:t.mediaType=1;break;case"IMAGE":case 2:t.mediaType=2;break;case"VIDEO":case 3:t.mediaType=3;break;case"AUDIO":case 4:t.mediaType=4}if(null!=e.mediaFormat&&(t.mediaFormat=String(e.mediaFormat)),null!=e.mediaContent&&("string"==typeof e.mediaContent?u.base64.decode(e.mediaContent,t.mediaContent=u.newBuffer(u.base64.length(e.mediaContent)),0):e.mediaContent.length&&(t.mediaContent=e.mediaContent)),null!=e.mediaID&&(u.Long?(t.mediaID=u.Long.fromValue(e.mediaID)).unsigned=!1:"string"==typeof e.mediaID?t.mediaID=parseInt(e.mediaID,10):"number"==typeof e.mediaID?t.mediaID=e.mediaID:"object"==typeof e.mediaID&&(t.mediaID=new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber())),null!=e.sensorOffset){if("object"!=typeof e.sensorOffset)throw TypeError(".sdii.here.pb.MediaContainer.sensorOffset: object expected");t.sensorOffset=d.sdii.here.pb.PositionOffset.fromObject(e.sensorOffset)}if(null!=e.sensorDirection){if("object"!=typeof e.sensorDirection)throw TypeError(".sdii.here.pb.MediaContainer.sensorDirection: object expected");t.sensorDirection=d.sdii.here.pb.Vector3D.fromObject(e.sensorDirection)}return null!=e.duration_s&&(t.duration_s=0|e.duration_s),null!=e.verticalViewingAngle_deg&&(t.verticalViewingAngle_deg=Number(e.verticalViewingAngle_deg)),null!=e.horizontalViewingAngle_deg&&(t.horizontalViewingAngle_deg=Number(e.horizontalViewingAngle_deg)),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(u.Long){var r=new u.Long(0,0,!1);i.timeStampUTC_ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.timeStampUTC_ms=t.longs===String?"0":0;i.mediaType=t.enums===String?"MEDIA_TYPE_UNDEFINED":0,i.mediaFormat="",i.mediaContent=t.bytes===String?"":[],u.Long?(r=new u.Long(0,0,!1),i.mediaID=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.mediaID=t.longs===String?"0":0,i.sensorOffset=null,i.sensorDirection=null,i.duration_s=0,i.verticalViewingAngle_deg=0,i.horizontalViewingAngle_deg=0}return null!=e.timeStampUTC_ms&&e.hasOwnProperty("timeStampUTC_ms")&&("number"==typeof e.timeStampUTC_ms?i.timeStampUTC_ms=t.longs===String?String(e.timeStampUTC_ms):e.timeStampUTC_ms:i.timeStampUTC_ms=t.longs===String?u.Long.prototype.toString.call(e.timeStampUTC_ms):t.longs===Number?new u.LongBits(e.timeStampUTC_ms.low>>>0,e.timeStampUTC_ms.high>>>0).toNumber():e.timeStampUTC_ms),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(i.mediaType=t.enums===String?d.sdii.here.pb.MediaContainer.MediaTypeEnum[e.mediaType]:e.mediaType),null!=e.mediaFormat&&e.hasOwnProperty("mediaFormat")&&(i.mediaFormat=e.mediaFormat),null!=e.mediaContent&&e.hasOwnProperty("mediaContent")&&(i.mediaContent=t.bytes===String?u.base64.encode(e.mediaContent,0,e.mediaContent.length):t.bytes===Array?Array.prototype.slice.call(e.mediaContent):e.mediaContent),null!=e.mediaID&&e.hasOwnProperty("mediaID")&&("number"==typeof e.mediaID?i.mediaID=t.longs===String?String(e.mediaID):e.mediaID:i.mediaID=t.longs===String?u.Long.prototype.toString.call(e.mediaID):t.longs===Number?new u.LongBits(e.mediaID.low>>>0,e.mediaID.high>>>0).toNumber():e.mediaID),null!=e.sensorOffset&&e.hasOwnProperty("sensorOffset")&&(i.sensorOffset=d.sdii.here.pb.PositionOffset.toObject(e.sensorOffset,t)),null!=e.sensorDirection&&e.hasOwnProperty("sensorDirection")&&(i.sensorDirection=d.sdii.here.pb.Vector3D.toObject(e.sensorDirection,t)),null!=e.duration_s&&e.hasOwnProperty("duration_s")&&(i.duration_s=e.duration_s),null!=e.verticalViewingAngle_deg&&e.hasOwnProperty("verticalViewingAngle_deg")&&(i.verticalViewingAngle_deg=t.json&&!isFinite(e.verticalViewingAngle_deg)?String(e.verticalViewingAngle_deg):e.verticalViewingAngle_deg),null!=e.horizontalViewingAngle_deg&&e.hasOwnProperty("horizontalViewingAngle_deg")&&(i.horizontalViewingAngle_deg=t.json&&!isFinite(e.horizontalViewingAngle_deg)?String(e.horizontalViewingAngle_deg):e.horizontalViewingAngle_deg),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e.MediaTypeEnum=function(){var e={},t=Object.create(e);return t[e[0]="MEDIA_TYPE_UNDEFINED"]=0,t[e[1]="OTHER"]=1,t[e[2]="IMAGE"]=2,t[e[3]="VIDEO"]=3,t[e[4]="AUDIO"]=4,t}(),e}(),o.PathMedia=function(){function e(e){if(this.mediaContainer=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.mediaContainer=u.emptyArray,e.decode=function(e,t){e instanceof c||(e=c.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new d.sdii.here.pb.PathMedia;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.mediaContainer&&r.mediaContainer.length||(r.mediaContainer=[]),r.mediaContainer.push(d.sdii.here.pb.MediaContainer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof c||(e=new c(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof d.sdii.here.pb.PathMedia)return e;var t=new d.sdii.here.pb.PathMedia;if(e.mediaContainer){if(!Array.isArray(e.mediaContainer))throw TypeError(".sdii.here.pb.PathMedia.mediaContainer: array expected");t.mediaContainer=[];for(var i=0;i<e.mediaContainer.length;++i){if("object"!=typeof e.mediaContainer[i])throw TypeError(".sdii.here.pb.PathMedia.mediaContainer: object expected");t.mediaContainer[i]=d.sdii.here.pb.MediaContainer.fromObject(e.mediaContainer[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.mediaContainer=[]),e.mediaContainer&&e.mediaContainer.length){i.mediaContainer=[];for(var r=0;r<e.mediaContainer.length;++r)i.mediaContainer[r]=d.sdii.here.pb.MediaContainer.toObject(e.mediaContainer[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,l.util.toJSONOptions)},e}(),o),a),s),e.exports=d},17550:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(64670),t),n(i(8002),t),n(i(40661),t),n(i(10643),t),n(i(50884),t),n(i(73636),t)},96500:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(90991),t),n(i(10643),t),n(i(68615),t),n(i(8775),t),n(i(78510),t),n(i(55954),t),n(i(65187),t),n(i(8420),t),n(i(68497),t),n(i(30136),t),n(i(26583),t),n(i(58696),t),n(i(52867),t),n(i(53568),t),n(i(46284),t),n(i(73636),t),n(i(57162),t),n(i(26244),t)},90991:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorUtils=void 0;const r=i(38338),n=i(84428),o=i(73644),a=255,s=new n.Color;var l;(l=t.ColorUtils||(t.ColorUtils={})).getHexFromRgba=function(e,t,i,n){return r.assert(n>=0&&n<=1),a-Math.floor(n*a)<<24^e*a<<16^t*a<<8^i*a<<0},l.getHexFromRgb=function(e,t,i){return r.assert(e>=0&&e<=1),r.assert(t>=0&&t<=1),r.assert(i>=0&&i<=1),e*a<<16^t*a<<8^i*a<<0},l.getHexFromHsl=function(e,t,i){return r.assert(e>=0&&e<=1),r.assert(t>=0&&t<=1),r.assert(i>=0&&i<=1),s.setHSL(e,t,i).getHex()},l.getRgbaFromHex=function(e,t=new o.RGBA){return r.assert(0==(0&e),"Wrong hex format"),t.r=(e>>16&a)/a,t.g=(e>>8&a)/a,t.b=(e>>0&a)/a,t.a=(a-(e>>24&a))/a,t},l.hasAlphaInHex=function(e){return r.assert(0==(0&e),"Wrong hex format"),e>>24!=0},l.getAlphaFromHex=function(e){return r.assert(0==(0&e),"Wrong hex format"),(a-(e>>24)&a)/a},l.removeAlphaFromHex=function(e){return r.assert(0==(0&e),"Wrong hex format"),16777215&e}},53568:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scaleHeight=t.getFeatureText=t.getFeatureName=t.getFeatureId=t.getProjectionName=t.getProjection=t.GeometryType=t.getArrayConstructor=void 0;const r=i(32941),n=i(10643),o=i(33189),a=i(68615);function s(e,t,i,r,n){var o;let a;if(void 0===t&&(t="name"),i){const i=e.lookup(`${t}:short`);if("string"==typeof i&&i.length>0)return i}if(r){const t=e.lookup("iso_code");if("string"==typeof t&&t.length>0)return t}if(void 0!==n)for(const i of n)if(a=null!==(o=e.lookup(`${t}:${i}`))&&void 0!==o?o:e.lookup(`${t}_${i}`),"string"==typeof a&&a.length>0)return a;if(a=e.lookup(t),"string"==typeof a)return a}var l;t.getArrayConstructor=function(e){switch(e){case"float":return Float32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array}},(l=t.GeometryType||(t.GeometryType={}))[l.Unspecified=0]="Unspecified",l[l.Point=1]="Point",l[l.Line=2]="Line",l[l.SolidLine=3]="SolidLine",l[l.Text=4]="Text",l[l.TextPath=5]="TextPath",l[l.ExtrudedLine=6]="ExtrudedLine",l[l.Polygon=7]="Polygon",l[l.ExtrudedPolygon=8]="ExtrudedPolygon",l[l.Object3D=9]="Object3D",l[l.Other=1e3]="Other",t.getProjection=function(e){switch(e){case"mercator":return r.mercatorProjection;case"webMercator":return r.webMercatorProjection;case"sphere":return r.sphereProjection;case"normalizedEquirectangular":return r.normalizedEquirectangularProjection;case"equirectangular":return r.equirectangularProjection;default:throw new Error(`Unknown projection ${e}`)}},t.getProjectionName=function(e){if(e===r.mercatorProjection)return"mercator";if(e===r.webMercatorProjection)return"webMercator";if(e===r.sphereProjection)return"sphere";if(e===r.normalizedEquirectangularProjection)return"normalizedEquirectangular";if(e===r.equirectangularProjection)return"equirectangular";throw new Error("Unknown projection")},t.getFeatureId=function(e){if(void 0===e)return 0;if("string"==typeof e||"number"==typeof e)return e;if(e.hasOwnProperty("$id")){const t=e.$id;if("string"==typeof t||"number"==typeof t)return t}return 0},t.getFeatureName=s,t.getFeatureText=function(e,t,i){let r,l;const c=e instanceof n.Env?e:e.env;let u="name";if(a.isTextTechnique(t)||a.isPoiTechnique(t)||a.isLineMarkerTechnique(t)){if(void 0!==t.text)return o.evaluateTechniqueAttr(e,t.text);if(void 0!==t.label&&(u=o.evaluateTechniqueAttr(e,t.label),"string"!=typeof u))return;r=t.useAbbreviation,l=t.useIsoCode}return s(c,u,r,l,i)},t.scaleHeight=function(e,t,i){return!o.evaluateTechniqueAttr(e,t.constantHeight,i<12)}},73406:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapEnv=t.Env=void 0;class i{static isEnv(e){return e instanceof i}lookup(e){}unmap(){return{}}}t.Env=i,t.MapEnv=class extends i{constructor(e,t){super(),this.entries=e,this.parent=t}lookup(e){if(this.entries.hasOwnProperty(e)){const t=this.entries[e];if(void 0!==t)return t}return this.parent?this.parent.lookup(e):void 0}unmap(){const e=this.parent?this.parent.unmap():{};for(const t in this.entries)this.entries.hasOwnProperty(t)&&(e[t]=this.entries[t]);return e}}},10643:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.InterpolateExpr=t.StepExpr=t.CaseExpr=t.MatchExpr=t.LookupExpr=t.CallExpr=t.HasAttributeExpr=t.ObjectLiteralExpr=t.StringLiteralExpr=t.NumberLiteralExpr=t.BooleanLiteralExpr=t.NullLiteralExpr=t.LiteralExpr=t.VarExpr=t.Expr=t.ExprScope=t.isJsonExpr=t.ExprDependencies=void 0;const o=i(84428),a=i(23887),s=i(32995),l=i(69159),c=i(8420),u=i(53076),d=i(73644),h=i(78510);n(i(73406),t);const m=new a.ExprEvaluator,p=new s.ExprInstantiator;class f{constructor(){this.properties=new Set}}t.ExprDependencies=f;class g{static of(e){const t=new f;return e.accept(this.instance,t),t}visitNullLiteralExpr(e,t){}visitBooleanLiteralExpr(e,t){}visitNumberLiteralExpr(e,t){}visitStringLiteralExpr(e,t){}visitObjectLiteralExpr(e,t){}visitVarExpr(e,t){t.properties.add(e.name)}visitHasAttributeExpr(e,t){t.properties.add(e.name)}visitCallExpr(e,t){switch(e.args.forEach((e=>e.accept(this,t))),e.op){case"dynamic-properties":t.volatile=!0;break;case"feature-state":t.featureState=!0,t.properties.add("$state"),t.properties.add("$id");break;case"id":t.properties.add("$id");break;case"zoom":case"world-ppi-scale":case"world-discrete-ppi-scale":t.properties.add("$zoom");break;case"geometry-type":t.properties.add("$geometryType")}}visitLookupExpr(e,t){return this.visitCallExpr(e,t)}visitMatchExpr(e,t){e.value.accept(this,t),e.branches.forEach((([e,i])=>i.accept(this,t))),e.fallback.accept(this,t)}visitCaseExpr(e,t){e.branches.forEach((([e,i])=>{e.accept(this,t),i.accept(this,t)})),e.fallback.accept(this,t)}visitStepExpr(e,t){e.input.accept(this,t),e.defaultValue.accept(this,t),e.stops.forEach((([e,i])=>i.accept(this,t)))}visitInterpolateExpr(e,t){e.input.accept(this,t),e.stops.forEach((([e,i])=>i.accept(this,t)))}}function y(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]}var v;g.instance=new g,t.isJsonExpr=y,function(e){e[e.Value=0]="Value",e[e.Condition=1]="Condition",e[e.Dynamic=2]="Dynamic"}(v=t.ExprScope||(t.ExprScope={}));class _{static isExpr(e){return e instanceof _}static parse(e){return new l.ExprParser(e).parse()}static fromJSON(e,t,i){return k(e,void 0!==t?{definitions:t,lockedNames:new Set,cache:null!=i?i:new Map}:void 0)}evaluate(e,t=v.Value,i){return this.accept(m,new a.ExprEvaluatorContext(m,e,t,i))}instantiate(e){return this.accept(p,e)}dependencies(){return this.m_dependencies||(this.m_dependencies=g.of(this)),this.m_dependencies}intern(e){return e.add(this)}toJSON(){return(new L).serialize(this)}isDynamic(){return void 0===this.m_isDynamic&&(this.m_isDynamic=this.exprIsDynamic()),this.m_isDynamic}}t.Expr=_;class b extends _{constructor(e){super(),this.name=e}accept(e,t){return e.visitVarExpr(this,t)}exprIsDynamic(){return!1}}t.VarExpr=b;class S extends _{static fromValue(e){switch(typeof e){case"boolean":return new E(e);case"number":return new C(e);case"string":return new w(e);case"object":return null===e?T.instance:new x(e);default:throw new Error(`failed to create a literal from '${e}'`)}}exprIsDynamic(){return!1}}t.LiteralExpr=S;class T extends S{constructor(){super(),this.value=null}accept(e,t){return e.visitNullLiteralExpr(this,t)}exprIsDynamic(){return!1}}t.NullLiteralExpr=T,T.instance=new T;class E extends S{constructor(e){super(),this.value=e}accept(e,t){return e.visitBooleanLiteralExpr(this,t)}}t.BooleanLiteralExpr=E;class C extends S{constructor(e){super(),this.value=e}accept(e,t){return e.visitNumberLiteralExpr(this,t)}}t.NumberLiteralExpr=C;class w extends S{constructor(e){super(),this.value=e}get promotedValue(){var e,t,i;return void 0===this.m_promotedValue&&(this.m_promotedValue=null!==(t=null!==(e=d.RGBA.parse(this.value))&&void 0!==e?e:u.Pixels.parse(this.value))&&void 0!==t?t:null),null!==(i=this.m_promotedValue)&&void 0!==i?i:void 0}accept(e,t){return e.visitStringLiteralExpr(this,t)}}t.StringLiteralExpr=w;class x extends S{constructor(e){super(),this.value=e}get isArrayLiteral(){return Array.isArray(this.value)}accept(e,t){return e.visitObjectLiteralExpr(this,t)}}t.ObjectLiteralExpr=x;class P extends _{constructor(e){super(),this.name=e}accept(e,t){return e.visitHasAttributeExpr(this,t)}exprIsDynamic(){return!1}}t.HasAttributeExpr=P;class O extends _{constructor(e,t){super(),this.op=e,this.args=t}get children(){return this.args}accept(e,t){return e.visitCallExpr(this,t)}exprIsDynamic(){var e;const t=null!==(e=this.descriptor)&&void 0!==e?e:a.ExprEvaluator.getOperator(this.op);return!!(t&&t.isDynamicOperator&&t.isDynamicOperator(this))||this.args.some((e=>e.isDynamic()))}}t.CallExpr=O;class A extends O{constructor(e){super("lookup",e),this.args=e}static parseArray(e,t){const i=e[1];if(void 0===i)throw new Error("missing lookup table in 'lookup' expression");const r=k(i,t);if(!(Array.isArray(i)&&r instanceof x))throw new Error("Invalid lookup table expression for operator 'lookup'. It must be a literal or a ref to one.");const n=r.value;if(!Array.isArray(n))throw new Error(`Invalid lookup table type (${typeof n}) for operator 'lookup'`);const o=e.slice(2).map((e=>k(e,t)));return o.unshift(r),new A(o)}accept(e,t){return e.visitLookupExpr(this,t)}}t.LookupExpr=A;class D extends _{constructor(e,t,i){super(),this.value=e,this.branches=t,this.fallback=i}static isValidMatchLabel(e){switch(typeof e){case"number":case"string":return!0;case"object":if(!Array.isArray(e)||0===e.length)return!1;const t=typeof e[0];return("number"===t||"string"===t)&&e.every((e=>typeof e===t));default:return!1}}accept(e,t){return e.visitMatchExpr(this,t)}exprIsDynamic(){return this.value.isDynamic()||this.branches.some((([e,t])=>t.isDynamic()))||this.fallback.isDynamic()}}t.MatchExpr=D;class R extends _{constructor(e,t){super(),this.branches=e,this.fallback=t}accept(e,t){return e.visitCaseExpr(this,t)}exprIsDynamic(){return this.branches.some((([e,t])=>e.isDynamic()||t.isDynamic()))||this.fallback.isDynamic()}}t.CaseExpr=R;class I extends _{constructor(e,t,i){super(),this.input=e,this.defaultValue=t,this.stops=i}accept(e,t){return e.visitStepExpr(this,t)}exprIsDynamic(){return this.input.isDynamic()||this.defaultValue.isDynamic()||this.stops.some((([e,t])=>t.isDynamic()))}}t.StepExpr=I;class M extends _{constructor(e,t,i){super(),this.mode=e,this.input=t,this.stops=i}accept(e,t){return e.visitInterpolateExpr(this,t)}exprIsDynamic(){return this.input.isDynamic()||this.stops.some((([e,t])=>t.isDynamic()))}}t.InterpolateExpr=M;class L{serialize(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return e.value instanceof o.Vector2?["make-vector",e.value.x,e.value.y]:e.value instanceof o.Vector3?["make-vector",e.value.x,e.value.y,e.value.z]:e.value instanceof o.Vector4?["make-vector",e.value.x,e.value.y,e.value.z,e.value.w]:["literal",e.value]}visitVarExpr(e,t){return["get",e.name]}visitHasAttributeExpr(e,t){return["has",e.name]}visitCallExpr(e,t){return[e.op,...e.args.map((e=>this.serialize(e)))]}visitLookupExpr(e,t){return this.visitCallExpr(e,t)}visitMatchExpr(e,t){const i=[];for(const[t,r]of e.branches)i.push(t,this.serialize(r));return["match",this.serialize(e.value),...i,this.serialize(e.fallback)]}visitCaseExpr(e,t){const i=[];for(const[t,r]of e.branches)i.push(this.serialize(t),this.serialize(r));return["case",...i,this.serialize(e.fallback)]}visitStepExpr(e,t){const i=["step"];return i.push(this.serialize(e.input)),i.push(this.serialize(e.defaultValue)),e.stops.forEach((([e,t])=>{i.push(e),i.push(this.serialize(t))})),i}visitInterpolateExpr(e,t){const i=["interpolate",e.mode];return i.push(this.serialize(e.input)),e.stops.forEach((([e,t])=>{i.push(e),i.push(this.serialize(t))})),i}}function k(e,t){if(Array.isArray(e))return N(e,t);if(null===e)return T.instance;if("boolean"==typeof e)return new E(e);if("number"==typeof e)return new C(e);if("string"==typeof e)return new w(e);throw new Error(`failed to create expression from: ${JSON.stringify(e)}`)}function N(e,t){const i=e[0];if("string"!=typeof i)throw new Error("expected a builtin function name");switch(i){case"!has":case"!in":return new O("!",[N([i.slice(1),...e.slice(1)])]);case"ref":return function(e,t){if("string"!=typeof e[1])throw new Error("expected the name of an attribute");if(void 0===t)throw new Error("ref used with no definitions");const i=e[1];if(t.lockedNames.has(i))throw new Error(`circular referene to '${i}'`);if(!(i in t.definitions))throw new Error(`definition '${i}' not found`);const r=t.cache.get(i);if(void 0!==r)return r;let n,o=t.definitions[i];const a=h.getDefinitionValue(o);if(c.isInterpolatedPropertyDefinition(a))return _.fromJSON(c.interpolatedPropertyDefinitionToJsonExpr(o));if(!y(a))return _.fromJSON(a);if(o=a,!y(o))throw new Error(`unsupported definition ${i}`);t.lockedNames.add(i);try{n=k(o,t)}finally{t.lockedNames.delete(i)}return t.cache.set(i,n),n}(e,t);case"get":return function(e,t){if(void 0!==e[2])return U("get",e,t);const i=e[1];if("string"!=typeof i)throw new Error("expected the name of an attribute");return new b(i)}(e,t);case"has":return function(e,t){if(void 0!==e[2])return U("has",e,t);const i=e[1];if("string"!=typeof i)throw new Error("expected the name of an attribute");return new P(i)}(e,t);case"literal":return function(e){const t=e[1];if(null===t||"object"!=typeof t)throw new Error("expected an object or array literal");return new x(t)}(e);case"match":return function(e,t){if(e.length<4)throw new Error("not enough arguments");if(!(e.length%2))throw new Error("fallback is missing in 'match' expression");const i=k(e[1],t),r=[];for(let i=2;i<e.length-1;i+=2){const n=e[i];if(!D.isValidMatchLabel(n))throw new Error(`'${JSON.stringify(n)}' is not a valid label for 'match'`);const o=k(e[i+1],t);r.push([n,o])}const n=k(e[e.length-1],t);return new D(i,r,n)}(e,t);case"case":return function(e,t){if(e.length<3)throw new Error("not enough arguments");if(e.length%2)throw new Error("fallback is missing in 'case' expression");const i=[];for(let r=1;r<e.length-1;r+=2){const n=k(e[r],t),o=k(e[r+1],t);i.push([n,o])}const r=k(e[e.length-1],t);return new R(i,r)}(e,t);case"interpolate":return function(e,t){const i=e[1];if(!function(e){if(!Array.isArray(e))return!1;switch(e[0]){case"discrete":case"linear":case"cubic":case"exponential":return!0;default:return!1}}(i))throw new Error("expected an interpolation type");if("exponential"===i[0]&&"number"!=typeof i[1])throw new Error("expected the base of the exponential interpolation");const r=void 0!==e[2]?k(e[2],t):void 0;if(!_.isExpr(r))throw new Error("expected the input of the interpolation");if(3===e.length||!(e.length%2))throw new Error("invalid number of samples");const n=[];for(let i=3;i<e.length-1;i+=2){const r=e[i],o=k(e[i+1],t);n.push([r,o])}return new M(i,r,n)}(e,t);case"step":return function(e,t){if(e.length<2)throw new Error("expected the input of the 'step' operator");if(e.length<3||!(e.length%2))throw new Error("not enough arguments");const i=k(e[1],t),r=k(e[2],t),n=[];for(let i=3;i<e.length;i+=2){const r=e[i],o=k(e[i+1],t);n.push([r,o])}return new I(i,r,n)}(e,t);case"lookup":return A.parseArray(e,t);default:return U(i,e,t)}}function U(e,t,i){return new O(e,t.slice(1).map((e=>k(e,i))))}},23887:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprEvaluator=t.ExprEvaluatorContext=void 0;const r=i(84428),n=i(10643),o=i(31392),a=i(85500),s=i(12112),l=i(3171),c=i(19102),u=i(48544),d=i(98702),h=i(49207),m=i(11911),p=i(8249),f=i(55546),g=i(92545),y=i(23368),v=i(53076),_=i(73644),b=new Map;function S(e,t){var i,r,o;if(t instanceof n.StringLiteralExpr)return null!==(i=t.promotedValue)&&void 0!==i?i:t.value;const a=e.evaluate(t);return"string"==typeof a&&null!==(o=null!==(r=_.RGBA.parse(a))&&void 0!==r?r:v.Pixels.parse(a))&&void 0!==o?o:a}t.ExprEvaluatorContext=class{constructor(e,t,i,r){this.evaluator=e,this.env=t,this.scope=i,this.cache=r}evaluate(e){var t,i;if(void 0===e)throw new Error("Failed to evaluate expression");const r=null===(t=this.cache)||void 0===t?void 0:t.get(e);if(void 0!==r)return r;const n=e.accept(this.evaluator,this);return null===(i=this.cache)||void 0===i||i.set(e,n),n}wrapValue(e){return n.Expr.isExpr(e)?e:n.LiteralExpr.fromValue(e)}};class T{static defineOperator(e,t){b.set(e,t)}static defineOperators(e){Object.getOwnPropertyNames(e).forEach((t=>{this.defineOperator(t,e[t])}))}static getOperator(e){return b.get(e)}visitVarExpr(e,t){const i=t.env.lookup(e.name);return void 0!==i?i:null}visitNullLiteralExpr(e,t){return null}visitBooleanLiteralExpr(e,t){return e.value}visitNumberLiteralExpr(e,t){return e.value}visitStringLiteralExpr(e,t){return e.value}visitObjectLiteralExpr(e,t){return e.value}visitHasAttributeExpr(e,t){return void 0!==t.env.lookup(e.name)}visitMatchExpr(e,t){const i=t.evaluate(e.value);for(const[r,n]of e.branches){if(Array.isArray(r)&&r.includes(i))return t.evaluate(n);if(r===i)return t.evaluate(n)}return t.evaluate(e.fallback)}visitCaseExpr(e,t){if(t.scope===n.ExprScope.Value){const i=e.branches.findIndex((([e,t])=>e.isDynamic()));if(-1!==i){let r;for(let o=0;o<e.branches.length;++o){const[a,s]=e.branches[o],l=t.evaluate(a),c=t.evaluate(s);if(o<i&&Boolean(l))return c;if((n.Expr.isExpr(l)||Boolean(l))&&(void 0===r&&(r=[]),null==r||r.push([t.wrapValue(l),t.wrapValue(c)]),!n.Expr.isExpr(l)&&Boolean(l)))return new n.CaseExpr(r,n.LiteralExpr.fromValue(null))}const o=t.evaluate(e.fallback);return void 0===r?o:new n.CaseExpr(r,t.wrapValue(o))}}for(const[i,r]of e.branches)if(t.evaluate(i))return t.evaluate(r);return t.evaluate(e.fallback)}visitCallExpr(e,t){var i;const r=null!==(i=e.descriptor)&&void 0!==i?i:b.get(e.op);if(r){let i;if(e.descriptor=r,t.scope===n.ExprScope.Value&&e.isDynamic()){if(e.descriptor.partialEvaluate)return e.descriptor.partialEvaluate(t,e);const r=e.args.map((e=>t.wrapValue(t.evaluate(e))));if(r.every(((t,i)=>t===e.args[i])))return e;i=new n.CallExpr(e.op,r)}else i=r.call(t,e);return i}throw new Error(`undefined operator '${e.op}'`)}visitLookupExpr(e,t){return this.visitCallExpr(e,t)}visitStepExpr(e,t){if(t.scope===n.ExprScope.Value){const i=t.evaluate(e.input),r=t.evaluate(e.defaultValue);return new n.StepExpr(t.wrapValue(i),t.wrapValue(r),e.stops.map((([e,i])=>{const r=t.evaluate(i);return[e,t.wrapValue(r)]})))}{const i=t.evaluate(e.input);if("number"!=typeof i)throw new Error(`input '${i}' must be a number`);if(i<e.stops[0][0])return t.evaluate(e.defaultValue);let r=e.stops.findIndex((e=>e[0]>i));return-1===r&&(r=e.stops.length),t.evaluate(e.stops[r-1][1])}}visitInterpolateExpr(e,t){if(t.scope===n.ExprScope.Value){const i=t.evaluate(e.input);return new n.InterpolateExpr(e.mode,t.wrapValue(i),e.stops.map((([e,i])=>{const r=t.evaluate(i);return[e,t.wrapValue(r)]})))}{const i=t.evaluate(e.input);if("number"!=typeof i)throw new Error("input must be a number");if("cubic"===e.mode[0])return function(e,t,i){if(i<t.stops[0][0])return S(e,t.stops[0][1]);if(i>=t.stops[t.stops.length-1][0])return S(e,t.stops[t.stops.length-1][1]);const n=t.stops.findIndex((e=>e[0]>i)),o=Math.max(0,n-1),a=0===o?n:o-1,s=n<t.stops.length-1?n+1:n-1,l=t.stops[a][0],c=t.stops[o][0],u=t.stops[n][0],d=.5*(u-c),h=d/(c-l),m=d/(t.stops[s][0]-u),p=(i-c)/(u-c),f=p*p,g=f*p,y=-h*g+2*h*f-h*p,b=(1+h)*g+(-1.5-2*h)*f+(-.5+h)*p+1,T=(-1-m)*g+(1.5+m)*f+.5*p,E=m*g-m*f,C=S(e,t.stops[a][1]),w=S(e,t.stops[o][1]),x=S(e,t.stops[n][1]),P=S(e,t.stops[s][1]);if("number"==typeof C&&"number"==typeof w&&"number"==typeof x&&"number"==typeof P)return y*C+b*w+T*x+E*P;if(C instanceof _.RGBA&&w instanceof _.RGBA&&x instanceof _.RGBA&&P instanceof _.RGBA)return new _.RGBA(r.MathUtils.clamp(y*C.r+b*w.r+T*x.r+E*P.r,0,1),r.MathUtils.clamp(y*C.g+b*w.g+T*x.g+E*P.g,0,1),r.MathUtils.clamp(y*C.b+b*w.b+T*x.b+E*P.b,0,1),r.MathUtils.clamp(y*C.a+b*w.a+T*x.a+E*P.a,0,1));if(C instanceof v.Pixels&&w instanceof v.Pixels&&x instanceof v.Pixels&&P instanceof v.Pixels)return new v.Pixels(y*C.value+b*w.value+T*x.value+E*P.value);if(C instanceof r.Color&&w instanceof r.Color&&x instanceof r.Color&&P instanceof r.Color)return new r.Color(y*C.r+b*w.r+T*x.r+E*P.r,y*C.g+b*w.g+T*x.g+E*P.g,y*C.b+b*w.b+T*x.b+E*P.b);if(C instanceof r.Vector2&&w instanceof r.Vector2&&x instanceof r.Vector2&&P instanceof r.Vector2)return new r.Vector2(y*C.x+b*w.x+T*x.x+E*P.x,y*C.y+b*w.y+T*x.y+E*P.y);if(C instanceof r.Vector3&&w instanceof r.Vector3&&x instanceof r.Vector3&&P instanceof r.Vector3)return new r.Vector3(y*C.x+b*w.x+T*x.x+E*P.x,y*C.y+b*w.y+T*x.y+E*P.y,y*C.z+b*w.z+T*x.z+E*P.z);if(C instanceof r.Vector4&&w instanceof r.Vector4&&x instanceof r.Vector4&&P instanceof r.Vector4)return new r.Vector4(y*C.x+b*w.x+T*x.x+E*P.x,y*C.y+b*w.y+T*x.y+E*P.y,y*C.z+b*w.z+T*x.z+E*P.z,y*C.w+b*w.w+T*x.w+E*P.w);if(Array.isArray(C)&&Array.isArray(w)&&Array.isArray(x)&&Array.isArray(P)){const e=C.length,t=[];for(let i=0;i<e;++i)t[i]=y*C[i]+b*w[i]+T*x[i]+E*P[i];return t}throw new Error("failed to interpolate values")}(t,e,i);const n=e.stops.findIndex((e=>e[0]>i));if(-1===n)return t.evaluate(e.stops[e.stops.length-1][1]);if(0===n)return t.evaluate(e.stops[0][1]);const[o,a]=e.stops[n],[s,l]=e.stops[n-1],c=S(t,l);let u=0;switch(e.mode[0]){case"discrete":return c;case"linear":u=(i-s)/(o-s);break;case"exponential":{const t=e.mode[1];u=1===t?(i-s)/(o-s):(Math.pow(t,i-s)-1)/(Math.pow(t,o-s)-1);break}default:throw new Error(`interpolation mode ${JSON.stringify(e.mode)} is not supported`)}const d=S(t,a);if("number"==typeof c&&"number"==typeof d)return r.MathUtils.lerp(c,d,u);if(c instanceof _.RGBA&&d instanceof _.RGBA)return c.clone().lerp(d,u);if(c instanceof v.Pixels&&d instanceof v.Pixels)return new v.Pixels(r.MathUtils.lerp(c.value,d.value,u));if(c instanceof r.Color&&d instanceof r.Color)return c.clone().lerp(d,u);if(c instanceof r.Vector2&&d instanceof r.Vector2)return c.clone().lerp(d,u);if(c instanceof r.Vector3&&d instanceof r.Vector3)return c.clone().lerp(d,u);if(c instanceof r.Vector4&&d instanceof r.Vector4)return c.clone().lerp(d,u);if(Array.isArray(c)&&Array.isArray(d)&&c.length===d.length)return c.map(((e,t)=>r.MathUtils.lerp(e,d[t],u)));throw new Error(`todo: mix(${JSON.stringify(c)}, ${JSON.stringify(d)}, ${u})`)}}}t.ExprEvaluator=T,T.defineOperators(a.CastOperators),T.defineOperators(l.ComparisonOperators),T.defineOperators(h.MathOperators),T.defineOperators(f.StringOperators),T.defineOperators(s.ColorOperators),T.defineOperators(g.TypeOperators),T.defineOperators(m.MiscOperators),T.defineOperators(u.FlowOperators),T.defineOperators(o.ArrayOperators),T.defineOperators(p.ObjectOperators),T.defineOperators(c.FeatureOperators),T.defineOperators(d.MapOperators),T.defineOperators(y.VectorOperators)},32995:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprInstantiator=void 0;const r=i(73406),n=i(10643),o=new r.Env;t.ExprInstantiator=class{visitNullLiteralExpr(e,t){return e}visitBooleanLiteralExpr(e,t){return e}visitNumberLiteralExpr(e,t){return e}visitStringLiteralExpr(e,t){return e}visitObjectLiteralExpr(e,t){return e}visitVarExpr(e,t){if(t.preserve&&t.preserve.has(e.name))return e;const i=t.env.lookup(e.name);return n.LiteralExpr.fromValue(void 0!==i?i:null)}visitHasAttributeExpr(e,t){if(t.preserve&&t.preserve.has(e.name))return e;const i=void 0!==t.env.lookup(e.name);return n.LiteralExpr.fromValue(i)}visitCallExprImpl(e,t,i){const r=e.args.map((e=>e.accept(this,t)));return r.some(((t,i)=>t!==e.args[i]))?i(e.op,r):e}visitCallExpr(e,t){return this.visitCallExprImpl(e,t,((e,t)=>new n.CallExpr(e,t)))}visitLookupExpr(e,t){return this.visitCallExprImpl(e,t,((e,t)=>new n.LookupExpr(t)))}visitMatchExpr(e,t){const i=e.value.accept(this,t);if(i instanceof n.LiteralExpr){const r=i.value;for(const[i,n]of e.branches){if(Array.isArray(i)&&i.includes(r))return n.accept(this,t);if(i===r)return n.accept(this,t)}return e.fallback.accept(this,t)}let r=e.value!==i;const o=e.branches.map((([e,i])=>{const n=i.accept(this,t);return n!==i&&(r=!0),[e,n]})),a=e.fallback.accept(this,t);return a!==e.fallback&&(r=!0),r?new n.MatchExpr(i,o,a):e}visitCaseExpr(e,t){const i=[];let r=!1;for(const[a,s]of e.branches){const e=a.accept(this,t),l=e.dependencies();if(a.isDynamic()||0!==l.properties.size)e!==a&&(r=!0),i.push([e,s]);else if(Boolean(e.evaluate(o,n.ExprScope.Condition)))return s.accept(this,t)}if(0===i.length)return e.fallback.accept(this,t);i.length!==e.branches.length&&(r=!0),i.forEach((e=>{const i=e[1].accept(this,t);i!==e[1]&&(r=!0),e[1]=i}));const a=e.fallback.accept(this,t);return a!==e.fallback&&(r=!0),r?new n.CaseExpr(i,a):e}visitStepExpr(e,t){const i=e.input.accept(this,t),r=e.defaultValue.accept(this,t),o=e.stops.map((([e,i])=>[e,i.accept(this,t)]));return new n.StepExpr(i,r,o)}visitInterpolateExpr(e,t){const i=e.input.accept(this,t),r=e.stops.map((([e,i])=>[e,i.accept(this,t)]));return new n.InterpolateExpr(e.mode,i,r)}}},69159:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprParser=void 0;const r=i(10643);var n,o;function a(e){switch(e){case n.Tab:case n.Lf:case n.Cr:case n.Space:return!0;default:return!1}}function s(e){return e>=n._0&&e<=n._9}function l(e){return e>=n.a&&e<=n.z||e>=n.A&&e<=n.Z}function c(e){return function(e){return l(e)||s(e)}(e)||e===n._||e===n.Dollar||e===n.Dot||e===n.LBracket||e===n.RBracket}function u(e){switch(e){case o.Eof:return"eof";case o.Error:return"error";case o.Identifier:return"identifier";case o.Number:return"number";case o.String:return"string";case o.Comma:return",";case o.LParen:return"(";case o.RParen:return")";case o.LBracket:return"[";case o.RBracket:return"]";case o.Exclaim:return"!";case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";case o.BarBar:return"||";case o.AmpAmp:return"&&";default:throw new Error(`invalid token ${e}`)}}!function(e){e[e.Tab=9]="Tab",e[e.Lf=10]="Lf",e[e.Cr=13]="Cr",e[e.Space=32]="Space",e[e.LParen=40]="LParen",e[e.RParen=41]="RParen",e[e.Comma=44]="Comma",e[e.Dot=46]="Dot",e[e.LBracket=91]="LBracket",e[e.Backslash=92]="Backslash",e[e.RBracket=93]="RBracket",e[e._0=48]="_0",e[e._9=57]="_9",e[e._=95]="_",e[e.A=64]="A",e[e.Z=90]="Z",e[e.a=97]="a",e[e.z=122]="z",e[e.DoubleQuote=34]="DoubleQuote",e[e.SingleQuote=39]="SingleQuote",e[e.Exclaim=33]="Exclaim",e[e.Equal=61]="Equal",e[e.Caret=94]="Caret",e[e.Tilde=126]="Tilde",e[e.Dollar=36]="Dollar",e[e.Less=60]="Less",e[e.Greater=62]="Greater",e[e.Bar=124]="Bar",e[e.Amp=38]="Amp"}(n||(n={})),function(e){e[e.Eof=0]="Eof",e[e.Error=1]="Error",e[e.Identifier=2]="Identifier",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Comma=5]="Comma",e[e.LParen=6]="LParen",e[e.RParen=7]="RParen",e[e.LBracket=8]="LBracket",e[e.RBracket=9]="RBracket",e[e.Exclaim=10]="Exclaim",e[e.TildeEqual=11]="TildeEqual",e[e.CaretEqual=12]="CaretEqual",e[e.DollarEqual=13]="DollarEqual",e[e.EqualEqual=14]="EqualEqual",e[e.ExclaimEqual=15]="ExclaimEqual",e[e.Less=16]="Less",e[e.Greater=17]="Greater",e[e.LessEqual=18]="LessEqual",e[e.GreaterEqual=19]="GreaterEqual",e[e.BarBar=20]="BarBar",e[e.AmpAmp=21]="AmpAmp"}(o||(o={}));class d{constructor(e){this.code=e,this.m_token=o.Error,this.m_index=0,this.m_char=n.Lf}token(){return this.m_token}text(){var e;return null!==(e=this.m_text)&&void 0!==e?e:""}next(){if(this.m_token=this.yylex(),this.m_token===o.Error)throw new Error(`unexpected character ${this.m_char}`);return this.m_token}yyinp(){var e;this.m_char=null!==(e=this.code.codePointAt(this.m_index++))&&void 0!==e?e:0}yylex(){for(this.m_text=void 0;a(this.m_char);)this.yyinp();if(0===this.m_char)return o.Eof;const e=this.m_char;switch(this.yyinp(),e){case n.LParen:return o.LParen;case n.RParen:return o.RParen;case n.LBracket:return o.LBracket;case n.RBracket:return o.RBracket;case n.Comma:return o.Comma;case n.SingleQuote:case n.DoubleQuote:{const t=this.m_index-1;for(;this.m_char&&this.m_char!==e;)this.yyinp();if(this.m_char!==e)throw new Error("Unfinished string literal");return this.yyinp(),this.m_text=this.code.substring(t,this.m_index-2),o.String}case n.Exclaim:return this.m_char===n.Equal?(this.yyinp(),o.ExclaimEqual):o.Exclaim;case n.Caret:return this.m_char===n.Equal?(this.yyinp(),o.CaretEqual):o.Error;case n.Tilde:return this.m_char===n.Equal?(this.yyinp(),o.TildeEqual):o.Error;case n.Equal:return this.m_char===n.Equal?(this.yyinp(),o.EqualEqual):o.Error;case n.Less:return this.m_char===n.Equal?(this.yyinp(),o.LessEqual):o.Less;case n.Greater:return this.m_char===n.Equal?(this.yyinp(),o.GreaterEqual):o.Greater;case n.Bar:return this.m_char===n.Bar?(this.yyinp(),o.BarBar):o.Error;case n.Amp:return this.m_char===n.Amp?(this.yyinp(),o.AmpAmp):o.Error;default:{const t=this.m_index-2;if(l(e)||e===n._||e===n.Dollar&&c(this.m_char)){for(;c(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Identifier}if(s(e)){for(;s(this.m_char);)this.yyinp();if(this.m_char===n.Dot)for(this.yyinp();s(this.m_char);)this.yyinp();return this.m_text=this.code.substring(t,this.m_index-1),o.Number}if(e===n.Dollar)return this.m_char===n.Equal?(this.yyinp(),o.DollarEqual):o.Error}}return o.Error}}function h(e){switch(e){case o.TildeEqual:return"~=";case o.CaretEqual:return"^=";case o.DollarEqual:return"$=";case o.EqualEqual:return"==";case o.ExclaimEqual:return"!=";default:return}}function m(e){switch(e){case o.Less:return"<";case o.Greater:return">";case o.LessEqual:return"<=";case o.GreaterEqual:return">=";default:return}}t.ExprParser=class{constructor(e){this.lex=new d(e),this.lex.next()}parse(){return this.parseLogicalOr()}yyexpect(e){if(this.lex.token()!==e)throw new Error(`Syntax error: Expected token '${u(e)}' but found '${u(this.lex.token())}'`);this.lex.next()}parsePrimary(){switch(this.lex.token()){case o.Identifier:{const e=this.lex.text();switch(e){case"has":this.lex.next(),this.yyexpect(o.LParen);const t=this.lex.text();return this.yyexpect(o.Identifier),this.yyexpect(o.RParen),new r.HasAttributeExpr(t);case"length":this.lex.next(),this.yyexpect(o.LParen);const i=this.parseLogicalOr();return this.yyexpect(o.RParen),new r.CallExpr("length",[i]);default:const n=new r.VarExpr(e);return this.lex.next(),n}}case o.LParen:{this.lex.next();const e=this.parseLogicalOr();return this.yyexpect(o.RParen),e}default:return this.parseLiteral()}}parseLiteral(){switch(this.lex.token()){case o.Number:{const e=new r.NumberLiteralExpr(parseFloat(this.lex.text()));return this.lex.next(),e}case o.String:{const e=new r.StringLiteralExpr(this.lex.text());return this.lex.next(),e}default:throw new Error("Syntax error")}}parseUnary(){return this.lex.token()===o.Exclaim?(this.lex.next(),new r.CallExpr("!",[this.parseUnary()])):this.parsePrimary()}parseRelational(){let e=this.parseUnary();for(;;)if(this.lex.token()===o.Identifier&&"in"===this.lex.text()){this.lex.next(),this.yyexpect(o.LBracket);const t=[this.parseLiteral()];for(;this.lex.token()===o.Comma;)this.lex.next(),t.push(this.parseLiteral());this.yyexpect(o.RBracket),e=new r.CallExpr("in",[e,r.LiteralExpr.fromValue(t.map((({value:e})=>e)))])}else{const t=m(this.lex.token());if(void 0===t)break;this.lex.next();const i=this.parseUnary();e=new r.CallExpr(t,[e,i])}return e}parseEquality(){let e=this.parseRelational();for(;;){let t=h(this.lex.token());if(void 0===t)break;"~="===t&&(t="in"),this.lex.next();const i=this.parseRelational();e=new r.CallExpr(t,[e,i])}return e}parseLogicalAnd(){const e=this.parseEquality();if(this.lex.token()!==o.AmpAmp)return e;const t=[e];do{this.lex.next(),t.push(this.parseEquality())}while(this.lex.token()===o.AmpAmp);return new r.CallExpr("all",t)}parseLogicalOr(){const e=this.parseLogicalAnd();if(this.lex.token()!==o.BarBar)return e;const t=[e];do{this.lex.next(),t.push(this.parseLogicalAnd())}while(this.lex.token()===o.BarBar);return new r.CallExpr("any",t)}}},330:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExprPool=void 0;const r=i(10643);t.ExprPool=class{constructor(){this.m_booleanLiterals=new Map,this.m_numberLiterals=new Map,this.m_stringLiterals=new Map,this.m_objectLiterals=new Map,this.m_arrayLiterals=[],this.m_varExprs=new Map,this.m_hasAttributeExprs=new Map,this.m_matchExprs=[],this.m_caseExprs=[],this.m_interpolateExprs=[],this.m_stepExprs=[],this.m_callExprs=new Map}add(e){return e.accept(this,void 0)}visitNullLiteralExpr(e,t){return r.NullLiteralExpr.instance}visitBooleanLiteralExpr(e,t){return this.m_booleanLiterals.get(e.value)||(this.m_booleanLiterals.set(e.value,e),e)}visitNumberLiteralExpr(e,t){return this.m_numberLiterals.get(e.value)||(this.m_numberLiterals.set(e.value,e),e)}visitStringLiteralExpr(e,t){return this.m_stringLiterals.get(e.value)||(this.m_stringLiterals.set(e.value,e),e)}visitObjectLiteralExpr(e,t){const i=this.m_objectLiterals.get(e.value);if(i)return i;if(Array.isArray(e.value)){const t=e.value,i=this.m_arrayLiterals.find((e=>{const i=e.value;return i.length===t.length&&t.every(((e,t)=>e===i[t]))}));if(void 0!==i)return i;this.m_arrayLiterals.push(e)}return this.m_objectLiterals.set(e.value,e),e}visitVarExpr(e,t){return this.m_varExprs.get(e.name)||(this.m_varExprs.set(e.name,e),e)}visitHasAttributeExpr(e,t){return this.m_hasAttributeExprs.get(e.name)||(this.m_hasAttributeExprs.set(e.name,e),e)}visitMatchExpr(e,t){const i=e.value.accept(this,t),n=e.branches.map((([e,i])=>[e,i.accept(this,t)])),o=e.fallback.accept(this,t);for(const e of this.m_matchExprs){if(e.value!==i)continue;if(e.fallback!==o)continue;if(e.branches.length!==n.length)continue;let t=!0;for(let i=0;i<n.length;i++)if(n[i][0]!==e.branches[i][0]||n[i][1]!==e.branches[i][1]){t=!1;break}if(t)return e}const a=new r.MatchExpr(i,n,o);return this.m_matchExprs.push(a),a}visitCaseExpr(e,t){const i=e.branches.map((([e,i])=>[e.accept(this,t),i.accept(this,t)])),n=e.fallback.accept(this,t);for(const e of this.m_caseExprs){if(e.fallback!==n)continue;if(e.branches.length!==i.length)continue;let t=!0;for(let r=0;r<i.length;r++)if(i[r][0]!==e.branches[r][0]||i[r][1]!==e.branches[r][1]){t=!1;break}if(t)return e}const o=new r.CaseExpr(i,n);return this.m_caseExprs.push(o),o}visitCallExprImpl(e,t,i){const r=e.args.map((e=>e.accept(this,t)));this.m_callExprs.has(e.op)||this.m_callExprs.set(e.op,[]);const n=this.m_callExprs.get(e.op);for(const e of n){if(e.args.length!==r.length)continue;let t=0;for(;t<e.args.length&&e.args[t]===r[t];++t);if(t===e.args.length)return e}const o=i(e.op,r);return o.descriptor=e.descriptor,n.push(o),o}visitCallExpr(e,t){return this.visitCallExprImpl(e,t,((e,t)=>new r.CallExpr(e,t)))}visitLookupExpr(e,t){return this.visitCallExprImpl(e,t,((e,t)=>new r.LookupExpr(t)))}visitStepExpr(e,t){if(this.m_stepExprs.includes(e))return e;const i=e.input.accept(this,t),n=e.defaultValue.accept(this,t),o=e.stops.map((e=>{const i=e[0],r=e[1].accept(this,t);return r===e[1]?e:[i,r]}));for(const e of this.m_stepExprs)if(e.input===i&&e.defaultValue===n&&o.length===e.stops.length&&o.every((([t,i],r)=>t===e.stops[r][0]&&i===e.stops[r][1])))return e;const a=new r.StepExpr(i,n,o);return this.m_stepExprs.push(a),a}visitInterpolateExpr(e,t){if(this.m_interpolateExprs.includes(e))return e;const i=e.input.accept(this,t),n=e.stops.map((e=>{const i=e[0],r=e[1].accept(this,t);return r===e[1]?e:[i,r]}));for(const t of this.m_interpolateExprs)if(t.input===i&&t.mode[0]===e.mode[0]&&t.mode[1]===e.mode[1]&&n.length===t.stops.length&&n.every((([e,i],r)=>e===t.stops[r][0]&&i===t.stops[r][1])))return t;const o=new r.InterpolateExpr(e.mode,i,n);return this.m_interpolateExprs.push(o),o}}},73636:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFeatureGeometry=void 0,t.isFeatureGeometry=function(e){const t=e.type;return"Point"===t||"MultiPoint"===t||"LineString"===t||"MultiLineString"===t||"Polygon"===t||"MultiPolygon"===t}},8002:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},58696:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},52867:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8420:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.interpolatedPropertyDefinitionToJsonExpr=t.isInterpolatedPropertyDefinition=t.InterpolationMode=void 0,(i=t.InterpolationMode||(t.InterpolationMode={}))[i.Discrete=0]="Discrete",i[i.Linear=1]="Linear",i[i.Cubic=2]="Cubic",i[i.Exponential=3]="Exponential",t.isInterpolatedPropertyDefinition=function(e){return!!(e&&void 0===e.interpolationMode&&Array.isArray(e.values)&&e.values.length>0&&void 0!==e.values[0]&&Array.isArray(e.zoomLevels)&&e.zoomLevels.length>0&&void 0!==e.zoomLevels[0]&&e.values.length===e.zoomLevels.length)},t.interpolatedPropertyDefinitionToJsonExpr=function(e){if(void 0===e.interpolation||"Discrete"===e.interpolation){const t=["step",["zoom"],e.values[0]];for(let i=1;i<e.zoomLevels.length;++i)t.push(e.zoomLevels[i],e.values[i]);return t}const t=["interpolate"];switch(e.interpolation){case"Linear":t.push(["linear"]);break;case"Cubic":t.push(["cubic"]);break;case"Exponential":t.push(["exponential",void 0!==e.exponent?e.exponent:2]);break;default:throw new Error(`interpolation mode '${e.interpolation}' is not supported`)}t.push(["zoom"]);for(let i=0;i<e.zoomLevels.length;++i)t.push(e.zoomLevels[i],e.values[i]);return t}},40661:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPolygonEdges=void 0;const r=i(84428),n=new r.Vector2,o=new r.Vector2,a=new r.Vector2,s=new r.Vector2;t.addPolygonEdges=function(e,t,i,r,l,c,u,d){for(let h=0;h<l.length;++h)if(l[h])if(!0===c){const c=t+2*h,m=c+1,p=t+(h+1)%l.length*2,f=p+1;!0===u&&e.push(c,p),e.push(m,f);const g=(0===h?l.length:h)-1;if(l[g])if(void 0!==d){const t=r[h*i],u=r[h*i+1],p=r[(h+1)%l.length*i],f=r[(h+1)%l.length*i+1];n.set(t,u),o.set(p,f),a.set(r[g*i],r[g*i+1]),s.set(n.x,n.y),s.sub(a).normalize().dot(o.sub(n).normalize())<=d&&e.push(c,m)}else e.push(c,m)}else{const i=t+h,r=t+(h+1)%l.length;e.push(i,r)}}},53076:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pixels=void 0;const i=/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))px$/;class r{constructor(e){this.value=e}static parse(e){const t=i.exec(e);if(null!==t)return new r(Number(t[1]))}toJSON(){return`${this.value}px`}}t.Pixels=r},55954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},65187:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPropertyValue=void 0;const r=i(38338),n=i(10643),o=i(53076),a=i(73644),s=i(26244),l=r.LoggerManager.instance.create("PropertyValue");t.getPropertyValue=function(e,t,i){var r,c,u;if(n.Expr.isExpr(e))try{let s=e.evaluate(t,n.ExprScope.Dynamic,i);return"string"==typeof s&&(s=null!==(c=null!==(r=a.RGBA.parse(s))&&void 0!==r?r:o.Pixels.parse(s))&&void 0!==c?c:s),s instanceof a.RGBA?s.getHex():s instanceof o.Pixels?s.value*(null!==(u=Number(t.lookup("$pixelToMeters")))&&void 0!==u?u:1):s}catch(t){return l.error("failed to evaluate expression",JSON.stringify(e),"error",String(t)),null}if(null==e)return null;if("string"!=typeof e)return e;{const i=t.lookup("$pixelToMeters")||1,r=s.parseStringEncodedNumeral(e,i);return void 0!==r?r:e}}},73644:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RGBA=void 0;const r=i(84428),n=i(90991),o=i(26244);class a{constructor(e=1,t=1,i=1,r=1){this.r=e,this.g=t,this.b=i,this.a=r}static parse(e){const t=o.parseStringEncodedColor(e);if(void 0!==t)return n.ColorUtils.getRgbaFromHex(t)}clone(){return new a(this.r,this.g,this.b,this.a)}getHex(){return n.ColorUtils.getHexFromRgba(this.r,this.g,this.b,this.a)}lerp(e,t){return this.r=r.MathUtils.lerp(this.r,e.r,t),this.g=r.MathUtils.lerp(this.g,e.g,t),this.b=r.MathUtils.lerp(this.b,e.b,t),this.a=r.MathUtils.lerp(this.a,e.a,t),this}toJSON(){return`rgba(${255*this.r<<0}, ${255*this.g<<0}, ${255*this.b<<0}, ${this.a})`}}t.RGBA=a},26244:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStringEncodedColor=t.parseStringEncodedNumeral=t.StringEncodedNumeralFormatMaxSize=t.StringEncodedNumeralFormats=t.StringEncodedColorFormats=t.StringEncodedMetricFormats=t.StringEncodedNumeralType=void 0;const r=i(38338),n=i(45694),o=i(90991);var a;!function(e){e[e.Meters=0]="Meters",e[e.Pixels=1]="Pixels",e[e.Hex=2]="Hex"}(a=t.StringEncodedNumeralType||(t.StringEncodedNumeralType={}));const s={type:a.Meters,size:1,regExp:/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))m$/,decoder:(e,t)=>{const i=s.regExp.exec(e);return!!i&&void 0!==(t[0]=Number(i[1]))}},l={type:a.Pixels,size:1,mask:1,regExp:/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*))px$/,decoder:(e,t)=>{const i=l.regExp.exec(e);return null!==i&&(t[0]=Number(i[1]),!0)}},c={type:a.Hex,size:4,regExp:/^\#((?:[0-9A-Fa-f][0-9A-Fa-f]){4}|[0-9A-Fa-f]{4})$/,decoder:(e,t)=>{const i=c.regExp.exec(e);if(null===i)return!1;const n=i[1],o=n.length;return r.assert(4===o||8===o,"Matched incorrect hex color format"),4===o?(t[0]=parseInt(n.charAt(0)+n.charAt(0),16)/255,t[1]=parseInt(n.charAt(1)+n.charAt(1),16)/255,t[2]=parseInt(n.charAt(2)+n.charAt(2),16)/255,t[3]=4===o?parseInt(n.charAt(3)+n.charAt(3),16)/255:1):8===o&&(t[0]=parseInt(n.charAt(0)+n.charAt(1),16)/255,t[1]=parseInt(n.charAt(2)+n.charAt(3),16)/255,t[2]=parseInt(n.charAt(4)+n.charAt(5),16)/255,t[3]=8===o?parseInt(n.charAt(6)+n.charAt(7),16)/255:1),!0}};t.StringEncodedMetricFormats=[s,l];const u=t.StringEncodedMetricFormats.reduce(((e,t)=>Math.max(e,t.size)),0);t.StringEncodedColorFormats=[c];const d=t.StringEncodedColorFormats.reduce(((e,t)=>Math.max(e,t.size)),0);t.StringEncodedNumeralFormats=[...t.StringEncodedMetricFormats,...t.StringEncodedColorFormats],t.StringEncodedNumeralFormatMaxSize=Math.max(d,u);const h=new Array(t.StringEncodedNumeralFormatMaxSize);function m(e,t,i=1){const r=t.find((t=>!!t.decoder(e,h)));if(void 0===r){const t=n.parseCSSColor(e);return Array.isArray(t)&&!t.some((e=>isNaN(e)))?o.ColorUtils.getHexFromRgba(t[0]/255,t[1]/255,t[2]/255,t[3]):void 0}switch(null==r?void 0:r.type){case a.Pixels:return h[0]*i;case a.Hex:return o.ColorUtils.getHexFromRgba(h[0],h[1],h[2],h[3]);default:return h[0]}}t.parseStringEncodedNumeral=function(e,i=1){return m(e,t.StringEncodedNumeralFormats,i)},t.parseStringEncodedColor=function(e){return m(e,t.StringEncodedColorFormats)}},64670:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeDecodedTechnique=t.StyleSetEvaluator=void 0;const r=i(38338),n=i(10643),o=i(330),a=i(8420),s=i(21120),l=i(68615),c=r.LoggerManager.instance.create("StyleSetEvaluator"),u=s.AttrScope.TechniqueGeometry;class d{classify(e){if(e._whenExpr){const t=this.switchStyle(e);e._whenExpr=e._whenExpr.accept(this,void 0),this._style=t}}visitNullLiteralExpr(e,t){return e}visitBooleanLiteralExpr(e,t){return e}visitNumberLiteralExpr(e,t){return e}visitStringLiteralExpr(e,t){return e}visitObjectLiteralExpr(e,t){return e}visitVarExpr(e,t){return e}visitHasAttributeExpr(e,t){return e}visitMatchExpr(e,t){return e}visitCaseExpr(e,t){return e}visitCallExpr(e,t){if("all"===e.op){const t=e.args.map((t=>t.accept(this,e))).filter((e=>void 0!==e));return new n.CallExpr(e.op,t)}if(t){const t=this.matchVarStringComparison(e);if(t){if(void 0===this._style.layer&&"$layer"===t.name)return void(this._style.layer=t.value);if(void 0===this._style._geometryType&&"$geometryType"===t.name)return void(this._style._geometryType=t.value)}}return e}visitLookupExpr(e,t){return this.visitCallExpr(e,t)}visitStepExpr(e,t){return e}visitInterpolateExpr(e,t){return e}matchVarStringComparison(e){if("=="===e.op){const t=e.args[0],i=e.args[1];if(t instanceof n.VarExpr&&i instanceof n.StringLiteralExpr)return{name:t.name,value:i.value};if(i instanceof n.VarExpr&&t instanceof n.StringLiteralExpr)return{name:i.name,value:t.value}}}switchStyle(e){const t=this._style;return this._style=e,t}}class h{constructor(e,t){this.key="",this.set(e,t)}set(e,t,i){let r=!1;if(void 0===e){const t=void 0!==i?i.lookup("$layer"):void 0;e="string"==typeof t?t:void 0}if(this.layer!==e&&(this.layer=e,r=!0),void 0===t){const e=void 0!==i?i.lookup("$geometryType"):void 0;t="string"==typeof e?e:void 0}return this.geometryType!==t&&(this.geometryType=t,r=!0),r&&this.updateKey(),this}updateKey(){void 0!==this.layer?void 0!==this.geometryType?this.key=`${this.layer}:${this.geometryType}`:this.key=`${this.layer}:`:void 0!==this.geometryType?this.key=`:${this.geometryType}`:this.key="all",this.cachedStyleSet=void 0}}function m(e){const t={};for(const i in e){if(!e.hasOwnProperty(i))continue;let r=e[i];"object"==typeof r&&(r.isVector2||r.isVector3||r.isVector4)&&(r=n.LiteralExpr.fromValue(r)),n.Expr.isExpr(r)&&(r=r.toJSON()),t[i]=r}return t}t.StyleSetEvaluator=class{constructor(e){var t;this.m_options=e,this.m_techniques=[],this.m_exprPool=new o.ExprPool,this.m_cachedResults=new Map,this.m_styleConditionClassifier=new d,this.m_subStyleSetCache=new Map,this.m_definitionExprCache=new Map,this.m_tmpOptimizedSubSetKey=new h,this.m_emptyEnv=new n.Env,this.m_featureDependencies=[],this.m_nextArrayBufferId=0,this.m_definitions=this.m_options.definitions,this.styleSet=(t=this.m_options.styleSet,this.m_definitions,t.map((e=>function(e,t){return Object.assign({},e)}(e)))),function(e){let t=0,i=0;for(const r of e)r._styleSetIndex=i++,void 0!==r.technique&&void 0===r.renderOrder&&(r.renderOrder=t++)}(this.styleSet),this.compileStyleSet()}getMatchingTechniques(e,t,i){if(this.m_previousResult&&this.m_previousEnv&&this.m_featureDependencies.every((t=>{var i;return(null===(i=this.m_previousEnv)||void 0===i?void 0:i.lookup(t))===e.lookup(t)})))return this.m_previousResult;const r=[];this.m_cachedResults.clear();const n=this.m_tmpOptimizedSubSetKey;n.set(t,i,e),this.m_layer=n.layer,this.m_geometryType=n.geometryType,this.m_zoomLevel=e.lookup("$zoom");const o=this.getOptimizedStyleSet(n);for(const t of o)if(this.processStyle(e,t,r))break;return this.m_previousResult=r,this.m_previousEnv=e,r}wantsLayer(e){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,void 0)).length>0}wantsFeature(e,t){return this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e,t)).length>0}resetTechniques(){for(const e of this.m_techniques)e._index=void 0;this.m_techniques.length=0,this.m_previousResult=void 0,this.m_previousEnv=void 0}get techniques(){return this.m_techniques}get decodedTechniques(){return this.m_techniques.map(m)}getOptimizedStyleSet(e){if(void 0!==e.cachedStyleSet)return e.cachedStyleSet;let t=this.m_subStyleSetCache.get(e.key);return void 0!==t?(e.cachedStyleSet=t,t):(t=this.createPreFilteredStyleSet(e),this.m_subStyleSetCache.set(e.key,t),e.cachedStyleSet=t,t)}createPreFilteredStyleSet(e){const{layer:t,geometryType:i}=e;return this.styleSet.filter((e=>!(void 0!==t&&void 0!==e.layer&&e.layer!==t||void 0!==i&&void 0!==e._geometryType&&e._geometryType!==i)))}compileStyleSet(){this.m_featureDependencies=["$layer","$geometryType","$zoom"],this.styleSet.forEach((e=>this.compileStyle(e))),this.styleSet.forEach((e=>{this.getOptimizedStyleSet(this.m_tmpOptimizedSubSetKey.set(e.layer,e._geometryType))}))}compileStyle(e){if(this.checkStyleDynamicAttributes(e),void 0!==e.when)try{e._whenExpr=Array.isArray(e.when)?n.Expr.fromJSON(e.when,this.m_definitions,this.m_definitionExprCache):n.Expr.parse(e.when),this.m_styleConditionClassifier.classify(e),void 0!==e._whenExpr&&(e._whenExpr=e._whenExpr.intern(this.m_exprPool));const t=e._whenExpr.dependencies();null==t||t.properties.forEach((e=>{this.m_featureDependencies.includes(e)||this.m_featureDependencies.push(e)})),n.isJsonExpr(e.minZoomLevel)&&(e._minZoomLevelExpr=n.Expr.fromJSON(e.minZoomLevel,this.m_definitions).intern(this.m_exprPool)),n.isJsonExpr(e.maxZoomLevel)&&(e._maxZoomLevelExpr=n.Expr.fromJSON(e.maxZoomLevel,this.m_definitions).intern(this.m_exprPool))}catch(t){c.log("failed to evaluate expression",JSON.stringify(e.when),"error",String(t))}}processStyle(e,t,i){if(!this.checkZoomLevel(e,t))return!1;if(void 0!==this.m_layer&&void 0!==t.layer&&t.layer!==this.m_layer)return!1;if(void 0!==this.m_geometryType&&void 0!==t._geometryType&&t._geometryType!==this.m_geometryType)return!1;if(t._whenExpr)try{if(!t._whenExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults))return!1}catch(e){return c.error(`failed to evaluate expression '${JSON.stringify(t.when)}': ${e}`),!1}return void 0!==t.technique&&("none"!==t.technique&&i.push(this.getTechniqueForStyleMatch(e,t)),!0===t.final)}checkZoomLevel(e,t){var i,r;if(void 0===t.minZoomLevel&&void 0===t.maxZoomLevel)return!0;const o=this.m_zoomLevel;if(void 0===o)return!0;if(void 0!==t.minZoomLevel){let r=t.minZoomLevel;if(!1===(null===(i=t._minZoomLevelExpr)||void 0===i?void 0:i.isDynamic()))try{r=t._minZoomLevelExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults)}catch(e){c.error(`failed to evaluate expression '${JSON.stringify(t._minZoomLevelExpr)}': ${e}`)}if("number"==typeof r&&o<r)return!1}if(void 0!==t.maxZoomLevel){let i=t.maxZoomLevel;if(!1===(null===(r=t._maxZoomLevelExpr)||void 0===r?void 0:r.isDynamic()))try{i=t._maxZoomLevelExpr.evaluate(e,n.ExprScope.Condition,this.m_cachedResults)}catch(e){c.error(`failed to evaluate expression '${JSON.stringify(t._maxZoomLevelExpr)}': ${e}`)}if("number"==typeof i&&o>=i)return!1}return!0}getTechniqueForStyleMatch(e,t){let i;if(void 0!==t._dynamicTechniques){const r=this.evaluateTechniqueProperties(t,e),n=this.getDynamicTechniqueKey(t,r);i=t._dynamicTechniques.get(n),void 0===i&&(i=this.createTechnique(t,n,r),t._dynamicTechniques.set(n,i))}else i=t._staticTechnique,void 0===i&&(t._staticTechnique=i=this.createTechnique(t,`${t._styleSetIndex}`,[]));return void 0===i._index&&(i._index=this.m_techniques.length,this.m_techniques.push(i)),i}getDynamicTechniqueKey(e,t){const i=t.map((([e,t])=>void 0===t?"U":"object"==typeof t?JSON.stringify(t,((e,t)=>{if(t instanceof ArrayBuffer){let e=t.id;return void 0===e&&(e=t.id=this.m_nextArrayBufferId++),e}return t})):JSON.stringify(t))).join(":");return`${e._styleSetIndex}:${i}`}checkStyleDynamicAttributes(e){var t;if(void 0!==e._dynamicTechniqueAttributes||"none"===e.technique)return;e._dynamicTechniqueAttributes=[],e._dynamicFeatureAttributes=[],e._dynamicForwardedAttributes=[],e._staticAttributes=[];const i=e._dynamicFeatureAttributes,r=e._dynamicTechniqueAttributes,o=e._dynamicForwardedAttributes,l=e._staticAttributes,d=(t,d)=>{if(void 0!==d){if(n.isJsonExpr(d)?d=n.Expr.fromJSON(d,this.m_definitions,this.m_definitionExprCache).intern(this.m_exprPool):a.isInterpolatedPropertyDefinition(d)&&(d=n.Expr.fromJSON(a.interpolatedPropertyDefinitionToJsonExpr(d)).intern(this.m_exprPool)),n.Expr.isExpr(d)){const i=d.dependencies();i.featureState&&("enabled"!==t?c.log("feature-state is not supported in this context"):e._usesFeatureState=!0),0!==i.properties.size||d.isDynamic()||(d=d.evaluate(this.m_emptyEnv))}if(n.Expr.isExpr(d)){const n=function(e,t){var i,r;return"extruded-polygon"===e.technique&&"color"===t&&!1!==e.vertexColors?u:null!==(r=null===(i=s.getTechniqueAttributeDescriptor(e.technique,t))||void 0===i?void 0:i.scope)&&void 0!==r?r:u}(e,t),a=d.dependencies();switch(a.properties.forEach((e=>{this.m_featureDependencies.includes(e)||this.m_featureDependencies.push(e)})),n){case s.AttrScope.FeatureGeometry:i.push([t,d]);break;case s.AttrScope.TechniqueGeometry:r.push([t,d]);break;case s.AttrScope.TechniqueRendering:0===a.properties.size?o.push([t,d]):r.push([t,d])}}else null!=d&&l.push([t,d])}},h=new Map([["category","_category"],["secondaryCategory","_secondaryCategory"]]);for(const i in e)e.hasOwnProperty(i)&&(i.startsWith("_")||["when","technique","layer","attr","description"].includes(i)||d(null!==(t=h.get(i))&&void 0!==t?t:i,e[i]));if(void 0!==e.attr)for(const t in e.attr)e.attr.hasOwnProperty(t)&&d(t,e.attr[t]);r.length>0&&(e._dynamicTechniques=new Map)}evaluateTechniqueProperties(e,t){return void 0===e._dynamicTechniqueAttributes?[]:e._dynamicTechniqueAttributes.map((([e,i])=>{try{return[e,i.evaluate(t,n.ExprScope.Value,this.m_cachedResults)]}catch(t){return c.error(`failed to evaluate expression '${i.toJSON()}': ${t}`),[e,null]}}))}createTechnique(e,t,i){var r,n;const o={};if(o.name=e.technique,void 0!==e._staticAttributes)for(const[t,i]of e._staticAttributes)null!==i&&(o[t]=i);for(const[e,t]of i)null!==t&&(o[e]=t);if(void 0!==e._dynamicFeatureAttributes)for(const[t,i]of e._dynamicFeatureAttributes)o[t]=i;if(void 0!==e._dynamicForwardedAttributes)for(const[t,i]of e._dynamicForwardedAttributes)o[t]=i;return o._index=this.m_techniques.length,o._styleSetIndex=e._styleSetIndex,void 0!==e.styleSet&&(o._styleSet=e.styleSet),void 0!==e._usesFeatureState&&(o._usesFeatureState=e._usesFeatureState),l.setTechniqueRenderOrderOrPriority(o,null!==(r=this.m_options.priorities)&&void 0!==r?r:[],null!==(n=this.m_options.labelPriorities)&&void 0!==n?n:[]),this.m_techniques.push(o),o}},t.makeDecodedTechnique=m},33189:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateTechniqueAttr=void 0;const r=i(10643),n=i(65187);t.evaluateTechniqueAttr=function(e,t,i){if(void 0===t)return i;const o=r.Env.isEnv(e)?n.getPropertyValue(t,e):n.getPropertyValue(t,e.env,e.cachedExprResults);return null!=o?o:i}},21120:(e,t)=>{"use strict";var i;function r(...e){const t={attrDescriptors:{}};for(const i of e)void 0!==i.attrTransparencyColor&&(t.attrTransparencyColor=i.attrTransparencyColor),void 0!==i.attrDescriptors&&(t.attrDescriptors=Object.assign(Object.assign({},t.attrDescriptors),i.attrDescriptors));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getTechniqueAutomaticAttrs=t.getTechniqueAttributeDescriptor=t.getTechniqueDescriptor=t.AttrScope=void 0,function(e){e[e.FeatureGeometry=0]="FeatureGeometry",e[e.TechniqueGeometry=1]="TechniqueGeometry",e[e.TechniqueRendering=2]="TechniqueRendering"}(i=t.AttrScope||(t.AttrScope={}));const n={attrTransparencyColor:"color",attrDescriptors:{constantHeight:i.FeatureGeometry,enabled:i.FeatureGeometry,fadeFar:i.TechniqueRendering,fadeNear:i.TechniqueRendering,transparent:{scope:i.TechniqueRendering,automatic:!0},side:{scope:i.TechniqueRendering,automatic:!0}}},o=r(n,{attrDescriptors:{color:{scope:i.TechniqueRendering,automatic:!0},size:{scope:i.TechniqueRendering,automatic:!0},opacity:{scope:i.TechniqueRendering,automatic:!0}}}),a=r(n,o),s=r(n,o),l=r(n,{attrDescriptors:{text:i.FeatureGeometry,label:i.FeatureGeometry,useAbbreviation:i.FeatureGeometry,useIsoCode:i.FeatureGeometry,poiName:i.FeatureGeometry,imageTexture:i.FeatureGeometry,iconColor:i.TechniqueRendering,iconBrightness:i.TechniqueRendering,backgroundColor:i.TechniqueRendering,backgroundSize:i.TechniqueRendering,backgroundOpacity:i.TechniqueRendering,color:i.TechniqueRendering,opacity:i.TechniqueRendering,size:i.TechniqueRendering}}),c={attrDescriptors:{polygonOffset:{scope:i.TechniqueRendering,automatic:!0},polygonOffsetFactor:{scope:i.TechniqueRendering,automatic:!0},polygonOffsetUnits:{scope:i.TechniqueRendering,automatic:!0},depthTest:{scope:i.TechniqueRendering,automatic:!0},transparent:{scope:i.TechniqueRendering,automatic:!0},opacity:{scope:i.TechniqueRendering,automatic:!0},color:{scope:i.TechniqueRendering,automatic:!0},lineColor:i.TechniqueRendering,lineFadeFar:i.TechniqueRendering,lineFadeNear:i.TechniqueRendering}},u=r(n,c,{attrDescriptors:{lineWidth:i.TechniqueRendering,secondaryWidth:i.TechniqueRendering,secondaryColor:i.TechniqueRendering,dashSize:i.TechniqueRendering,gapSize:i.TechniqueRendering,outlineColor:{scope:i.TechniqueRendering,automatic:!0},caps:{scope:i.TechniqueRendering,automatic:!0},drawRangeStart:{scope:i.TechniqueRendering,automatic:!0},drawRangeEnd:{scope:i.TechniqueRendering,automatic:!0},dashes:{scope:i.TechniqueRendering,automatic:!0},dashColor:{scope:i.TechniqueRendering,automatic:!0}}}),d=r(n,{attrDescriptors:{color:{scope:i.TechniqueRendering,automatic:!0},opacity:{scope:i.TechniqueRendering,automatic:!0},lineWidth:i.FeatureGeometry}}),h=r(n,c,{attrDescriptors:{wireframe:{scope:i.TechniqueRendering,automatic:!0},color:{scope:i.TechniqueRendering,automatic:!0},opacity:{scope:i.TechniqueRendering,automatic:!0},transparent:{scope:i.TechniqueRendering,automatic:!0},lineWidth:i.TechniqueRendering,map:{scope:i.TechniqueRendering,automatic:!0}}}),m=r(n,{attrDescriptors:{color:{scope:i.TechniqueRendering,automatic:!0},vertexColors:{scope:i.TechniqueRendering,automatic:!0},wireframe:{scope:i.TechniqueRendering,automatic:!0},roughness:{scope:i.TechniqueRendering,automatic:!0},metalness:{scope:i.TechniqueRendering,automatic:!0},alphaTest:{scope:i.TechniqueRendering,automatic:!0},depthTest:{scope:i.TechniqueRendering,automatic:!0},transparent:{scope:i.TechniqueRendering,automatic:!0},opacity:{scope:i.TechniqueRendering,automatic:!0},emissive:{scope:i.TechniqueRendering,automatic:!0},emissiveIntensity:{scope:i.TechniqueRendering,automatic:!0},refractionRatio:{scope:i.TechniqueRendering,automatic:!0},normalMapType:{scope:i.TechniqueRendering,automatic:!0},map:{scope:i.TechniqueRendering,automatic:!0},normalMap:{scope:i.TechniqueRendering,automatic:!0},displacementMap:{scope:i.TechniqueRendering,automatic:!0},roughnessMap:{scope:i.TechniqueRendering,automatic:!0},emissiveMap:{scope:i.TechniqueRendering,automatic:!0},bumpMap:{scope:i.TechniqueRendering,automatic:!0},metalnessMap:{scope:i.TechniqueRendering,automatic:!0},alphaMap:{scope:i.TechniqueRendering,automatic:!0}}}),p={"extruded-polygon":r(n,m,{attrDescriptors:{height:i.FeatureGeometry,floorHeight:i.FeatureGeometry,color:i.FeatureGeometry,defaultColor:i.FeatureGeometry,defaultHeight:i.FeatureGeometry,boundaryWalls:i.FeatureGeometry,footprint:i.FeatureGeometry,maxSlope:i.FeatureGeometry,animateExtrusion:i.TechniqueRendering,lineWidth:i.TechniqueRendering,lineFadeNear:i.TechniqueRendering,lineFadeFar:i.TechniqueRendering,lineColor:i.TechniqueRendering}}),"line-marker":l,"labeled-icon":l,"solid-line":u,"dashed-line":u,terrain:m,standard:m,squares:a,circles:s,line:d,segments:d,fill:h,text:r(n,{attrDescriptors:{text:i.FeatureGeometry,label:i.FeatureGeometry,useAbbreviation:i.FeatureGeometry,useIsoCode:i.FeatureGeometry,backgroundColor:i.TechniqueRendering,backgroundSize:i.TechniqueRendering,backgroundOpacity:i.TechniqueRendering,color:i.TechniqueRendering,opacity:i.TechniqueRendering,priority:i.TechniqueRendering,size:i.TechniqueRendering}}),shader:r(n,{attrDescriptors:{params:i.TechniqueRendering}})};function f(e){return"string"!=typeof e&&(e=e.name),p[e]}t.getTechniqueDescriptor=f,t.getTechniqueAttributeDescriptor=function(e,t){const i=f(e),r=null==i?void 0:i.attrDescriptors,n=null==r?void 0:r[t];if(void 0!==typeof n)return"object"==typeof n?n:{scope:n}};const g=new Map;t.getTechniqueAutomaticAttrs=function(e){var t;if("string"!=typeof e&&(e=e.name),g.has(e))return g.get(e);const i=[],r=null===(t=f(e))||void 0===t?void 0:t.attrDescriptors;if(void 0===r)return i;for(const e in r){if(!r.hasOwnProperty(e))continue;const t=r[e];void 0!==t&&"number"!=typeof t&&!0===t.automatic&&i.push(e)}return g.set(e,i),i}},8775:(e,t)=>{"use strict";var i,r,n,o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.isTextureBuffer=t.PlacementToken=t.transientToPickability=t.Pickability=t.PoiStackMode=t.TextureCoordinateType=t.GeometryKindSet=t.GeometryKind=t.StandardGeometryKind=void 0,function(e){e.All="_all_",e.Background="background",e.Terrain="terrain",e.Area="area",e.Line="line",e.Water="water",e.Border="border",e.Road="road",e.Building="building",e.Label="label",e.Detail="detail"}(i=t.StandardGeometryKind||(t.StandardGeometryKind={})),t.GeometryKind=i;class s extends Set{isSuperset(e){for(const t of e)if(!this.has(t))return!1;return!0}hasIntersection(e){for(const t of e)if(this.has(t))return!0;return!1}hasOrIntersects(e){return e instanceof Set?this.hasIntersection(e):this.has(e)}hasOrIntersectsArray(e){for(const t of e)if(this.has(t))return!0;return!1}}t.GeometryKindSet=s,(a=t.TextureCoordinateType||(t.TextureCoordinateType={})).TileSpace="tile-space",a.EquirectangularSpace="equirectangular-space",a.FeatureSpace="feature-space",(o=t.PoiStackMode||(t.PoiStackMode={})).Show="show-in-stack",o.Hide="hide-in-stack",o.ShowParent="show-parent",function(e){e.onlyVisible="only-visible",e.transient="transient",e.all="all"}(r=t.Pickability||(t.Pickability={})),t.transientToPickability=function(e){let t=r.onlyVisible;return null!=e&&(t="string"==typeof e?e:!0===e?r.transient:r.onlyVisible),t},(n=t.PlacementToken||(t.PlacementToken={})).TopLeft="TL",n.Top="T",n.TopRight="TR",n.Right="R",n.BottomRight="BR",n.Bottom="B",n.BottomLeft="BL",n.Left="L",n.Center="C",n.NorthWest="NW",n.North="N",n.NorthEast="NE",n.East="E",n.SouthEast="SE",n.South="S",n.SouthWest="SW",n.West="W",t.isTextureBuffer=function(e){return e&&e.buffer&&"string"==typeof e.type}},68615:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTechniqueRenderOrderOrPriority=t.composeTechniqueTextureName=t.addBuffersToTransferList=t.textureCoordinateType=t.supportsTextures=t.needsVertexNormals=t.isLabelRejectionLineTechnique=t.isShaderTechnique=t.isTextTechnique=t.isTerrainTechnique=t.isStandardTechnique=t.isExtrudedPolygonTechnique=t.isFillTechnique=t.isStandardExtrudedLineTechnique=t.isBasicExtrudedLineTechnique=t.isExtrudedLineTechnique=t.isSegmentsTechnique=t.isSpecialDashesLineTechnique=t.isSolidLineTechnique=t.isLineTechnique=t.isLineMarkerTechnique=t.isPoiTechnique=t.isSquaresTechnique=t.isCirclesTechnique=t.TRANSPARENCY_PROPERTY_KEYS=t.TEXTURE_PROPERTY_KEYS=void 0;const r=i(8775);function n(e){return"labeled-icon"===e.name}function o(e){return"line-marker"===e.name}function a(e){return"extruded-line"===e.name}function s(e){return a(e)&&"standard"===e.shading}function l(e){return"fill"===e.name}function c(e){return"extruded-polygon"===e.name}function u(e){return"standard"===e.name}function d(e){return"terrain"===e.name}function h(e){return"text"===e.name}function m(e){return"shader"===e.name}function p(e){return l(e)||u(e)||c(e)||d(e)}t.TEXTURE_PROPERTY_KEYS=["map","normalMap","displacementMap","roughnessMap","emissiveMap","alphaMap","metalnessMap","bumpMap"],t.TRANSPARENCY_PROPERTY_KEYS=["opacity","transparent"],t.isCirclesTechnique=function(e){return"circles"===e.name},t.isSquaresTechnique=function(e){return"squares"===e.name},t.isPoiTechnique=n,t.isLineMarkerTechnique=o,t.isLineTechnique=function(e){return"line"===e.name},t.isSolidLineTechnique=function(e){return"solid-line"===e.name||"dashed-line"===e.name},t.isSpecialDashesLineTechnique=function(e){return("solid-line"===e.name||"dashed-line"===e.name)&&void 0!==e.dashes&&"Square"!==e.dashes},t.isSegmentsTechnique=function(e){return"segments"===e.name},t.isExtrudedLineTechnique=a,t.isBasicExtrudedLineTechnique=function(e){return a(e)&&"basic"===e.shading},t.isStandardExtrudedLineTechnique=s,t.isFillTechnique=l,t.isExtrudedPolygonTechnique=c,t.isStandardTechnique=u,t.isTerrainTechnique=d,t.isTextTechnique=h,t.isShaderTechnique=m,t.isLabelRejectionLineTechnique=function(e){return"label-rejection-line"===e.name},t.needsVertexNormals=function(e){return c(e)||l(e)||u(e)||d(e)||s(e)},t.supportsTextures=p,t.textureCoordinateType=function(e){return p(e)||m(e)?e.textureCoordinateType:void 0},t.addBuffersToTransferList=function(e,i){if(u(e)||c(e)||d(e))for(const n of t.TEXTURE_PROPERTY_KEYS){const t=e[n];r.isTextureBuffer(t)&&t.buffer instanceof ArrayBuffer&&i.push(t.buffer)}},t.composeTechniqueTextureName=function(e,t){let i=e;return"string"==typeof t.imageTexturePrefix&&(i=t.imageTexturePrefix+i),"string"==typeof t.imageTexturePostfix&&(i+=t.imageTexturePostfix),i},t.setTechniqueRenderOrderOrPriority=function(e,t,i){if(h(e)||n(e)||o(e)){if(i&&"string"==typeof e._category){const t=i.indexOf(e._category);-1!==t&&(e.priority=i.length-t)}}else if(t&&void 0!==e._styleSet){const i=i=>{const r=null==t?void 0:t.findIndex((t=>t.group===e._styleSet&&t.category===i));return void 0!==r&&-1!==r?10*(r+1):void 0};if("string"==typeof e._category){const t=i(e._category);void 0!==t&&(e.renderOrder=t)}if("string"==typeof e._secondaryCategory){const t=i(e._secondaryCategory);void 0!==t&&(e.secondaryRenderOrder=t)}}}},78510:(e,t)=>{"use strict";function i(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.value)}Object.defineProperty(t,"__esModule",{value:!0}),t.isJsonExprReference=t.getDefinitionValue=t.isVerboseDefinition=void 0,t.isVerboseDefinition=i,t.getDefinitionValue=function(e){return i(e)?e.value:e},t.isJsonExprReference=function(e){return Array.isArray(e)&&2===e.length&&"ref"===e[0]&&"string"==typeof e[1]}},57162:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeVisitor=void 0;const r=i(10643);t.ThemeVisitor=class{constructor(e){this.theme=e}visitStyles(e){const t=t=>!r.isJsonExpr(t)&&!!e(t);if(void 0!==this.theme.styles)for(const e in this.theme.styles)if(void 0!==this.theme.styles[e])for(const i of this.theme.styles[e])if(t(i))return!0;return!1}}},50884:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreeBufferUtils=void 0;const r=i(53568);!function(e){function t(e){if(e instanceof Int8Array)return"int8";if(e instanceof Uint8Array)return"uint8";if(e instanceof Int16Array)return"int16";if(e instanceof Uint16Array)return"uint16";if(e instanceof Int32Array)return"int32";if(e instanceof Uint32Array)return"uint32";if(e instanceof Float32Array)return"float";throw new Error(`Unsupported buffer type ${name}`)}function i(e){const i=e.array;return{name:e.name,buffer:i.buffer,type:t(i),itemCount:e.itemSize,normalized:e.normalized}}e.getBufferElementType=t,e.fromThreeBufferAttribute=i,e.fromThreeInterleavedBufferAttribute=function(e){throw new Error("Not implemented yet")},e.fromThreeBufferGeometry=function(e,t){const n=[],o=Object.getOwnPropertyNames(e.attributes);for(const t of o){const r=i(e.attributes[t]);r.name=t,n.push(r)}const a=null!==e.index?i(e.index):void 0;let s=0;if(void 0!==a)s=null===e.index?0:e.index.count;else{const t=e.attributes.position;if(void 0===t)throw new Error("Missing position attibute to deduce item count");s=t.count}return{type:r.GeometryType.Unspecified,vertexAttributes:n,index:a,groups:[{start:0,count:s,technique:t}]}}}(t.ThreeBufferUtils||(t.ThreeBufferUtils={}))},46284:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},26583:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerDecoderProtocol=t.RequestController=void 0,t.RequestController=class{constructor(e=0,t=new AbortController){this.priority=e,this.abortController=t}get signal(){return this.abortController.signal}abort(){this.abortController.abort()}},function(e){let t,i;!function(e){e.Configuration="configuration"}(t=e.DecoderMessageName||(e.DecoderMessageName={})),e.isConfigurationMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Configuration},function(e){e.DecodeTileRequest="decode-tile-request",e.TileInfoRequest="tile-info-request"}(i=e.Requests||(e.Requests={})),e.isDecodeTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===i.DecodeTileRequest},e.isTileInfoRequest=function(e){return e&&"string"==typeof e.type&&e.type===i.TileInfoRequest}}(t.WorkerDecoderProtocol||(t.WorkerDecoderProtocol={}))},68497:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerServiceProtocol=void 0,function(e){let t,i;e.WORKER_SERVICE_MANAGER_SERVICE_ID="worker-service-manager",function(e){e.Initialized="initialized",e.Request="request",e.Response="response"}(t=e.ServiceMessageName||(e.ServiceMessageName={})),e.isInitializedMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Initialized},function(e){e.CreateService="create-service",e.DestroyService="destroy-service"}(i=e.Requests||(e.Requests={})),e.isUnknownServiceError=function(e){return e.message.includes("unknown targetServiceType requested: ")},e.isRequestMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Request},e.isResponseMessage=function(e){return e&&"string"==typeof e.service&&"string"==typeof e.type&&e.type===t.Response}}(t.WorkerServiceProtocol||(t.WorkerServiceProtocol={}))},30136:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerTilerProtocol=void 0,function(e){let t;!function(e){e.RegisterIndex="register-index",e.UpdateIndex="update-index",e.TileRequest="tile-request"}(t=e.Requests||(e.Requests={})),e.isRegisterIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.RegisterIndex},e.isUpdateIndexRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.UpdateIndex},e.isTileRequest=function(e){return e&&"string"==typeof e.type&&e.type===t.TileRequest}}(t.WorkerTilerProtocol||(t.WorkerTilerProtocol={}))},31392:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayOperators=void 0;const r=i(10643),n=["boolean","number","string"];function o(e,t){if(!(e instanceof r.StringLiteralExpr&&n.includes(e.value)))throw new Error(`expected "boolean", "number" or "string" instead of '${JSON.stringify(e)}'`);const i=e.value;t.forEach(((e,t)=>{if(typeof e!==i)throw new Error(`expected array element at index ${t} to have type '${i}'`)}))}function a(e,t){const i=e.evaluate(t);if(!Array.isArray(i))throw new Error(`'${i}' is not an array`);return i}const s={array:{call:(e,t)=>{switch(t.args.length){case 0:throw new Error("not enough arguments");case 1:return a(e,t.args[0]);case 2:{const i=a(e,t.args[1]);return o(t.args[0],i),i}case 3:{const i=a(e,t.args[2]);return function(e,t){if(!(e instanceof r.NumberLiteralExpr))throw new Error("missing expected number of elements");const i=e.value;if(t.length!==i)throw new Error(`the array must have ${i} element(s)`)}(t.args[1],i),o(t.args[0],i),i}default:throw new Error("too many arguments")}}},"make-array":{call:(e,t)=>{if(0===t.args.length)throw new Error("not enough arguments");return[...t.args.map((t=>e.evaluate(t)))]}},at:{call:(e,t)=>{const i=t.args,r=e.evaluate(i[0]);if("number"!=typeof r)throw new Error("expected the index of the element to retrieve");const n=e.evaluate(i[1]);if(!Array.isArray(n))throw new Error("expected an array");return r>=0&&r<n.length?n[r]:null}},slice:{call:(e,t)=>{if(t.args.length<2)throw new Error("not enough arguments");const i=e.evaluate(t.args[0]);if("string"!=typeof i&&!Array.isArray(i))throw new Error("input must be a string or an array");const r=e.evaluate(t.args[1]);if("number"!=typeof r)throw new Error("expected an index");let n;if(t.args.length>2&&(n=e.evaluate(t.args[2]),"number"!=typeof n))throw new Error("expected an index");return i.slice(r,n)}}};t.ArrayOperators=s},85500:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CastOperators=void 0;const i={"to-boolean":{call:(e,t)=>Boolean(e.evaluate(t.args[0]))},"to-string":{call:(e,t)=>String(e.evaluate(t.args[0]))},"to-number":{call:(e,t)=>{for(const i of t.args){const t=Number(e.evaluate(i));if(!isNaN(t))return t}throw new Error("cannot convert the value to a number")}}};t.CastOperators=i},12112:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorOperators=void 0;const r=i(84428),n=i(90991),o=i(26244),a={alpha:{call:(e,t)=>{let i=e.evaluate(t.args[0]);return"string"==typeof i&&(i=o.parseStringEncodedColor(i)),"number"==typeof i?n.ColorUtils.getAlphaFromHex(i):1}},rgba:{call:(e,t)=>{const i=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),a=e.evaluate(t.args[2]),s=e.evaluate(t.args[3]);if("number"==typeof i&&"number"==typeof o&&"number"==typeof a&&"number"==typeof s&&i>=0&&o>=0&&a>=0&&s>=0&&s<=1)return function(e,t,i,o){return n.ColorUtils.getHexFromRgba(r.MathUtils.clamp(e,0,255)/255,r.MathUtils.clamp(t,0,255)/255,r.MathUtils.clamp(i,0,255)/255,r.MathUtils.clamp(o,0,1))}(i,o,a,s);throw new Error(`unknown color 'rgba(${i},${o},${a},${s})'`)}},rgb:{call:(e,t)=>{const i=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),a=e.evaluate(t.args[2]);if("number"==typeof i&&"number"==typeof o&&"number"==typeof a&&i>=0&&o>=0&&a>=0)return function(e,t,i){return n.ColorUtils.getHexFromRgb(r.MathUtils.clamp(e,0,255)/255,r.MathUtils.clamp(t,0,255)/255,r.MathUtils.clamp(i,0,255)/255)}(i,o,a);throw new Error(`unknown color 'rgb(${i},${o},${a})'`)}},hsl:{call:(e,t)=>{const i=e.evaluate(t.args[0]),o=e.evaluate(t.args[1]),a=e.evaluate(t.args[2]);if("number"==typeof i&&"number"==typeof o&&"number"==typeof a&&i>=0&&o>=0&&a>=0)return function(e,t,i){return n.ColorUtils.getHexFromHsl(r.MathUtils.euclideanModulo(e,360)/360,r.MathUtils.clamp(t,0,100)/100,r.MathUtils.clamp(i,0,100)/100)}(i,o,a);throw new Error(`unknown color 'hsl(${i},${o}%,${a}%)'`)}}};t.ColorOperators=a},3171:(e,t)=>{"use strict";function i(e,t,i=!1){const r=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]);if(!("number"==typeof r&&"number"==typeof n||"string"==typeof r&&"string"==typeof n)&&i)throw new Error(`invalid operands '${r}' and '${n}' for operator '${t.op}'`);switch(t.op){case"<":return r<n;case">":return r>n;case"<=":return r<=n;case">=":return r>=n;default:throw new Error(`invalid comparison operator '${t.op}'`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ComparisonOperators=void 0;const r={"!":{call:(e,t)=>!e.evaluate(t.args[0])},"==":{call:(e,t)=>e.evaluate(t.args[0])===e.evaluate(t.args[1])},"!=":{call:(e,t)=>e.evaluate(t.args[0])!==e.evaluate(t.args[1])},"<":{call:(e,t)=>i(e,t)},">":{call:(e,t)=>i(e,t)},"<=":{call:(e,t)=>i(e,t)},">=":{call:(e,t)=>i(e,t)}};t.ComparisonOperators=r},19102:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeatureOperators=void 0;const r=i(73406),n=i(10643),o={"geometry-type":{call:(e,t)=>{switch(e.env.lookup("$geometryType")){case"point":return"Point";case"line":return"LineString";case"polygon":return"Polygon";default:return null}}},"feature-state":{isDynamicOperator:()=>!0,call:(e,t)=>{var i,o;if(e.scope!==n.ExprScope.Dynamic)throw new Error("feature-state cannot be used in this context");const a=e.evaluate(t.args[0]);if("string"!=typeof a)throw new Error("expected the name of the property of the feature state");const s=e.env.lookup("$state");return r.Env.isEnv(s)?null!==(i=s.lookup(a))&&void 0!==i?i:null:s instanceof Map&&null!==(o=s.get(a))&&void 0!==o?o:null}},id:{call:(e,t)=>{var i;return null!==(i=e.env.lookup("$id"))&&void 0!==i?i:null}}};t.FeatureOperators=o},48544:(e,t)=>{"use strict";function i(e,t,i){switch(t){case"boolean":case"number":case"string":for(const r of i){const i=e.evaluate(r);if(typeof i===t)return i}throw new Error(`expected a '${t}'`);default:throw new Error(`invalid type '${t}'`)}}Object.defineProperty(t,"__esModule",{value:!0}),t.FlowOperators=void 0;const r={all:{call:(e,t)=>{for(const i of t.args)if(!e.evaluate(i))return!1;return!0}},any:{call:(e,t)=>{for(const i of t.args)if(e.evaluate(i))return!0;return!1}},none:{call:(e,t)=>{for(const i of t.args)if(e.evaluate(i))return!1;return!0}},boolean:{call:(e,t)=>i(e,"boolean",t.args)},number:{call:(e,t)=>i(e,"number",t.args)},string:{call:(e,t)=>i(e,"string",t.args)}};t.FlowOperators=r},98702:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapOperators=void 0;const r=i(10643),n={"ppi-scale":{call:(e,t)=>e.evaluate(t.args[0])*(t.args[1]?e.evaluate(t.args[1]):1)},"world-ppi-scale":{isDynamicOperator:()=>!0,call:(e,t)=>{const i=e.evaluate(t.args[0]),r=t.args[1]?e.evaluate(t.args[1]):1,n=e.env.lookup("$zoom");return i*(Math.pow(2,17)/Math.pow(2,n))*r}},"world-discrete-ppi-scale":{isDynamicOperator:()=>!0,call:(e,t)=>{const i=e.evaluate(t.args[0]),r=t.args[1]?e.evaluate(t.args[1]):1,n=e.env.lookup("$zoom");return i*(Math.pow(2,17)/Math.pow(2,Math.floor(n)))*r}},ppi:{call:e=>{const t=e.env.lookup("$ppi");return"number"==typeof t?t:72}},zoom:{isDynamicOperator:()=>!0,call:(e,t)=>{var i;return e.scope===r.ExprScope.Value?t:null!==(i=e.env.lookup("$zoom"))&&void 0!==i?i:null}}};t.MapOperators=n},49207:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathOperators=void 0;const r=i(84428),n={"^":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);if("number"!=typeof i||"number"!=typeof r)throw new Error(`invalid operands '${typeof i}' and '${typeof r}' for operator '^'`);return Math.pow(i,r)}},"-":{call:(e,t)=>{if(1===t.args.length){const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`nvalid operand '${typeof i} for operator '-'`);return-i}const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);if("number"!=typeof i||"number"!=typeof r)throw new Error(`invalid operands '${typeof i}' and '${typeof r}' for operator '-'`);return i-r}},"/":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);if("number"!=typeof i||"number"!=typeof r)throw new Error(`invalid operands '${typeof i}' and '${typeof r}' for operator '/'`);return i/r}},"%":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);if("number"!=typeof i||"number"!=typeof r)throw new Error(`invalid operands '${typeof i}' and '${typeof r}' for operator '%'`);return i%r}},"+":{call:(e,t)=>t.args.reduce(((t,i)=>Number(t)+Number(e.evaluate(i))),0)},"*":{call:(e,t)=>t.args.reduce(((t,i)=>Number(t)*Number(e.evaluate(i))),1)},abs:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'abs'`);return Math.abs(i)}},acos:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'acos'`);return Math.acos(i)}},asin:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'asin'`);return Math.asin(i)}},atan:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'atan'`);return Math.atan(i)}},ceil:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'ceil'`);return Math.ceil(i)}},cos:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'cos'`);return Math.cos(i)}},e:{call:()=>Math.E},floor:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'floor'`);return Math.floor(i)}},ln:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'ln'`);return Math.log(i)}},ln2:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'ln2'`);return Math.log2(i)}},log10:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'log10'`);return Math.log10(i)}},max:{call:(e,t)=>Math.max(...t.args.map((t=>Number(e.evaluate(t)))))},min:{call:(e,t)=>Math.min(...t.args.map((t=>Number(e.evaluate(t)))))},clamp:{call:(e,t)=>{const i=e.evaluate(t.args[0]),n=e.evaluate(t.args[1]),o=e.evaluate(t.args[2]);if("number"!=typeof i||"number"!=typeof n||"number"!=typeof o)throw new Error(`invalid operands '${i}', ${n}, ${o} for operator 'clamp'`);return r.MathUtils.clamp(i,n,o)}},pi:{call:()=>Math.PI},round:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'round'`);return Math.round(i)}},sin:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'sin'`);return Math.sin(i)}},sqrt:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'sqrt'`);return Math.sqrt(i)}},tan:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if("number"!=typeof i)throw new Error(`invalid operand '${i}' for operator 'tan'`);return Math.tan(i)}}};t.MathOperators=n},11911:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MiscOperators=void 0;const r=i(38338),n=i(10643);function o(e){return e.join("&")}function a(e,t){return e+"="+JSON.stringify(t)}function s(e,t=0){if(t>=e.length)return[];const i=s(e,t+1),r=i.length;for(let n=0;n<r;n+=1)i.push([...i[n],e[t]]);return i.push([e[t]]),i}function l(e,t){const i=e.args.slice(1),r=[];for(let e=0;e<i.length;e+=2){const n=t.evaluate(i[e+1]);if(null===n)continue;const o=t.evaluate(i[e]);r.push(a(o,n))}return r.sort().reverse(),function(e){e.sort(((e,t)=>t.length-e.length));const t=e.map((e=>o(e)));return t.push(""),t}(s(r))}const c={length:{call:(e,t)=>{const i=e.evaluate(t.args[0]);if(Array.isArray(i)||"string"==typeof i)return i.length;throw new Error(`invalid operand '${i}' for operator 'length'`)}},coalesce:{call:(e,t)=>{for(const i of t.args){const t=e.evaluate(i);if(null!==t)return t}return null}},lookup:{call:(e,t)=>{r.assert(t.args.length>0,"missing lookup table");const i=l(t,e);let s=e.evaluate(t.args[0]);if(r.assert(Array.isArray(s)||s instanceof Map,"wrong lookup table type"),Array.isArray(s)){s=function(e){const t=new Map;for(const i of e){if("object"!=typeof i)throw new Error(`Invalid lookup table entry type (${typeof i})`);if(!i.keys)throw new Error("Lookup table entry has no 'keys' property.");if(!i.attributes)throw new Error("Lookup table entry has no 'attributes' property.");const e=o(Object.getOwnPropertyNames(i.keys).sort().map((e=>a(e,i.keys[e]))));t.set(e,i.attributes)}return t}(s);const e=new n.ObjectLiteralExpr(s);t.args[0]=e}return function(e,t){for(const i of e){const e=t.get(i);if(e)return e}return null}(i,s)}}};t.MiscOperators=c},8249:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectOperators=void 0;const r=i(73406),n=i(10643),o=Object.prototype.hasOwnProperty;var a;function s(e,t,i){var n;const s=e.evaluate(t[0]);if("string"!=typeof s)throw new Error("expected the name of an attribute");const l=e.evaluate(t[1]);if(l&&"object"==typeof l){if(r.Env.isEnv(l)){const e=null!==(n=l.lookup(s))&&void 0!==n?n:null;return i===a.get?e:null!==e}if(o.call(l,s))return i!==a.get||l[s]}return i===a.get&&null}!function(e){e[e.get=0]="get",e[e.has=1]="has"}(a||(a={}));const l={in:{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);return("string"==typeof i&&"string"==typeof r||!!Array.isArray(r))&&r.includes(i)}},get:{call:(e,t)=>s(e,t.args,a.get)},has:{call:(e,t)=>s(e,t.args,a.has)},"dynamic-properties":{isDynamicOperator:()=>!0,call:(e,t)=>e.scope===n.ExprScope.Dynamic?e.env:t}};t.ObjectOperators=l},55546:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringOperators=void 0;const i={concat:{call:(e,t)=>"".concat(...t.args.map((t=>String(e.evaluate(t)))))},downcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleLowerCase()},upcase:{call:(e,t)=>String(e.evaluate(t.args[0])).toLocaleUpperCase()},"~=":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);return"string"==typeof i&&"string"==typeof r&&i.includes(r)}},"^=":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);return"string"==typeof i&&"string"==typeof r&&i.startsWith(r)}},"$=":{call:(e,t)=>{const i=e.evaluate(t.args[0]),r=e.evaluate(t.args[1]);return"string"==typeof i&&"string"==typeof r&&i.endsWith(r)}}};t.StringOperators=i},92545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOperators=void 0,t.TypeOperators={typeof:{call:(e,t)=>typeof e.evaluate(t.args[0])}}},23368:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorOperators=void 0;const r=i(84428),n=i(10643);function o(e,t,i){let n;switch(i){case"vector2":n=r.Vector2;break;case"vector3":n=r.Vector3;break;case"vector4":n=r.Vector4}for(const i of t.args){const t=e.evaluate(i);if(t instanceof n)return t}throw new Error(`expected a "${i}"`)}function a(e,t,i){let n,o;switch(i){case"vector2":n=r.Vector2,o=2;break;case"vector3":n=r.Vector3,o=3;break;case"vector4":n=r.Vector4,o=4}for(const i of t.args){const t=e.evaluate(i);if(t instanceof n)return t;if(Array.isArray(t)&&t.length===o&&t.every((e=>"number"==typeof e)))return(new n).fromArray(t)}throw new Error(`expected a "${i}"`)}const s={"make-vector":{call:(e,t)=>{if(void 0!==t._value)return t._value;if(t.args.length<2)throw new Error("not enough arguments");if(t.args.length>4)throw new Error("too many arguments");const i=t.args.map((t=>e.evaluate(t)));let o;switch(i.forEach(((e,t)=>{if("number"!=typeof e)throw new Error(`expected vector component at index ${t} to have type "number"`)})),i.length){case 2:o=(new r.Vector2).fromArray(i);break;case 3:o=(new r.Vector3).fromArray(i);break;case 4:o=(new r.Vector4).fromArray(i);break;default:throw new Error("too many arguments")}return t.args.every((e=>e instanceof n.NumberLiteralExpr))&&(t._value=o),o}},vector2:{call:(e,t)=>o(e,t,"vector2")},vector3:{call:(e,t)=>o(e,t,"vector3")},vector4:{call:(e,t)=>o(e,t,"vector4")},"to-vector2":{call:(e,t)=>a(e,t,"vector2")},"to-vector3":{call:(e,t)=>a(e,t,"vector3")},"to-vector4":{call:(e,t)=>a(e,t,"vector4")}};t.VectorOperators=s},76254:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},37725:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapLineString=t.clipLineString=void 0;const r=i(32941),n=i(38338),o=i(84428);class a{constructor(e,t,i,r,n){this.isInside=n,this.p0=new o.Vector2(e,t),this.p1=new o.Vector2(i,r)}inside(e){return this.isInside(e)}computeIntersection(e,t){const i=new o.Vector2;return n.Math2D.intersectLines(e.x,e.y,t.x,t.y,this.p0.x,this.p0.y,this.p1.x,this.p1.y,i),i}clipLine(e){const t=e,i=[];e=[],i.push(e);const r=t=>{0!==e.length&&e[e.length-1].equals(t)||e.push(t)};for(let n=0;n<t.length;++n){const o=t[n],a=n>0?t[n-1]:void 0;this.inside(o)?(void 0===a||this.inside(a)||(e.length>0&&(e=[],i.push(e)),r(this.computeIntersection(a,o))),r(o)):void 0!==a&&this.inside(a)&&r(this.computeIntersection(a,o))}return 0===i[i.length-1].length&&(i.length=i.length-1),i}clipLines(e){const t=[];return e.forEach((e=>{this.clipLine(e).forEach((e=>{t.push(e)}))})),t}}function s(e,t,i){for(const i of t)e=i.clipLines(e);const n=new o.Vector3,a=[];return e.forEach((e=>{if(0===e.length)return;const t=e.map((({x:e,y:t})=>{n.set(e,t,0);const o=r.webMercatorProjection.unprojectPoint(n);return o.longitude+=i,o}));a.push(t)})),a.length>0?a:void 0}t.clipLineString=function(e,t,i,r,n){const o=new a(t,i,t,n,(e=>e.x>t)),s=new a(t,n,r,n,(e=>e.y<n)),l=new a(r,n,r,i,(e=>e.x<r)),c=new a(r,i,t,i,(e=>e.y>i));let u=o.clipLine(e);return u=s.clipLines(u),u=l.clipLines(u),u=c.clipLines(u),u},t.wrapLineString=function(e){const t=new o.Vector3,i=[e.map((e=>{const{x:i,y:n}=r.webMercatorProjection.projectPoint(e,t);return new o.Vector2(i,n)}))];return{left:s(i,u,360),middle:s(i,c,0),right:s(i,d,-360)}};const l=r.EarthConstants.EQUATORIAL_CIRCUMFERENCE,c=[new a(0,l,0,0,(e=>e.x>0)),new a(l+0,0,l+0,l,(e=>e.x<l+0))],u=[new a(-l-0,l,-l-0,0,(e=>e.x>-l-0)),new a(0,0,0,l,(e=>e.x<0))],d=[new a(l-0,l,l-0,0,(e=>e.x>l-0)),new a(2*l+0,0,2*l+0,l,(e=>e.x<2*l+0))]},46115:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clipPolygon=t.ClippingEdge=void 0;const r=i(84428);class n{clipPolygon(e,t){const i=e;e=[];const r=t=>{const i=e[e.length-1];(!(null==i?void 0:i.equals(t))||!0===t.isClipped&&!(null==i?void 0:i.isClipped)||!t.isClipped&&!0===(null==i?void 0:i.isClipped))&&e.push(t)};for(let e=0;e<i.length;++e){const n=i[e],o=i[(e+i.length-1)%i.length];if(this.inside(n,t)){if(!this.inside(o,t)){const e=this.computeIntersection(o,n,t);e.isClipped=!0,r(e)}r(n)}else if(this.inside(o,t)){const e=this.computeIntersection(o,n,t);e.isClipped=!0,r(e)}}return e}}t.ClippingEdge=n;const o=[new class extends n{inside(e){return e.y>=0}computeIntersection(e,t){const{x:i,y:n}=e,{x:o,y:a}=t;return new r.Vector2((i*a-n*o)/-(n-a),0).round()}},new class extends n{inside(e,t){return e.x<=t}computeIntersection(e,t,i){const{x:n,y:o}=e,{x:a,y:s}=t;return new r.Vector2(i,(n*s-o*a-(o-s)*-i)/(n-a)).round()}},new class extends n{inside(e,t){return e.y<=t}computeIntersection(e,t,i){const{x:n,y:o}=e,{x:a,y:s}=t;return new r.Vector2((n*s-o*a-(n-a)*i)/-(o-s),i).round()}},new class extends n{inside(e){return e.x>=0}computeIntersection(e,t){const{x:i,y:n}=e,{x:o,y:a}=t;return new r.Vector2(0,(i*a-n*o)/(i-o)).round()}}];t.clipPolygon=function(e,t){if(0===e.length)return e;e[0].equals(e[e.length-1])||(e=[...e,e[0]]);for(const i of o)e=i.clipPolygon(e,t);return e.length<3?[]:e}},81028:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdgeLengthGeometrySubdivisionModifier=t.SubdivisionMode=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(66202),s=[new o.Vector3,new o.Vector3];var l;!function(e){e[e.All=0]="All",e[e.NoDiagonals=1]="NoDiagonals"}(l=t.SubdivisionMode||(t.SubdivisionMode={}));class c extends a.SubdivisionModifier{constructor(e,t,i=l.All,o){super(),this.subdivision=e,this.geoBox=t,this.subdivisionMode=i,this.projection=o,n.assert(o.type===r.ProjectionType.Planar,"EdgeLengthGeometrySubdivisionModifier only supports planar projections");const a=o.projectPoint(t.northEast,s[0]),c=o.projectPoint(t.southWest,s[1]);this.m_projectedBox={min:{x:Math.min(a.x,c.x),y:Math.min(a.y,c.y),z:Math.min(a.z,c.z)},max:{x:Math.max(a.x,c.x),y:Math.max(a.y,c.y),z:Math.max(a.z,c.z)}},this.m_maxLengthX=(this.m_projectedBox.max.x-this.m_projectedBox.min.x)/e,this.m_maxLengthY=(this.m_projectedBox.max.y-this.m_projectedBox.min.y)/e,this.subdivisionMode===l.All&&(this.m_maxLengthX*=1.1,this.m_maxLengthY*=1.1),this.m_maxLength=Math.sqrt(this.m_maxLengthX*this.m_maxLengthX+this.m_maxLengthY*this.m_maxLengthY)}get maxLength(){return this.m_maxLength}get maxLengthX(){return this.m_maxLengthX}get maxLengthY(){return this.m_maxLengthY}shouldSplitTriangle(e,t,i){const r=this.shouldSplitEdge(e,t),n=this.shouldSplitEdge(t,i),o=this.shouldSplitEdge(i,e);if(!(r||n||o))return;const a=e.distanceTo(t),s=t.distanceTo(i),l=i.distanceTo(e),c=Math.max(r?a:0,n?s:0,o?l:0);if(a===c)return 0;if(s===c)return 1;if(l===c)return 2;throw new Error("Could not split triangle.")}shouldSplitEdge(e,t){switch(this.subdivisionMode){case l.All:return e.y===t.y&&Math.abs(e.x-t.x)>this.m_maxLengthX||e.x===t.x&&Math.abs(e.y-t.y)>this.m_maxLengthY||e.distanceTo(t)>this.m_maxLength;case l.NoDiagonals:return e.y===t.y&&Math.abs(e.x-t.x)>this.m_maxLengthX||e.x===t.x&&Math.abs(e.y-t.y)>this.m_maxLengthY}}}t.EdgeLengthGeometrySubdivisionModifier=c},56772:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SphericalGeometrySubdivisionModifier=void 0;const r=i(32941),n=i(84428),o=i(66202),a=[new n.Vector3,new n.Vector3,new n.Vector3];class s extends o.SubdivisionModifier{constructor(e,t=r.sphereProjection){super(),this.angle=e,this.projection=t}shouldSplitTriangle(e,t,i){const n=r.sphereProjection.reprojectPoint(this.projection,e,a[0]),o=r.sphereProjection.reprojectPoint(this.projection,t,a[1]),s=r.sphereProjection.reprojectPoint(this.projection,i,a[2]),l=n.angleTo(o),c=o.angleTo(s),u=s.angleTo(n),d=Math.max(l,Math.max(c,u));if(!(d<this.angle)){if(d===l)return 0;if(d===c)return 1;if(d===u)return 2;throw new Error("failed to split triangle")}}}t.SphericalGeometrySubdivisionModifier=s},66202:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubdivisionModifier=void 0;const r=i(84428),n=new r.Vector3,o=new r.Vector3,a=new r.Vector3;t.SubdivisionModifier=class{constructor(){}modify(e){const t=e.getAttribute("position"),i=Array.from(t.array),r=e.getAttribute("uv"),s=void 0!==r?Array.from(r.array):void 0,l=e.getAttribute("edge"),c=void 0!==l?Array.from(l.array):void 0,u=e.getAttribute("wall"),d=void 0!==u?Array.from(u.array):void 0,h=e.getIndex(),m=Array.from(h.array),p=new Map;function f(e,t){const r=`${Math.min(e,t)}_${Math.max(e,t)}`,l=p.get(r);if(void 0!==l)return l;n.set(i[3*e],i[3*e+1],i[3*e+2]),o.set(i[3*t],i[3*t+1],i[3*t+2]),a.lerpVectors(n,o,.5);const u=i.length/3;return i.push(...a.toArray()),p.set(r,u),void 0!==s&&(n.set(s[2*e],s[2*e+1],0),o.set(s[2*t],s[2*t+1],0),a.lerpVectors(n,o,.5),s.push(a.x,a.y)),void 0!==c&&(c[e]===t?(c.push(t),c[e]=u):c[t]===e?(c.push(e),c[t]=u):c.push(-1)),void 0!==d&&(d[e]===t?(d.push(t),d[e]=u):d[t]===e?(d.push(e),d[t]=u):d.push(-1)),u}const g=[];for(;m.length>=3;){const e=m.shift(),t=m.shift(),r=m.shift();switch(n.set(i[3*e],i[3*e+1],i[3*e+2]),o.set(i[3*t],i[3*t+1],i[3*t+2]),a.set(i[3*r],i[3*r+1],i[3*r+2]),this.shouldSplitTriangle(n,o,a)){case 0:{const i=f(e,t);m.push(e,i,r,i,t,r);break}case 1:{const i=f(t,r);m.push(e,t,i,e,i,r);break}case 2:{const i=f(r,e);m.push(e,t,i,i,t,r);break}case void 0:g.push(e,t,r);break;default:throw new Error("failed to subdivide the given geometry")}}return t.array=t.array instanceof Float32Array?new Float32Array(i):new Float64Array(i),t.count=i.length/t.itemSize,t.needsUpdate=!0,e.setIndex(g),void 0!==s&&(r.array=new Float32Array(s),r.count=s.length/r.itemSize,r.needsUpdate=!0),void 0!==c&&(l.array=new Float32Array(c),l.count=c.length/l.itemSize,l.needsUpdate=!0),e}}},32941:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(46240),t),n(i(54179),t),n(i(98504),t),n(i(13211),t),n(i(24362),t),n(i(58864),t),n(i(24489),t),n(i(71822),t),n(i(459),t),n(i(46685),t),n(i(35382),t),n(i(50885),t),n(i(94348),t),n(i(61479),t),n(i(21676),t),n(i(81080),t),n(i(20218),t),n(i(94644),t),n(i(24585),t),n(i(53718),t),n(i(10347),t),n(i(60696),t),n(i(73527),t),n(i(92196),t),n(i(21519),t),n(i(90999),t),n(i(51184),t),n(i(60107),t),n(i(96564),t),n(i(75963),t),n(i(39884),t),n(i(55538),t),n(i(38568),t),n(i(97652),t),n(i(614),t),n(i(43725),t)},46240:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoBox=void 0;const r=i(84428),n=i(13211);class o{constructor(e,t){this.southWest=e,this.northEast=t,this.west>this.east&&(this.northEast.longitude+=360)}static fromCoordinates(e,t){return new o(e,t)}static fromCenterAndExtents(e,t){return new o(new n.GeoCoordinates(e.latitude-t.latitudeSpan/2,e.longitude-t.longitudeSpan/2),new n.GeoCoordinates(e.latitude+t.latitudeSpan/2,e.longitude+t.longitudeSpan/2))}get minAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.min(this.southWest.altitude,this.northEast.altitude)}get maxAltitude(){if(void 0!==this.southWest.altitude&&void 0!==this.northEast.altitude)return Math.max(this.southWest.altitude,this.northEast.altitude)}get south(){return this.southWest.latitude}get north(){return this.northEast.latitude}get west(){return this.southWest.longitude}get east(){return this.northEast.longitude}get center(){const e=.5*(this.south+this.north),{west:t,east:i}=this,{minAltitude:r,altitudeSpan:o}=this;let a;if(void 0!==r&&void 0!==o&&(a=r+.5*o),t<=i)return new n.GeoCoordinates(e,.5*(t+i),a);let s=.5*(360+i+t);return s>360&&(s-=360),new n.GeoCoordinates(e,s,a)}get latitudeSpanInRadians(){return r.MathUtils.degToRad(this.latitudeSpan)}get longitudeSpanInRadians(){return r.MathUtils.degToRad(this.longitudeSpan)}get latitudeSpan(){return this.north-this.south}get altitudeSpan(){if(void 0!==this.maxAltitude&&void 0!==this.minAltitude)return this.maxAltitude-this.minAltitude}get longitudeSpan(){let e=this.northEast.longitude-this.southWest.longitude;return e<0&&(e+=360),e}get latitudeSpanInDegrees(){return this.latitudeSpan}get longitudeSpanInDegrees(){return this.longitudeSpan}contains(e){if(void 0===e.altitude||void 0===this.minAltitude||void 0===this.maxAltitude)return this.containsHelper(e);const t=this.minAltitude===this.maxAltitude,i=this.minAltitude===e.altitude,r=this.minAltitude<=e.altitude&&this.maxAltitude>e.altitude;return!!(t?i:r)&&this.containsHelper(e)}clone(){return new o(this.southWest.clone(),this.northEast.clone())}growToContain(e){this.southWest.latitude=Math.min(this.southWest.latitude,e.latitude),this.southWest.longitude=Math.min(this.southWest.longitude,e.longitude),this.southWest.altitude=void 0!==this.southWest.altitude&&void 0!==e.altitude?Math.min(this.southWest.altitude,e.altitude):void 0!==this.southWest.altitude?this.southWest.altitude:void 0!==e.altitude?e.altitude:void 0,this.northEast.latitude=Math.max(this.northEast.latitude,e.latitude),this.northEast.longitude=Math.max(this.northEast.longitude,e.longitude),this.northEast.altitude=void 0!==this.northEast.altitude&&void 0!==e.altitude?Math.max(this.northEast.altitude,e.altitude):void 0!==this.northEast.altitude?this.northEast.altitude:void 0!==e.altitude?e.altitude:void 0}containsHelper(e){if(e.latitude<this.southWest.latitude||e.latitude>=this.northEast.latitude)return!1;const{west:t,east:i}=this;let r=e.longitude;if(i>n.MAX_LONGITUDE)for(;r<t;)r+=360;if(r>i)for(;r>t+360;)r-=360;return r>=t&&r<i}}t.GeoBox=o},54179:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoBoxExtentLike=void 0,t.isGeoBoxExtentLike=function(e){return e&&"object"==typeof e&&"number"==typeof e.latitudeSpan&&"number"==typeof e.longitudeSpan}},38191:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordLike=t.geoCoordLikeToGeoPointLike=t.geoCoordLikeToGeoCoordinatesLike=void 0;const r=i(98504),n=i(24362),o=i(71822);t.geoCoordLikeToGeoCoordinatesLike=function(e){return r.isGeoCoordinatesLike(e)?e:o.isLatLngLike(e)?{latitude:e.lat,longitude:e.lng}:{latitude:e[1],longitude:e[0]}},t.geoCoordLikeToGeoPointLike=function(e){return n.isGeoPointLike(e)?e:o.isLatLngLike(e)?[e.lng,e.lat]:[e.longitude,e.latitude]},t.isGeoCoordLike=function(e){return r.isGeoCoordinatesLike(e)||o.isLatLngLike(e)||!n.isGeoPointLike(e)}},13211:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoCoordinates=t.MIN_LONGITUDE=t.MAX_LONGITUDE=t.MIN_LATITUDE=t.MAX_LATITUDE=void 0;const r=i(84428),n=i(98504),o=i(24362),a=i(71822);t.MAX_LATITUDE=90,t.MIN_LATITUDE=-90,t.MAX_LONGITUDE=180,t.MIN_LONGITUDE=-180;const s=new r.Vector3,l=new r.Vector3;class c{constructor(e,t,i){this.latitude=e,this.longitude=t,this.altitude=i}static fromDegrees(e,t,i){return new c(e,t,i)}static fromRadians(e,t,i){return new c(r.MathUtils.radToDeg(e),r.MathUtils.radToDeg(t),i)}static fromLatLng(e){return new c(e.lat,e.lng)}static fromGeoPoint(e){return new c(e[1],e[0],e[2])}static fromObject(e){if(o.isGeoPointLike(e))return c.fromGeoPoint(e);if(n.isGeoCoordinatesLike(e))return c.fromDegrees(e.latitude,e.longitude,e.altitude);if(a.isLatLngLike(e))return c.fromDegrees(e.lat,e.lng);throw new Error("Invalid input coordinate format.")}static lerp(e,t,i,r=!1,n=!1){var o,a;if(r){if(e.lng<t.lng){const r=e.clone();return r.longitude+=360,this.lerp(t,r,1-i)}{const r=t.clone();return r.longitude+=360,this.lerp(e,r,i)}}const u=s.set(e.lat,e.lng,null!==(o=e.altitude)&&void 0!==o?o:0),d=l.set(t.lat,t.lng,null!==(a=t.altitude)&&void 0!==a?a:0);u.lerp(d,i);const h=new c(u.x,u.y,u.z);return n?h.normalized():h}get latitudeInRadians(){return r.MathUtils.degToRad(this.latitude)}get longitudeInRadians(){return r.MathUtils.degToRad(this.longitude)}get latitudeInDegrees(){return this.latitude}get longitudeInDegrees(){return this.longitude}get lat(){return this.latitude}get lng(){return this.longitude}isValid(){return!isNaN(this.latitude)&&!isNaN(this.longitude)}normalized(){let{latitude:e,longitude:t}=this;return isNaN(e)||isNaN(t)?this:((t<-180||t>180)&&(t=function(e,t){const i=e%360;return i<0==0?i:i+360}(t+180)-180),e=r.MathUtils.clamp(e,-90,90),new c(e,t,this.altitude))}equals(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.altitude===e.altitude}copy(e){return this.latitude=e.latitude,this.longitude=e.longitude,this.altitude=e.altitude,this}clone(){return new c(this.latitude,this.longitude,this.altitude)}toLatLng(){return{lat:this.latitude,lng:this.longitude}}toGeoPoint(){return void 0!==this.altitude?[this.longitude,this.latitude,this.altitude]:[this.longitude,this.latitude]}minLongitudeSpanTo(e){const t=Math.min(this.longitude,e.longitude),i=Math.max(this.longitude,e.longitude);return Math.min(i-t,360+t-i)}}t.GeoCoordinates=c},98504:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoCoordinatesLike=void 0,t.isGeoCoordinatesLike=function(e){return e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&("number"==typeof e.altitude||void 0===e.altitude)}},24362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoPointLike=void 0,t.isGeoPointLike=function(e){if(Array.isArray(e)){const[t,i,r]=e;return"number"==typeof t&&"number"==typeof i&&(void 0===r||"number"==typeof r)}return!1}},24489:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPolygon=t.isAntimeridianCrossing=void 0;const r=i(84428),n=i(46240),o=i(13211),a=i(38191);function s(e,t){return Math.max(e,t)-Math.min(e,t)}function l(e,t){return e>0&&t<0&&s(e,t)>180}t.isAntimeridianCrossing=function(e,t){return Math.sign(e)===-Math.sign(t)&&s(e,t)>180},t.GeoPolygon=class{constructor(e,t=!1,i=!1){this.m_coordinates=e.map((e=>a.geoCoordLikeToGeoCoordinatesLike(e))),t&&this.sortCCW(),i&&this.wrapCoordinatesAround()}get coordinates(){return this.m_coordinates}getGeoBoundingBox(){const e=this.getCentroid();if(void 0===e)return n.GeoBox.fromCoordinates(this.coordinates[0],this.coordinates[0]);const{east:t,west:i}=this.getEastAndWest(e),{north:r,south:a}=this.getNorthAndSouth();return n.GeoBox.fromCoordinates(new o.GeoCoordinates(a,i),new o.GeoCoordinates(r,t))}getCentroid(){const e=this.getArea();if(0===e)return;let t,i=0,r=0,n=this.m_coordinates.length-1;return this.m_coordinates.forEach(((e,o)=>{const a=this.m_coordinates[n];t=e.latitude*a.longitude-a.latitude*e.longitude,i+=(e.latitude+a.latitude)*t,r+=(e.longitude+a.longitude)*t,n=o})),t=6*e,new o.GeoCoordinates(i/t,e<0?r/t-180:r/t)}sortCCW(){const e=this.getPolyAverageCenter();e&&this.m_coordinates.sort(((t,i)=>{const n=new r.Vector2(t.latitude-e.latitude,t.longitude-e.longitude).normalize();return new r.Vector2(i.latitude-e.latitude,i.longitude-e.longitude).normalize().angle()-n.angle()}))}wrapCoordinatesAround(){const e=this.m_coordinates.findIndex(((e,t)=>{const i=0===t?this.m_coordinates.length-1:t-1;return l(this.m_coordinates[i].longitude,e.longitude)}));if(e<0)return;let t=!0;for(let i=0;i<this.m_coordinates.length;i++){const r=(e+i)%this.m_coordinates.length,n=this.m_coordinates[r].longitude,o=this.m_coordinates[(r+1)%this.m_coordinates.length].longitude;t&&(this.m_coordinates[r].longitude+=360),l(o,n)?t=!1:l(n,o)&&(t=!0)}}getPolyAverageCenter(){const e=this.m_coordinates.reduce(((e,t)=>new o.GeoCoordinates(e.latitude+t.latitude,e.longitude+t.longitude)));return new o.GeoCoordinates(e.latitude/this.m_coordinates.length,e.longitude/this.m_coordinates.length)}getArea(){let e=0,t=this.m_coordinates.length-1;return this.m_coordinates.forEach(((i,r)=>{const n=this.m_coordinates[t];e+=i.latitude*n.longitude,e-=i.longitude*n.latitude,t=r})),e/=2}getEastAndWest(e){let t=e.longitude,i=e.longitude,n=this.m_coordinates.length-1;return this.m_coordinates.forEach(((o,a)=>{const s=this.m_coordinates[n];n=a;const l=new r.Vector2(o.latitude-e.latitude,o.longitude-e.longitude).normalize(),c=new r.Vector2(s.latitude-e.latitude,s.longitude-e.longitude).normalize();let u=1===Math.sign(c.angle()-l.angle());c.y>=0&&l.y<0&&(u=!0);const d=o.longitude;d<e.longitude?u?t=Math.min(t,d):i=Math.min(i,d):u?i=Math.max(i,d):t=Math.max(t,d)})),{east:i,west:t}}getNorthAndSouth(){let e=o.MIN_LATITUDE,t=o.MAX_LATITUDE;return this.m_coordinates.forEach(((i,r)=>{e=Math.max(e,i.latitude),t=Math.min(t,i.latitude)})),{north:e,south:t}}}},58864:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isGeoPolygonLike=void 0;const r=i(38191);t.isGeoPolygonLike=function(e){if(!e||!Array.isArray(e.coordinates)&&e.coordinates.length>2)return!1;let t=!0;return e.coordinates.forEach((i=>{r.isGeoCoordLike(e)||(t=!1)})),t}},71822:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLatLngLike=void 0,t.isLatLngLike=function(e){return e&&"number"==typeof e.lat&&"number"==typeof e.lng}},55538:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBox3Like=void 0,t.isBox3Like=function(e){const t=e;return void 0!==t.min&&void 0!==t.max}},97652:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0;const r=i(84428);!function(e){function t(e){return(e%=360)<0&&(e+=360),e}function i(e,i){const r=(e=t(e))-(i=t(i));return r>180?r-360:r<=-180?r+360:r}e.newEmptyBox3=function(){return{min:{x:1/0,y:1/0,z:1/0},max:{x:-1/0,y:-1/0,z:-1/0}}},e.newVector3=function(e,t,i,r){return void 0===r?{x:e,y:t,z:i}:(r.x=e,r.y=t,r.z=i,r)},e.copyVector3=function(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t},e.degToRad=r.MathUtils.degToRad,e.radToDeg=r.MathUtils.radToDeg,e.clamp=r.MathUtils.clamp,e.normalizeAngleDeg=t,e.normalizeLongitudeDeg=function(e){return(e=t(e))>180&&(e-=360),e},e.angleDistanceDeg=i,e.interpolateAnglesDeg=function(e,t,r){return(e+i(t,e)*r)%360}}(t.MathUtils||(t.MathUtils={}))},43725:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrientedBox3=void 0;const r=i(84428);function n(e,t,i,r,n){const o=i.dot(t),a=i.dot(e);if(Math.abs(a)<1e-20)return Math.abs(o)<=r;const s=1/a,l=(o+r)*s,c=(o-r)*s;return l>c?(c>n.min&&(n.min=c),l<n.max&&(n.max=l)):(l>n.min&&(n.min=l),c<n.max&&(n.max=c)),n.min<=n.max&&n.max>=0}const o=new r.Vector3,a={min:-1/0,max:1/0};class s{constructor(e,t,i){this.position=new r.Vector3,this.xAxis=new r.Vector3(1,0,0),this.yAxis=new r.Vector3(0,1,0),this.zAxis=new r.Vector3(0,0,1),this.extents=new r.Vector3,void 0!==e&&this.position.copy(e),void 0!==t&&t.extractBasis(this.xAxis,this.yAxis,this.zAxis),void 0!==i&&this.extents.copy(i)}clone(){const e=new s;return e.copy(this),e}copy(e){this.position.copy(e.position),this.xAxis.copy(e.xAxis),this.yAxis.copy(e.yAxis),this.zAxis.copy(e.zAxis),this.extents.copy(e.extents)}getCenter(e=new r.Vector3){return e.copy(this.position)}getSize(e=new r.Vector3){return e.copy(this.extents).multiplyScalar(2)}getRotationMatrix(e=new r.Matrix4){return e.makeBasis(this.xAxis,this.yAxis,this.zAxis)}intersects(e){const t=Array.isArray(e)?e:e.planes;for(const e of t){const t=Math.abs(e.normal.dot(this.xAxis)*this.extents.x)+Math.abs(e.normal.dot(this.yAxis)*this.extents.y)+Math.abs(e.normal.dot(this.zAxis)*this.extents.z);if(e.distanceToPoint(this.position)+t<0)return!1}return!0}intersectsRay(e){if(a.min=-1/0,a.max=1/0,o.copy(this.position).sub(e.origin),n(e.direction,o,this.xAxis,this.extents.x,a)&&n(e.direction,o,this.yAxis,this.extents.y,a)&&n(e.direction,o,this.zAxis,this.extents.z,a))return a.min>0?a.min:a.max}contains(e){const t=e.x-this.position.x,i=e.y-this.position.y,r=e.z-this.position.z,n=Math.abs(t*this.xAxis.x+i*this.xAxis.y+r*this.xAxis.z),o=Math.abs(t*this.yAxis.x+i*this.yAxis.y+r*this.yAxis.z),a=Math.abs(t*this.zAxis.x+i*this.zAxis.y+r*this.zAxis.z);return!(n>this.extents.x||o>this.extents.y||a>this.extents.z)}distanceToPoint(e){return Math.sqrt(this.distanceToPointSquared(e))}distanceToPointSquared(e){const t=new r.Vector3;t.subVectors(e,this.position);const i=[t.dot(this.xAxis),t.dot(this.yAxis),t.dot(this.zAxis)];let n=0;for(let e=0;e<3;++e){const t=i[e],r=this.extents.getComponent(e);if(t<-r){const e=r+t;n+=e*e}else if(t>r){const e=t-r;n+=e*e}}return n}}t.OrientedBox3=s},38568:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOrientedBox3Like=void 0,t.isOrientedBox3Like=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis&&void 0!==t.extents}},614:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTransformLike=void 0,t.isTransformLike=function(e){const t=e;return void 0!==t.position&&void 0!==t.xAxis&&void 0!==t.yAxis&&void 0!==t.zAxis}},75963:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector2Like=void 0,t.isVector2Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}},39884:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVector3Like=void 0,t.isVector3Like=function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}},459:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EarthConstants=void 0;class i{}t.EarthConstants=i,i.EQUATORIAL_CIRCUMFERENCE=40075016.68557849,i.EQUATORIAL_RADIUS=6378137,i.MIN_ELEVATION=-433,i.MAX_ELEVATION=8848,i.MAX_BUILDING_HEIGHT=828},46685:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equirectangularProjection=t.normalizedEquirectangularProjection=void 0;const r=i(84428),n=i(46240),o=i(13211),a=i(55538),s=i(97652),l=i(38568),c=i(459),u=i(50885);class d extends u.Projection{constructor(){super(...arguments),this.type=u.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,i){return i||(i=new r.Box3),i.min.x=0,i.min.y=0,i.min.z=e,i.max.x=this.unitScale,i.max.y=this.unitScale/2,i.max.z=t,i}projectPoint(e,t){var i;return void 0===t&&(t={x:0,y:0,z:0}),t.x=(r.MathUtils.degToRad(e.longitude)+Math.PI)*d.geoToWorldScale*this.unitScale,t.y=(r.MathUtils.degToRad(e.latitude)+.5*Math.PI)*d.geoToWorldScale*this.unitScale,t.z=null!==(i=e.altitude)&&void 0!==i?i:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(e.y*d.worldToGeoScale/this.unitScale-.5*Math.PI,e.x*d.worldToGeoScale/this.unitScale-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){const i=this.projectPoint(new o.GeoCoordinates(e.center.latitude,e.center.longitude,0)),{latitudeSpanInRadians:n,longitudeSpanInRadians:c,altitudeSpan:u}=e,h=c*d.geoToWorldScale,m=n*d.geoToWorldScale;return t||(t=new r.Box3),a.isBox3Like(t)?(t.min.x=i.x-.5*h*this.unitScale,t.min.y=i.y-.5*m*this.unitScale,t.max.x=i.x+.5*h*this.unitScale,t.max.y=i.y+.5*m*this.unitScale,void 0!==u?(t.min.z=i.z-.5*u,t.max.z=i.z+.5*u):(t.min.z=0,t.max.z=0)):l.isOrientedBox3Like(t)&&(s.MathUtils.newVector3(1,0,0,t.xAxis),s.MathUtils.newVector3(0,1,0,t.yAxis),s.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=i.x,t.position.y=i.y,t.position.z=i.z,t.extents.x=.5*h*this.unitScale,t.extents.y=.5*m*this.unitScale,t.extents.z=Math.max(Number.EPSILON,.5*(null!=u?u:0))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),i=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,i)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}d.geoToWorldScale=1/(2*Math.PI),d.worldToGeoScale=2*Math.PI/1,t.normalizedEquirectangularProjection=new d(1),t.equirectangularProjection=new d(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},35382:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identityProjection=void 0;const r=i(84428),n=i(46240),o=i(13211),a=i(55538),s=i(97652),l=i(38568),c=i(50885);class u extends c.Projection{constructor(){super(...arguments),this.type=c.ProjectionType.Planar}getScaleFactor(e){return 1}worldExtent(e,t,i){return i||(i=new r.Box3),i.min.x=-Math.PI,i.min.y=.5*-Math.PI,i.min.z=e,i.max.x=Math.PI,i.max.y=.5*Math.PI,i.max.z=t,i}projectPoint(e,t){var i;return t||(t={x:0,y:0,z:0}),t.x=r.MathUtils.degToRad(e.longitude),t.y=r.MathUtils.degToRad(e.latitude),t.z=null!==(i=e.altitude)&&void 0!==i?i:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(e.y,e.x,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){t||(t=new r.Box3);const i=this.projectPoint(new o.GeoCoordinates(e.south,e.west,e.minAltitude)),n=this.projectPoint(new o.GeoCoordinates(e.north,e.east,e.maxAltitude));return a.isBox3Like(t)?(t.min.x=i.x,t.min.y=i.y,t.min.z=i.z,t.max.x=n.x,t.max.y=n.y,t.max.z=n.z):l.isOrientedBox3Like(t)&&(s.MathUtils.newVector3(1,0,0,t.xAxis),s.MathUtils.newVector3(0,1,0,t.yAxis),s.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(i.x+n.x),t.position.y=.5*(i.y+n.y),t.position.z=.5*(i.z+n.z),t.extents.x=.5*(n.x-i.x),t.extents.y=.5*(n.y-i.y),t.extents.z=Math.max(Number.EPSILON,.5*(n.z-i.z))),t}unprojectBox(e){const t=this.unprojectPoint(e.min),i=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,i)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}}t.identityProjection=new u(1)},94348:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorProjection=t.mercatorProjection=t.MercatorConstants=void 0;const r=i(84428),n=i(46240),o=i(13211),a=i(98504),s=i(55538),l=i(97652),c=i(38568),u=i(459),d=i(50885);class h extends d.Projection{constructor(){super(...arguments),this.type=d.ProjectionType.Planar}static clamp(e,t,i){return Math.min(Math.max(t,e),i)}static latitudeClamp(e){return h.clamp(e,-m.MAXIMUM_LATITUDE,m.MAXIMUM_LATITUDE)}static latitudeProject(e){return Math.log(Math.tan(.25*Math.PI+.5*e))/Math.PI}static latitudeClampProject(e){return h.latitudeProject(h.latitudeClamp(e))}static unprojectLatitude(e){return 2*Math.atan(Math.exp(Math.PI*e))-.5*Math.PI}getScaleFactor(e){return Math.cosh(2*Math.PI*(e.y/this.unitScale-.5))}worldExtent(e,t,i){return i||(i=new r.Box3),i.min.x=0,i.min.y=0,i.min.z=e,i.max.x=this.unitScale,i.max.y=this.unitScale,i.max.z=t,i}projectPoint(e,t){var i;let r;return r=e instanceof o.GeoCoordinates?e:new o.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(r.longitude+180)/360*this.unitScale,t.y=(.5*h.latitudeClampProject(r.latitudeInRadians)+.5)*this.unitScale,t.z=null!==(i=r.altitude)&&void 0!==i?i:0,t}unprojectPoint(e){return o.GeoCoordinates.fromRadians(h.unprojectLatitude(2*(e.y/this.unitScale-.5)),e.x/this.unitScale*2*Math.PI-Math.PI,e.z)}unprojectAltitude(e){return e.z}projectBox(e,t){var i;const n=this.projectPoint(e.center),o=(.5*h.latitudeClampProject(e.northEast.latitudeInRadians)+.5)*this.unitScale,a=(.5*h.latitudeClampProject(e.southWest.latitudeInRadians)+.5)*this.unitScale,u=.5*(o+a);n.y=u;const d=o-a,m=e.longitudeSpan/360*this.unitScale;if(t||(t=new r.Box3),s.isBox3Like(t)){t.min.x=n.x-.5*m,t.min.y=n.y-.5*d,t.max.x=n.x+.5*m,t.max.y=n.y+.5*d;const i=e.altitudeSpan;void 0!==i?(t.min.z=n.z-.5*i,t.max.z=n.z+.5*i):(t.min.z=0,t.max.z=0)}else{if(!c.isOrientedBox3Like(t))throw new Error("invalid bounding box");l.MathUtils.newVector3(1,0,0,t.xAxis),l.MathUtils.newVector3(0,1,0,t.yAxis),l.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=n.x,t.position.y=n.y,t.position.z=n.z,t.extents.x=.5*m,t.extents.y=.5*d,t.extents.z=Math.max(Number.EPSILON,.5*(null!==(i=e.altitudeSpan)&&void 0!==i?i:0))}return t}unprojectBox(e){const t=this.unprojectPoint(e.min),i=this.unprojectPoint(e.max);return n.GeoBox.fromCoordinates(t,i)}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:1}:(t.x=0,t.y=0,t.z=1),t}reprojectPoint(e,i,r){return e===this||e!==t.webMercatorProjection&&e!==t.mercatorProjection?super.reprojectPoint(e,i,r):(void 0===r&&(r={}),r.x=i.x,r.y=this.unitScale-i.y,r.z=i.z,r)}}class m{}t.MercatorConstants=m,m.MAXIMUM_LATITUDE=1.4844222297453322,t.mercatorProjection=new h(u.EarthConstants.EQUATORIAL_CIRCUMFERENCE),t.webMercatorProjection=new class extends h{projectPoint(e,t){var i;let r;r=e instanceof o.GeoCoordinates?e:new o.GeoCoordinates(e.latitude,e.longitude,e.altitude),t||(t={x:0,y:0,z:0}),t.x=(r.longitude+180)/360*this.unitScale;const n=Math.sin(h.latitudeClamp(r.latitudeInRadians));return t.y=(.5-Math.log((1+n)/(1-n))/(4*Math.PI))*this.unitScale,t.z=null!==(i=r.altitude)&&void 0!==i?i:0,t}unprojectPoint(e){const t=e.x/this.unitScale-.5,i=.5-e.y/this.unitScale,r=360*t,n=90-360*Math.atan(Math.exp(2*-i*Math.PI))/Math.PI;return new o.GeoCoordinates(n,r,e.z)}projectBox(e,t){const i=super.projectBox(e,t);if(s.isBox3Like(i)){const e=i.max.y;i.max.y=this.unitScale-i.min.y,i.min.y=this.unitScale-e}else c.isOrientedBox3Like(i)&&(l.MathUtils.newVector3(1,0,0,i.xAxis),l.MathUtils.newVector3(0,-1,0,i.yAxis),l.MathUtils.newVector3(0,0,-1,i.zAxis),i.position.y=this.unitScale-i.position.y);return i}unprojectBox(e){const t=this.unprojectPoint(e.min),i=this.unprojectPoint(e.max);return new n.GeoBox(new o.GeoCoordinates(i.latitude,t.longitude,t.altitude),new o.GeoCoordinates(t.latitude,i.longitude,i.altitude))}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}localTangentSpace(e,t){return a.isGeoCoordinatesLike(e)?this.projectPoint(e,t.position):l.MathUtils.copyVector3(e,t.position),l.MathUtils.newVector3(1,0,0,t.xAxis),l.MathUtils.newVector3(0,-1,0,t.yAxis),l.MathUtils.newVector3(0,0,-1,t.zAxis),t}}(u.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},50885:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Projection=t.ProjectionType=void 0;const r=i(98504),n=i(97652);var o;(o=t.ProjectionType||(t.ProjectionType={}))[o.Planar=0]="Planar",o[o.Spherical=1]="Spherical",t.Projection=class{constructor(e){this.unitScale=e}localTangentSpace(e,t){return r.isGeoCoordinatesLike(e)?this.projectPoint(e,t.position):n.MathUtils.copyVector3(e,t.position),n.MathUtils.newVector3(1,0,0,t.xAxis),n.MathUtils.newVector3(0,1,0,t.yAxis),n.MathUtils.newVector3(0,0,1,t.zAxis),t}reprojectPoint(e,t,i){return e===this?void 0===i?{x:t.x,y:t.y,z:t.z}:(i.x=t.x,i.y=t.y,i.z=t.z,i):this.projectPoint(e.unprojectPoint(t),i)}}},21676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sphereProjection=void 0;const r=i(84428),n=i(13211),o=i(98504),a=i(55538),s=i(97652),l=i(38568),c=i(459),u=i(94348),d=i(50885);function h(e){const t=1/Math.PI,i=Math.floor(2*(e*t+1));return r.MathUtils.clamp(i,0,4)}function m(e){return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)}function p(e,t,i){var n;const o=.5*(i+(null!==(n=e.maxAltitude)&&void 0!==n?n:0)),a=r.MathUtils.degToRad(e.west),s=r.MathUtils.degToRad(e.east),l=h(a),c=h(s);let u=Math.cos(a),d=u,m=Math.sin(a),p=m;for(let e=l+1;e<=c;e++){const t=(e+1&1)*((2&e)-1);u=Math.min(t,u),d=Math.max(t,d);const i=(1&e)*((2&e)-1);m=Math.min(i,m),p=Math.max(i,p)}const f=Math.cos(s);u=Math.min(f,u),d=Math.max(f,d);const g=Math.sin(s);m=Math.min(g,m),p=Math.max(g,p);const y=(d+u)*o,v=(d-u)*o,_=(p+m)*o,b=(p-m)*o,S=r.MathUtils.degToRad(e.south),T=r.MathUtils.degToRad(e.north),E=Math.sin(T),C=Math.sin(S),w=(E+C)*o,x=(E-C)*o;return t.min.x=y-v,t.min.y=_-b,t.min.z=w-x,t.max.x=y+v,t.max.y=_+b,t.max.z=w+x,t}class f extends d.Projection{constructor(){super(...arguments),this.type=d.ProjectionType.Spherical}worldExtent(e,t,i=new r.Box3){const n=this.unitScale+t;return i.min.x=-n,i.min.y=-n,i.min.z=-n,i.max.x=n,i.max.y=n,i.max.z=n,i}projectPoint(e,t=s.MathUtils.newVector3(0,0,0)){return function(e,t,i){var n;const o=i+(null!==(n=e.altitude)&&void 0!==n?n:0),a=r.MathUtils.degToRad(e.latitude),s=r.MathUtils.degToRad(e.longitude),l=Math.cos(a);return t.x=o*l*Math.cos(s),t.y=o*l*Math.sin(s),t.z=o*Math.sin(a),t}(e,t,this.unitScale)}unprojectPoint(e){const t=e.x*e.x+e.y*e.y,i=Math.sqrt(t),r=e.z/i;if(isNaN(r))return n.GeoCoordinates.fromRadians(0,0,-this.unitScale);const o=Math.sqrt(t+e.z*e.z);return n.GeoCoordinates.fromRadians(Math.atan(r),Math.atan2(e.y,e.x),o-this.unitScale)}unprojectAltitude(e){const t=e.x*e.x+e.y*e.y+e.z*e.z;return Math.sqrt(t)-c.EarthConstants.EQUATORIAL_RADIUS}projectBox(e,t=new r.Box3){var i,n;if(a.isBox3Like(t))return p(e,t,this.unitScale);if(l.isOrientedBox3Like(t)){if(e.longitudeSpan>=90){const i=p(e,new r.Box3,this.unitScale);return s.MathUtils.newVector3(1,0,0,t.xAxis),s.MathUtils.newVector3(0,1,0,t.yAxis),s.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=.5*(i.max.x+i.min.x),t.position.y=.5*(i.max.y+i.min.y),t.position.z=.5*(i.max.z+i.min.z),t.extents.x=.5*(i.max.x-i.min.x),t.extents.y=.5*(i.max.y-i.min.y),t.extents.z=.5*(i.max.z-i.min.z),t}const{south:o,west:a,north:l,east:c,center:u}=e,d=u.longitude,h=u.latitude,m=Math.cos(r.MathUtils.degToRad(o)),f=Math.sin(r.MathUtils.degToRad(o)),g=Math.cos(r.MathUtils.degToRad(a)),y=Math.sin(r.MathUtils.degToRad(a)),v=Math.cos(r.MathUtils.degToRad(l)),_=Math.sin(r.MathUtils.degToRad(l)),b=Math.cos(r.MathUtils.degToRad(c)),S=Math.sin(r.MathUtils.degToRad(c)),T=Math.cos(r.MathUtils.degToRad(d)),E=Math.sin(r.MathUtils.degToRad(d)),C=Math.cos(r.MathUtils.degToRad(h)),w=Math.sin(r.MathUtils.degToRad(h));let x,P,O;s.MathUtils.newVector3(T*C,E*C,w,t.zAxis),s.MathUtils.newVector3(-E,T,0,t.xAxis),s.MathUtils.newVector3(-T*w,-E*w,C,t.yAxis),o>=0?(x=Math.abs(m*(T*(y-S)+E*(b-g))),P=C*f-w*m,O=C*_-w*v*(T*b+E*S)):(l<=0?(x=Math.abs(v*(T*(y-S)+E*(b-g))),O=C*_-w*v):(x=Math.abs(T*(y-S)+E*(b-g)),O=C*_-w*v*(E*S+T*b)),P=C*f-w*m*(T*b+E*S));const A=.5*(this.unitScale+(null!==(i=e.maxAltitude)&&void 0!==i?i:0)),D=.5*(this.unitScale+(null!==(n=e.minAltitude)&&void 0!==n?n:0)),R=C*(T*b+E*S),I=Math.min(v*R+_*w,m*R+f*w);return s.MathUtils.newVector3(x*A,(O-P)*A,A-I*D,t.extents),s.MathUtils.newVector3(0,(P+O)*A,A+A,t.position),function(e,t,i,r){const n=e.x*r.x+t.x*r.y+i.x*r.z,o=e.y*r.x+t.y*r.y+i.y*r.z,a=e.z*r.x+t.z*r.y+i.z*r.z;r.x=n,r.y=o,r.z=a}(t.xAxis,t.yAxis,t.zAxis,t.position),t.position.x=t.position.x-t.zAxis.x*t.extents.z,t.position.y=t.position.y-t.zAxis.y*t.extents.z,t.position.z=t.position.z-t.zAxis.z*t.extents.z,t}throw new Error("Invalid bounding box")}unprojectBox(e){throw new Error("Method not implemented.")}getScaleFactor(e){return 1}groundDistance(e){return m(e)-this.unitScale}scalePointToSurface(e){const t=this.unitScale/(m(e)||1);return e.x*=t,e.y*=t,e.z*=t,e}surfaceNormal(e,t){void 0===t&&(t={x:0,y:0,z:0});const i=1/(m(e)||1);return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t}reprojectPoint(e,t,i){if(e===u.mercatorProjection||e===u.webMercatorProjection){const{x:r,y:n,z:o}=t,a=this.unitScale,s=r/a-Math.PI,l=n/a-Math.PI,c=Math.exp(l),d=c*c,h=2*c/(d+1),m=(d-1)/(d+1),p=a+o;return void 0===i&&(i={}),i.x=Math.cos(s)*h*p,i.y=Math.sin(s)*h*p,i.z=m*p,e===u.webMercatorProjection&&(i.z=-i.z),i}return super.reprojectPoint(e,t,i)}localTangentSpace(e,t){let i;o.isGeoCoordinatesLike(e)?(this.projectPoint(e,t.position),i=e):(s.MathUtils.copyVector3(e,t.position),i=this.unprojectPoint(e));const n=r.MathUtils.degToRad(i.latitude),a=r.MathUtils.degToRad(i.longitude),l=Math.cos(a),c=Math.sin(a),u=Math.cos(n),d=Math.sin(n);return s.MathUtils.newVector3(l*u,c*u,d,t.zAxis),s.MathUtils.newVector3(-c,l,0,t.xAxis),s.MathUtils.newVector3(-l*d,-c*d,u,t.yAxis),t}}t.sphereProjection=new f(c.EarthConstants.EQUATORIAL_RADIUS)},61479:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transverseMercatorProjection=t.TransverseMercatorUtils=void 0;const r=i(84428),n=i(46240),o=i(13211),a=i(55538),s=i(97652),l=i(38568),c=i(459),u=i(50885);class d extends u.Projection{constructor(e){super(e),this.unitScale=e,this.type=u.ProjectionType.Planar,this.m_phi0=0,this.m_lambda0=0}static clampGeoPoint(e,t){const i=e.latitude,r=e.longitude,n=h.POLE_RADIUS,a=h.POLE_RADIUS_SQ,s=Math.round(r/90),l=90*s-r;if(s%2==0||Math.abs(l)>n)return e;const c=i-0,u=l*l+c*c;if(u<a){const e=Math.sqrt(u),t=(n-e)/e,a=1,s=0===l&&0===c?n*a:l;return new o.GeoCoordinates(i+c*t,r+s*t)}return e}getScaleFactor(e){return Math.cosh(2*(e.x/this.unitScale-.5)*Math.PI)}worldExtent(e,t,i){return i||(i=new r.Box3),i.min.x=0,i.min.y=0,i.min.z=e,i.max.x=this.unitScale,i.max.y=this.unitScale,i.max.z=t,i}projectPoint(e,t){var i;t||(t={x:0,y:0,z:0});const n=d.clampGeoPoint(e,this.unitScale),o=n.longitude/360+.5,a=1===o?0:Math.floor(o),s=r.MathUtils.degToRad(n.latitude),l=r.MathUtils.degToRad(n.longitude-360*a)-this.m_lambda0,c=Math.cos(s)*Math.sin(l);t.x=Math.atanh(c),t.y=Math.atan2(Math.tan(s),Math.cos(l))-this.m_phi0;const u=.5/Math.PI;return t.x=this.unitScale*(r.MathUtils.clamp(t.x*u+.5,0,1)+a),t.y=this.unitScale*r.MathUtils.clamp(t.y*u+.5,0,1),t.z=null!==(i=e.altitude)&&void 0!==i?i:0,t}unprojectPoint(e){const t=2*Math.PI,i=e.x/this.unitScale,r=e.y/this.unitScale,n=1===i?0:Math.floor(i),a=t*(i-.5-n),s=t*(r-.5),l=e.z||0,c=s+this.m_phi0,u=Math.asin(Math.sin(c)/Math.cosh(a)),d=this.m_lambda0+Math.atan2(Math.sinh(a),Math.cos(c))+n*t;return o.GeoCoordinates.fromRadians(u,d,l)}projectBox(e,t){const{north:i,south:n,east:c,west:u}=e,d=[e.center,e.northEast,e.southWest,new o.GeoCoordinates(n,c),new o.GeoCoordinates(i,u)],m=h.POLE_EDGE_DEG,p=u<90&&c>90,f=u<0&&c>0,g=u<m&&c>-m&&i>0&&n<0;u<-90&&c>-90&&(d.push(new o.GeoCoordinates(i,-90)),d.push(new o.GeoCoordinates(n,-90))),p&&(d.push(new o.GeoCoordinates(i,90)),d.push(new o.GeoCoordinates(n,90))),f&&(d.push(new o.GeoCoordinates(i,0)),d.push(new o.GeoCoordinates(n,0))),g&&(d.push(new o.GeoCoordinates(0,u)),d.push(new o.GeoCoordinates(0,c))),h.alignLatitude(d,d[0]);const y=d.map((e=>this.projectPoint(e))),v=y.map((e=>e.x)),_=y.map((e=>e.y)),b=y.map((e=>e.z)),S=Math.min(...v),T=Math.min(..._),E=Math.min(...b),C=Math.max(...v),w=Math.max(..._),x=Math.max(...b);if(t||(t=new r.Box3),a.isBox3Like(t))t.min.x=S,t.min.y=T,t.min.z=E,t.max.x=C,t.max.y=w,t.max.z=x;else{if(!l.isOrientedBox3Like(t))throw new Error("invalid bounding box");s.MathUtils.newVector3(1,0,0,t.xAxis),s.MathUtils.newVector3(0,1,0,t.yAxis),s.MathUtils.newVector3(0,0,1,t.zAxis),t.position.x=(S+C)/2,t.position.y=(T+w)/2,t.position.z=(E+x)/2,t.extents.x=(C-S)/2,t.extents.y=(w-T)/2,t.extents.z=(x-E)/2}return t}unprojectBox(e){const t=this.unitScale,i=e.min,r=e.max,a=[{x:(i.x+r.x)/2,y:(i.y+r.y)/2,z:0},i,r,{x:i.x,y:r.y,z:0},{x:r.x,y:i.y,z:0}],s=.5*t,l=.25*t,c=.75*t,u=i.x<s&&r.x>s,d=i.y<s&&r.y>s,m=i.y<l&&r.y>l,p=i.y<c&&r.y>c;d&&(a.push({x:i.x,y:s,z:0}),a.push({x:r.x,y:s,z:0}),u&&a.push({x:s,y:s,z:0})),m&&(a.push({x:i.x,y:l,z:0}),a.push({x:r.x,y:l,z:0}),u&&a.push({x:s,y:l,z:0})),p&&(a.push({x:i.x,y:c,z:0}),a.push({x:r.x,y:c,z:0}),u&&a.push({x:s,y:c,z:0}));const f=a.map((e=>this.unprojectPoint(e)));h.alignLongitude(f,f[0]);const g=f.map((e=>e.latitude)),y=f.filter((e=>Math.abs(e.latitude)<90)).map((e=>e.longitude)),v=f.map((e=>{var t;return null!==(t=e.altitude)&&void 0!==t?t:0})),_=new o.GeoCoordinates(Math.min(...g),Math.min(...y),Math.min(...v)),b=new o.GeoCoordinates(Math.max(...g),Math.max(...y),Math.max(...v));return n.GeoBox.fromCoordinates(_,b)}unprojectAltitude(e){return e.z}groundDistance(e){return e.z}scalePointToSurface(e){return e.z=0,e}surfaceNormal(e,t){return void 0===t?t={x:0,y:0,z:-1}:(t.x=0,t.y=0,t.z=-1),t}}class h{static alignLatitude(e,t){for(const i of e)0===i.latitude&&(i.latitude=1e-9*t.latitude)}static alignLongitude(e,t){const i=t.longitude<0?180:-180,r=t.longitude<0?-180:180;for(const t of e)t.longitude===i&&(t.longitude=r)}}t.TransverseMercatorUtils=h,h.POLE_EDGE=1.4844222297453322,h.POLE_EDGE_DEG=r.MathUtils.radToDeg(h.POLE_EDGE),h.POLE_RADIUS=90-h.POLE_EDGE_DEG,h.POLE_RADIUS_SQ=Math.pow(h.POLE_RADIUS,2),t.transverseMercatorProjection=new d(c.EarthConstants.EQUATORIAL_CIRCUMFERENCE)},81080:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlatTileBoundingBoxGenerator=void 0;const r=i(84428);t.FlatTileBoundingBoxGenerator=class{constructor(e,t=0,i=0){this.tilingScheme=e,this.minElevation=t,this.maxElevation=i,this.m_tilingScheme=e,this.m_worldBox=e.projection.worldExtent(t,i);const{min:r,max:n}=this.m_worldBox;this.m_worldDimensions={x:n.x-r.x,y:n.y-r.y,z:n.z-r.z}}get projection(){return this.m_tilingScheme.projection}get subdivisionScheme(){return this.m_tilingScheme.subdivisionScheme}getWorldBox(e,t){const i=e.level,n=this.subdivisionScheme.getLevelDimensionX(i),o=this.subdivisionScheme.getLevelDimensionY(i),a=this.m_worldDimensions.x/n,s=this.m_worldDimensions.y/o,l=this.m_worldBox.min.x+a*e.column,c=this.m_worldBox.min.y+s*e.row;return t||(t=new r.Box3),t.min.x=l,t.min.y=c,t.min.z=this.m_worldBox.min.z,t.max.x=l+a,t.max.y=c+s,t.max.z=this.m_worldBox.max.z,t}getGeoBox(e){const t=this.getWorldBox(e);return this.projection.unprojectBox(t)}}},20218:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.halfQuadTreeSubdivisionScheme=void 0,t.halfQuadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(e){return 0===e?1:2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 0!==e?1<<e-1:1}}},90999:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hereTilingScheme=void 0;const r=i(46685),n=i(20218),o=i(21519);t.hereTilingScheme=new o.TilingScheme(n.halfQuadTreeSubdivisionScheme,r.normalizedEquirectangularProjection)},60107:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mercatorTilingScheme=void 0;const r=i(94348),n=i(94644),o=i(21519);t.mercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,r.mercatorProjection)},96564:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.polarTilingScheme=void 0;const r=i(61479),n=i(94644),o=i(21519);t.polarTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,r.transverseMercatorProjection)},24585:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTree=void 0;const r=i(60696);t.QuadTree=class{constructor(e){this.tilingScheme=e}visit(e){this.visitTileKey(r.TileKey.fromRowColumnLevel(0,0,0),e)}visitTileKey(e,t){if(t(e,this.tilingScheme.getGeoBox(e)))for(const i of this.tilingScheme.getSubTileKeys(e))this.visitTileKey(i,t)}}},94644:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.quadTreeSubdivisionScheme=void 0,t.quadTreeSubdivisionScheme=new class{getSubdivisionX(){return 2}getSubdivisionY(){return 2}getLevelDimensionX(e){return 1<<e}getLevelDimensionY(e){return 1<<e}}},53718:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubTiles=void 0;const r=i(60696);class n{constructor(e,t,i){this.tileKey=e,this.sizeX=t,this.sizeY=i}[Symbol.iterator](){return 2===this.sizeX&&2===this.sizeY?n.ZCurveIterator(this.tileKey):n.RowColumnIterator(this.tileKey,this.sizeX,this.sizeY)}}t.SubTiles=n,function(e){e.RowColumnIterator=function*(e,t,i){for(let n=0;n<i;n++)for(let o=0;o<t;o++)yield r.TileKey.fromRowColumnLevel(e.row*i+n,e.column*t+o,e.level+1)},e.ZCurveIterator=function*(e){for(let t=0;t<4;t++)yield r.TileKey.fromRowColumnLevel(e.row<<1|t>>1,e.column<<1|1&t,e.level+1)}}(n=t.SubTiles||(t.SubTiles={}))},10347:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},60696:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileKey=void 0;const i=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496];class r{constructor(e,t,i){this.row=e,this.column=t,this.level=i}static fromRowColumnLevel(e,t,i){return new r(e,t,i)}static fromQuadKey(e){const t=e.length;let i=0,n=0;for(let r=0;r<e.length;++r){const o=1<<r,a=parseInt(e.charAt(t-r-1),10);1&a&&(n|=o),2&a&&(i|=o)}return r.fromRowColumnLevel(i,n,t)}static fromMortonCode(e){let t=0,i=0,n=0,o=e;for(;o>1;){const e=1<<t;1&o&&(n|=e),2&o&&(i|=e),t++,o=(o-(3&o))/4}const a=r.fromRowColumnLevel(i,n,t);return a.m_mortonCode=e,a}static fromHereTile(e){const t=r.fromMortonCode(parseInt(e,10));return t.m_hereTile=e,t}static columnsAtLevel(e){return Math.pow(2,e)}static rowsAtLevel(e){return Math.pow(2,e)}static atCoords(e,t,i,n,o){return r.fromRowColumnLevel(Math.floor(i/(o/r.rowsAtLevel(e))),Math.floor(t/(n/r.columnsAtLevel(e))),e)}static parentMortonCode(e){return Math.floor(e/4)}parent(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return r.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)}changedLevelBy(e){const t=Math.max(0,this.level+e);let i=this.row,n=this.column;return e>=0?(i<<=e,n<<=e):(i>>>=-e,n>>>=-e),r.fromRowColumnLevel(i,n,t)}changedLevelTo(e){return this.changedLevelBy(e-this.level)}mortonCode(){if(void 0===this.m_mortonCode){let e=this.column,t=this.row,r=i[this.level<<1];for(let n=0;n<this.level;++n)1&e&&(r+=i[2*n]),1&t&&(r+=i[2*n+1]),e>>>=1,t>>>=1;this.m_mortonCode=r}return this.m_mortonCode}toHereTile(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile}toQuadKey(){let e="";for(let t=this.level;t>0;--t){const i=1<<t-1,r=0!=(this.column&i),n=0!=(this.row&i);e+=r&&n?"3":n?"2":r?"1":"0"}return e}equals(e){return this.row===e.row&&this.column===e.column&&this.level===e.level}addedSubKey(e){const t=r.fromQuadKey(0===e.length?"-":e),i=this.changedLevelBy(t.level);return r.fromRowColumnLevel(i.row+t.row,i.column+t.column,i.level)}addedSubHereTile(e){const t=r.fromHereTile(e),i=this.changedLevelBy(t.level);return r.fromRowColumnLevel(i.row+t.row,i.column+t.column,i.level)}getSubHereTile(e){const t=1<<2*e;return(this.mortonCode()&t-1|t).toString()}rowCount(){return r.rowsAtLevel(this.level)}columnCount(){return r.columnsAtLevel(this.level)}}t.TileKey=r},73527:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileKeyUtils=t.powerOfTwo=void 0;const r=i(13211),n=i(60696);t.powerOfTwo=(()=>{let e=.5;return new Array(53).fill(0).map((()=>e*=2))})(),function(e){function i(e,t,i){const r=e.projection,o=e.subdivisionScheme,a=o.getLevelDimensionX(i),s=o.getLevelDimensionY(i),{min:l,max:c}=r.worldExtent(0,0),u=c.x-l.x,d=c.y-l.y;if(t.x<l.x||t.x>c.x)return null;if(t.y<l.y||t.y>c.y)return null;const h=Math.min(a-1,Math.floor(a*(t.x-l.x)/u)),m=Math.min(s-1,Math.floor(s*(t.y-l.y)/d));return n.TileKey.fromRowColumnLevel(m,h,i)}function o(e,i,r=4){const n=function(e,i=4){let r=0;const n=t.powerOfTwo[i];for(e+=n/2;e<0;)e+=n;for(;e>=n;)e-=n;for(let n=0;n<i&&e>0;n++)1&e&&(r+=t.powerOfTwo[53-i+n]),e>>>=1;return r}(i,r);return e.mortonCode()+n}function a(e,i=4){let r=0,n=e,o=0;for(;o<i;o++){const e=t.powerOfTwo[52-o];n>=e&&(n-=e,r+=t.powerOfTwo[i-1-o])}return r-=t.powerOfTwo[i-1],{offset:r,mortonCode:n}}e.geoCoordinatesToTileKey=function(e,t,r){return i(e,e.projection.projectPoint(t),r)},e.worldCoordinatesToTileKey=i,e.geoRectangleToTileKeys=function(t,i,o){const a=(e,t,i)=>e<t?i-(t-e)%(i-t):t+(e-t)%(i-t),s=(e,t,i)=>Math.min(Math.max(e,t),i),l=a(i.southWest.longitudeInRadians,-Math.PI,Math.PI),c=s(i.southWest.latitudeInRadians,-.5*Math.PI,.5*Math.PI),u=a(i.northEast.longitudeInRadians,-Math.PI,Math.PI),d=s(i.northEast.latitudeInRadians,-.5*Math.PI,.5*Math.PI),h=e.geoCoordinatesToTileKey(t,r.GeoCoordinates.fromRadians(c,l),o),m=e.geoCoordinatesToTileKey(t,r.GeoCoordinates.fromRadians(d,u),o),p=t.subdivisionScheme.getLevelDimensionX(o);if(!h||!m)throw new Error("Invalid coordinates");const f=h.column;let g=m.column;l>u&&(g+=g!==f?p:p-1);const y=Math.min(h.row,m.row),v=Math.max(h.row,m.row),_=new Array;for(let e=y;e<=v;++e)for(let t=f;t<=g;++t)_.push(n.TileKey.fromRowColumnLevel(e,t%p,o));return _},e.getKeyForTileKeyAndOffset=o,e.extractOffsetAndMortonKeyFromKey=a,e.getParentKeyFromKey=function(e,t=4){const{offset:i,mortonCode:r}=a(e,t);return o(n.TileKey.fromMortonCode(n.TileKey.parentMortonCode(r)),i,t)}}(t.TileKeyUtils||(t.TileKeyUtils={}))},92196:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileTreeTraverse=void 0;const r=i(53718);t.TileTreeTraverse=class{constructor(e){this.m_subdivisionScheme=e}subTiles(e){const t=this.m_subdivisionScheme.getSubdivisionX(e.level),i=this.m_subdivisionScheme.getSubdivisionY(e.level);return new r.SubTiles(e,t,i)}}},21519:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilingScheme=void 0;const r=i(81080),n=i(73527),o=i(92196);t.TilingScheme=class{constructor(e,t){this.subdivisionScheme=e,this.projection=t,this.boundingBoxGenerator=new r.FlatTileBoundingBoxGenerator(this),this.tileTreeTraverse=new o.TileTreeTraverse(e)}getSubTileKeys(e){return this.tileTreeTraverse.subTiles(e)}getTileKey(e,t){return n.TileKeyUtils.geoCoordinatesToTileKey(this,e,t)}getTileKeys(e,t){return n.TileKeyUtils.geoRectangleToTileKeys(this,e,t)}getGeoBox(e){return this.boundingBoxGenerator.getGeoBox(e)}getWorldBox(e,t){return this.boundingBoxGenerator.getWorldBox(e,t)}}},51184:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorTilingScheme=void 0;const r=i(94348),n=i(94644),o=i(21519);t.webMercatorTilingScheme=new o.TilingScheme(n.quadTreeSubdivisionScheme,r.webMercatorProjection)},10791:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(50440),t),n(i(19136),t),n(i(65556),t),n(i(74384),t)},65556:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionLine=t.HighPrecisionWireFrameLine=void 0;const r=i(84428),n=i(74384);class o extends r.Line{constructor(e,t,i){super(e,t),this.matrixWorldInverse=new r.Matrix4,i&&this.setPositions(i)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){n.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,i,r,o,a)=>{n.HighPrecisionUtils.updateHpUniforms(this,i,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionWireFrameLine=o;class a extends r.Mesh{constructor(e,t,i){super(e,t),this.matrixWorldInverse=new r.Matrix4,i&&this.setPositions(i)}get bufferGeometry(){return this.geometry}get shaderMaterial(){return this.material}setPositions(e){n.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.onBeforeRender=(e,t,i,r,o,a)=>{n.HighPrecisionUtils.updateHpUniforms(this,i,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionLine=a},62132:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionPoints=void 0;const r=i(30462),n=i(84428),o=i(74384);class a extends n.Points{constructor(e,t,i,o,a){void 0===t&&(t=new r.HighPrecisionPointMaterial({color:o||r.HighPrecisionPointMaterial.DEFAULT_COLOR,opacity:void 0!==a?a:1})),super(void 0===e?new n.BufferGeometry:e,t),this.matrixWorldInverse=new n.Matrix4,i&&this.setPositions(i)}get bufferGeometry(){return this.geometry}clearGeometry(){return this.geometry=new n.BufferGeometry}get shaderMaterial(){return this.material}setPositions(e){o.HighPrecisionUtils.setPositions(this,e)}setupForRendering(){this.material.isHighPrecisionPointsMaterial&&void 0!==this.dimensionality&&this.material.setDimensionality(this.dimensionality),this.onBeforeRender=(e,t,i,r,n,a)=>{o.HighPrecisionUtils.updateHpUniforms(this,i,this.shaderMaterial)}}updateMatrixWorld(e){const t=this.matrixWorldNeedsUpdate||e;super.updateMatrixWorld(e),t&&this.matrixWorldInverse.copy(this.matrixWorld).invert()}}t.HighPrecisionPoints=a},74384:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HighPrecisionUtils=void 0;const r=i(30462),n=i(84428),o=i(65556),a=i(62132),s=i(19136);!function(e){function t(e){return new n.Vector3(Math.fround(e.x),Math.fround(e.y),Math.fround(e.z))}function i(e,i){const r=(new n.Matrix4).copy(e.projectionMatrix).multiply(e.matrixWorldInverse),o=new n.Vector3(0,0,0).applyMatrix4(i),a=t(o);return{viewProjection:r,eyePosHi:a,eyePosLo:t(o.sub(a))}}function l(e){if(e.length>0){const t=e[0];if(null==t)throw Error("Empty element in positions");const i=new Array,r=new Array,o=(...e)=>{for(const t of e){const e=Math.fround(t);r.push(t-e),i.push(e)}},a=e=>{o(e.x,e.y,e.z)};if(void 0!==t.z)e.forEach((e=>{a(e)}));else{if(i.length%3!=0)throw Error("Positions must be 3D, not 2D");e.forEach((e=>{o(e)}))}return{positionHigh:new n.Float32BufferAttribute(i,3),positionLow:new n.Float32BufferAttribute(r,3)}}return{positionHigh:new n.Float32BufferAttribute([],3),positionLow:new n.Float32BufferAttribute([],3)}}function c(e,t,i=0){const r=new Array,n=e.length;for(let o=0;o<n;o+=t){for(let t=0;t<i;t++)r.push(e[o+t]);const n=e[o+i],a=e[o+i+1],s=e[o+i+2],l=Math.fround(n),c=n-l,u=Math.fround(a),d=a-u,h=Math.fround(s),m=s-h;r.push(l,u,h,c,d,m);for(let n=i+3;n<t;n++)r.push(e[o+n])}return r}function u(e,t){const i=l(t);return e.bufferGeometry.setAttribute("position",i.positionHigh),e.bufferGeometry.setAttribute("positionLow",i.positionLow),i.positionHigh.itemSize}e.doubleToFloatVec=t,e.makeFloatVec=function(e){const t=Math.fround(e.x),i=Math.fround(e.y),r=Math.fround(e.z),o=new n.Vector3(e.x-t,e.y-i,e.z-r);return e.x=Math.fround(t),e.y=Math.fround(i),e.z=Math.fround(r),o},e.createHighPrecisionCameraPos=i,e.updateHpUniforms=function(e,t,r){const n=i(t,e.matrixWorldInverse),o=n.viewProjection;if(void 0===r||!r.isMaterial)throw Error("High pecision line has no high precision material");if(!(r.uniforms&&r.uniforms.u_mvp&&r.uniforms.u_eyepos&&r.uniforms.u_eyepos_lowpart))throw Error("High pecision material has missing uniforms");r.uniforms.u_mvp.value=new Float32Array(o.elements),r.uniforms.u_eyepos.value=new Float32Array(n.eyePosHi.toArray()),r.uniforms.u_eyepos_lowpart.value=new Float32Array(n.eyePosLo.toArray())},e.createAttributes=l,e.addInterleavedAttributes3=c,e.setPositions=u,e.convertPositions=function(e){if(e.length<=0)return{positions:[]};const t=e[0];if(null==t)throw Error("Empty element in positions");const i=t;if(void 0===i.y&&void 0===i.z)return{positions:e};const r=new Array;return e.forEach((e=>{r.push(e.x,e.y,e.z)})),{positions:r}},e.createLine=function(e,t){const i=void 0!==t.lineWidth?t.lineWidth:5,a=void 0!==t.addCircles&&t.addCircles,l=void 0!==t.wireFrame&&t.wireFrame,u=[],d=[];s.triangulateLine(e,i,u,d,a);const h=new n.BufferGeometry,m=c(u,3),p=new n.InterleavedBuffer(new Float32Array(m),6),f=new n.InterleavedBufferAttribute(p,3,0,!1),g=new n.InterleavedBufferAttribute(p,3,3,!1);h.setAttribute("position",f),h.setAttribute("positionLow",g),h.setIndex(new n.BufferAttribute(new Uint32Array(d),1));const y=new r.HighPrecisionLineMaterial(t),v=l?new o.HighPrecisionWireFrameLine(h,y):new o.HighPrecisionLine(h,y);return v.setupForRendering(),v},e.createPoints=function(e,t){const i=[];for(let t=0;t<e.length;t++)i.push(i.length/3);const o=new n.BufferGeometry,s=r.isHighPrecisionPointMaterial(t)?t:new r.HighPrecisionPointMaterial(t),l=new a.HighPrecisionPoints(o,s);return u(l,e),l.setupForRendering(),l}}(t.HighPrecisionUtils||(t.HighPrecisionUtils={}))},50440:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineGroup=t.createSimpleLineGeometry=t.createLineGeometry=t.LineGeometry=void 0;const r=i(38338),n=i(84428),o=new n.Vector3,a=new n.Vector3,s=new n.Vector3,l=new n.Vector3,c=new n.Vector3,u={attributes:[{name:"extrusionCoord",itemSize:3,offset:0},{name:"position",itemSize:3,offset:3},{name:"tangent",itemSize:3,offset:6},{name:"biTangent",itemSize:4,offset:9}],stride:13},d={attributes:[{name:"uv",itemSize:2,offset:u.stride},{name:"normal",itemSize:3,offset:u.stride+2}],stride:5},h={attributes:[...u.attributes,...d.attributes],stride:u.stride+d.stride},m={attributes:[{name:"extrusionCoord",itemSize:2,offset:0},{name:"position",itemSize:3,offset:2},{name:"positionLow",itemSize:3,offset:5},{name:"tangent",itemSize:3,offset:8},{name:"biTangent",itemSize:4,offset:11}],stride:15},p={attributes:[...m.attributes,...d.attributes],stride:m.stride+d.stride};class f{constructor(){this.vertices=[],this.vertexColors=[],this.indices=[]}}function g(e,t){return t?e?p:m:e?h:u}function y(e,t,i,n,u,d,h=new f,m=!1){if(0===t.length)return h;const p=g(void 0!==u,m).stride,y=t.length/3,v=new Array(y),_=new Array(t.length-3),b=h.vertices.length/p,S=void 0!==n&&n.length>0,T=void 0!==u&&u.length>0,E=void 0!==d&&d.length&&t.length;r.assert(!S||n.length===y),r.assert(!T||u.length/2===y),r.assert(!E||d.length===t.length);let C=.1;v[0]=C;for(let e=0;e<y-1;++e){let i=0;for(let r=0;r<3;++r){const n=t[3*(e+1)+r]-t[3*e+r];_[3*e+r]=n,i+=n*n}C+=Math.sqrt(i),v[e+1]=C}const w=S?Math.abs(n[n.length-1]-n[0]):1,x=v[v.length-1]/w;if(S)for(let e=0;e<y;++e)v[e]=n[e]*x+.1;let P=!0;for(let e=0;e<3;++e)P=P&&t[e]===t[t.length-3+e];const O=[],A=(r,n,p,f,g)=>{O.length=0,h.vertices.push(f,-1*g,x),O.push(f,1*g,x);for(let e=0;e<3;++e){if(m){const i=Math.fround(t[3*r+e]),n=t[3*r+e]-i;h.vertices.push(i,n),O.push(i,n)}else h.vertices.push(t[3*r+e]),O.push(t[3*r+e]);a.setComponent(e,t[3*r+e])}for(let e=0;e<3;++e)s.setComponent(e,_[n+e]),l.setComponent(e,_[p+e]);s.normalize(),h.vertices.push(s.x,s.y,s.z),O.push(s.x,s.y,s.z),a.add(e),i.surfaceNormal(a,a);const y=function(e,t,i,r){let n=0;return t.equals(i)||(n=Math.acos(t.dot(i))*Math.sign(e.dot(o.copy(t).cross(i))),Number.isNaN(n)&&(n=0)),r.copy(t).add(i).normalize().cross(e).normalize(),n}(a,s,l.normalize(),c);h.vertices.push(c.x,c.y,c.z,y),O.push(c.x,c.y,c.z,y),T&&(h.vertices.push(u[2*r],u[2*r+1]),O.push(u[2*r],u[2*r+1]),h.vertices.push(a.x,a.y,a.z),O.push(a.x,a.y,a.z)),h.vertices.push(...O),E&&(h.vertexColors.push(d[3*r],d[3*r+1],d[3*r+2]),h.vertexColors.push(d[3*r],d[3*r+1],d[3*r+2]))};for(let e=0;e<y;++e){const t=P&&0===e?_.length-3:3*Math.max(0,e-1),i=P&&e===y-1?0:Math.min(3*e,_.length-3);e>0&&A(e,t,i,v[e-1],v[e]),e+1<y&&A(e,t,i,-1*v[Math.min(e,v.length-1)],v[Math.min(e+1,v.length-1)])}for(let e=0;e<y-1;++e){const t=b+4*e;h.indices.push(t,t+1,t+2,t+2,t+1,t+3)}return h}function v(e,t,i=new f){if(0===e.length)return i;const r=e.length/3;let n=i.vertices.length/3;const o=void 0!==t&&t.length&&e.length;for(let a=0;a<r;++a,n++){a>0&&i.indices.push(n),a<r-1&&i.indices.push(n);for(let r=0;r<3;++r)i.vertices.push(e[3*a+r]),o&&i.vertexColors.push(t[3*a+r])}return i}t.LineGeometry=f,t.createLineGeometry=y,t.createSimpleLineGeometry=v;class _{constructor(e=!1,t=!1,i=!1){this.hasNormalsAndUvs=e,this.highPrecision=t,this.isSimple=i,this.m_geometry=new f}static createGeometry(e,t,i,r,o=!1,a=!1,s=!1){if(s)return r.setAttribute("position",new n.BufferAttribute(new Float32Array(e),3)),t.length===e.length&&r.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),r.setIndex(new n.BufferAttribute(new Uint32Array(i),1)),r;{const s=g(o,a),l=new n.InterleavedBuffer(new Float32Array(e),s.stride);return s.attributes.forEach((e=>{const t=new n.InterleavedBufferAttribute(l,e.itemSize,e.offset,!1);r.setAttribute(e.name,t)})),t.length===e.length&&r.setAttribute("color",new n.BufferAttribute(new Float32Array(t),3)),r.setIndex(new n.BufferAttribute(new Uint32Array(i),1)),r}}clear(){this.m_geometry.vertices=[],this.m_geometry.vertexColors=[],this.m_geometry.indices=[]}add(e,t,i,n,o,a){return this.isSimple?v(t,a,this.m_geometry):(r.assert(!this.hasNormalsAndUvs||void 0!==o),y(e,t,i,n,o,a,this.m_geometry,this.highPrecision)),this}get vertices(){return this.m_geometry.vertices}get vertexColors(){return this.m_geometry.vertexColors}get indices(){return this.m_geometry.indices}get vertexAttributes(){return g(this.hasNormalsAndUvs,this.highPrecision).attributes}get stride(){return g(this.hasNormalsAndUvs,this.highPrecision).stride}createGeometry(e){return void 0===e&&(e=new n.BufferGeometry),_.createGeometry(this.m_geometry.vertices,this.m_geometry.vertexColors,this.m_geometry.indices,e,this.hasNormalsAndUvs,this.highPrecision)}}t.LineGroup=_},19136:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructLineWidth=t.reconstructLine=t.triangulateLine=t.numCirclePoints=void 0;const r=i(84428),n=new r.Vector3(0,0,1),o=[0,1,2,1,3,2],a=[0,1,3,3,1,2,0,3,4,5,4,3],s=Math.PI/8;function l(e,t,i,r,n,o){const a=n.length/3;n.push(e,t,0);for(let l=0;l<9;++l){const c=s*l+Math.PI/2+i;n.push(e+r*Math.cos(c),t+r*Math.sin(c),0),o.push(a,a+l+1,a+(l+1)%9+1)}}t.numCirclePoints=function(e){return 9},t.triangulateLine=function(e,t,i,s,c=!0,u=c){if(e.length<3)return;const d=new r.Vector2;if(c){const r=3!==e.length?d.set(e[3]-e[0],e[4]-e[1]).angle():0;l(e[0],e[1],r,t,i,s)}const h=i.length/3,m=new r.Vector3,p=new r.Vector3,f=new r.Vector3,g=new r.Vector3,y=new r.Vector3,v=new r.Vector3,_=new r.Vector3,b=new r.Vector3,S=new r.Vector3,T=e.length/3;let E=0;for(let r=0;r<T;++r){let l=!1;if(p.set(e[3*r],e[3*r+1],e[3*r+2]),r+1<T){if(f.set(e[3*(r+1)],e[3*(r+1)+1],e[3*(r+1)+2]),g.copy(f).sub(p).normalize().cross(n),y.copy(g),r>0&&(y.add(m).multiplyScalar(1-.5*g.dot(m)),l=m.angleTo(g)>Math.PI/2,l)){const e=t/Math.cos(g.angleTo(m)/2);v.copy(g).add(m).normalize().multiplyScalar(-e).add(p),_.copy(m).multiplyScalar(t).add(p),b.copy(g).add(m).normalize().multiplyScalar(e).add(p),S.copy(g).multiplyScalar(t).add(p)}l?i.push(v.x,v.y,v.z,_.x,_.y,_.z,b.x,b.y,b.z,S.x,S.y,S.z):(v.copy(y).multiplyScalar(-t).add(p),_.copy(y).multiplyScalar(t).add(p),i.push(v.x,v.y,v.z,_.x,_.y,_.z)),m.copy(g)}else v.copy(m).multiplyScalar(-t).add(p),_.copy(m).multiplyScalar(t).add(p),i.push(v.x,v.y,v.z,_.x,_.y,_.z);r!==T-1&&((l?a:o).forEach((e=>s.push(h+E+e))),E+=l?4:2)}if(u){const r=2!==e.length?d.set(e[3*(T-3)]-e[3*(T-2)],e[3*(T-3)+1]-e[3*(T-2)+1]).angle():Math.PI;l(e[3*(T-2)],e[3*(T-2)+1],r,t,i,s)}},t.reconstructLine=function(e,t){const i=new Float32Array(e.length/2);for(let r=3*t,n=2*r;r<i.length;r+=3,n+=6)i[r]=e[n]+.5*(e[n+3]-e[n]),i[r+1]=e[n+1]+.5*(e[n+3+1]-e[n+1]),i[r+2]=e[n+2]+.5*(e[n+3+2]-e[n+2]);return i},t.reconstructLineWidth=function(e,t){const i=e[2*t+3]-e[2*t],r=e[2*t+3+1]-e[2*t+1],n=e[2*t+3+2]-e[2*t+2];return.5*Math.sqrt(i*i+r*r+n*n)}},45772:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(49715),t)},49715:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.Entry=void 0;const r=i(38338);class n{constructor(e,t,i,r,n){this.key=e,this.value=t,this.size=i,this.newer=r,this.older=n}}t.Entry=n,t.LRUCache=class{constructor(e,t=(()=>1)){this.m_size=0,this.m_map=new Map,this.m_newest=null,this.m_oldest=null,this.m_capacity=e,this.m_sizeFunction=t}forEach(e,t){let i=this.m_newest;for(;null!==i;){const r=i.older;e.call(t,i.value,i.key,this),i=r}}get size(){return this.m_size}get capacity(){return this.m_capacity}get map(){return this.m_map}get newest(){return this.m_newest}get oldest(){return this.m_oldest}setCapacity(e){this.m_capacity=e,this.evict()}setCapacityAndMeasure(e,t=(()=>1)){this.m_capacity=e,this.m_sizeFunction=t,this.shrinkToCapacity()}shrinkToCapacity(){let e=0;const t=this.m_sizeFunction;let i=this.m_newest;for(;null!==i;){const r=t(i.value);i.size=r,e+=r,i=i.older}this.m_size=e,this.evict()}set(e,t){const i=this.m_sizeFunction(t);let o=this.m_map.get(e);if(void 0!==o)this.m_size=this.m_size-o.size+i,o.value=t,o.size=i,this.promoteEntry(o),this.evict();else{if(i>this.m_capacity)return;if(o=new n(e,t,i,null,null),0===this.m_map.size)this.m_newest=this.m_oldest=o;else{r.assert(null!==this.m_newest);const e=this.m_newest;o.older=this.m_newest,e.newer=o,this.m_newest=o}this.m_map.set(e,o),this.m_size+=i,this.evict()}}get(e){const t=this.m_map.get(e);if(void 0!==t)return this.promoteEntry(t),t.value}has(e){return this.m_map.has(e)}clear(){this.m_newest=this.m_oldest=null,this.m_size=0,this.m_map.clear()}evictAll(){const e=this.evictionCallback;void 0!==e&&this.forEach(((t,i)=>e(i,t))),this.clear()}evictSelected(e,t){const i=this.evictionCallback;let r=this.m_newest;for(;null!==r;){const n=r.older;e.call(t,r.value,r.key)&&(void 0!==i&&i(r.key,r.value),this.deleteEntry(r),this.m_map.delete(r.key)),r=n}}delete(e){const t=this.m_map.get(e);return void 0!==t&&(this.deleteEntry(t),this.m_map.delete(e))}evict(){for(;null!==this.m_oldest&&this.m_size>this.m_capacity;)if(void 0===this.evictOldest())return}evictOldest(){r.assert(null!==this.m_oldest);const e=this.m_oldest;r.assert(null===e.older);let t=e;if(void 0!==this.canEvict)for(;!this.canEvict(t.key,t.value);){if(null===t.newer)return;t=t.newer}if(t===e)this.m_oldest=t.newer,null!==t.newer&&(r.assert(t.newer.older===t),t.newer.older=null);else{if(null===t.newer)return;r.assert(t.newer.older===t),t.newer.older=t.older,null!==t.older&&(t.older.newer=t.newer)}const i=this.m_map.delete(t.key);return r.assert(!0===i),i&&void 0!==this.evictionCallback&&this.evictionCallback(t.key,t.value),this.m_size-=t.size,t}deleteEntry(e){e===this.m_newest?this.m_newest=e.older:e.newer?e.newer.older=e.older:r.assert(!1),e===this.m_oldest?this.m_oldest=e.newer:e.older?e.older.newer=e.newer:r.assert(!1),this.m_size-=e.size}promoteEntry(e){if(e===this.m_newest)return;e.newer&&(r.assert(e.newer.older===e),e.newer.older=e.older),e.older&&(r.assert(e.older.newer===e),e.older.newer=e.newer),e===this.m_oldest&&(this.m_oldest=e.newer),e.newer=null,e.older=this.m_newest,r.assert(null!==this.m_newest);const t=this.m_newest;r.assert(null===t.newer),t.newer=e,this.m_newest=e}}},19955:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(24117),t),n(i(54401),t),n(i(90941),t),n(i(87120),t),n(i(16731),t),n(i(50414),t)},19898:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(11504),t),n(i(11597),t),n(i(77860),t)},11504:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProvider=void 0,i(76254);const r=i(84428);class n extends r.EventDispatcher{constructor(){super(...arguments),this.m_clients=new Set}register(e){return 0===this.m_clients.size&&(this.m_connectPromise=this.connect()),this.m_clients.add(e),this.m_connectPromise}unregister(e){this.m_clients.delete(e)&&0===this.m_clients.size&&this.dispose()}}t.DataProvider=n},50414:(e,t,i)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonTiler=void 0;const n=i(96500),o=i(8305),a=null!==(r=o.default)&&void 0!==r?r:o,s=-(-2&-Math.ceil(204.8));t.GeoJsonTiler=class{constructor(){this.indexes=new Map}dispose(){}async connect(){return await Promise.resolve()}async registerIndex(e,t){if(!this.indexes.has(e))return await this.updateIndex(e,t)}async updateIndex(e,t){if(t instanceof URL){const e=await fetch(t.href);if(!e.ok)throw new Error(`GeoJsonTiler: Unable to fetch ${t.href}: ${e.statusText}`);t=await e.json()}else t=t;const i=n.isFeatureGeometry(t)||"GeometryCollection"===t.type||"Feature"===t.type&&void 0===t.id||"FeatureCollection"===t.type&&t.features.length>0&&void 0===t.features[0].id,r=a(t,{maxZoom:20,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:s,lineMetrics:!1,promoteId:null,generateId:i,debug:0});r.geojson=t,this.indexes.set(e,r)}async getTile(e,t){const i=this.indexes.get(e);if(void 0===i)throw new Error("Tile not found");const r=i.getTile(t.level,t.column,t.row);return null!==r&&(r.layer=e),r||{}}}},24117:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemedTileDecoder=void 0;const r=i(17550),n=i(38338).LoggerManager.instance.create("ThemedTileDecoder");t.ThemedTileDecoder=class{constructor(){this.m_storageLevelOffset=0}dispose(){}decodeTile(e,t,i){return void 0===this.m_styleSetEvaluator?(n.info("cannot decode tile, as there is not style available"),Promise.resolve(void 0)):this.decodeThemedTile(e,t,this.m_styleSetEvaluator,i)}getTileInfo(e,t,i){return Promise.resolve(void 0)}configure(e,t){void 0!==(null==e?void 0:e.styleSet)&&(this.m_styleSetEvaluator=new r.StyleSetEvaluator(e)),void 0!==(null==e?void 0:e.languages)&&(this.languages=e.languages),void 0!==t&&void 0!==t.storageLevelOffset&&(this.m_storageLevelOffset=t.storageLevelOffset)}}},11597:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileDataSource=t.TileFactory=void 0;const r=i(90602),n=i(37581),o=i(38338),a=i(77860);t.TileFactory=class{constructor(e){this.m_modelConstructor=e}create(e,t){const i=new this.m_modelConstructor(e,t);return i.tileLoader=new a.TileLoader(e,t,e.dataProvider(),e.decoder),i}};class s extends r.DataSource{constructor(e,t){var i,n;if(super(t),this.m_tileFactory=e,this.m_options=t,this.logger=o.LoggerManager.instance.create("TileDataSource"),this.m_isReady=!1,t.decoder)this.m_decoder=t.decoder;else{if(!t.concurrentDecoderServiceName)throw new Error(`TileDataSource[${this.name}]: unable to create, missing decoder or concurrentDecoderServiceName`);this.m_decoder=r.ConcurrentDecoderFacade.getTileDecoder(t.concurrentDecoderServiceName,t.concurrentDecoderScriptUrl,t.concurrentDecoderWorkerCount,t.workerConnectionTimeout)}this.useGeometryLoader=!0,this.cacheable=!0,this.m_unregisterClearTileCache=null===(n=(i=this.dataProvider()).onDidInvalidate)||void 0===n?void 0:n.call(i,(()=>this.mapView.markTilesDirty(this)))}dispose(){var e;null===(e=this.m_unregisterClearTileCache)||void 0===e||e.call(this),this.decoder.dispose(),this.dataProvider().unregister(this)}ready(){return this.m_isReady&&this.m_options.dataProvider.ready()}get decoder(){return this.m_decoder}async connect(){await Promise.all([this.m_options.dataProvider.register(this),this.m_decoder.connect()]),this.m_isReady=!0;let e={};void 0!==this.m_options.storageLevelOffset&&(e={storageLevelOffset:this.m_options.storageLevelOffset}),this.m_decoder.configure({languages:this.languages},e)}setLanguages(e){this.languages=e,this.m_decoder.configure({languages:this.languages}),this.mapView.clearTileCache(this.name)}async setTheme(e,t){let i;e=await n.ThemeLoader.load(e),void 0!==this.styleSetName&&void 0!==e.styles&&(i=e.styles[this.styleSetName]),void 0!==t&&(this.languages=t),void 0!==i&&(this.m_decoder.configure({styleSet:i,definitions:e.definitions,priorities:e.priorities,labelPriorities:e.labelPriorities,languages:t}),this.mapView.clearTileCache(this.name))}dataProvider(){return this.m_options.dataProvider}getTilingScheme(){return this.m_options.tilingScheme}getTile(e,t=!1){const i=this.m_tileFactory.create(this,e);return i.copyrightInfo=this.m_options.copyrightInfo,void 0!==this.m_options.copyrightProvider&&this.m_options.copyrightProvider.getCopyrights(i.geoBox,e.level).then((e=>{i.copyrightInfo=void 0===i.copyrightInfo?e:[...i.copyrightInfo,...e],this.requestUpdate()})),t||i.load(),i}getTileInfo(e){return new Promise(((t,i)=>{const n=new a.TileInfoLoader(this,e,this.m_options.dataProvider,this.decoder);n.loadAndDecode().then((e=>{e===r.TileLoaderState.Ready?t(n.tileInfo):i(new Error(`TileDataSource#getInfoTile wrong final state: ${e}`))}))}))}}t.TileDataSource=s},54401:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileDecoderService=void 0;const r=i(96500),n=i(32941),o=i(38338),a=i(87120),s=o.LoggerManager.instance.create("TileDecoderService");class l extends a.WorkerService{constructor(e,t){super(e),this.serviceId=e,this.m_decoder=t,this.m_decoder.connect()}static start(e,t){return new l(e,t)}handleRequest(e){return r.WorkerDecoderProtocol.isDecodeTileRequest(e)?this.handleDecodeTileRequest(e):r.WorkerDecoderProtocol.isTileInfoRequest(e)?this.handleTileInfoRequest(e):super.handleRequest(e)}handleMessage(e){r.WorkerDecoderProtocol.isConfigurationMessage(e)?this.handleConfigurationMessage(e):s.error(`[${this.serviceId}]: invalid message ${e.type}`)}async handleDecodeTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),i=r.getProjection(e.projection),o=await this.m_decoder.decodeTile(e.data,t,i),a=[],s=e=>{void 0!==e&&e.buffer.byteLength>0&&!a.includes(e.buffer)&&a.push(e.buffer)};return null==o||o.geometries.forEach((e=>{var t,i,r;if(null===(t=e.vertexAttributes)||void 0===t||t.forEach((e=>s(e))),null===(i=e.interleavedVertexAttributes)||void 0===i||i.forEach((e=>s(e))),s(e.index),s(e.edgeIndex),Array.isArray(e.objInfos)&&1===e.objInfos.length&&"object"==typeof e.objInfos[0]&&(null===(r=e.objInfos[0])||void 0===r?void 0:r.hasOwnProperty("displacementMap"))){const t=e.objInfos[0];s(t.displacementMap)}Array.isArray(e.attachments)&&e.attachments.forEach((e=>{s(e.index),s(e.edgeIndex)}))})),null==o||o.techniques.forEach((e=>{r.addBuffersToTransferList(e,a)})),{response:o,transferList:a}}handleTileInfoRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey),i=r.getProjection(e.projection);return this.m_decoder.getTileInfo(e.data,t,i).then((e=>({response:e,transferList:void 0!==e&&void 0!==e.transferList?e.transferList:[]})))}handleConfigurationMessage(e){this.m_decoder.configure(e,e.options)}}t.TileDecoderService=l},77860:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileInfoLoader=t.TileLoader=void 0,i(76254);const r=i(96500),n=i(90602),o=i(10772),a=i(38338).LoggerManager.instance.create("TileLoader");class s extends n.BaseTileLoader{constructor(e,t,i,r){super(e,t),this.dataSource=e,this.tileKey=t,this.dataProvider=i,this.tileDecoder=r}get priority(){return this.m_priority}set priority(e){this.m_priority=e,void 0!==this.requestController&&(this.requestController.priority=e)}loadImpl(e,t,i){this.dataProvider.getTile(this.tileKey,e).then((r=>{if(e.aborted){const e=new Error("Aborted");throw e.name="AbortError",e}this.onLoaded(r,t,i)})).catch((e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&i(e)}))}cancelImpl(){this.state===o.TileLoaderState.Decoding&&this.requestController&&(this.requestController.abort(),this.requestController=void 0)}startDecodeTile(e,t){const i=this.payload;if(void 0===i)return void a.error("TileLoader#startDecodeTile: Cannot decode without payload");this.state=o.TileLoaderState.Decoding,this.payload=void 0;const n=new r.RequestController(this.priority);this.requestController=n;const s=this.dataSource;this.tileDecoder.decodeTile(i,this.tileKey,s.projection,n).then((t=>{n.signal.aborted||this.onDecoded(t,e)})).catch((e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&t(e)}))}onLoaded(e,t,i){this.state=o.TileLoaderState.Loaded,this.payload=e,0===e.byteLength||e.constructor===Object&&0===Object.keys(e).length?this.onDecoded({geometries:[],techniques:[]},t):this.startDecodeTile(t,i)}onDecoded(e,t){this.decodedTile=e,t(o.TileLoaderState.Ready)}}t.TileLoader=s,t.TileInfoLoader=class extends s{startDecodeTile(e,t){const i=this.payload;if(void 0===i)return void a.error("TileInfoLoader#startDecodeTile: Cannot decode without payload");this.state=o.TileLoaderState.Decoding,this.payload=void 0;const n=new r.RequestController(this.priority);this.requestController=n;const s=this.dataSource;this.tileDecoder.getTileInfo(i,this.tileKey,s.projection,n).then((t=>{n.signal.aborted||(this.tileInfo=t,e(o.TileLoaderState.Ready))})).catch((e=>{"AbortError"!==e.name&&"AbortError: Aborted"!==e.message&&t(e)}))}}},90941:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilerService=void 0;const r=i(96500),n=i(32941),o=i(50414),a=i(87120);class s extends a.WorkerService{constructor(e){super(e),this.serviceId=e,this.tiler=new o.GeoJsonTiler}static start(e){return new s(e)}handleRequest(e){return r.WorkerTilerProtocol.isRegisterIndexRequest(e)?this.handleRegisterIndexRequest(e):r.WorkerTilerProtocol.isUpdateIndexRequest(e)?this.handleUpdateIndexRequest(e):r.WorkerTilerProtocol.isTileRequest(e)?this.handleTileRequest(e):super.handleRequest(e)}async handleTileRequest(e){const t=n.TileKey.fromMortonCode(e.tileKey);return{response:await this.tiler.getTile(e.index,t)||{}}}async handleRegisterIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return await this.tiler.registerIndex(e.id,t),{response:{}}}async handleUpdateIndexRequest(e){const t="string"==typeof e.input?new URL(e.input):e.input;return this.tiler.updateIndex(e.id,t),{response:{}}}}t.TilerService=s},87120:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerService=void 0;const r=i(96500),n=i(38338).LoggerManager.instance.create("WorkerService",{enabled:!0});t.WorkerService=class{constructor(e){this.serviceId=e,this.m_pendingRequests=new Map,this.onMessage=e=>{if("string"==typeof e.data.service&&e.data.service===this.serviceId)try{if(r.WorkerServiceProtocol.isRequestMessage(e.data)){const t=e.data,i={service:t.service,messageId:t.messageId,responseSent:!1};this.m_pendingRequests.set(t.messageId,i),this.tryHandleRequest(t.request).then((e=>{this.doSendResponse(i,{service:this.serviceId,type:r.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,response:e.response},e.transferList)})).catch((e=>{this.doSendResponse(i,{service:this.serviceId,type:r.WorkerServiceProtocol.ServiceMessageName.Response,messageId:t.messageId,errorMessage:e.toString(),errorStack:e.stack})}))}else this.tryHandleMessage(e.data)}catch(t){n.error(`[${this.serviceId}]: Unhandled exception when handling ${e.type}`)}},self.addEventListener("message",this.onMessage);const t={service:e,type:r.WorkerServiceProtocol.ServiceMessageName.Initialized};self.postMessage(t)}destroy(){this.cancelAllPendingRequests(),self.removeEventListener("message",this.onMessage)}handleMessage(e){n.error(`[${this.serviceId}]: Invalid message ${e.type}`)}handleRequest(e){throw new Error(`ServiceAdapter[${this.serviceId}]: Invalid request '${e.type}'`)}tryHandleMessage(e){try{this.handleMessage(e)}catch(t){n.error(`[${this.serviceId}]: Failed, handling message ${e.type}`)}}tryHandleRequest(e){try{return this.handleRequest(e)}catch(e){return n.error(`[${this.serviceId}]: Failure`,e),Promise.reject(e)}}doSendResponse(e,t,i){e.responseSent||(void 0!==i?self.postMessage(t,i):self.postMessage(t),e.responseSent=!0,this.m_pendingRequests.delete(e.messageId))}cancelAllPendingRequests(){this.m_pendingRequests.forEach((e=>{this.doSendResponse(e,{service:this.serviceId,type:r.WorkerServiceProtocol.ServiceMessageName.Response,messageId:e.messageId,errorMessage:"cancelled"})}))}}},16731:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerServiceManager=void 0;const r=i(96500),n=i(87120);class o extends n.WorkerService{constructor(e=r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID){super(e),this.m_factories=new Map,this.m_services=new Map}static getInstance(){return void 0===this.m_service&&(this.m_service=new o(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID)),this.m_service}register(e){this.m_factories.set(e.serviceType,e.factory)}handleRequest(e){if(e.type===r.WorkerServiceProtocol.Requests.CreateService){if(void 0!==this.m_services.get(e.targetServiceId))throw Error(`error - service with targetServiceId='${e.targetServiceId}' already running, ignoring CreateService request`);const t=this.m_factories.get(e.targetServiceType);if(void 0===t)throw Error(`unknown targetServiceType requested: '${e.targetServiceType}'`);const i=t(e.targetServiceId);this.m_services.set(e.targetServiceId,i)}if(e.type===r.WorkerServiceProtocol.Requests.DestroyService){const t=this.m_services.get(e.targetServiceId);if(void 0===t)throw Error(`unknown targetServiceId '${e.targetServiceId}'`);t.destroy(),this.m_services.delete(e.targetServiceId)}return Promise.resolve({response:{}})}}t.WorkerServiceManager=o},90602:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(43064),t),n(i(9152),t),n(i(79882),t),n(i(38738),t),n(i(81621),t),n(i(95585),t),n(i(40160),t),n(i(23193),t),n(i(41470),t),n(i(4038),t),n(i(74678),t),n(i(11369),t),n(i(69598),t),n(i(77391),t),n(i(25370),t),n(i(86140),t),n(i(86381),t),n(i(11566),t),n(i(41621),t),n(i(16875),t),n(i(37337),t),n(i(47678),t),n(i(50519),t),n(i(2422),t),n(i(16114),t),n(i(10772),t),n(i(49140),t),n(i(86870),t),n(i(50921),t),n(i(45572),t),n(i(17624),t),n(i(64525),t),n(i(63311),t),n(i(71540),t),n(i(67180),t),n(i(66437),t),n(i(22227),t),n(i(61257),t),n(i(11970),t),n(i(54504),t),n(i(22469),t),n(i(30924),t),n(i(37581),t),n(i(84070),t),n(i(27462),t),n(i(43867),t),n(i(83829),t),n(i(96393),t),n(i(64665),t),n(i(56009),t),n(i(75249),t)},43064:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnimatedExtrusionHandler=t.AnimatedExtrusionState=void 0;const r=i(96500),n=i(30462),o=i(38338);var a;!function(e){e[e.None=0]="None",e[e.Started=1]="Started",e[e.Finished=2]="Finished"}(a=t.AnimatedExtrusionState||(t.AnimatedExtrusionState={})),t.AnimatedExtrusionHandler=class{constructor(e){this.m_mapView=e,this.enabled=!0,this.duration=750,this.m_minZoomLevel=1,this.m_forceEnabled=!1,this.m_dataSourceMap=new Map,this.m_state=a.None,this.m_startTime=-1}get forceEnabled(){return this.m_forceEnabled}set forceEnabled(e){this.m_forceEnabled=e,this.duration=750}get minZoomLevel(){return this.m_minZoomLevel}setAnimationProperties(e,t){if(!r.isExtrudedPolygonTechnique(e))return!1;if(e.hasOwnProperty("minZoomLevel")&&(this.m_minZoomLevel=e.minZoomLevel),this.forceEnabled)return this.enabled;void 0!==e.animateExtrusionDuration&&(this.duration=e.animateExtrusionDuration);const i=r.getPropertyValue(e.animateExtrusion,t);return null===i?this.enabled:"boolean"==typeof i?i:"number"==typeof i&&0!==i}update(e){const t=this.m_dataSourceMap.size>0&&e>=this.m_minZoomLevel;this.m_state===a.None&&t?this.m_state=a.Started:this.m_state===a.None||t||this.resetAnimation(!0),this.animateExtrusion()}add(e,t){e.addDisposeCallback(this.removeTile.bind(this));let i=!1;this.m_state!==a.None&&(i=this.skipAnimation(e),i?this.setTileExtrusionRatio(t,1):this.m_state===a.Finished&&this.resetAnimation(!1)),this.getOrCreateTileMap(e.dataSource).set(e.tileKey.mortonCode(),{materials:t,animated:i})}get isAnimating(){return this.m_state!==a.Finished&&this.m_state!==a.None}getTileMap(e,t=!1){return this.m_dataSourceMap.get(e)}getOrCreateTileMap(e){let t=this.m_dataSourceMap.get(e);return t||(t=new Map,this.m_dataSourceMap.set(e,t)),t}skipAnimation(e){return this.wasAnyAncestorAnimated(e)||this.wasAnyDescendantAnimated(e)}wasAnyAncestorAnimated(e){var t,i;const r=e.dataSource.getDataZoomLevel(this.m_minZoomLevel),n=Math.max(0,e.tileKey.level-r),o=Math.min(n,this.m_mapView.visibleTileSet.options.quadTreeSearchDistanceUp),a=this.getTileMap(e.dataSource);if(!a)return!1;let s=e.tileKey;for(let e=1;e<=o;++e)if(s=s.parent(),null!==(i=null===(t=a.get(s.mortonCode()))||void 0===t?void 0:t.animated)&&void 0!==i&&i)return!0;return!1}wasAnyDescendantAnimated(e){var t,i;const r=e.dataSource.maxDataLevel-e.tileKey.level,n=Math.min(r,this.m_mapView.visibleTileSet.options.quadTreeSearchDistanceDown),o=this.getTileMap(e.dataSource);if(!o)return!1;const a=e.dataSource.getTilingScheme();let s=[e.tileKey],l=[];for(let e=1;e<=n;++e){l.length=0;for(const e of s)for(const r of a.getSubTileKeys(e)){if(null!==(i=null===(t=o.get(r.mortonCode()))||void 0===t?void 0:t.animated)&&void 0!==i&&i)return!0;l.push(r)}[s,l]=[l,s]}return!1}removeTile(e){const t=this.getTileMap(e.dataSource);t&&(t.delete(e.tileKey.mortonCode()),0===t.size&&this.m_dataSourceMap.delete(e.dataSource))}animateExtrusion(){if(this.m_state!==a.Started)return;const e=Date.now();this.m_startTime<0&&(this.m_startTime=e);const t=this.duration,i=Math.min(e-this.m_startTime,t),r=o.MathUtils.easeInOutCubic(n.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN,n.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX,i/t);this.setExtrusionRatio(r),i>=t&&(this.m_state=a.Finished),this.m_mapView.update()}resetAnimation(e){this.m_state=a.None,this.m_startTime=-1,e&&this.m_dataSourceMap.forEach((e=>{e.forEach((e=>{e.animated=!1}))}))}setExtrusionRatio(e){this.m_dataSourceMap.forEach((t=>{t.forEach((t=>{t.animated||(this.setTileExtrusionRatio(t.materials,e),e>=1&&(t.animated=!0))}))}))}setTileExtrusionRatio(e,t){e.forEach((e=>{e.extrusionRatio=t}))}}},45886:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundDataSource=void 0;const r=i(32941),n=i(86140),o=i(73553),a=i(84070);class s extends n.DataSource{constructor(){super({name:"background"}),this.m_tilingScheme=s.DEFAULT_TILING_SCHEME,this.cacheable=!0,this.addGroundPlane=!0,this.enablePicking=!1}updateStorageLevelOffset(){let e;this.mapView.dataSources.forEach((t=>{t!==this&&t.getTilingScheme()===this.m_tilingScheme&&(e=void 0===e?t.storageLevelOffset:Math.max(e,t.storageLevelOffset))})),void 0===e&&(e=0),e!==this.storageLevelOffset&&(this.storageLevelOffset=e,this.mapView.clearTileCache(this.name))}async setTheme(e,t){this.mapView.clearTileCache(this.name)}setTilingScheme(e){const t=null!=e?e:s.DEFAULT_TILING_SCHEME;t!==this.m_tilingScheme&&(this.m_tilingScheme=t,this.updateStorageLevelOffset(),this.mapView.clearTileCache(this.name))}getTilingScheme(){return this.m_tilingScheme}getTile(e){const t=new a.Tile(this,e);return t.forceHasGeometry(!0),o.addGroundPlane(t,s.GROUND_RENDER_ORDER),t}}t.BackgroundDataSource=s,s.GROUND_RENDER_ORDER=Number.MIN_SAFE_INTEGER,s.DEFAULT_TILING_SCHEME=r.webMercatorTilingScheme},9152:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTileLoader=void 0;const r=i(38338),n=i(10772),o=r.LoggerManager.instance.create("BaseTileLoader");t.BaseTileLoader=class{constructor(e,t){this.dataSource=e,this.tileKey=t,this.state=n.TileLoaderState.Initialized,this.m_priority=0,this.loadAbortController=new AbortController}get priority(){return this.m_priority}set priority(e){this.m_priority=e}loadAndDecode(){switch(this.state){case n.TileLoaderState.Loading:case n.TileLoaderState.Loaded:case n.TileLoaderState.Decoding:return this.donePromise;case n.TileLoaderState.Ready:case n.TileLoaderState.Failed:case n.TileLoaderState.Initialized:case n.TileLoaderState.Canceled:return this.load(),this.donePromise}}waitSettled(){return this.donePromise?this.donePromise:Promise.resolve(this.state)}cancel(){this.state===n.TileLoaderState.Loading&&(this.loadAbortController.abort(),this.loadAbortController=new AbortController),this.cancelImpl(),this.onDone(n.TileLoaderState.Canceled)}get isFinished(){return this.state===n.TileLoaderState.Ready||this.state===n.TileLoaderState.Canceled||this.state===n.TileLoaderState.Failed}cancelImpl(){}load(){this.loadImpl(this.loadAbortController.signal,this.onDone.bind(this),this.onError.bind(this)),void 0===this.donePromise&&(this.donePromise=new Promise(((e,t)=>{this.resolveDonePromise=e,this.rejectedDonePromise=t}))),this.state=n.TileLoaderState.Loading}onDone(e){this.resolveDonePromise&&e===n.TileLoaderState.Ready?this.resolveDonePromise(e):this.rejectedDonePromise&&this.rejectedDonePromise(e),this.resolveDonePromise=void 0,this.rejectedDonePromise=void 0,this.donePromise=void 0,this.state=e}onError(e){if(this.state===n.TileLoaderState.Canceled)return;const t=this.dataSource;o.error(`[${t.name}]: failed to load tile ${this.tileKey.mortonCode()}`,e),this.error=e,this.onDone(n.TileLoaderState.Failed)}}},79882:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BoundsGenerator=void 0;const r=i(32941),n=i(28496),o=i(68693);t.BoundsGenerator=class{constructor(e){this.m_view=e,this.createViewBounds()}generate(){return this.m_view.projection!==this.m_viewBounds.projection&&this.createViewBounds(),this.m_viewBounds.generate()}createViewBounds(){this.m_viewBounds=this.m_view.projection.type===r.ProjectionType.Planar?new n.PlaneViewBounds(this.m_view.camera,this.m_view.projection,this.m_view):new o.SphereViewBounds(this.m_view.camera,this.m_view.projection)}}},38738:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraMovementDetector=void 0;const r=i(84428),n=i(83829);t.CameraMovementDetector=class{constructor(e,t,i){this.m_throttlingTimeout=e,this.m_movementStartedFunc=t,this.m_movementFinishedFunc=i,this.m_lastCameraPos=new r.Vector3,this.m_newCameraPos=new r.Vector3,this.m_throttlingTimerId=void 0,this.m_movementDetectorDeadline=0,this.onDeadlineTimer=()=>{this.m_throttlingTimerId=void 0;const e=performance.now();e>=this.m_movementDetectorDeadline?this.movementFinished():this.startMovementFinishedTimer(e)},void 0===this.m_throttlingTimeout&&(this.m_throttlingTimeout=300)}checkCameraMoved(e,t){const i=n.MapViewUtils.extractAttitude(e,e.camera),r=e.camera.getWorldPosition(this.m_newCameraPos);if(void 0===this.m_lastAttitude)return this.m_lastCameraPos.copy(r),this.m_lastAttitude=i,!1;const o=!this.m_lastCameraPos.equals(r)||i.yaw!==this.m_lastAttitude.yaw||i.pitch!==this.m_lastAttitude.pitch||i.roll!==this.m_lastAttitude.roll;return o&&(this.m_lastCameraPos.copy(r),this.m_lastAttitude=i),o!==this.m_cameraMovedLastFrame&&(o&&this.movementStarted(),this.m_cameraMovedLastFrame=o),o&&(this.m_movementDetectorDeadline=t+this.m_throttlingTimeout,this.startMovementFinishedTimer(t)),this.m_cameraMovedLastFrame}clear(e){const t=e.camera.getWorldPosition(this.m_newCameraPos);this.m_lastCameraPos.set(t.x,t.y,t.z);const i=n.MapViewUtils.extractAttitude(e,e.camera);this.m_lastAttitude=i}forceMoved(){this.m_lastCameraPos.set(Number.NaN,Number.NaN,Number.NaN)}get cameraIsMoving(){return void 0!==this.m_throttlingTimerId}dispose(){this.removeMovementFinishedTimer(),this.m_movementStartedFunc=void 0,this.m_movementFinishedFunc=void 0}get cameraMovedLastFrame(){return!0===this.m_cameraMovedLastFrame}movementStarted(){void 0!==this.m_movementStartedFunc&&this.m_movementStartedFunc()}movementFinished(){this.removeMovementFinishedTimer(),void 0!==this.m_movementFinishedFunc&&this.m_movementFinishedFunc()}startMovementFinishedTimer(e){if(void 0===this.m_throttlingTimerId){const t=Math.max(0,this.m_movementDetectorDeadline-e);this.m_throttlingTimerId=setTimeout(this.onDeadlineTimer,t)}}removeMovementFinishedTimer(){void 0!==this.m_throttlingTimerId&&(clearTimeout(this.m_throttlingTimerId),this.m_throttlingTimerId=void 0)}}},81621:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraUtils=void 0;const r=i(38338),n=i(84428),o=i(41621);function a(e,t,i){return r.assert(e>0,"Focal length must be larger than 0"),Math.atan((1-t)*i*.5/e)}function s(e,t,i){return r.assert(e>0,"Focal length must be larger than 0"),0===t?2*Math.atan(.5*i/e):a(e,t,i)+a(e,-t,i)}function l(e){return e.userData.fovs}function c(e,t,i,r,l){const c=r*e.aspect;let d=s(i,t.x,c);if((d<o.MIN_FOV_RAD||d>o.MAX_FOV_RAD)&&(d=n.MathUtils.clamp(d,o.MIN_FOV_RAD,o.MAX_FOV_RAD),l=s(u(d,c,t.x),t.y,r)),e.fov=n.MathUtils.radToDeg(l),0===(h=t).x&&0===h.y)delete e.userData.fovs;else{const n=r*e.aspect;e.userData.fovs={top:a(i,t.y,r),right:a(i,t.x,n),horizontal:d}}var h;e.userData.focalLength=i}function u(e,t,i){const n=t/2;if(0===i)return n/Math.tan(e/2);const o=i**2;if(Math.abs(e-Math.PI/2)<1e-6)return n*Math.sqrt(1-o);const a=Math.tan(e),s=n*(1+Math.sign(a)*Math.sqrt(1+a**2*(1-o)))/a;return r.assert(s>=0,"Focal length must be larger than 0"),s}!function(e){function t(e){var t;return null===(t=e.userData)||void 0===t?void 0:t.focalLength}function i(e){return n.MathUtils.degToRad(e.fov)}function r(e,t,r){t=n.MathUtils.clamp(t,o.MIN_FOV_RAD,o.MAX_FOV_RAD);const s=a(e);return c(e,s,u(t,r,s.y),r,t),i(e)}function a(e,t=new n.Vector2){return t.x=-e.projectionMatrix.elements[8],t.y=-e.projectionMatrix.elements[9],t}function d(e){var t,i;return null!==(i=null===(t=l(e))||void 0===t?void 0:t.horizontal)&&void 0!==i?i:2*Math.atan(Math.tan(n.MathUtils.degToRad(e.fov)/2)*e.aspect)}function h(e){var t,i;return null!==(i=null===(t=l(e))||void 0===t?void 0:t.top)&&void 0!==i?i:n.MathUtils.degToRad(e.fov/2)}function m(e){var t,i;return null!==(i=null===(t=l(e))||void 0===t?void 0:t.right)&&void 0!==i?i:d(e)/2}e.getFocalLength=t,e.setFocalLength=function(e,i,n){const l=a(e),u=s(i,l.y,n);return u<o.MIN_FOV_RAD||u>o.MAX_FOV_RAD?r(e,u,n):c(e,l,i,n,u),t(e)},e.getVerticalFov=i,e.setVerticalFov=r,e.convertWorldToScreenSize=function(e,t,i){return e*i/t},e.convertScreenToWorldSize=function(e,t,i){return t*i/e},e.getPrincipalPoint=a,e.setPrincipalPoint=function(e,t){const i=e.aspect,r=.999999;e.setViewOffset(i,1,-n.MathUtils.clamp(t.x,-.999999,r)*i/2,1*n.MathUtils.clamp(t.y,-.999999,r)/2,i,1)},e.getHorizontalFov=d,e.getTopFov=h,e.getBottomFov=function(e){return n.MathUtils.degToRad(e.fov)-h(e)},e.getRightFov=m,e.getLeftFov=function(e){var t;return void 0!==(null===(t=l(e))||void 0===t?void 0:t.right)?d(e)-m(e):d(e)/2}}(t.CameraUtils||(t.CameraUtils={}))},95585:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDefaultClipPlanesEvaluator=t.TiltViewClipPlanesEvaluator=t.TopViewClipPlanesEvaluator=t.ElevationBasedClipPlanesEvaluator=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(81621),s=i(83829),l=1e-6;var c;!function(e){const t=[new o.Vector3,new o.Vector3],i=new o.Raycaster,n=new o.Sphere(new o.Vector3,r.EarthConstants.EQUATORIAL_RADIUS);function a(e,t){return e-t<l?0:Math.sqrt(e*e-t*t)}e.getFarDistanceFromElevatedHorizon=function(t,i,r,n){const o=a(i,r),s=a(n,r),l=Math.asin(r/i),c=Math.abs(l-e.getNormalToFwdAngle(t));return Math.cos(c)*(o+s)},e.getProjNearPlaneTanDistance=function(e,i,r){const n=e.getWorldDirection(t[0]),o=t[1].copy(n).multiplyScalar(-r).sub(e.position),a=o.dot(n);return a/o.length()>Math.cos(i)?a:void 0},e.getProjSphereIntersectionDistance=function(e,r,o){i.setFromCamera(r,e),n.radius=o;const a=i.ray.intersectSphere(n,t[0]);return null!==a?a.sub(e.position).dot(e.getWorldDirection(t[1])):void 0},e.getNormalToFwdAngle=function(e){const i=t[0].copy(e.position).negate().normalize().dot(e.getWorldDirection(t[1]));return Math.acos(o.MathUtils.clamp(i,-1,1))}}(c||(c={}));class u{constructor(e,t){n.assert(e>=t),this.m_minElevation=t,this.m_maxElevation=e}set maxElevation(e){this.m_maxElevation=e,this.m_minElevation=Math.min(e,this.m_minElevation)}get maxElevation(){return this.m_maxElevation}set minElevation(e){this.m_minElevation=e,this.m_maxElevation=Math.max(e,this.m_maxElevation)}get minElevation(){return this.m_minElevation}}t.ElevationBasedClipPlanesEvaluator=u;class d extends u{constructor(e=r.EarthConstants.MAX_BUILDING_HEIGHT,t=0,i=1,a=.05,s=6){super(e,t),this.nearMin=i,this.nearFarMarginRatio=a,this.farMaxRatio=s,this.m_tmpVectors=[new o.Vector3,new o.Vector3,new o.Vector3],this.m_tmpQuaternion=new o.Quaternion,n.assert(i>0),n.assert(a>=0),n.assert(s>1);const l=a*i;this.m_minimumViewRange={near:i,far:i+l,minimum:this.nearMin,maximum:Math.max(i*s,i+l)}}evaluateClipPlanes(e,t,i){n.assert(e instanceof o.PerspectiveCamera,"Unsupported camera type.");const a=e;return t.type===r.ProjectionType.Spherical?this.evaluateDistanceSphericalProj(a,t,i):t.type===r.ProjectionType.Planar?this.evaluateDistancePlanarProj(a,t,i):(n.assert(!1,"Unsupported projection type"),Object.assign({},this.minimumViewRange))}get minimumViewRange(){return this.m_minimumViewRange}evaluateDistancePlanarProj(e,t,i){n.assert(t.type!==r.ProjectionType.Spherical);let o=this.nearMin,a=this.nearMin*this.farMaxRatio;const s=t.groundDistance(e.position),l=s*this.farMaxRatio;o=s-this.maxElevation,a=s-this.minElevation,o=Math.max(o,this.nearMin),a=Math.min(a,l);const c=this.nearFarMarginRatio*(o+a)/2;return o=Math.max(o-c/2,this.nearMin),a=Math.max(a+c/2,o+c),{near:o,far:a,minimum:this.nearMin,maximum:Math.max(l,a)}}evaluateDistanceSphericalProj(e,t,i){n.assert(t.type===r.ProjectionType.Spherical);const a=t.groundDistance(e.position);let u=a-this.maxElevation;const d=r.EarthConstants.EQUATORIAL_RADIUS,h=Math.max(l,e.position.length()),m=Math.asin(d/h);let p=o.MathUtils.degToRad(e.fov/2);e.aspect>1&&(p=s.MapViewUtils.calculateHorizontalFovByVerticalFov(2*p,e.aspect));const f=d+this.maxElevation,g=c.getFarDistanceFromElevatedHorizon(e,h,d,f);let y=p>m?g:this.getFovBasedFarPlane(e,h,d,2*p,t);const v=a-this.minElevation,_=a*this.farMaxRatio;u=Math.max(u,this.nearMin),y=Math.max(y,v);const b=this.nearFarMarginRatio*(u+y)/2;return u=Math.max(u-b/2,this.nearMin),y=Math.max(y+b/2,u+b),{near:u,far:y,minimum:this.nearMin,maximum:_}}getFovBasedFarPlane(e,t,i,r,o){const a=e.position;e.matrixWorld.extractBasis(this.m_tmpVectors[0],this.m_tmpVectors[1],this.m_tmpVectors[2]),this.m_tmpQuaternion.setFromAxisAngle(this.m_tmpVectors[0],r/2);const s=this.m_tmpVectors[2],l=this.m_tmpVectors[1].copy(s).applyQuaternion(this.m_tmpQuaternion),c=a.dot(l);if(c<0)return o.groundDistance(e.position)*this.farMaxRatio;const u=a.dot(a)-c*c,d=i*i;return n.assert(u<=d,"Please use this evaluator only for top view camera poses."),c-Math.sqrt(d-u)}}t.TopViewClipPlanesEvaluator=d;class h extends d{constructor(){super(...arguments),this.m_tmpV2=new o.Vector2}evaluateDistancePlanarProj(e,t,i){n.assert(t.type!==r.ProjectionType.Spherical);const c=Object.assign({},this.minimumViewRange),u=Math.PI/2-l,d=t.groundDistance(e.position),h=s.MapViewUtils.extractCameraTilt(e,t),m=a.CameraUtils.getTopFov(e),p=a.CameraUtils.getBottomFov(e),f=o.MathUtils.clamp(h+m,-u,u),g=o.MathUtils.clamp(h-p,-u,u),y=Math.max(0,(d-this.minElevation)/Math.cos(f)),v=Math.max(0,(d-this.maxElevation)/Math.cos(g));return c.near=v*Math.cos(p),c.far=y*Math.cos(m),this.applyViewRangeConstraints(c,e,t,i)}evaluateDistanceSphericalProj(e,t,i){n.assert(t.type===r.ProjectionType.Spherical);const o=Object.assign({},this.minimumViewRange);return o.near=this.computeNearDistSphericalProj(e,t),o.far=this.computeFarDistSphericalProj(e,t),this.applyViewRangeConstraints(o,e,t,i)}computeNearDistSphericalProj(e,t){n.assert(t.type===r.ProjectionType.Spherical);const i=t.groundDistance(e.position)-this.maxElevation;if(i<=0)return 0;const o=r.EarthConstants.EQUATORIAL_RADIUS+this.maxElevation,s=a.CameraUtils.getBottomFov(e),l=c.getProjNearPlaneTanDistance(e,s,o);if(void 0!==l)return l;a.CameraUtils.getPrincipalPoint(e,this.m_tmpV2);const u=this.m_tmpV2.y>0,d=c.getProjSphereIntersectionDistance(e,this.m_tmpV2.setComponent(1,-1),o),h=u?c.getProjSphereIntersectionDistance(e,this.m_tmpV2.setComponent(1,1),o):1/0,m=Math.min(null!=d?d:1/0,null!=h?h:1/0);return n.assert(m!==1/0,"No reference point for near distance found"),null!=m?m:i}computeFarDistSphericalProj(e,t){n.assert(t.type===r.ProjectionType.Spherical);const i=r.EarthConstants.EQUATORIAL_RADIUS,o=i+this.minElevation,s=i+this.maxElevation,l=e.position.length();a.CameraUtils.getPrincipalPoint(e,this.m_tmpV2);const u=this.m_tmpV2.x<=0?1:-1,d=this.m_tmpV2.y>0,h=c.getProjSphereIntersectionDistance(e,this.m_tmpV2.set(u,1),o),m=d?c.getProjSphereIntersectionDistance(e,this.m_tmpV2.set(u,-1),o):0,p=Math.max(null!=h?h:1/0,null!=m?m:1/0);return p!==1/0?p:c.getFarDistanceFromElevatedHorizon(e,l,i,s)}applyViewRangeConstraints(e,t,i,r){const{distance:n}=s.MapViewUtils.getTargetAndDistance(i,t,r),a=i.groundDistance(t.position)-this.minElevation,l=n*this.farMaxRatio;e.near=Math.max(e.near,this.nearMin),e.far=o.MathUtils.clamp(e.far,a,l);const c=this.nearFarMarginRatio*(e.near+e.far)/2;return e.near=Math.max(e.near-c/2,this.nearMin),e.far=Math.max(e.far+c/2,e.near+c),e.minimum=this.nearMin,e.maximum=l,e}}t.TiltViewClipPlanesEvaluator=h,t.createDefaultClipPlanesEvaluator=()=>new h},40160:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorCache=void 0;const r=i(84428);class n{constructor(){this.m_map=new Map}static get instance(){return this.m_instance}getColor(e){"number"==typeof e&&(e="#"+e.toString(16).padStart(6,"0"));let t=this.m_map.get(e);return void 0!==t||(t=new r.Color(e),this.m_map.set(e,t)),t}get size(){return this.m_map.size}clear(){this.m_map.clear()}}t.ColorCache=n,n.m_instance=new n},41470:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrentDecoderFacade=void 0;const r=i(83222),n=i(64665);class o{static getTileDecoder(e,t,i,r){const o=this.getWorkerSet(t,i,r);return new n.WorkerBasedDecoder(o,e)}static getWorkerSet(e,t,i){void 0===e&&(e=this.defaultScriptUrl);let n=this.workerSets[e];if(void 0===n){const o=void 0!==i?1e3*i:void 0;n=new r.ConcurrentWorkerSet({scriptUrl:e,workerCount:null!=t?t:this.defaultWorkerCount,workerConnectionTimeout:o}),this.workerSets[e]=n}return n}static destroyWorkerSet(e){const t=this.workerSets[e];void 0!==t&&(t.destroy(),delete this.workerSets[e])}static destroy(){Object.keys(this.workerSets).forEach((e=>{this.workerSets[e].destroy()})),this.workerSets={}}static destroyIfTerminated(){let e=!0;Object.keys(this.workerSets).forEach((t=>{this.workerSets[t].terminated||(e=!1)})),e&&o.destroy()}}t.ConcurrentDecoderFacade=o,o.defaultScriptUrl="./decoder.bundle.js",o.defaultWorkerCount=void 0,o.workerSets={}},4038:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrentTilerFacade=void 0;const r=i(83222),n=i(56009);class o{static getTiler(e,t,i,r){const o=this.getWorkerSet(t,i,r);return new n.WorkerBasedTiler(o,e)}static getWorkerSet(e,t,i){void 0===e&&(e=this.defaultScriptUrl);let n=this.workerSets[e];if(void 0===n){const o=void 0!==i?1e3*i:void 0;n=new r.ConcurrentWorkerSet({scriptUrl:e,workerCount:null!=t?t:this.defaultWorkerCount,workerConnectionTimeout:o}),this.workerSets[e]=n}return n}static destroyWorkerSet(e){const t=this.workerSets[e];void 0!==t&&(t.destroy(),delete this.workerSets[e])}static destroy(){Object.keys(this.workerSets).forEach((e=>{this.workerSets[e].destroy()})),this.workerSets={}}static destroyIfTerminated(){let e=!0;Object.keys(this.workerSets).forEach((t=>{this.workerSets[t].terminated||(e=!1)})),e&&o.destroy()}}t.ConcurrentTilerFacade=o,o.defaultScriptUrl="./decoder.bundle.js",o.defaultWorkerCount=1,o.workerSets={}},83222:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConcurrentWorkerSet=t.DEFAULT_WORKER_INITIALIZATION_TIMEOUT=t.isLoggingMessage=void 0;const r=i(96500),n=i(38338),o=i(84428),a=i(75249),s=n.LoggerManager.instance.create("ConcurrentWorkerSet");function l(e){return e&&"number"==typeof e.level&&e.type===n.WORKERCHANNEL_MSG_TYPE}t.isLoggingMessage=l,t.DEFAULT_WORKER_INITIALIZATION_TIMEOUT=1e4,t.ConcurrentWorkerSet=class{constructor(e){this.m_options=e,this.m_workerChannelLogger=n.LoggerManager.instance.create("WorkerChannel"),this.m_eventListeners=new Map,this.m_workers=new Array,this.m_availableWorkers=new Array,this.m_workerPromises=new Array,this.m_readyPromises=new Map,this.m_requests=new Map,this.m_workerRequestQueue=[],this.m_nextMessageId=0,this.m_stopped=!0,this.m_referenceCount=0,this.onWorkerMessage=(e,t)=>{if(r.WorkerServiceProtocol.isResponseMessage(t.data)){const i=t.data;if(null===i.messageId)return void s.error(`[${this.m_options.scriptUrl}]: Bad ResponseMessage: no messageId`);const r=this.m_requests.get(i.messageId);if(void 0===r)return void s.error(`[${this.m_options.scriptUrl}]: Bad ResponseMessage: invalid messageId`);if(e>=0&&e<this.m_workers.length){const t=this.m_workers[e];this.m_availableWorkers.push(t),this.checkWorkerRequestQueue()}else s.error(`[${this.m_options.scriptUrl}]: onWorkerMessage: invalid workerId`);if(void 0!==i.errorMessage){const e=new Error(i.errorMessage);void 0!==i.errorStack&&(e.stack=i.errorStack),r.resolver(e)}else r.resolver(void 0,i.response)}else if(r.WorkerServiceProtocol.isInitializedMessage(t.data)){const e=this.getReadyPromise(t.data.service);++e.count===this.m_workerPromises.length&&e.resolve()}else if(l(t.data))switch(t.data.level){case n.LogLevel.Trace:this.m_workerChannelLogger.trace(...t.data.message);break;case n.LogLevel.Debug:this.m_workerChannelLogger.debug(...t.data.message);break;case n.LogLevel.Log:this.m_workerChannelLogger.log(...t.data.message);break;case n.LogLevel.Info:this.m_workerChannelLogger.info(...t.data.message);break;case n.LogLevel.Warn:this.m_workerChannelLogger.warn(...t.data.message);break;case n.LogLevel.Error:this.m_workerChannelLogger.error(...t.data.message)}else this.eventHandler(t)},this.start()}addReference(){this.m_referenceCount+=1,1===this.m_referenceCount&&this.m_stopped&&this.start()}removeReference(){this.m_referenceCount-=1,0===this.m_referenceCount&&this.destroy()}start(e){if(void 0!==e&&(this.m_options=e),!this.m_stopped)throw new Error("ConcurrentWorker set already started");this.m_workerCount=n.getOptionValue(this.m_options.workerCount,"undefined"!=typeof navigator&&void 0!==navigator.hardwareConcurrency?o.MathUtils.clamp(navigator.hardwareConcurrency-1,1,2):void 0,2);const i=n.getOptionValue(this.m_options.workerConnectionTimeout,t.DEFAULT_WORKER_INITIALIZATION_TIMEOUT);for(let e=0;e<this.m_workerCount;++e){const t=a.WorkerLoader.startWorker(this.m_options.scriptUrl,i).then((t=>{const i=t=>{this.onWorkerMessage(e,t)};return t.addEventListener("message",i),this.m_workers.push(t),this.m_availableWorkers.push(t),{worker:t,listener:i}}));this.m_workerPromises.push(t)}this.m_stopped=!1}get workerCount(){return this.m_workerCount}async stop(){this.m_stopped=!0,await this.waitForAllResponses().then((()=>{this.terminateWorkers()}))}destroy(){this.m_stopped=!0,this.m_requests.forEach((e=>{e.resolver(new Error("worker destroyed"))})),this.m_requests.clear(),this.m_workerRequestQueue=[],this.terminateWorkers(),this.m_eventListeners.clear()}get terminated(){return 0===this.m_workers.length}async connect(e){return this.ensureStarted(),await Promise.all(this.m_workerPromises),await this.getReadyPromise(e).promise}addEventListener(e,t){this.m_eventListeners.set(e,t)}removeEventListener(e){this.m_eventListeners.delete(e)}invokeRequest(e,t,i,n){this.ensureStarted();const o=this.m_nextMessageId++;let a;const s=new Promise(((e,t)=>{a=(i,r)=>{this.m_requests.delete(o),void 0!==i?t(i):e(r)}}));this.m_requests.set(o,{promise:s,resolver:a});const l={service:e,type:r.WorkerServiceProtocol.ServiceMessageName.Request,messageId:o,request:t};return this.postRequestMessage(l,i,n),s}broadcastRequest(e,t,i){const n=[];for(const o of this.m_workers){const a=this.m_nextMessageId++;let s;const l=new Promise(((e,t)=>{s=(i,r)=>{this.m_requests.delete(a),void 0!==i?t(i):e(r)}}));n.push(l),this.m_requests.set(a,{promise:l,resolver:s});const c={service:e,type:r.WorkerServiceProtocol.ServiceMessageName.Request,messageId:a,request:t};void 0!==i?o.postMessage(c,i):o.postMessage(c)}return Promise.all(n)}broadcastMessage(e,t){this.ensureStarted(),void 0!==t?this.m_workers.forEach((i=>i.postMessage(e,t))):this.m_workers.forEach((t=>t.postMessage(e)))}get requestQueueSize(){return this.m_workerRequestQueue.length}get numWorkers(){return this.m_workers.length}get numIdleWorkers(){return this.m_availableWorkers.length}eventHandler(e){"string"==typeof e.data.type&&this.dispatchEvent(e.data.type,e)}postRequestMessage(e,t,i){if(this.ensureStarted(),0===this.m_workers.length)throw new Error("ConcurrentWorkerSet#postMessage: no workers started");if(void 0!==i&&i.signal.aborted){const t=this.m_requests.get(e.messageId);if(void 0===t)return void s.error(`[${this.m_options.scriptUrl}]: Bad RequestMessage: invalid messageId`);const i=new Error("Aborted");return i.name="AbortError",void t.resolver(i,void 0)}if(this.m_availableWorkers.length>0){const i=this.m_availableWorkers.pop();void 0!==t?i.postMessage(e,t):i.postMessage(e)}else void 0===i&&(i=new r.RequestController(0)),0===i.priority&&(i.priority=-this.m_nextMessageId),this.m_workerRequestQueue.unshift({message:e,buffers:t,requestController:i})}ensureStarted(){if(this.m_stopped)throw new Error("ConcurrentWorkerSet stopped")}async waitForAllResponses(){const e=new Array;this.m_requests.forEach((t=>{e.push(t.promise)})),await Promise.all(e)}dispatchEvent(e,t){const i=this.m_eventListeners.get(e);void 0!==i&&i(t)}terminateWorkers(){this.m_workerPromises.forEach((e=>{e.then((e=>{void 0!==e&&(e.worker.removeEventListener("message",e.listener),e.worker.terminate())}))})),this.m_workers=[],this.m_workerPromises=[],this.m_availableWorkers=[],this.m_readyPromises.clear()}getReadyPromise(e){const t=this.m_readyPromises.get(e);if(void 0!==t)return t;const i={count:0,promise:void 0,resolve:()=>{},reject:e=>{i.error=e},error:void 0};return i.promise=new Promise(((e,t)=>{const r=i;void 0!==r.error?t(r.error):r.count===this.m_workerPromises.length&&e(),r.resolve=e,r.reject=t})),this.m_readyPromises.set(e,i),i}checkWorkerRequestQueue(){if(0!==this.m_workerRequestQueue.length&&0!==this.m_availableWorkers.length)for(this.m_workerRequestQueue.sort(((e,t)=>e.requestController.priority-t.requestController.priority));this.m_availableWorkers.length>0&&this.m_workerRequestQueue.length>0;){const e=this.m_workerRequestQueue.pop();this.postRequestMessage(e.message,e.buffers,e.requestController)}}}},86140:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSource=void 0;const r=i(330),n=i(38338),o=i(84428),a=n.LoggerManager.instance.create("DataSource");class s extends o.EventDispatcher{constructor(e={}){super(),this.UPDATE_EVENT={type:"update"},this.enabled=!0,this.cacheable=!1,this.useGeometryLoader=!1,this.addGroundPlane=!1,this.minDataLevel=1,this.maxDataLevel=20,this.minDisplayLevel=1,this.maxDisplayLevel=20,this.allowOverlappingTiles=!0,this.enablePicking=!0,this.dataSourceOrder=0,this.exprPool=new r.ExprPool,this.m_maxGeometryHeight=0,this.m_minGeometryHeight=0,this.m_storageLevelOffset=0,this.m_featureStateMap=new Map;let{name:t}=e;const{styleSetName:i,languages:n,minZoomLevel:o,maxZoomLevel:a,minDataLevel:l,maxDataLevel:c,minDisplayLevel:u,maxDisplayLevel:d,storageLevelOffset:h,allowOverlappingTiles:m,enablePicking:p,minGeometryHeight:f,maxGeometryHeight:g,dataSourceOrder:y}=e;void 0!==t&&0!==t.length||(t="anonymous-datasource#"+ ++s.uniqueNameCounter),this.name=t,this.styleSetName=i,void 0!==n&&(this.languages=n),void 0!==l&&(this.minDataLevel=l),void 0!==c&&(this.maxDataLevel=c),void 0!==o&&(this.minZoomLevel=o),void 0!==a&&(this.maxZoomLevel=a),void 0!==u&&(this.minDisplayLevel=u),void 0!==d&&(this.maxDisplayLevel=d),void 0!==h&&(this.m_storageLevelOffset=h),void 0!==m&&(this.allowOverlappingTiles=m),void 0!==p&&(this.enablePicking=p),void 0!==f&&(this.minGeometryHeight=f),void 0!==g&&(this.maxGeometryHeight=g),y&&(this.dataSourceOrder=y)}getFeatureState(e){return this.m_featureStateMap.get(e)}clearFeatureState(){this.m_featureStateMap.clear()}setFeatureState(e,t){this.m_featureStateMap.set(e,t)}removeFeatureState(e){this.m_featureStateMap.delete(e)}get styleSetName(){return this.m_styleSetName}set styleSetName(e){e!==this.m_styleSetName&&(this.m_styleSetName=e,this.clearCache(),this.requestUpdate())}dispose(){}clearCache(){}isFullyCovering(){return this.addGroundPlane}ready(){return!0}get mapView(){if(void 0===this.m_mapView)throw new Error("This DataSource was not added to MapView");return this.m_mapView}get projection(){return this.mapView.projection}async connect(){}attach(e){this.m_mapView=e}detach(e){n.assert(this.m_mapView===e),this.m_mapView=void 0}isDetached(){return void 0===this.m_mapView}async setTheme(e,t){}setLanguages(e){this.languages=e}setPoliticalView(e){}updateTile(e){}shouldPreloadTiles(){return!1}get minZoomLevel(){return a.warn("DataSource.minZoomLevel is deprecated. Use minDataLevel and maxDataLevel instead."),this.minDataLevel}set minZoomLevel(e){a.warn("DataSource.minZoomLevel is deprecated. Use minDataLevel and minDisplayLevel instead."),this.minDataLevel=e}get maxZoomLevel(){return a.warn("DataSource.maxZoomLevel is deprecated. Use maxDataLevel and maxDisplayLevel instead."),this.maxDataLevel}set maxZoomLevel(e){a.warn("DataSource.maxZoomLevel is deprecated. Use maxDataLevel and maxDisplayLevel instead."),this.maxDataLevel=e}get maxGeometryHeight(){return this.m_maxGeometryHeight}set maxGeometryHeight(e){this.m_maxGeometryHeight=e}get minGeometryHeight(){return this.m_minGeometryHeight}set minGeometryHeight(e){this.m_minGeometryHeight=e}get storageLevelOffset(){return this.m_storageLevelOffset}set storageLevelOffset(e){this.m_storageLevelOffset=e}setEnableElevationOverlay(e){}getDataZoomLevel(e){return o.MathUtils.clamp(e+this.m_storageLevelOffset,this.minDataLevel,this.maxDataLevel)}isVisible(e){return e>=this.minDisplayLevel&&e<=this.maxDisplayLevel}canGetTile(e,t){return t.level<=e}shouldSubdivide(e,t){return t.level<=e}shouldRenderText(e,t){return!0}requestUpdate(){this.dispatchEvent(this.UPDATE_EVENT)}}t.DataSource=s,s.uniqueNameCounter=0},61712:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debugContext=t.DebugContext=void 0;const r=i(84428),n="undefined"==typeof window;class o extends r.EventDispatcher{constructor(e){super(),this.value=e}set(e,t){this.value=e,this.dispatchEvent({type:o.SET_EVENT_TYPE,name:t,value:e})}}o.SET_EVENT_TYPE="set";class a{constructor(){this.m_optionsMap=new Map,!n&&"undefined"!=typeof window&&window&&(window.__debugContext=this)}setValue(e,t){let i=this.m_optionsMap.get(e);i?i.set(t,e):(i=new o(t),this.m_optionsMap.set(e,i))}getValue(e){const t=this.m_optionsMap.get(e);return t?t.value:void 0}hasOption(e){return void 0!==this.m_optionsMap.get(e)}addEventListener(e,t){const i=this.m_optionsMap.get(e);if(!i)throw Error("Unknown option: "+e);i.addEventListener(o.SET_EVENT_TYPE,t)}hasEventListener(e,t){const i=this.m_optionsMap.get(e);if(i)return i.hasEventListener(o.SET_EVENT_TYPE,t);throw Error("Unknown option: "+e)}removeEventListener(e,t){const i=this.m_optionsMap.get(e);if(!i)throw Error("Unknown option: "+e);i.removeEventListener(o.SET_EVENT_TYPE,t)}get options(){return this.m_optionsMap}clear(){this.m_optionsMap.forEach((e=>{e.set(void 0,"")}))}}t.DebugContext=a,t.debugContext=new a},37337:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateColorProperty=t.applyBaseColorToMaterial=t.applySecondaryColorToMaterial=t.evaluateBaseColorProperty=t.buildMetricValueEvaluator=t.getMaterialConstructor=t.BASE_TECHNIQUE_NON_MATERIAL_PROPS=t.buildObject=t.usesObject3D=t.getBufferAttribute=t.createMaterial=void 0;const r=i(96500),n=i(21120),o=i(30462),a=i(38338),s=i(84428),l=i(2016),c=i(67862),u=i(48874),d=i(71540),h=i(51771),m=a.LoggerManager.instance.create("DecodedTileHelpers");function p(e,t,i,r){const n=(new s.TextureLoader).load(e,t,void 0,i);r&&n.addEventListener("dispose",(()=>{URL.revokeObjectURL(e)}))}function f(e,t,i){const n=i.technique;let o=n[t];if(void 0!==o)return new Promise(((a,l)=>{const c=i=>{!function(e,t){t&&(void 0!==t.wrapS&&(e.wrapS=h.toWrappingMode(t.wrapS)),void 0!==t.wrapT&&(e.wrapT=h.toWrappingMode(t.wrapT)),void 0!==t.magFilter&&(e.magFilter=h.toTextureFilter(t.magFilter)),void 0!==t.minFilter&&(e.minFilter=h.toTextureFilter(t.minFilter)),void 0!==t.flipY&&(e.flipY=t.flipY),void 0!==t.repeatU&&(e.repeat.x=t.repeatU),void 0!==t.repeatV&&(e.repeat.y=t.repeatV))}(i,n[t+"Properties"]),e[t]=i,e.needsUpdate=!0,a(i)},u=e=>{m.error("#createMaterial: Failed to load texture: ",e),l(e)};if(!r.Expr.isExpr(o)||(o=r.getPropertyValue(o,i.env),o))if("string"==typeof o)p(o,c,u,!1);else if(r.isTextureBuffer(o))if("image/raw"===o.type)!function(e,t,i){const r=e.dataTextureProperties;if(r){const i=r.type?h.toTextureDataType(r.type):void 0,n=function(e,t){if(void 0===t)return new Uint8Array(e);switch(t){case s.UnsignedByteType:return new Uint8Array(e);case s.ByteType:return new Int8Array(e);case s.ShortType:return new Int16Array(e);case s.UnsignedShortType:return new Uint16Array(e);case s.IntType:return new Int32Array(e);case s.UnsignedIntType:return new Uint32Array(e);case s.FloatType:return new Float32Array(e);case s.HalfFloatType:return new Uint16Array(e)}throw new Error("Unsupported texture data type")}(e.buffer,i);t(new s.DataTexture(n,r.width,r.height,r.format?h.toPixelFormat(r.format):void 0,i))}else i("no data texture properties provided.")}(o,c,u);else{const e=new Blob([o.buffer],{type:o.type});p(URL.createObjectURL(e),c,u,!0)}else"object"!=typeof o||"IMG"!==o.nodeName&&"CANVAS"!==o.nodeName||c(new s.CanvasTexture(o));else c(new s.Texture)}))}function g(e,t){if(void 0!==e.name)switch(e.name){case"extruded-line":if(!r.isExtrudedLineTechnique(e))throw new Error("Invalid extruded-line technique");return"standard"===e.shading?o.MapMeshStandardMaterial:o.MapMeshBasicMaterial;case"standard":case"terrain":case"extruded-polygon":return o.MapMeshStandardMaterial;case"dashed-line":case"solid-line":return o.SolidLineMaterial;case"fill":return t?o.MapMeshStandardMaterial:o.MapMeshBasicMaterial;case"squares":return s.PointsMaterial;case"circles":return o.CirclePointsMaterial;case"line":case"segments":return s.LineBasicMaterial;case"shader":return s.ShaderMaterial;case"text":case"labeled-icon":case"line-marker":case"label-rejection-line":return}}function y(e,t){return null==e?e:("string"==typeof e&&(e.endsWith("px")?(t="Pixel",e=Number.parseFloat(e)):e.endsWith("m")&&(e=Number.parseFloat(e))),"Pixel"===t?t=>{var i;return(null!==(i=t.env.lookup("$pixelToMeters"))&&void 0!==i?i:1)*r.getPropertyValue(e,t.env)}:e)}function v(e,t,i){let n=S(t,i);void 0!==n&&(r.ColorUtils.hasAlphaInHex(n)&&(m.warn("Used RGBA value for technique color without transparency support!"),n=r.ColorUtils.removeAlphaFromHex(n)),e.setHex(n))}function _(e,t,i,n,a){const l=S(n,a);if(void 0===l)return;const{r:c,g:u,b:d,a:h}=r.ColorUtils.getRgbaFromHex(l),m=i;let p=h;void 0!==m.opacity&&(p*=b(m.opacity,a)),p=s.MathUtils.clamp(p,0,1),e instanceof o.RawShaderMaterial?e.setOpacity(p):e.opacity=p,t.setRGB(c,u,d),p>=1?o.disableBlending(e):o.enableBlending(e)}function b(e,t){return void 0!==t&&r.Expr.isExpr(e)&&(e=r.getPropertyValue(e,t)),e}function S(e,t){if(null!=(e=b(e,t))){if("number"==typeof e)return e;if("string"==typeof e){const t=r.parseStringEncodedColor(e);if(void 0!==t)return t}m.error(`Unsupported color format: '${e}'`)}}function T(e){var t;return null===(t=n.getTechniqueDescriptor(e))||void 0===t?void 0:t.attrTransparencyColor}t.createMaterial=function(e,t,i){const l=t.technique,c=g(l,!0===t.shadowsEnabled),d={};if(void 0===c)return;c.prototype instanceof o.RawShaderMaterial&&(d.rendererCapabilities=e,c!==o.HighPrecisionLineMaterial&&(d.fog=t.fog)),!0===t.shadowsEnabled&&"fill"===l.name&&(d.removeDiffuseLight=!0);const h=new c(d);return void 0!==l.id&&(h.name=l.id),r.isExtrudedPolygonTechnique(l)&&(h.flatShading=!0),h.depthTest=r.isExtrudedPolygonTechnique(l)&&!1!==l.depthTest,r.supportsTextures(l)&&r.TEXTURE_PROPERTY_KEYS.forEach((e=>{const r=f(h,e,t);r&&(null==i||i(r))})),r.isShaderTechnique(l)?function(e,t){e.transparent?o.enableBlending(t):o.disableBlending(t);const i=e.params,n=T(e),a=n&&n in e.params;if(Object.getOwnPropertyNames(i).filter((e=>{if(n===e||a&&r.TRANSPARENCY_PROPERTY_KEYS.includes(e))return!1;return"name"!==e})).forEach((e=>{!function(e,t,i,r){const n=e;if(n[t]instanceof s.Color)v(e[t],i,r);else{const e=b(i,r);null!==e&&(n[t]=e)}}(t,e,i[e])})),a){const r=n;_(t,t[r],e,i[r])}}(l,h):u.MapMaterialAdapter.create(h,function(e){var t;const i=n.getTechniqueAutomaticAttrs(e);switch(e.name){case"dashed-line":case"solid-line":{const r=a.pick(e,i);return r.lineWidth=y(null!==(t=e.lineWidth)&&void 0!==t?t:0,e.metricUnit),r.outlineWidth=y(e.outlineWidth,e.metricUnit),r.dashSize=y(e.dashSize,e.metricUnit),r.gapSize=y(e.gapSize,e.metricUnit),r.offset=y(e.offset,e.metricUnit),r}case"fill":return a.pick(e,i);case"standard":case"terrain":case"extruded-polygon":{const t=a.pick(e,i);return!0!==e.vertexColors&&(t.color=e.color),t}case"circles":case"squares":return a.pick(e,i);case"extruded-line":return a.pick(e,["color","wireframe","transparent","opacity","polygonOffset","polygonOffsetFactor","polygonOffsetUnits",...i]);case"line":case"segments":return a.pick(e,i);default:return{}}}(l)),h},t.getBufferAttribute=function(e){switch(e.type){case"float":return new s.BufferAttribute(new Float32Array(e.buffer),e.itemCount);case"uint8":return new s.BufferAttribute(new Uint8Array(e.buffer),e.itemCount,e.normalized);case"uint16":return new s.BufferAttribute(new Uint16Array(e.buffer),e.itemCount,e.normalized);case"uint32":return new s.BufferAttribute(new Uint32Array(e.buffer),e.itemCount,e.normalized);case"int8":return new s.BufferAttribute(new Int8Array(e.buffer),e.itemCount,e.normalized);case"int16":return new s.BufferAttribute(new Int16Array(e.buffer),e.itemCount,e.normalized);case"int32":return new s.BufferAttribute(new Int32Array(e.buffer),e.itemCount,e.normalized);default:throw new Error(`unsupported buffer of type ${e.type}`)}},t.usesObject3D=function(e){const t=e.name;return void 0!==t&&"text"!==t&&"labeled-icon"!==t&&"line-marker"!==t&&"label-rejection-line"!==t},t.buildObject=function(e,t,i,n,o){switch(a.assert(void 0!==e.name),e.name){case"extruded-line":case"standard":case"extruded-polygon":case"fill":return o?new l.DisplacedMesh(t,i,(()=>({min:n.elevationRange.minElevation,max:n.elevationRange.maxElevation}))):new s.Mesh(t,i);case"terrain":return new s.Mesh(t,i);case"dashed-line":case"solid-line":return o?new l.DisplacedMesh(t,i,(()=>({min:n.elevationRange.minElevation,max:n.elevationRange.maxElevation})),c.SolidLineMesh.raycast):new c.SolidLineMesh(t,i);case"circles":return new d.Circles(t,i);case"squares":return new d.Squares(t,i);case"line":case"segments":return new s.LineSegments(t,i);case"shader":switch(a.assert(r.isShaderTechnique(e),"Invalid technique"),e.primitive){case"line":return new s.Line(t,i);case"segments":return new s.LineSegments(t,i);case"point":return new s.Points(t,i);case"mesh":return new s.Mesh(t,i)}}return a.assert(!1,"Invalid technique"),new s.Object3D},t.BASE_TECHNIQUE_NON_MATERIAL_PROPS=["name","id","renderOrder","transient"],t.getMaterialConstructor=g,t.buildMetricValueEvaluator=y,t.evaluateBaseColorProperty=function(e,t){const i=function(e){const t=T(e);if(void 0!==t)return r.isShaderTechnique(e)?e.params[t]:e[t]}(e);if(void 0!==i)return S(i,t)},t.applySecondaryColorToMaterial=v,t.applyBaseColorToMaterial=_,t.evaluateColorProperty=S},47678:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDepthPrePassStencil=t.createDepthPrePassMesh=t.isDepthPrePassMesh=t.createDepthPrePassMaterial=t.isRenderDepthPrePassEnabled=t.DEPTH_PRE_PASS_STENCIL_MASK=void 0;const r=i(90991),n=i(30462),o=i(84428),a=i(37337);function s(e){e.depthWrite=!1,e.depthFunc=o.EqualDepth,e.colorWrite=!0,n.enforceBlending(e);const t=e.clone();return t.isDepthPrepassMaterial=!0,t.depthWrite=!0,t.depthTest=!0,t.depthFunc=o.LessDepth,t.colorWrite=!1,t.opacity=1,t.blending=o.NoBlending,t}t.DEPTH_PRE_PASS_STENCIL_MASK=1,t.isRenderDepthPrePassEnabled=function(e,t){if(!1===e.enableDepthPrePass)return!1;let i=void 0!==e.opacity&&e.opacity>0&&e.opacity<1;if(!i){const n=a.evaluateBaseColorProperty(e,t);if(void 0!==n){const e=r.ColorUtils.getAlphaFromHex(n);i=e>0&&e<1}}return i},t.createDepthPrePassMaterial=s,t.isDepthPrePassMesh=function(e){if(!0!==e.isMesh)return!1;const t=e;return t.material instanceof Array?t.material.every((e=>!0===e.isDepthPrepassMaterial)):!0===t.material.isDepthPrepassMaterial},t.createDepthPrePassMesh=function(e){const t=e.geometry;if(!(t instanceof o.BufferGeometry))throw new Error("#createDepthPassMesh only BufferGeometry is supported");const i=t.getAttribute("position");if(!i)throw new Error("#createDepthPassMesh position attribute not found");const r=new o.BufferGeometry;r.setAttribute("position",i);const n=t.getAttribute("uv");n&&r.setAttribute("uv",n);const a=t.getAttribute("normal");a&&r.setAttribute("normal",a);const l=t.getAttribute("extrusionAxis");l&&r.setAttribute("extrusionAxis",l),t.index&&r.setIndex(t.index);for(const e of t.groups){const{start:t,count:i,materialIndex:n}=e;r.addGroup(t,i,n)}const c=e.material instanceof Array?e.material.map(s):s(e.material),u=new o.Mesh(r,c);return u.renderOrder=e.renderOrder-1e-6,u},t.setDepthPrePassStencil=function(e,i){function r(e){const i=e;i.stencilWrite=!0,i.stencilFail=o.KeepStencilOp,i.stencilZFail=o.KeepStencilOp,i.stencilZPass=o.ReplaceStencilOp,i.stencilFunc=o.AlwaysStencilFunc,i.stencilRef=255,i.stencilFuncMask=t.DEPTH_PRE_PASS_STENCIL_MASK}function n(e){const i=e;i.stencilWrite=!0,i.stencilFail=o.KeepStencilOp,i.stencilZFail=o.KeepStencilOp,i.stencilZPass=o.ZeroStencilOp,i.stencilFunc=o.EqualStencilFunc,i.stencilRef=255,i.stencilFuncMask=t.DEPTH_PRE_PASS_STENCIL_MASK}e.material instanceof Array?e.material.map(r):r(e.material),i.material instanceof Array?i.material.map(n):n(i.material)}},50519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2422:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},16114:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CalculationStatus=void 0,(i=t.CalculationStatus||(t.CalculationStatus={}))[i.PendingApproximate=0]="PendingApproximate",i[i.FinalPrecise=1]="FinalPrecise"},86381:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=void 0,t.EventDispatcher=class{constructor(){this.m_listeners=new Map}dispose(){this.removeAllEventListeners()}hasEventListener(e,t){const i=this.m_listeners.get(e);return void 0!==i&&(void 0===t||i.includes(t))}addEventListener(e,t){let i=this.m_listeners.get(e);void 0===i&&(i=[],this.m_listeners.set(e,i)),i.includes(t)||i.push(t)}removeEventListener(e,t){const i=this.m_listeners.get(e);if(void 0!==i)if(void 0===t)this.m_listeners.delete(e);else{const r=i.indexOf(t);-1!==r&&(i.splice(r,1),0===i.length&&this.m_listeners.delete(e))}}removeAllEventListeners(){const e=Array.from(this.m_listeners.keys());for(const t of e)this.removeEventListener(t)}get eventTypes(){return Array.from(this.m_listeners.keys())}listeners(e){return this.m_listeners.get(e)}dispatchEvent(e){const t=this.m_listeners.get(e.type);if(void 0!==t){e.target=this;const i=t.slice(0);for(let t=0,r=i.length;t<r;t++)i[t].call(this,e)}}}},11566:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedClipPlanesEvaluator=void 0,t.FixedClipPlanesEvaluator=class{constructor(e=1,t=10){this.minNear=e,this.minFarOffset=t,this.minFar=e+t,this.m_nearPlane=e,this.m_farPlane=this.minFar}get nearPlane(){return this.m_nearPlane}set nearPlane(e){this.invalidatePlanes(e,this.m_farPlane)}get farPlane(){return this.m_farPlane}set farPlane(e){this.invalidatePlanes(this.m_nearPlane,e)}set minElevation(e){}get minElevation(){return 0}set maxElevation(e){}get maxElevation(){return 0}evaluateClipPlanes(e,t,i){return{near:this.m_nearPlane,far:this.m_farPlane,minimum:this.minNear,maximum:this.m_farPlane}}invalidatePlanes(e,t){const i=Math.max(this.minNear,e),r=Math.max(this.minFar,t,i+this.minFarOffset);this.m_nearPlane=i,this.m_farPlane=r}}},41621:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_FOV_RAD=t.MIN_FOV_RAD=t.MAX_FOV_DEG=t.MIN_FOV_DEG=t.DEFAULT_FOV_CALCULATION=void 0;const r=i(84428);t.DEFAULT_FOV_CALCULATION={type:"dynamic",fov:40},t.MIN_FOV_DEG=10,t.MAX_FOV_DEG=140,t.MIN_FOV_RAD=r.MathUtils.degToRad(t.MIN_FOV_DEG),t.MAX_FOV_RAD=r.MathUtils.degToRad(t.MAX_FOV_DEG)},56870:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrustumIntersection=t.TileKeyEntry=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(16114),s=i(5239),l=i(83829),c=[new o.Vector3,new o.Vector3],u=new o.Vector4;class d{constructor(e,t,i=0,r,n=0){this.tileKey=e,this.area=t,this.offset=i,this.elevationRange=r,this.distance=n}}t.TileKeyEntry=d,t.FrustumIntersection=class{constructor(e,t,i,r,n,a=256){this.m_camera=e,this.mapView=t,this.m_extendedFrustumCulling=i,this.m_tileWrappingEnabled=r,this.m_enableMixedLod=n,this.m_tilePixelSize=a,this.m_frustum=new o.Frustum,this.m_viewProjectionMatrix=new o.Matrix4,this.m_rootTileKeys=[],this.m_tileKeyEntries=new Map,this.m_mapTileCuller=new s.MapTileCuller(e)}get camera(){return this.m_camera}get projection(){return this.mapView.projection}updateFrustum(e){this.m_viewProjectionMatrix.multiplyMatrices(void 0!==e?e:this.m_camera.projectionMatrix,this.m_camera.matrixWorldInverse),this.m_frustum.setFromProjectionMatrix(this.m_viewProjectionMatrix),this.m_extendedFrustumCulling&&this.m_mapTileCuller.setup(),this.computeRequiredInitialRootTileKeys(this.m_camera.position)}compute(e,t,i,a){this.m_tileKeyEntries.clear(),n.assert(0!==this.mapView.viewportHeight);const s=Math.pow(this.m_tilePixelSize/this.mapView.viewportHeight,2),l=void 0!==t&&t.getTilingScheme()===e,c=this.mapView.projection.type===r.ProjectionType.Spherical||l,u=new Set(i);let d=0,h=0;a.forEach((e=>{d=Math.min(d,e.minGeometryHeight),h=Math.max(h,e.maxGeometryHeight)}));const m={calculationFinal:!0,tileBounds:c?new r.OrientedBox3:new o.Box3};for(const e of u)this.m_tileKeyEntries.set(e,new Map);for(const i of this.m_rootTileKeys){const n=i.tileKey,o=i.offset,a=this.getTileKeyEntry(n,o,e,m,d,h,l?t:void 0);if(void 0!==a)for(const e of u)this.m_tileKeyEntries.get(e).set(r.TileKeyUtils.getKeyForTileKeyAndOffset(n,o),a)}const p=[...this.m_rootTileKeys.values()];for(;p.length>0;){const n=p.pop();if(void 0===n)break;const o=n.tileKey,c=n.offset;if(!a.some(((e,t)=>e.shouldSubdivide(i[t],o))))continue;if(this.m_enableMixedLod&&n.area<s)continue;const f=r.TileKeyUtils.getKeyForTileKeyAndOffset(o,c);for(const e of u)o.level>=e||this.m_tileKeyEntries.get(e).delete(f);for(const i of e.getSubTileKeys(o)){const n=this.getTileKeyEntry(i,c,e,m,d,h,l?t:void 0);if(void 0!==n){for(const e of u){if(n.tileKey.level>e)continue;const t=r.TileKeyUtils.getKeyForTileKeyAndOffset(i,c);this.m_tileKeyEntries.get(e).set(t,n)}p.push(n)}}}return{tileKeyEntries:this.m_tileKeyEntries,calculationFinal:m.calculationFinal}}getTileKeyEntry(e,t,i,r,n,o,s){var l,c;const u=function(e,t,i){const r=e.getGeoBox(t),n=360*i;return r.northEast.longitude+=n,r.southWest.longitude+=n,r}(i,e,t);if(void 0!==s){const t=s.getElevationRange(e);u.southWest.altitude=t.minElevation,u.northEast.altitude=t.maxElevation,r.calculationFinal=r.calculationFinal&&t.calculationStatus===a.CalculationStatus.FinalPrecise}u.southWest.altitude=(null!==(l=u.southWest.altitude)&&void 0!==l?l:0)+n,u.northEast.altitude=(null!==(c=u.northEast.altitude)&&void 0!==c?c:0)+o,this.mapView.projection.projectBox(u,r.tileBounds);const{area:h,distance:m}=this.computeTileAreaAndDistance(r.tileBounds);if(h>0)return new d(e,h,t,{minElevation:u.southWest.altitude,maxElevation:u.northEast.altitude},m)}computeTileAreaAndDistance(e){if(e instanceof o.Box3){if(this.m_extendedFrustumCulling&&!this.m_mapTileCuller.frustumIntersectsTileBox(e)||!this.m_frustum.intersectsBox(e))return{area:0,distance:1/0}}else if(!e.intersects(this.m_frustum))return{area:0,distance:1/0};const t=e.getCenter(c[0]),i=u.set(t.x,t.y,t.z,1).applyMatrix4(this.m_viewProjectionMatrix),r=.5*e.getSize(c[1]).length()/i.w;return{area:r*r,distance:i.z<=-i.w?-1:i.z>=i.w?1:i.z/i.w}}computeRequiredInitialRootTileKeys(e){this.m_rootTileKeys=[];const t=r.TileKey.fromRowColumnLevel(0,0,0);if(this.mapView.projection.type!==r.ProjectionType.Planar||!this.m_tileWrappingEnabled)return void this.m_rootTileKeys.push(new d(t,1/0,0));const i=this.mapView.projection.unprojectPoint(e),n=Math.round(i.longitude/360),a=this.m_camera,s=l.MapViewUtils.extractAttitude(this.mapView,a).pitch,c=a.aspect>1?a.aspect:1/a.aspect,u=o.MathUtils.degToRad(a.fov*c/2)+s,h=Math.tan(u)*a.position.z-Math.tan(s)*a.position.z,m=new o.Vector3(e.x-h,e.y,e.z),p=this.mapView.projection.unprojectPoint(m),f=o.MathUtils.clamp(Math.ceil(Math.abs((i.longitude-p.longitude)/360)*Math.SQRT2),0,7);for(let e=-f+n;e<=f+n;e++)this.m_rootTileKeys.push(new d(t,1/0,e))}}},10772:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TileLoaderState=void 0,(i=t.TileLoaderState||(t.TileLoaderState={}))[i.Initialized=0]="Initialized",i[i.Loading=1]="Loading",i[i.Loaded=2]="Loaded",i[i.Decoding=3]="Decoding",i[i.Ready=4]="Ready",i[i.Canceled=5]="Canceled",i[i.Failed=6]="Failed"},45572:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapAnchors=void 0;const r=i(32941),n=i(84428);t.MapAnchors=class{constructor(){this.m_anchors=[],this.m_priorities=[]}get children(){return this.m_anchors}add(e){this.m_anchors.push(e)}remove(e){const t=this.m_anchors.findIndex((t=>t===e));t>-1&&this.m_anchors.splice(t,1)}clear(){this.m_anchors.length=0}setPriorities(e){this.m_priorities=e}update(e,t,i,o){const a=new n.Vector3;this.m_anchors.forEach((n=>{var s;if(void 0!==n.styleSet){const e=null===(s=this.m_priorities)||void 0===s?void 0:s.findIndex((e=>e.group===n.styleSet&&e.category===n.category));void 0!==e&&-1!==e&&(n.renderOrder=10*(e+1))}const l=void 0!==n.geoPosition?n.geoPosition:n.anchor;void 0!==l&&(r.isVector3Like(l)?a.set(l.x,l.y,l.z):r.isGeoCoordinatesLike(l)&&e.projectPoint(l,a),n.position.copy(a).sub(t)),!0===n.overlay?o.add(n):i.add(n)}))}}},48874:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapMaterialAdapter=void 0;const r=i(96500),n=i(30462),o=i(84428),a=i(37337);function s(e){return r.TEXTURE_PROPERTY_KEYS.includes(e)}class l{constructor(e,t){this.m_lastUpdateFrameNumber=-1,this.tmpColor=new o.Color,this.material=e,this.styledProperties=t,this.currentStyledProperties={},this.m_dynamicProperties=[];for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];r.Expr.isExpr(i)||"function"==typeof i?this.m_dynamicProperties.push([e,i]):this.currentStyledProperties[e]=i}this.setupStaticProperties()}static get(e){var t;const i=null===(t=e.userData)||void 0===t?void 0:t.mapAdapter;return i instanceof l?i:void 0}static install(e){return e.material.userData||(e.material.userData={}),e.material.userData.mapAdapter=e}static create(e,t){return l.install(new l(e,t))}static ensureUpdated(e,t){var i,r;return null!==(r=null===(i=l.get(e))||void 0===i?void 0:i.ensureUpdated(t))&&void 0!==r&&r}toJSON(){return{styledProperties:this.styledProperties}}ensureUpdated(e){return this.m_lastUpdateFrameNumber!==e.frameNumber&&(this.m_lastUpdateFrameNumber=e.frameNumber,this.updateDynamicProperties(e))}setupStaticProperties(){var e,t;let i=!1;for(const e in this.styledProperties){if(!this.styledProperties.hasOwnProperty(e))continue;const t=this.currentStyledProperties[e];null!=t&&("color"===e||"opacity"===e?i=!0:s(e)||this.applyMaterialGenericProp(e,t))}if(i){const i=null!==(e=this.currentStyledProperties.color)&&void 0!==e?e:16711680,r=null!==(t=this.currentStyledProperties.opacity)&&void 0!==t?t:1;this.applyMaterialBaseColor(i,r)}}updateDynamicProperties(e){var t,i;let n=!1;if(this.m_dynamicProperties.length>0){let o=!1;for(const[t,i]of this.m_dynamicProperties){const a=r.Expr.isExpr(i)?r.getPropertyValue(i,e.env):i(e);a!==this.currentStyledProperties[t]&&(this.currentStyledProperties[t]=a,"color"===t||"opacity"===t?o=!0:s(t)?(this.applyMaterialTextureProp(t,a),n=!0):(this.applyMaterialGenericProp(t,a),n=!0))}if(o){const e=null!==(t=this.currentStyledProperties.color)&&void 0!==t?t:16711680,r=null!==(i=this.currentStyledProperties.opacity)&&void 0!==i?i:1;this.applyMaterialBaseColor(e,r),n=!0}}return n}applyMaterialTextureProp(e,t){const i=this.material;if(!i[e]||null===t)return;const r=i[e];let n;if("string"==typeof t)n=(new o.TextureLoader).load(t,(t=>{i[e]=t}));else if("object"==typeof t){const r=t,a="IMG"===r.nodeName,s="CANVAS"===r.nodeName;if(a||s)if(n=new o.CanvasTexture(r),a&&!r.complete){const t=()=>{i[e]=n,r.removeEventListener("load",t)};r.addEventListener("load",t)}else i[e]=n}n&&(n.wrapS=r.wrapS,n.wrapT=r.wrapT,n.magFilter=r.magFilter,n.minFilter=r.minFilter,n.flipY=r.flipY,n.repeat=r.repeat)}applyMaterialGenericProp(e,t){const i=this.material;if(i[e]instanceof o.Color){let e=t;if("number"!=typeof e){const t=a.evaluateColorProperty(e);if(void 0===t)return;e=t}const i=r.ColorUtils.removeAlphaFromHex(e);this.tmpColor.set(i),t=this.tmpColor}i[e]=t}applyMaterialBaseColor(e,t){if("number"!=typeof e){const t=a.evaluateColorProperty(e);if(void 0===t)return;e=t}const{r:i,g:s,b:l,a:c}=r.ColorUtils.getRgbaFromHex(null!=e?e:16711680),u=c*o.MathUtils.clamp(null!=t?t:1,0,1);this.material instanceof n.RawShaderMaterial?this.material.setOpacity(u):this.material.opacity=u,this.material.color.setRGB(i,s,l),u>=1?n.disableBlending(this.material):n.enableBlending(this.material)}}t.MapMaterialAdapter=l},38125:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapObjectAdapter=void 0;const r=i(96500),n=i(48874);class o{constructor(e,t){var i;this.m_lastUpdateFrameNumber=-1,this.m_notCompletlyTransparent=!0,this.object=e,this.technique=t.technique,this.kind=t.kind,this.dataSource=t.dataSource,this.m_pickability=null!==(i=t.pickability)&&void 0!==i?i:r.Pickability.onlyVisible,this.m_notCompletlyTransparent=this.getObjectMaterials().some((e=>e.opacity>0)),this.level=t.level}static get(e){var t;return(null===(t=e.userData)||void 0===t?void 0:t.mapAdapter)instanceof o?e.userData.mapAdapter:void 0}static install(e){return e.object.userData||(e.object.userData={}),e.object.userData.mapAdapter=e}static create(e,t){return o.install(new o(e,t))}static ensureUpdated(e,t){var i,r;return null!==(r=null===(i=o.get(e))||void 0===i?void 0:i.ensureUpdated(t))&&void 0!==r&&r}toJSON(){return{kind:this.kind,technique:this.technique}}ensureUpdated(e){return this.m_lastUpdateFrameNumber!==e.frameNumber&&(this.m_lastUpdateFrameNumber=e.frameNumber,this.updateMaterials(e))}isVisible(){return this.object.visible&&this.m_notCompletlyTransparent}isPickable(){return this.pickability===r.Pickability.onlyVisible&&this.isVisible()||this.m_pickability===r.Pickability.all}get pickability(){return this.m_pickability}updateMaterials(e){let t=!1;const i=this.getObjectMaterials();for(const r of i){const i=n.MapMaterialAdapter.ensureUpdated(r,e);t=t||i}return t&&(this.m_notCompletlyTransparent=i.some((e=>e.opacity>0))),t}getObjectMaterials(){const e=this.object;return Array.isArray(e.material)?e.material:void 0!==e.material?[e.material]:[]}}t.MapObjectAdapter=o},5239:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapTileCuller=void 0;const r=i(84428);t.MapTileCuller=class{constructor(e){this.m_camera=e,this.m_globalFrustumMin=new r.Vector3,this.m_globalFrustumMax=new r.Vector3,this.m_frustumCorners=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3]}setup(){const e=this.getFrustumCorners(),t=this.m_camera.matrixWorld;this.m_globalFrustumMin.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.m_globalFrustumMax.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(const i of e)i.applyMatrix4(t),this.m_globalFrustumMin.x=Math.min(this.m_globalFrustumMin.x,i.x),this.m_globalFrustumMin.y=Math.min(this.m_globalFrustumMin.y,i.y),this.m_globalFrustumMin.z=Math.min(this.m_globalFrustumMin.z,i.z),this.m_globalFrustumMax.x=Math.max(this.m_globalFrustumMax.x,i.x),this.m_globalFrustumMax.y=Math.max(this.m_globalFrustumMax.y,i.y),this.m_globalFrustumMax.z=Math.max(this.m_globalFrustumMax.z,i.z)}frustumIntersectsTileBox(e){const t=this.m_globalFrustumMin,i=this.m_globalFrustumMax;return!(i.x<e.min.x||i.y<e.min.y||i.z<e.min.z||t.x>e.max.x||t.y>e.max.y||t.z>e.max.z)}getFrustumCorners(){const e=this.m_frustumCorners,t=this.m_camera.projectionMatrixInverse;let i=0;function r(r,n,o){e[i++].set(r,n,o).applyMatrix4(t)}return r(-1,-1,-1),r(1,-1,-1),r(-1,1,-1),r(1,1,-1),r(-1,-1,1),r(1,-1,1),r(-1,1,1),r(1,1,1),e}}},17624:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapView=t.MapViewPowerPreference=t.MapViewEventNames=t.TileTaskGroups=void 0;const r=i(96500),n=i(32941),o=i(38338),a=i(84428),s=i(43064),l=i(45886),c=i(38738),u=i(81621),d=i(95585),h=i(23193),m=i(41470),p=i(4038),f=i(11369),g=i(86381),y=i(41621),v=i(56870),_=i(58512),b=i(69476),S=i(50921),T=i(45572),E=i(18928),C=i(14057),w=i(43495),x=i(67180),P=i(66437),O=i(22227),A=i(16875),D=i(71043),R=i(61257),I=i(86241),M=i(54504),L=i(81887),k=i(83829),N=i(96393);var U,j;o.LoggerManager.instance.setLogLevelForAll(o.LogLevel.Error),(j=t.TileTaskGroups||(t.TileTaskGroups={})).FETCH_AND_DECODE="fetch",j.CREATE="create",function(e){e.Update="update",e.Resize="resize",e.Render="render",e.AfterRender="didrender",e.FirstFrame="first-render",e.FrameComplete="frame-complete",e.ThemeLoaded="theme-loaded",e.AnimationStarted="animation-started",e.AnimationFinished="animation-finished",e.MovementStarted="movement-started",e.MovementFinished="movement-finished",e.DataSourceConnect="datasource-connect",e.CopyrightChanged="copyright-changed",e.ContextLost="webglcontext-lost",e.ContextRestored="webglcontext-restored",e.CameraPositionChanged="camera-changed",e.Dispose="dispose"}(U=t.MapViewEventNames||(t.MapViewEventNames={}));const F=o.LoggerManager.instance.create("MapView"),V=4e6,B={vector2:[new a.Vector2],vector3:[new a.Vector3,new a.Vector3,new a.Vector3],rayCaster:new a.Raycaster,groundPlane:new a.Plane,groundSphere:new a.Sphere(void 0,n.EarthConstants.EQUATORIAL_RADIUS),matrix4:[new a.Matrix4,new a.Matrix4],transform:[{position:new a.Vector3,xAxis:new a.Vector3,yAxis:new a.Vector3,zAxis:new a.Vector3}],color:new a.Color};var G;!function(e){e.Default="default",e.LowPower="low-power",e.HighPerformance="high-performance"}(G=t.MapViewPowerPreference||(t.MapViewPowerPreference={}));const z={projection:n.mercatorProjection,addBackgroundDatasource:!0,maxVisibleDataSourceTiles:100,extendedFrustumCulling:!0,tileCacheSize:200,resourceComputationType:N.ResourceComputationType.EstimationInMb,quadTreeSearchDistanceUp:3,quadTreeSearchDistanceDown:2,pixelRatio:"undefined"!=typeof window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1,target:new n.GeoCoordinates(25,0),zoomLevel:5,tilt:0,heading:0,theme:{},maxTilesPerFrame:0};class H extends g.EventDispatcher{constructor(e){var t,i;super(),this.UPDATE_EVENT={type:U.Update},this.RENDER_EVENT={type:U.Render},this.DID_RENDER_EVENT={type:U.AfterRender},this.FIRST_FRAME_EVENT={type:U.FirstFrame},this.FRAME_COMPLETE_EVENT={type:U.FrameComplete},this.THEME_LOADED_EVENT={type:U.ThemeLoaded},this.ANIMATION_STARTED_EVENT={type:U.AnimationStarted},this.ANIMATION_FINISHED_EVENT={type:U.AnimationFinished},this.MOVEMENT_STARTED_EVENT={type:U.MovementStarted},this.MOVEMENT_FINISHED_EVENT={type:U.MovementFinished},this.CONTEXT_LOST_EVENT={type:U.ContextLost},this.CONTEXT_RESTORED_EVENT={type:U.ContextRestored},this.COPYRIGHT_CHANGED_EVENT={type:U.CopyrightChanged},this.DISPOSE_EVENT={type:U.Dispose},this.m_renderLabels=!0,this.m_visibleTileSetLock=!1,this.m_tileWrappingEnabled=!0,this.m_zoomLevel=1,this.m_minZoomLevel=1,this.m_maxZoomLevel=20,this.m_minCameraHeight=20,this.m_rteCamera=new a.PerspectiveCamera,this.m_yaw=0,this.m_pitch=0,this.m_roll=0,this.m_targetDistance=0,this.m_targetGeoPos=n.GeoCoordinates.fromObject(z.target),this.m_targetWorldPos=new a.Vector3,this.m_viewRanges={near:.1,far:V,minimum:.1,maximum:V},this.m_scene=new a.Scene,this.m_overlayScene=new a.Scene,this.m_sceneRoot=new a.Object3D,this.m_overlaySceneRoot=new a.Object3D,this.m_mapAnchors=new T.MapAnchors,this.m_animationCount=0,this.m_drawing=!1,this.m_updatePending=!1,this.m_frameNumber=0,this.m_forceCameraAspect=void 0,this.m_taskSchedulerTimeout=void 0,this.m_tileDataSources=[],this.m_connectedDataSources=new Set,this.m_failedDataSources=new Set,this.m_enablePolarDataSource=!0,this.m_raycaster=new a.Raycaster,this.m_plane=new a.Plane(new a.Vector3(0,0,1)),this.m_sphere=new a.Sphere(void 0,n.EarthConstants.EQUATORIAL_RADIUS),this.m_firstFrameRendered=!1,this.m_firstFrameComplete=!1,this.m_userImageCache=new S.MapViewImageCache,this.m_env=new r.MapEnv({}),this.m_poiManager=new P.PoiManager(this),this.m_poiTableManager=new O.PoiTableManager(this),this.m_lastTileIds="",this.m_copyrightInfo=[],this.m_disposed=!1,this.onWebGLContextLost=e=>{this.dispatchEvent(this.CONTEXT_LOST_EVENT),F.warn("WebGL context lost",e)},this.onWebGLContextRestored=e=>{this.dispatchEvent(this.CONTEXT_RESTORED_EVENT),void 0!==this.m_renderer&&(this.textElementsRenderer.restoreRenderers(this.m_renderer),this.getTheme().then((e=>{this.m_sceneEnvironment.updateClearColor(e.clearColor,e.clearAlpha),this.update()}))),F.warn("WebGL context restored",e)},this.m_options=Object.assign({},e),this.m_uriResolver=this.m_options.uriResolver,void 0!==this.m_options.minZoomLevel&&(this.m_minZoomLevel=this.m_options.minZoomLevel),void 0!==this.m_options.maxZoomLevel&&(this.m_maxZoomLevel=this.m_options.maxZoomLevel),void 0!==this.m_options.minCameraHeight&&(this.m_minCameraHeight=this.m_options.minCameraHeight),void 0!==this.m_options.maxBounds&&(this.m_geoMaxBounds=this.m_options.maxBounds),void 0!==this.m_options.decoderUrl&&(m.ConcurrentDecoderFacade.defaultScriptUrl=this.m_uriResolver?this.m_uriResolver.resolveUri(this.m_options.decoderUrl):this.m_options.decoderUrl),void 0!==this.m_options.decoderCount&&(m.ConcurrentDecoderFacade.defaultWorkerCount=this.m_options.decoderCount),this.m_visibleTileSetOptions=Object.assign(Object.assign({},z),{clipPlanesEvaluator:void 0!==e.clipPlanesEvaluator?e.clipPlanesEvaluator:d.createDefaultClipPlanesEvaluator()}),void 0!==e.projection&&(this.m_visibleTileSetOptions.projection=e.projection),void 0!==e.extendedFrustumCulling&&(this.m_visibleTileSetOptions.extendedFrustumCulling=e.extendedFrustumCulling),void 0!==e.maxVisibleDataSourceTiles&&(this.m_visibleTileSetOptions.maxVisibleDataSourceTiles=e.maxVisibleDataSourceTiles),void 0!==e.tileCacheSize&&(this.m_visibleTileSetOptions.tileCacheSize=e.tileCacheSize),void 0!==e.resourceComputationType&&(this.m_visibleTileSetOptions.resourceComputationType=e.resourceComputationType),void 0!==e.quadTreeSearchDistanceUp&&(this.m_visibleTileSetOptions.quadTreeSearchDistanceUp=e.quadTreeSearchDistanceUp),void 0!==e.quadTreeSearchDistanceDown&&(this.m_visibleTileSetOptions.quadTreeSearchDistanceDown=e.quadTreeSearchDistanceDown),void 0!==e.enablePolarDataSource&&(this.m_enablePolarDataSource=e.enablePolarDataSource),this.m_pixelRatio=e.pixelRatio,this.m_options.maxFps=null!==(t=this.m_options.maxFps)&&void 0!==t?t:0,this.m_options.enableStatistics=!0===this.m_options.enableStatistics,this.m_languages=this.m_options.languages,this.m_politicalView=this.m_options.politicalView,this.handleRequestAnimationFrame=this.renderLoop.bind(this),void 0!==this.m_options.tileWrappingEnabled&&(this.m_tileWrappingEnabled=this.m_options.tileWrappingEnabled),this.setupStats(this.m_options.enableStatistics),this.canvas.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.m_renderer=new(null!==(i=a.WebGL1Renderer)&&void 0!==i?i:a.WebGLRenderer)({canvas:this.canvas,context:this.m_options.context,antialias:this.nativeWebglAntialiasEnabled,alpha:this.m_options.alpha,preserveDrawingBuffer:!0===this.m_options.preserveDrawingBuffer,powerPreference:void 0===this.m_options.powerPreference?G.Default:this.m_options.powerPreference}),this.m_renderer.autoClear=!1,this.m_renderer.debug.checkShaderErrors=!1,this.m_renderer.info.autoReset=!1,this.m_tileObjectRenderer=new L.TileObjectRenderer(this.m_env,this.m_renderer),this.setupRenderer(this.m_tileObjectRenderer),this.m_options.fovCalculation=void 0===this.m_options.fovCalculation?y.DEFAULT_FOV_CALCULATION:this.m_options.fovCalculation,this.m_options.fovCalculation.fov=a.MathUtils.clamp(this.m_options.fovCalculation.fov,y.MIN_FOV_DEG,y.MAX_FOV_DEG);const{width:l,height:u}=this.getCanvasClientSize(),p=l/u;this.m_camera=new a.PerspectiveCamera(this.m_options.fovCalculation.fov,p,.1,V),this.m_camera.up.set(0,0,1),this.setFovOnCamera(this.m_options.fovCalculation,u),this.projection.projectPoint(this.m_targetGeoPos,this.m_targetWorldPos),this.m_scene.add(this.m_camera),this.m_screenProjector=new D.ScreenProjector(this.m_camera),this.m_taskScheduler=new C.MapViewTaskScheduler(this.maxFps),this.m_tileGeometryManager=new b.TileGeometryManager(this),void 0!==e.enableMixedLod&&(this.m_enableMixedLod=e.enableMixedLod),void 0!==e.lodMinTilePixelSize&&(this.m_lodMinTilePixelSize=e.lodMinTilePixelSize),this.m_visibleTiles=this.createVisibleTileSet(),this.m_sceneEnvironment=new E.MapViewEnvironment(this,e),this.setupCamera(),this.m_pickHandler=new x.PickHandler(this,this.m_rteCamera,!0===this.m_options.enablePickTechnique),this.m_movementDetector=new c.CameraMovementDetector(this.m_options.movementThrottleTimeout,(()=>this.movementStarted()),(()=>this.movementFinished()));const f=this.m_options.customAntialiasSettings;if(this.mapRenderingManager=new h.MapRenderingManager(l,u,this.m_options.dynamicPixelRatio,f),this.m_animatedExtrusionHandler=new s.AnimatedExtrusionHandler(this),this.m_enablePolarDataSource){const t=void 0!==e.polarStyleSetName?e.polarStyleSetName:"polar";this.m_polarDataSource=new A.PolarTileDataSource({styleSetName:t,geometryLevelOffset:e.polarGeometryLevelOffset}),this.updatePolarDataSource()}this.m_taskScheduler.addEventListener(U.Update,(()=>{this.update()})),void 0!==e.throttlingEnabled&&(this.m_taskScheduler.throttlingEnabled=e.throttlingEnabled),this.m_themeManager=new w.MapViewThemeManager(this,this.m_uriResolver),this.m_textElementsRenderer=this.createTextRenderer(),this.setTheme(o.getOptionValue(this.m_options.theme,z.theme)),this.update()}get lights(){return this.m_sceneEnvironment.lights}get taskQueue(){return this.m_taskScheduler.taskQueue}get renderLabels(){return this.m_renderLabels}set renderLabels(e){this.m_renderLabels=e}get delayLabelsUntilMovementFinished(){return this.textElementsRenderer.delayLabelsUntilMovementFinished}set delayLabelsUntilMovementFinished(e){this.textElementsRenderer.delayLabelsUntilMovementFinished=e}get textElementsRenderer(){return this.m_textElementsRenderer}get cameraMovementDetector(){return this.m_movementDetector}get animatedExtrusionHandler(){return this.m_animatedExtrusionHandler}get tileGeometryManager(){return this.m_tileGeometryManager}get enableMixedLod(){return this.m_enableMixedLod}set enableMixedLod(e){this.m_enableMixedLod!==e&&(this.m_enableMixedLod=e,this.createVisibleTileSet(),this.update())}get tileWrappingEnabled(){return this.m_tileWrappingEnabled}set tileWrappingEnabled(e){this.projection.type!==n.ProjectionType.Spherical?(e!==this.m_tileWrappingEnabled&&(this.m_tileWrappingEnabled=e,this.createVisibleTileSet()),this.update()):F.warn("Setting this with spherical projection has no affect. Was this intended?")}dispose(e=!0){this.DISPOSE_EVENT.time=Date.now(),this.dispatchEvent(this.DISPOSE_EVENT),this.m_disposed=!0,this.m_movementFinishedUpdateTimerId&&(clearTimeout(this.m_movementFinishedUpdateTimerId),this.m_movementFinishedUpdateTimerId=void 0),void 0!==this.m_animationFrameHandle&&(cancelAnimationFrame(this.m_animationFrameHandle),this.m_animationFrameHandle=void 0),this.canvas.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas.removeEventListener("webglcontextrestored",this.onWebGLContextRestored);for(const e of this.m_tileDataSources)e.dispose();this.m_visibleTiles.clearTileCache(),this.m_textElementsRenderer.clearRenderStates(),this.m_renderer.dispose(),e&&this.m_renderer.forceContextLoss(),this.m_themeManager.dispose(),this.m_tileGeometryManager.clear(),this.m_movementDetector.dispose(),m.ConcurrentDecoderFacade.destroyIfTerminated(),p.ConcurrentTilerFacade.destroyIfTerminated(),this.m_taskScheduler.clearQueuedTasks(),super.dispose()}get disposed(){return this.m_disposed}get resourceComputationType(){return this.m_visibleTiles.resourceComputationType}set resourceComputationType(e){this.m_visibleTiles.resourceComputationType=e}getCacheSize(){return this.m_visibleTiles.getDataSourceCacheSize()}setCacheSize(e,t){this.m_visibleTiles.setDataSourceCacheSize(e),t=void 0!==t?t:e/2,this.m_visibleTiles.setNumberOfVisibleTiles(Math.floor(t)),this.m_themeManager.updateCache(),this.m_textElementsRenderer.invalidateCache(),this.update()}get extendedFrustumCulling(){return void 0===this.m_options.extendedFrustumCulling||this.m_visibleTileSetOptions.extendedFrustumCulling}set extendedFrustumCulling(e){this.m_visibleTileSetOptions.extendedFrustumCulling=e}get lockVisibleTileSet(){return this.m_visibleTileSetLock}set lockVisibleTileSet(e){this.m_visibleTileSetLock=e}get pointOfView(){return this.m_pointOfView}set pointOfView(e){this.m_pointOfView=e,this.update()}loadPostEffects(e){fetch(e).then((e=>e.json())).then((e=>{this.m_postEffects=e,this.setPostEffects()}))}get postEffects(){return this.m_postEffects}set postEffects(e){this.m_postEffects=e,this.setPostEffects()}get theme(){return this.m_themeManager.theme}set theme(e){this.setTheme(e)}async setTheme(e){const t=await this.m_themeManager.setTheme(e);return this.THEME_LOADED_EVENT.time=Date.now(),this.dispatchEvent(this.THEME_LOADED_EVENT),this.update(),t}async getTheme(){return await this.m_themeManager.getTheme()}get uriResolver(){return this.m_uriResolver}get forceCameraAspect(){return this.m_forceCameraAspect}set forceCameraAspect(e){this.m_forceCameraAspect=e}get languages(){return this.m_languages}set languages(e){this.m_languages=e,this.m_tileDataSources.forEach((e=>{e.setLanguages(this.m_languages)})),this.update()}get politicalView(){return this.m_politicalView}set politicalView(e){this.m_politicalView!==e&&(this.m_politicalView=e,this.m_tileDataSources.forEach((t=>{t.setPoliticalView(e)})))}get copyrightInfo(){return this.m_copyrightInfo}set disableFading(e){this.m_textElementsRenderer.disableFading=e}get disableFading(){return this.m_textElementsRenderer.disableFading}get frameNumber(){return this.m_frameNumber}resetFrameNumber(){this.m_frameNumber=0,this.m_previousFrameTimeStamp=void 0}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}get canvas(){return this.m_options.canvas}get collisionDebugCanvas(){return this.m_collisionDebugCanvas}get scene(){return this.m_scene}get overlayScene(){return this.m_overlayScene}get sceneEnvironment(){return this.m_sceneEnvironment}get camera(){return this.m_camera}get renderer(){return this.m_renderer}get clearColor(){const e=this.m_renderer.getClearColor(B.color);return void 0!==e?e.getHex():0}set clearColor(e){this.m_renderer.setClearColor(e)}get clearAlpha(){const e=this.m_renderer.getClearAlpha();return void 0!==e?e:0}set clearAlpha(e){this.m_renderer.setClearAlpha(e)}get projection(){return this.m_visibleTileSetOptions.projection}set projection(e){const t=this.tilt,i=this.heading;this.m_visibleTileSetOptions.projection=e,this.updatePolarDataSource(),this.clearTileCache(),this.textElementsRenderer.clearRenderStates(),this.m_visibleTiles=this.createVisibleTileSet(),this.geoMaxBounds=this.geoMaxBounds,this.lookAtImpl({tilt:t,heading:i})}get clipPlanesEvaluator(){return this.m_visibleTileSetOptions.clipPlanesEvaluator}set clipPlanesEvaluator(e){this.m_visibleTileSetOptions.clipPlanesEvaluator=e}get focalLength(){var e;return null!==(e=u.CameraUtils.getFocalLength(this.m_camera))&&void 0!==e?e:0}get target(){return this.m_targetGeoPos}get worldTarget(){return this.m_targetWorldPos}get targetDistance(){return this.m_targetDistance}get viewRanges(){return this.m_viewRanges}get geoCenter(){return this.projection.unprojectPoint(this.m_camera.position).normalized()}set geoCenter(e){if(void 0!==e.altitude)this.projection.projectPoint(e,this.m_camera.position);else{const t=this.geoCenter.altitude;this.projection.projectPoint(new n.GeoCoordinates(e.latitude,e.longitude,t),this.m_camera.position)}this.update()}get mapAnchors(){return this.m_mapAnchors}get worldCenter(){return this.m_camera.position}get pickHandler(){return this.m_pickHandler}get imageCache(){return this.m_themeManager.imageCache}get userImageCache(){return this.m_userImageCache}get poiManager(){return this.m_poiManager}get poiTableManager(){return this.m_poiTableManager}get minCameraHeight(){return this.m_minCameraHeight}get minZoomLevel(){return this.m_minZoomLevel}set minZoomLevel(e){this.m_minZoomLevel=e,this.update()}get maxZoomLevel(){return this.m_maxZoomLevel}set maxZoomLevel(e){this.m_maxZoomLevel=e,this.update()}get geoMaxBounds(){return this.m_geoMaxBounds}set geoMaxBounds(e){this.m_geoMaxBounds=e,this.m_worldMaxBounds=this.m_geoMaxBounds?this.projection.projectBox(this.m_geoMaxBounds,this.projection.type===n.ProjectionType.Planar?new a.Box3:new n.OrientedBox3):void 0}get worldMaxBounds(){return this.m_worldMaxBounds}get zoomLevel(){return this.m_zoomLevel}set zoomLevel(e){this.lookAtImpl({zoomLevel:e})}get tilt(){return a.MathUtils.radToDeg(this.m_pitch)}set tilt(e){this.lookAtImpl({tilt:e})}get heading(){return-a.MathUtils.radToDeg(this.m_yaw)}set heading(e){this.lookAtImpl({heading:e})}get env(){return this.m_env}get storageLevel(){return a.MathUtils.clamp(Math.floor(this.m_zoomLevel),this.m_minZoomLevel,this.m_maxZoomLevel)}get viewportHeight(){return this.canvas.height}get nativeWebglAntialiasEnabled(){return void 0===this.m_options.enableNativeWebglAntialias?this.pixelRatio<2:this.m_options.enableNativeWebglAntialias}get dataSources(){return this.m_tileDataSources}setFovCalculation(e){this.m_options.fovCalculation=e,this.updateCameras()}getDataSourceByName(e){return this.m_tileDataSources.find((t=>t.name===e))}getDataSourcesByStyleSetName(e){return this.m_tileDataSources.filter((t=>t.styleSetName===e))}isDataSourceEnabled(e){return e.enabled&&e.ready()&&this.m_connectedDataSources.has(e.name)&&e.isVisible(this.zoomLevel)}async addDataSource(e){var t,i;if(void 0!==this.getDataSourceByName(e.name))throw new Error(`A DataSource with the name "${e.name}" already exists in this MapView.`);e.attach(this),e.setEnableElevationOverlay(void 0!==this.m_elevationProvider);const r=this.m_tileDataSources.find((e=>!0===e.addGroundPlane&&!(e instanceof l.BackgroundDataSource)));!0===e.addGroundPlane&&void 0!==r&&console.warn(`The DataSources ${e.name} and ${r.name} both have a ground plane added, this will cause problems with the fallback logic, see HARP-14728 & HARP-15488.`),this.m_tileDataSources.push(e),null===(t=this.m_sceneEnvironment)||void 0===t||t.updateBackgroundDataSource();try{if(await e.connect(),!this.m_tileDataSources.includes(e))return;e.addEventListener(U.Update,(()=>{this.update()}));const t=await this.getTheme();e.setLanguages(this.m_languages),void 0!==t&&void 0!==t.styles&&await e.setTheme(t),this.m_connectedDataSources.add(e.name),this.dispatchEvent({type:U.DataSourceConnect,dataSourceName:e.name}),this.update()}catch(t){F.error(`Failed to connect to datasource ${e.name}: ${null!==(i=t.message)&&void 0!==i?i:t}`),this.m_failedDataSources.add(e.name),this.dispatchEvent({type:U.DataSourceConnect,dataSourceName:e.name,error:t})}}removeDataSource(e){const t=this.m_tileDataSources.indexOf(e);-1!==t&&(e.detach(this),this.m_visibleTiles.removeDataSource(e),this.m_tileDataSources.splice(t,1),this.m_connectedDataSources.delete(e.name),this.m_failedDataSources.delete(e.name),this.m_sceneEnvironment.updateBackgroundDataSource(),this.update())}get visibleTileSet(){return this.m_visibleTiles}addOverlayText(e){this.m_textElementsRenderer.addOverlayText(e),this.update()}clearOverlayText(){this.m_textElementsRenderer.clearOverlayText()}lookAt(e,t,i,r){if(n.isGeoCoordinatesLike(e)){const n={target:e,zoomLevel:void 0!==t?k.MapViewUtils.calculateZoomLevelFromDistance(this,t):void 0,tilt:i,heading:r};this.lookAtImpl(n)}else"object"==typeof e&&this.lookAtImpl(e)}setCameraGeolocationAndZoom(e,t,i=0,r=0){this.geoCenter=e;let o=Math.min(k.MapViewUtils.MAX_TILT_DEG,r);if(this.projection.type===n.ProjectionType.Spherical){const e=Math.asin(n.EarthConstants.EQUATORIAL_RADIUS/(k.MapViewUtils.calculateDistanceToGroundFromZoomLevel(this,t)+n.EarthConstants.EQUATORIAL_RADIUS)),i=a.MathUtils.radToDeg(e);o=Math.min(o,i)}k.MapViewUtils.zoomOnTargetPosition(this,0,0,t),k.MapViewUtils.setRotation(this,i,o),this.update()}setDynamicProperty(e,t){if(e.startsWith("$"))throw new Error(`failed to update the value of the dynamic property '${e}'`);this.m_env.entries[e]=t,this.update()}removeDynamicProperty(e){if(e.startsWith("$"))throw new Error(`failed to remove the dynamic property '${e}'`);delete this.m_env.entries[e],this.update()}get animating(){return this.m_animationCount>0}beginAnimation(){0==this.m_animationCount++&&(this.update(),this.ANIMATION_STARTED_EVENT.time=Date.now(),this.dispatchEvent(this.ANIMATION_STARTED_EVENT))}endAnimation(){this.m_animationCount>0&&--this.m_animationCount,0===this.m_animationCount&&(this.ANIMATION_FINISHED_EVENT.time=Date.now(),this.dispatchEvent(this.ANIMATION_FINISHED_EVENT))}get cameraIsMoving(){return this.m_movementDetector.cameraIsMoving}get isDynamicFrame(){return!this.m_visibleTiles.allVisibleTilesLoaded||this.m_themeManager.isUpdating()||this.cameraIsMoving||this.animating||this.m_updatePending||this.m_animatedExtrusionHandler.isAnimating||this.m_textElementsRenderer.isUpdatePending||this.m_textElementsRenderer.loading}get pixelToWorld(){if(void 0===this.m_pixelToWorld){o.assert(void 0!==this.m_options.fovCalculation);const e=this.m_targetDistance,t=u.CameraUtils.getFocalLength(this.m_camera);o.assert(void 0!==t),this.m_pixelToWorld=u.CameraUtils.convertScreenToWorldSize(t,e,1)}return this.m_pixelToWorld}get worldToPixel(){return 1/this.pixelToWorld}get pixelRatio(){return void 0!==this.m_pixelRatio?this.m_pixelRatio:"undefined"!=typeof window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1}set pixelRatio(e){this.m_pixelRatio=e,this.renderer.getPixelRatio()!==this.pixelRatio&&this.renderer.setPixelRatio(this.pixelRatio)}set maxFps(e){this.m_options.maxFps=e,this.m_taskScheduler.maxFps=e}get maxFps(){return this.m_options.maxFps}set dynamicPixelRatio(e){this.mapRenderingManager.lowResPixelRatio=e}get dynamicPixelRatio(){return this.mapRenderingManager.lowResPixelRatio}getScreenPosition(e){n.isVector3Like(e)?B.vector3[0].copy(e):this.projection.projectPoint(n.GeoCoordinates.fromObject(e),B.vector3[0]);const t=this.m_screenProjector.project(B.vector3[0]);if(void 0!==t){const{width:e,height:i}=this.getCanvasClientSize();t.x=t.x+e/2,t.y=i-(t.y+i/2)}return t}getWorldPositionAt(e,t,i){this.m_raycaster.setFromCamera(this.getNormalizedScreenCoordinates(e,t),this.m_camera);const r=this.projection.type===n.ProjectionType.Spherical?this.m_raycaster.ray.intersectSphere(this.m_sphere,B.vector3[0]):this.m_raycaster.ray.intersectPlane(this.m_plane,B.vector3[0]);if(null===r&&!0===i){const e=this.m_camera.getWorldDirection(B.vector3[0]).dot(this.m_raycaster.ray.direction);return B.vector3[0].copy(this.m_raycaster.ray.direction).multiplyScalar(this.m_camera.far/e).add(this.m_camera.position)}return r}getGeoCoordinatesAt(e,t,i){const r=this.getWorldPositionAt(e,t,i);if(!r)return null;const o=this.projection.unprojectPoint(r);return this.tileWrappingEnabled||this.projection.type!==n.ProjectionType.Planar||(o.longitude=a.MathUtils.clamp(o.longitude,-180,180)),o}getNormalizedScreenCoordinates(e,t){const{width:i,height:r}=this.getCanvasClientSize();return new a.Vector3(e/i*2-1,-t/r*2+1,0)}intersectMapObjects(e,t,i){return this.m_pickHandler.intersectMapObjects(e,t,i)}resize(e,t){this.m_renderer.setSize(e,t,!1),this.m_renderer.getPixelRatio()!==this.pixelRatio&&this.m_renderer.setPixelRatio(this.pixelRatio),void 0!==this.mapRenderingManager&&this.mapRenderingManager.setSize(e,t),void 0!==this.collisionDebugCanvas&&(this.collisionDebugCanvas.width=e,this.collisionDebugCanvas.height=t),this.updateCameras(),this.update(),this.dispatchEvent({type:U.Resize,size:{width:e,height:t}})}renderSync(e){void 0===e&&(e=o.PerformanceTimer.now()),this.render(e)}update(){this.disposed?F.warn("update(): MapView has been disposed of."):(this.dispatchEvent(this.UPDATE_EVENT),this.m_updatePending||(this.m_updatePending=!0,this.startRenderLoop()))}get updatePending(){return this.m_updatePending}requestUpdateIfNeeded(){this.update()}clearTileCache(e,t){if(void 0!==this.m_visibleTiles){if(void 0!==e){const i=this.getDataSourceByName(e);i&&(this.m_visibleTiles.clearTileCache(i,t),i.clearCache())}else this.m_visibleTiles.clearTileCache(void 0,t),this.m_tileDataSources.forEach((e=>e.clearCache()));void 0!==this.m_elevationProvider&&this.m_elevationProvider.clearCache()}}forEachVisibleTile(e){this.m_visibleTiles.forEachVisibleTile(e)}forEachCachedTile(e){this.m_visibleTiles.forEachCachedTile(e)}markTilesDirty(e,t){this.m_visibleTiles.markTilesDirty(e,t),this.update()}async setElevationSource(e,t,i){this.m_elevationSource&&this.m_elevationSource!==e&&this.removeDataSource(this.m_elevationSource),this.m_tileDataSources.includes(e)||await this.addDataSource(e),this.m_elevationSource=e,this.m_elevationRangeSource=t,this.m_elevationRangeSource.ready()||await this.m_elevationRangeSource.connect(),this.m_elevationProvider=i,this.dataSources.forEach((e=>{e.setEnableElevationOverlay(!0)})),this.m_tileGeometryManager.setTileUpdateCallback((e=>{_.overlayOnElevation(e)})),this.clearTileCache()}clearElevationSource(e){this.removeDataSource(e),this.m_elevationSource=void 0,this.m_elevationRangeSource=void 0,this.m_elevationProvider=void 0,this.dataSources.forEach((e=>{e.setEnableElevationOverlay(!1)})),this.m_tileGeometryManager.setTileUpdateCallback(void 0),this.clearTileCache()}get fog(){return this.m_sceneEnvironment.fog}setPostEffects(){this.mapRenderingManager.bloom.enabled=!1,this.mapRenderingManager.outline.enabled=!1,this.mapRenderingManager.vignette.enabled=!1,this.mapRenderingManager.sepia.enabled=!1,void 0!==this.m_postEffects&&(void 0!==this.m_postEffects.bloom&&(this.mapRenderingManager.bloom=this.m_postEffects.bloom),void 0!==this.m_postEffects.outline&&(this.mapRenderingManager.outline.enabled=this.m_postEffects.outline.enabled,this.mapRenderingManager.updateOutline(this.m_postEffects.outline)),void 0!==this.m_postEffects.vignette&&(this.mapRenderingManager.vignette=this.m_postEffects.vignette),void 0!==this.m_postEffects.sepia&&(this.mapRenderingManager.sepia=this.m_postEffects.sepia))}get elevationProvider(){return this.m_elevationProvider}get throttlingEnabled(){return!0===this.m_taskScheduler.throttlingEnabled}set throttlingEnabled(e){this.m_taskScheduler.throttlingEnabled=e}get shadowsEnabled(){return!0===this.m_options.enableShadows}set shadowsEnabled(e){void 0!==this.m_renderer.shadowMap&&e!==this.m_renderer.shadowMap.enabled&&(this.m_options.enableShadows=e,this.m_renderer.shadowMap.enabled=e,this.m_renderer.shadowMap.type=a.PCFSoftShadowMap,this.clearTileCache())}extractAttitude(){const e=this.m_camera,t=this.projection,i=B.vector3[1],r=B.transform[0],n=B.matrix4[1];i.setFromMatrixPosition(e.matrixWorld),t.localTangentSpace(this.m_targetGeoPos,r),n.makeBasis(r.xAxis,r.yAxis,r.zAxis),B.matrix4[0].copy(n).invert().multiply(e.matrixWorld),r.xAxis.setFromMatrixColumn(B.matrix4[0],0),r.yAxis.setFromMatrixColumn(B.matrix4[0],1),r.zAxis.setFromMatrixColumn(B.matrix4[0],2);let o=0,a=0,s=0;const l=r.zAxis.dot(i.set(0,0,1));return l<1-1e-10?l>1e-10-1?(o=Math.atan2(r.zAxis.x,-r.zAxis.y),a=Math.acos(r.zAxis.z),s=Math.atan2(r.xAxis.x,r.yAxis.z)):(o=-Math.atan2(-r.yAxis.x,r.xAxis.x),a=180,s=0):(o=Math.atan2(-r.yAxis.x,r.xAxis.x),a=0,s=0),{yaw:o,pitch:a,roll:s}}lookAtImpl(e){const t=Math.min(o.getOptionValue(e.tilt,this.tilt),k.MapViewUtils.MAX_TILT_DEG),i=o.getOptionValue(e.heading,this.heading),r=void 0!==e.zoomLevel?k.MapViewUtils.calculateDistanceFromZoomLevel(this,a.MathUtils.clamp(e.zoomLevel,this.m_minZoomLevel,this.m_maxZoomLevel)):void 0!==e.distance?e.distance:this.m_targetDistance;let s;if(void 0!==e.bounds){let o;if(e.bounds instanceof n.GeoBox)s=e.target?n.GeoCoordinates.fromObject(e.target):e.bounds.center,o=k.MapViewUtils.geoBoxToGeoPoints(e.bounds);else if(e.bounds instanceof n.GeoPolygon)s=e.bounds.getCentroid(),o=e.bounds.coordinates;else if(n.isGeoBoxExtentLike(e.bounds)){s=e.target?n.GeoCoordinates.fromObject(e.target):this.target;const t=n.GeoBox.fromCenterAndExtents(s,e.bounds);o=k.MapViewUtils.geoBoxToGeoPoints(t)}else{if(!Array.isArray(e.bounds))throw Error("#lookAt: Invalid 'bounds' value");o=e.bounds,void 0!==e.target&&(s=n.GeoCoordinates.fromObject(e.target))}e.bounds instanceof n.GeoBox||e.bounds instanceof n.GeoPolygon||!this.m_tileWrappingEnabled||this.projection.type!==n.ProjectionType.Planar||(o=k.MapViewUtils.wrapGeoPointsToScreen(o,s));const l=o.map((e=>this.projection.projectPoint(n.GeoCoordinates.fromObject(e),new a.Vector3))),c=new a.Vector3;return void 0===s?((new a.Box3).setFromPoints(l).getCenter(c),this.projection.scalePointToSurface(c),s=this.projection.unprojectPoint(c)):this.projection.projectPoint(s,c),void 0!==e.zoomLevel||void 0!==e.distance?this.lookAtImpl({tilt:t,heading:i,distance:r,target:s}):this.lookAtImpl(k.MapViewUtils.getFitBoundsLookAtParams(s,c,l,{tilt:t,heading:i,minDistance:k.MapViewUtils.calculateDistanceFromZoomLevel(this,this.maxZoomLevel),projection:this.projection,camera:this.camera}))}s=void 0!==e.target?n.GeoCoordinates.fromObject(e.target):this.target,k.MapViewUtils.getCameraRotationAtTarget(this.projection,s,-i,t,this.camera.quaternion),k.MapViewUtils.getCameraPositionFromTargetCoordinates(s,r,-i,t,this.projection,this.camera.position),this.camera.updateMatrixWorld(!0),this.updateLookAtSettings(),this.update()}updatePolarDataSource(){const e=this.m_polarDataSource;if(!0===this.m_enablePolarDataSource&&void 0!==e){const t=this.getDataSourceByName(e.name);this.projection.type===n.ProjectionType.Spherical?void 0===t&&this.addDataSource(e):void 0!==t&&this.removeDataSource(e)}}updateCameras(e){var t;this.m_camera.updateMatrixWorld(!1),this.updateLookAtSettings();const{width:i,height:r}=this.m_renderer.getSize(B.vector2[0]);this.m_camera.aspect=void 0!==this.m_forceCameraAspect?this.m_forceCameraAspect:i/r,this.setFovOnCamera(this.m_options.fovCalculation,r);const n=this.projection.getScaleFactor(this.camera.position),o=n*this.m_tileDataSources.reduce(((e,t)=>Math.max(e,t.maxGeometryHeight)),0),a=n*this.m_tileDataSources.reduce(((e,t)=>Math.min(e,t.minGeometryHeight)),0);Object.assign(this.m_viewRanges,void 0===e?this.m_visibleTiles.updateClipPlanes(o,a):e),this.m_camera.near=this.m_viewRanges.near,this.m_camera.far=this.m_viewRanges.far,this.m_camera.updateProjectionMatrix(),this.m_rteCamera.copy(this.m_camera),this.m_rteCamera.position.setScalar(0),this.m_rteCamera.updateMatrixWorld(!0),null===(t=this.m_textElementsRenderer)||void 0===t||t.updateCamera(),this.m_screenProjector.update(this.camera,i,r),this.m_pixelToWorld=void 0,this.m_sceneEnvironment.update()}updateLookAtSettings(){let{target:e,distance:t,final:i}=k.MapViewUtils.getTargetAndDistance(this.projection,this.camera,this.elevationProvider);i||this.update(),this.geoMaxBounds&&({target:e,distance:t}=k.MapViewUtils.constrainTargetAndDistanceToViewBounds(e,t,this)),this.m_targetWorldPos.copy(e),this.m_targetGeoPos=this.projection.unprojectPoint(this.m_targetWorldPos),this.m_targetDistance=t,this.m_zoomLevel=k.MapViewUtils.calculateZoomLevelFromDistance(this,this.m_targetDistance);const{yaw:r,pitch:n,roll:o}=this.extractAttitude();this.m_yaw=r,this.m_pitch=n,this.m_roll=o}updateEnv(){this.m_env.entries.$zoom=this.m_zoomLevel,this.m_env.entries.$pixelToMeters=this.pixelToWorld,this.m_env.entries.$frameNumber=this.m_frameNumber}ndcToView(e,t){return t.set(e.x,e.y,e.z).applyMatrix4(this.camera.projectionMatrixInverse).applyMatrix4(this.m_rteCamera.matrixWorld),t}renderLoop(e){if(!0!==this.m_options.synchronousRendering&&!this.disposed){if(0===this.maxFps)this.render(e);else{const t=3,i=1e3/this.maxFps;e>=(void 0===this.m_previousFrameTimeStamp?0:this.m_previousFrameTimeStamp)+i-t&&this.render(e)}this.isDynamicFrame?this.m_animationFrameHandle=requestAnimationFrame(this.handleRequestAnimationFrame):this.m_animationFrameHandle=void 0}}startRenderLoop(){void 0!==this.m_animationFrameHandle||this.m_options.synchronousRendering||(this.m_animationFrameHandle=requestAnimationFrame(this.handleRequestAnimationFrame))}getEnabledTileDataSources(){const e=[];for(const t of this.m_tileDataSources)this.isDataSourceEnabled(t)&&e.push(t);return e}render(e){if(this.m_drawing)return;if(this.disposed)return void F.warn("render(): MapView has been disposed of.");let t;this.RENDER_EVENT.time=e,this.dispatchEvent(this.RENDER_EVENT),this.m_tileObjectRenderer.prepareRender(),++this.m_frameNumber;const i=R.PerformanceStatistics.instance,r=i.enabled;if(r){if(t=i.currentFrame,void 0!==this.m_previousFrameTimeStamp){const i=e-this.m_previousFrameTimeStamp;t.setValue("render.fps",1e3/i)}i.storeAndClearFrameInfo(),t=t,t.setValue("renderCount.frameNumber",this.m_frameNumber)}let n,a,s,l,c,u;if(this.m_previousFrameTimeStamp=e,this.m_renderer.info.reset(),this.m_updatePending=!1,this.m_thisFrameTilesChanged=void 0,this.m_drawing=!0,this.m_renderer.getPixelRatio()!==this.pixelRatio&&this.m_renderer.setPixelRatio(this.pixelRatio),this.updateCameras(),this.updateEnv(),this.m_renderer.clear(),this.m_sceneRoot.children.length=0,this.m_overlaySceneRoot.children.length=0,r&&(n=o.PerformanceTimer.now()),!this.lockVisibleTileSet){const e=this.m_visibleTiles.updateRenderList(this.storageLevel,Math.floor(this.zoomLevel),this.getEnabledTileDataSources(),this.m_frameNumber,this.m_elevationRangeSource);e.viewRangesChanged&&this.updateCameras(e.viewRanges)}r&&(a=o.PerformanceTimer.now());const d=this.m_visibleTiles.dataSourceTileList;if(d.forEach((({zoomLevel:e,renderedTiles:t})=>{t.forEach((t=>{this.m_tileObjectRenderer.render(t,e,this.zoomLevel,this.m_camera.position,this.m_sceneRoot),t.frameNumLastVisible=this.m_frameNumber}))})),this.m_mapAnchors.update(this.projection,this.camera.position,this.m_sceneRoot,this.m_overlaySceneRoot),this.m_animatedExtrusionHandler.update(this.zoomLevel),void 0!==t&&(t.addValue("renderCount.numTilesRendered",0),t.addValue("renderCount.numTilesVisible",0),t.addValue("renderCount.numTilesLoading",0),d.forEach((({zoomLevel:e,renderedTiles:i,visibleTiles:r,numTilesLoading:n})=>{t.addValue("renderCount.numTilesRendered",i.size),t.addValue("renderCount.numTilesVisible",r.length),t.addValue("renderCount.numTilesLoading",n)}))),this.m_movementDetector.checkCameraMoved(this,e)){const{latitude:e,longitude:t,altitude:i}=this.geoCenter;this.dispatchEvent({type:U.CameraPositionChanged,latitude:e,longitude:t,altitude:i,yaw:this.m_yaw,pitch:this.m_pitch,roll:this.m_roll,tilt:this.tilt,heading:this.heading,zoom:this.zoomLevel})}const h=void 0!==this.m_pointOfView?this.m_pointOfView:this.m_rteCamera;if(this.renderLabels&&!this.m_pointOfView&&this.m_textElementsRenderer.placeText(d,e),r&&(s=o.PerformanceTimer.now()),this.mapRenderingManager.render(this.m_renderer,this.m_scene,h,!this.isDynamicFrame),r&&(l=o.PerformanceTimer.now()),this.renderLabels&&!this.m_pointOfView&&this.m_textElementsRenderer.renderText(this.m_viewRanges.maximum),this.m_overlaySceneRoot.children.length>0&&this.m_renderer.render(this.m_overlayScene,h),r&&(c=o.PerformanceTimer.now()),this.m_firstFrameRendered||(this.m_firstFrameRendered=!0,r&&i.appResults.set("firstFrame",e),this.FIRST_FRAME_EVENT.time=e,this.dispatchEvent(this.FIRST_FRAME_EVENT)),this.m_visibleTiles.disposePendingTiles(),this.m_drawing=!1,this.checkCopyrightUpdates(),void 0!==this.m_taskSchedulerTimeout&&clearTimeout(this.m_taskSchedulerTimeout),this.m_taskSchedulerTimeout=setTimeout((()=>{this.m_taskSchedulerTimeout=void 0,this.m_taskScheduler.processPending(e)}),0),void 0!==t){u=o.PerformanceTimer.now();const r=u-e;t.setValue("render.setupTime",n-e),t.setValue("render.cullTime",a-n),t.setValue("render.textPlacementTime",s-a),t.setValue("render.drawTime",l-s),t.setValue("render.textDrawTime",c-l),t.setValue("render.cleanupTime",u-c),t.setValue("render.frameRenderTime",r),t.setValue("render.fullFrameTime",r),t.setValue("render.geometryCreationTime",0),i.addWebGLInfo(this.m_renderer.info),i.addMemoryInfo()}this.DID_RENDER_EVENT.time=e,this.dispatchEvent(this.DID_RENDER_EVENT),this.isDynamicFrame||(!1===this.m_firstFrameComplete&&(this.m_firstFrameComplete=!0,r&&i.appResults.set("firstFrameComplete",e)),this.FRAME_COMPLETE_EVENT.time=e,this.dispatchEvent(this.FRAME_COMPLETE_EVENT))}setupCamera(){o.assert(void 0!==this.m_visibleTiles),this.m_options.target=n.GeoCoordinates.fromObject(o.getOptionValue(this.m_options.target,z.target)),this.m_options.target.altitude=0,this.m_options.tilt=o.getOptionValue(this.m_options.tilt,z.tilt),this.m_options.heading=o.getOptionValue(this.m_options.heading,z.heading),this.m_options.zoomLevel=o.getOptionValue(this.m_options.zoomLevel,z.zoomLevel),this.lookAtImpl(this.m_options);const{width:e,height:t}=this.getCanvasClientSize();this.resize(e,t)}createVisibleTileSet(){o.assert(void 0!==this.m_tileGeometryManager),this.m_visibleTiles&&(this.m_visibleTiles.clearTileCache(),this.m_visibleTiles.disposePendingTiles());const e=void 0===this.m_enableMixedLod?this.projection.type===n.ProjectionType.Spherical:this.m_enableMixedLod;return this.m_visibleTiles=new N.VisibleTileSet(new v.FrustumIntersection(this.m_camera,this,this.m_visibleTileSetOptions.extendedFrustumCulling,this.m_tileWrappingEnabled,e,this.m_lodMinTilePixelSize),this.m_tileGeometryManager,this.m_visibleTileSetOptions,this.taskQueue),this.m_visibleTiles}movementStarted(){this.m_textElementsRenderer.movementStarted(),this.MOVEMENT_STARTED_EVENT.time=Date.now(),this.dispatchEvent(this.MOVEMENT_STARTED_EVENT)}movementFinished(){this.m_textElementsRenderer.movementFinished(),this.MOVEMENT_FINISHED_EVENT.time=Date.now(),this.dispatchEvent(this.MOVEMENT_FINISHED_EVENT),this.animating||(void 0!==this.m_movementFinishedUpdateTimerId&&clearTimeout(this.m_movementFinishedUpdateTimerId),this.m_movementFinishedUpdateTimerId=setTimeout((()=>{this.m_movementFinishedUpdateTimerId=void 0,this.update()}),0))}checkIfTilesChanged(){if(void 0!==this.m_thisFrameTilesChanged)return this.m_thisFrameTilesChanged;const e=this.m_visibleTiles.dataSourceTileList,t=[];t.length=0,e.forEach((({dataSource:e,renderedTiles:i})=>{i.forEach((i=>{t.push(e.name+"-"+i.tileKey.mortonCode())}))})),t.sort();const i=t.join("#");return i!==this.m_lastTileIds?(this.m_lastTileIds=i,this.m_thisFrameTilesChanged=!0):this.m_thisFrameTilesChanged=!1,this.m_thisFrameTilesChanged}checkCopyrightUpdates(){if(!this.checkIfTilesChanged())return;const e=this.getRenderedTilesCopyrightInfo();if(e!==this.m_copyrightInfo){if(e.length===this.m_copyrightInfo.length){let t=!0;for(let i=0;i<e.length;i++){const r=e[i],n=this.m_copyrightInfo[i];if(r.label!==n.label){t=!1;break}}if(t)return}this.m_copyrightInfo=e,this.dispatchEvent(this.COPYRIGHT_CHANGED_EVENT)}}getRenderedTilesCopyrightInfo(){let e=[];for(const t of this.m_visibleTiles.dataSourceTileList)for(const i of t.renderedTiles.values()){const t=i.copyrightInfo;void 0!==t&&0!==t.length&&(e=f.CopyrightInfo.mergeArrays(e,t))}return e}setupStats(e){new R.PerformanceStatistics(e,1e3)}setupRenderer(e){var t;this.m_scene.add(this.m_sceneRoot),this.m_overlayScene.add(this.m_overlaySceneRoot),this.shadowsEnabled=null!==(t=this.m_options.enableShadows)&&void 0!==t&&t,e.setupRenderer()}createTextRenderer(){return new M.TextElementsRenderer(new I.MapViewState(this,this.checkIfTilesChanged.bind(this)),this.m_screenProjector,this.m_poiManager,this.m_renderer,[this.imageCache,this.userImageCache],this.m_options)}async resetTextRenderer(e,t,i){await this.m_textElementsRenderer.updateFontCatalogs(e),await this.m_textElementsRenderer.updateTextStyles(t,i),this.update()}setFovOnCamera(e,t){const i=a.MathUtils.degToRad(e.fov);if("fixed"===e.type)return void u.CameraUtils.setVerticalFov(this.m_camera,i,t);let r=u.CameraUtils.getFocalLength(this.m_camera);void 0===r&&(u.CameraUtils.setVerticalFov(this.m_camera,i,t),r=u.CameraUtils.getFocalLength(this.m_camera)),u.CameraUtils.setFocalLength(this.m_camera,r,t)}getCanvasClientSize(){const{clientWidth:e,clientHeight:t}=this.canvas;if(0===e||0===t||"number"!=typeof e||"number"!=typeof t){const e=this.m_renderer.getPixelRatio();return{width:Math.round(this.canvas.width/e),height:Math.round(this.canvas.height/e)}}return{width:e,height:t}}}t.MapView=H},64525:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewAtmosphere=t.AtmosphereLightMode=void 0;const r=i(32941),n=i(30462),o=i(38338),a=i(84428),s=i(95585);var l,c,u;!function(e){e[e.Ground=1]="Ground",e[e.Sky=2]="Sky",e[e.SkyAndGround=3]="SkyAndGround"}(l||(l={})),function(e){e[e.ScatteringShader=0]="ScatteringShader",e[e.SimpleColor=1]="SimpleColor",e[e.Wireframe=2]="Wireframe"}(c||(c={})),function(e){e[e.LightOverhead=0]="LightOverhead",e[e.LightDynamic=1]="LightDynamic"}(u=t.AtmosphereLightMode||(t.AtmosphereLightMode={}));const d={clipPlanes:{near:0,far:0}};class h{constructor(e,t,i,n,o,u=l.SkyAndGround,d=c.ScatteringShader){this.m_mapAnchors=e,this.m_sceneCamera=t,this.m_projection=i,this.m_rendererCapabilities=n,this.m_updateCallback=o,this.m_atmosphereVariant=u,this.m_materialVariant=d,this.m_enabled=!0,this.m_clipPlanesEvaluator=new s.TiltViewClipPlanesEvaluator(.025*r.EarthConstants.EQUATORIAL_RADIUS,0,1,.05,1e7),this.m_lightDirection=new a.Vector3(0,1,0),this.m_atmosphereVariant&l.Sky&&this.createSkyGeometry(),this.m_atmosphereVariant&l.Ground&&this.createGroundGeometry(),this.addToMapAnchors(this.m_mapAnchors)}static isPresent(e){for(const t of e.children)if(t.name===h.SkyAtmosphereUserName||t.name===h.GroundAtmosphereUserName)return!0;return!1}get skyMesh(){return this.m_skyMesh}get groundMesh(){return this.m_groundMesh}set enabled(e){if(this.disposed)return;if(this.m_enabled===e)return;this.m_enabled=e;const t=h.isPresent(this.m_mapAnchors);e&&!t?this.addToMapAnchors(this.m_mapAnchors):!e&&t&&this.removeFromMapAnchors(this.m_mapAnchors)}get enabled(){return this.m_enabled}set lightMode(e){if(this.m_materialVariant!==c.ScatteringShader)return;const t=e===u.LightDynamic;void 0!==this.m_groundMaterial&&this.m_groundMaterial.setDynamicLighting(t),void 0!==this.m_skyMaterial&&this.m_skyMaterial.setDynamicLighting(t)}dispose(){var e,t,i,r;this.enabled&&(this.enabled=!1),null===(e=this.m_skyMaterial)||void 0===e||e.dispose(),null===(t=this.m_groundMaterial)||void 0===t||t.dispose(),null===(i=this.m_skyGeometry)||void 0===i||i.dispose(),null===(r=this.m_groundGeometry)||void 0===r||r.dispose(),this.m_skyGeometry=void 0,this.m_groundGeometry=void 0,this.m_skyMaterial=void 0,this.m_groundMaterial=void 0,this.m_skyMesh=void 0,this.m_groundMesh=void 0}reset(e){}get disposed(){return void 0===this.m_skyMesh&&void 0===this.m_groundMesh}addToMapAnchors(e){o.assert(!h.isPresent(e),"Atmosphere already added"),void 0!==this.m_skyMesh&&e.add(m(this.m_skyMesh,Number.MIN_SAFE_INTEGER)),void 0!==this.m_groundMesh&&e.add(m(this.m_groundMesh,Number.MAX_SAFE_INTEGER)),this.m_updateCallback&&this.m_updateCallback()}removeFromMapAnchors(e){if(!h.isPresent(e))return;let t=!1;void 0!==this.m_skyMesh&&(e.remove(this.m_skyMesh),t=!0),void 0!==this.m_groundMesh&&(e.remove(this.m_groundMesh),t=!0),t&&this.m_updateCallback&&this.m_updateCallback()}createSkyGeometry(){switch(this.m_projection.type){case r.ProjectionType.Spherical:this.m_skyGeometry=new a.SphereGeometry(1.025*r.EarthConstants.EQUATORIAL_RADIUS,256,256);break;default:this.m_skyGeometry=new a.PlaneGeometry(200,200)}this.m_skyGeometry.translate(0,0,0),this.m_materialVariant===c.ScatteringShader?this.m_skyMaterial=new n.SkyAtmosphereMaterial({rendererCapabilities:this.m_rendererCapabilities}):this.m_materialVariant===c.SimpleColor?this.m_skyMaterial=new a.MeshBasicMaterial({color:new a.Color(12908781),opacity:.4,transparent:!1,depthTest:!0,depthWrite:!1,side:a.BackSide,blending:a.NormalBlending,fog:!1}):this.m_skyMaterial=new a.MeshStandardMaterial({color:8388607,depthTest:!1,depthWrite:!1,normalScale:new a.Vector2(-1,-1),side:a.BackSide,wireframe:!0}),this.m_skyMesh=new a.Mesh(this.m_skyGeometry,this.m_skyMaterial),this.m_skyMesh.name=h.SkyAtmosphereUserName,this.setupSkyForRendering()}createGroundGeometry(){switch(this.m_projection.type){case r.ProjectionType.Spherical:this.m_groundGeometry=new a.SphereGeometry(1.0001*r.EarthConstants.EQUATORIAL_RADIUS,256,256);break;default:this.m_groundGeometry=new a.PlaneGeometry(200,200)}this.m_groundGeometry.translate(0,0,0),this.m_materialVariant===c.ScatteringShader?this.m_groundMaterial=new n.GroundAtmosphereMaterial({rendererCapabilities:this.m_rendererCapabilities}):this.m_materialVariant===c.SimpleColor?this.m_groundMaterial=new a.MeshBasicMaterial({color:new a.Color(50687),opacity:.4,transparent:!0,depthTest:!1,depthWrite:!1,side:a.FrontSide,blending:a.NormalBlending,fog:!1}):this.m_groundMaterial=new a.MeshStandardMaterial({color:1149338,depthTest:!0,depthWrite:!1,side:a.FrontSide,wireframe:!0}),this.m_groundMesh=new a.Mesh(this.m_groundGeometry,this.m_groundMaterial),this.m_groundMesh.name=h.GroundAtmosphereUserName,this.setupGroundForRendering()}setupSkyForRendering(){if(void 0===this.m_skyMesh)return;let e;e=this.m_materialVariant!==c.ScatteringShader?(e,t)=>{this.overrideClipPlanes(e)}:(e,t)=>{this.overrideClipPlanes(e),o.assert(t instanceof n.SkyAtmosphereMaterial);const i=this.m_skyMaterial;i.updateUniforms(i,this.m_skyMesh,e,this.m_lightDirection)},o.assert(void 0!==this.m_skyMaterial),this.m_skyMesh.onBeforeRender=(t,i,r,n,o,a)=>{e(r,o)},this.m_skyMesh.onAfterRender=(e,t,i,r,n,o)=>{this.revertClipPlanes(i)}}setupGroundForRendering(){void 0!==this.m_groundMesh&&this.m_materialVariant===c.ScatteringShader&&(o.assert(void 0!==this.m_groundMaterial),this.m_groundMesh.onBeforeRender=(e,t,i,r,a,s)=>{o.assert(a instanceof n.GroundAtmosphereMaterial);const l=this.m_groundMaterial;l.updateUniforms(l,this.m_groundMesh,i,this.m_lightDirection)})}overrideClipPlanes(e){const t=this.m_sceneCamera;d.clipPlanes.near=t.near,d.clipPlanes.far=t.far;const i=this.m_clipPlanesEvaluator.evaluateClipPlanes(this.m_sceneCamera,this.m_projection);o.assert(e instanceof a.PerspectiveCamera);const n=e;n.near=i.near,n.far=i.far+.1*r.EarthConstants.EQUATORIAL_RADIUS,n.updateProjectionMatrix()}revertClipPlanes(e){o.assert(e instanceof a.PerspectiveCamera);const t=e;t.near=d.clipPlanes.near,t.far=d.clipPlanes.far,t.updateProjectionMatrix()}}function m(e,t){const i=e;return i.renderOrder=t,i.pickable=!1,i.anchor=new a.Vector3(0,0,0),i}t.MapViewAtmosphere=h,h.SkyAtmosphereUserName="SkyAtmosphere",h.GroundAtmosphereUserName="GroundAtmosphere"},18928:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewEnvironment=t.DEFAULT_CLEAR_COLOR=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(45886),s=i(63311),l=i(40270),c=i(51771),u=n.LoggerManager.instance.create("MapViewEnvironment");t.DEFAULT_CLEAR_COLOR=16777215;const d={vector3:[new o.Vector3,new o.Vector3,new o.Vector3],frustumPoints:[new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3]};t.MapViewEnvironment=class{constructor(e,t){this.m_mapView=e,this.m_fog=new s.MapViewFog(this.m_mapView.scene),!1!==t.addBackgroundDatasource&&(this.m_backgroundDataSource=new a.BackgroundDataSource,this.m_mapView.addDataSource(this.m_backgroundDataSource)),void 0!==t.backgroundTilingScheme&&void 0!==this.m_backgroundDataSource&&this.m_backgroundDataSource.setTilingScheme(t.backgroundTilingScheme),this.updateClearColor()}get lights(){var e;return null!==(e=this.m_createdLights)&&void 0!==e?e:[]}get fog(){return this.m_fog}updateBackgroundDataSource(){this.m_backgroundDataSource&&this.m_backgroundDataSource.updateStorageLevelOffset()}clearBackgroundDataSource(){void 0!==this.m_backgroundDataSource&&this.m_mapView.clearTileCache(this.m_backgroundDataSource.name)}update(){this.m_fog.update(this.m_mapView,this.m_mapView.viewRanges.maximum),void 0!==this.m_skyBackground&&this.m_mapView.projection.type===r.ProjectionType.Planar&&this.m_skyBackground.updateCamera(this.m_mapView.camera),this.updateLights()}updateClearColor(e,i){void 0!==e?this.m_mapView.renderer.setClearColor(new o.Color(e),i):this.m_mapView.renderer.setClearColor(t.DEFAULT_CLEAR_COLOR,i)}updateSkyBackground(e,t){if(this.m_skyBackground instanceof l.SkyBackground&&void 0!==e)this.updateSkyBackgroundColors(e,t);else{if(void 0===this.m_skyBackground&&void 0!==e)return void this.addNewSkyBackground(e,t);this.m_skyBackground instanceof l.SkyBackground&&void 0===e&&this.removeSkyBackGround()}}updateLighting(e){var t;this.m_createdLights&&this.m_createdLights.forEach((e=>{this.m_mapView.scene.remove(e)})),null===(t=this.m_overlayCreatedLights)||void 0===t||t.forEach((e=>{this.m_mapView.overlayScene.remove(e),e instanceof o.DirectionalLight&&this.m_mapView.overlayScene.remove(e.target)})),void 0!==e&&(this.m_createdLights=[],this.m_overlayCreatedLights=[],e.forEach((e=>{const t=c.createLight(e);if(!t)return void u.warn(`MapView: failed to create light ${e.name} of type ${e.type}`);if(this.m_mapView.scene.add(t),t.isDirectionalLight){const e=t;this.m_mapView.scene.add(e.target)}this.m_createdLights.push(t);const i=t.clone();this.m_mapView.overlayScene.add(i),i instanceof o.DirectionalLight&&this.m_mapView.overlayScene.add(i.target.clone())})))}updateLights(){if(!this.m_mapView.shadowsEnabled||this.m_mapView.projection.type===r.ProjectionType.Spherical||void 0===this.m_createdLights||0===this.m_createdLights.length)return;const e=[{x:-1,y:-1,z:-1},{x:1,y:-1,z:-1},{x:-1,y:1,z:-1},{x:1,y:1,z:-1},{x:-1,y:-1,z:1},{x:1,y:-1,z:1},{x:-1,y:1,z:1},{x:1,y:1,z:1}].map(((e,t)=>this.m_mapView.ndcToView(e,d.frustumPoints[t])));this.m_createdLights.forEach((t=>{const i=t;if(!0===i.isDirectionalLight){const t=d.vector3[0];t.copy(i.target.position),t.sub(i.position),t.normalize();const n=d.vector3[1];this.m_mapView.projection.type===r.ProjectionType.Planar&&n.set(0,0,-1);const a=this.m_mapView.tilt,s=this.m_mapView.targetDistance*Math.cos(o.MathUtils.degToRad(a))/n.dot(t);i.target.position.copy(this.m_mapView.worldTarget).sub(this.m_mapView.camera.position),i.position.copy(this.m_mapView.worldTarget),i.position.addScaledVector(t,-s),i.position.sub(this.m_mapView.camera.position),i.updateMatrixWorld(),i.shadow.updateMatrices(i);const l=i.shadow.camera,c=e.map((e=>this.viewToLightSpace(e.clone(),l))),u=new o.Box3;c.forEach((e=>{u.expandByPoint(e)})),l.left=u.min.x,l.right=u.max.x,l.top=u.max.y,l.bottom=u.min.y,l.near=.95*-u.max.z,l.far=-u.min.z,l.updateProjectionMatrix()}}))}addNewSkyBackground(e,t){"gradient"===e.type&&void 0===e.groundColor&&(e.groundColor=n.getOptionValue(t,"#000000")),this.m_skyBackground=new l.SkyBackground(e,this.m_mapView.projection.type,this.m_mapView.camera),this.m_mapView.scene.background=this.m_skyBackground.texture}removeSkyBackGround(){this.m_mapView.scene.background=null,void 0!==this.m_skyBackground&&(this.m_skyBackground.dispose(),this.m_skyBackground=void 0)}updateSkyBackgroundColors(e,t){var i;"gradient"===e.type&&void 0===e.groundColor&&(e.groundColor=n.getOptionValue(t,"#000000")),void 0!==this.m_skyBackground&&(this.m_skyBackground.updateTexture(e,this.m_mapView.projection.type),this.m_mapView.scene.background=null===(i=this.m_skyBackground)||void 0===i?void 0:i.texture)}viewToLightSpace(e,t){return e.applyMatrix4(t.matrixWorldInverse)}}},63311:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewFog=void 0;const r=i(30462),n=i(87655),o=i(38338),a=i(84428);t.MapViewFog=class{constructor(e){this.m_scene=e,this.m_enabled=!0,this.m_fog=new a.Fog(0),this.m_fogIsDefined=!1}set enabled(e){this.m_enabled=e,e&&this.m_fogIsDefined&&null===this.m_scene.fog?this.add():e||null===this.m_scene.fog||this.remove()}get enabled(){return this.m_enabled}reset(e){this.m_cachedFog=e,void 0!==e&&void 0!==e.color&&void 0!==e.startRatio?(this.m_fogIsDefined=!0,this.m_fog.color.set(e.color),this.m_enabled&&null===this.m_scene.fog&&this.add()):(this.m_fogIsDefined=!1,null!==this.m_scene.fog&&this.remove())}update(e,t){if(null!==this.m_scene.fog&&void 0!==this.m_cachedFog&&this.m_cachedFog&&void 0!==this.m_cachedFog.startRatio&&(void 0!==e.camera.far||void 0!==t)){const i=void 0!==t?t:e.camera.far,r=1,n=0,s=this.m_cachedFog.startRatio,l=1;o.assert(s<=l);const c=Math.abs(Math.cos(e.tilt)),u=o.MathUtils.smoothStep(r,n,c);this.m_fog.near=a.MathUtils.lerp(i*s,i,1-u),this.m_fog.far=a.MathUtils.lerp(i*l,i,u),this.m_fog.near=Math.min(this.m_fog.near,e.camera.far),this.m_fog.far=Math.min(this.m_fog.far,e.camera.far)}}add(){this.m_scene.fog=this.m_fog,this.setFogInRawShaderMaterials(!0)}remove(){this.m_scene.fog=null,this.setFogInRawShaderMaterials(!1)}setFogInRawShaderMaterials(e){this.m_scene.traverse((t=>{if(t instanceof a.Mesh){const i=t.material;i instanceof a.Material&&!(i instanceof r.HighPrecisionLineMaterial)&&i.fog!==e&&(i.fog=e,i instanceof n.RawShaderMaterial&&i.invalidateFog())}}))}}},71540:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Squares=t.Circles=t.MapViewPoints=void 0;const r=i(84428);class n extends r.Points{constructor(){super(...arguments),this.enableRayTesting=!0}raycast(e,t){if(!this.enableRayTesting)return;const i=this.geometry,n=this.matrixWorld,a=o(e.ray.origin.clone().add(e.ray.direction).project(e.camera),e),s=(i,r)=>{const s=function(e,t,i){const r=e.clone().applyMatrix4(t),n=r.distanceTo(i.ray.origin),a=r.project(i.camera),s=a.x<1&&a.x>-1&&a.y<1&&a.y>-1;return s?{absoluteScreenPosition:o(a,i),pointIsOnScreen:s,distance:n}:{pointIsOnScreen:s}}(i,n,e);s.pointIsOnScreen&&this.testPoint(i,s.absoluteScreenPosition,a,r,s.distance,t)},l=new r.Vector3,c=i.index,u=i.attributes.position.array;if(null!==c){const e=c.array;for(let t=0,i=e.length;t<i;t++)s(l.fromArray(u,3*e[t]),t)}else for(let e=0,t=u.length/3;e<t;e++)s(l.fromArray(u,3*e),e)}}function o(e,t){return new r.Vector2(e.x+1,1-e.y).divideScalar(2).multiply(t.canvasSize).ceil()}t.MapViewPoints=n,t.Circles=class extends n{testPoint(e,t,i,r,n,o){const a=t.x-i.x,s=t.y-i.y;Math.sqrt(a*a+s*s)<=this.material.size/2&&o.push({point:e,distance:n,index:r,object:this})}},t.Squares=class extends n{testPoint(e,t,i,r,n,o){const a=t.x-i.x,s=t.y-i.y,l=this.material.size/2;Math.abs(a)<=l&&Math.abs(s)<=l&&o.push({point:e,distance:n,index:r,object:this})}}},14057:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewTaskScheduler=void 0;const r=i(38338),n=i(84428),o=i(17624),a=i(61257),s={type:"update"};class l extends n.EventDispatcher{constructor(e=60){super(),this.m_maxFps=e,this.m_throttlingEnabled=!1,this.m_taskQueue=new r.TaskQueue({groups:[o.TileTaskGroups.FETCH_AND_DECODE,o.TileTaskGroups.CREATE],prioSortFn:(e,t)=>e.getPriority()-t.getPriority()}),this.maxFps=e}set maxFps(e){this.m_maxFps=e<=0?60:e}get maxFps(){return this.m_maxFps}get taskQueue(){return this.m_taskQueue}get throttlingEnabled(){return!0===this.m_throttlingEnabled}set throttlingEnabled(e){this.m_throttlingEnabled=e}requestUpdate(){this.dispatchEvent(s)}processPending(e){const t=a.PerformanceStatistics.instance,i=t.enabled?t.currentFrame:void 0;let n;t.enabled&&(n=r.PerformanceTimer.now()),this.m_taskQueue.update();let s=this.taskQueue.numItemsLeft();if(null==i||i.setValue("TaskScheduler.numPendingTasks",s),this.throttlingEnabled){let t=this.spaceInFrame(e);t=t>2?t-2:t,null==i||i.setValue("TaskScheduler.estimatedAvailableTime",t);let r=0;for(;t>0&&s>0;){function e(e){var i,n;return t-=null!==(n=null===(i=e.estimatedProcessTime)||void 0===i?void 0:i.call(e))&&void 0!==n?n:2,t>0||1===r}r++,[o.TileTaskGroups.CREATE,o.TileTaskGroups.FETCH_AND_DECODE].forEach((t=>{this.m_taskQueue.numItemsLeft(t)&&this.m_taskQueue.processNext(t,e)})),s=this.m_taskQueue.numItemsLeft()}s=this.m_taskQueue.numItemsLeft(),s>0&&(null==i||i.setValue("TaskScheduler.pendingTasksNotYetProcessed",s),this.requestUpdate())}else this.m_taskQueue.processNext(o.TileTaskGroups.CREATE,void 0,this.m_taskQueue.numItemsLeft(o.TileTaskGroups.CREATE)),this.m_taskQueue.processNext(o.TileTaskGroups.FETCH_AND_DECODE,void 0,this.m_taskQueue.numItemsLeft(o.TileTaskGroups.FETCH_AND_DECODE));t.enabled&&(null==i||i.setValue("TaskScheduler.pendingTasksTime",r.PerformanceTimer.now()-n))}clearQueuedTasks(){this.m_taskQueue.clear()}spaceInFrame(e){const t=(performance||Date).now()-e;return Math.max(1e3/this.m_maxFps-t,0)}}t.MapViewTaskScheduler=l},43495:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewThemeManager=void 0;const r=i(38338),n=i(50921),o=i(37581),a=r.LoggerManager.instance.create("MapViewThemeManager");t.MapViewThemeManager=class{constructor(e,t){this.m_mapView=e,this.m_uriResolver=t,this.m_abortControllers=[],this.m_theme={},this.m_imageCache=new n.MapViewImageCache}async setTheme(e){return this.isUpdating()&&(a.warn("Formerly set Theme is still updating, update will be canceled"),this.cancelThemeUpdate()),this.m_updatePromise=this.loadTheme(e).then((async e=>{await this.updateTheme(e)})),await this.m_updatePromise,this.m_updatePromise=void 0,this.m_theme}async getTheme(){return this.isUpdating()&&await this.m_updatePromise,this.m_theme}isUpdating(){return void 0!==this.m_updatePromise}get theme(){return this.isUpdating()?{}:this.m_theme}async loadTheme(e){let t={};if("string"!=typeof e&&o.ThemeLoader.isThemeLoaded(e))t=e;else try{t=await o.ThemeLoader.load(e,{uriResolver:this.m_uriResolver,signal:this.createAbortController().signal})}catch(e){"AbortError"===e.name?a.warn(`theme loading was aborted due to: ${e}`):a.error(`failed to load theme: ${e}`)}return t}async updateTheme(e){var t,i;const r=this.m_mapView.sceneEnvironment;this.m_theme.fog=e.fog,this.m_theme.sky=e.sky,r.updateSkyBackground(e.sky),r.fog.reset(e.fog),this.m_theme.lights=e.lights,r.updateLighting(e.lights),this.m_theme.clearColor=e.clearColor,this.m_theme.clearAlpha=e.clearAlpha,r.updateClearColor(e.clearColor,e.clearAlpha),this.m_theme.images=e.images,this.m_theme.imageTextures=e.imageTextures,await this.updateImages(e.images,e.imageTextures),this.m_theme.poiTables=e.poiTables,await this.loadPoiTables(e.poiTables),this.m_theme.textStyles=e.textStyles,this.m_theme.defaultTextStyle=e.defaultTextStyle,this.m_theme.fontCatalogs=e.fontCatalogs,await this.m_mapView.resetTextRenderer(e.fontCatalogs,e.textStyles,e.defaultTextStyle),Array.isArray(e.priorities)&&(this.m_theme.priorities=e.priorities),this.m_mapView.mapAnchors.setPriorities(null!==(t=e.priorities)&&void 0!==t?t:[]),Array.isArray(e.labelPriorities)&&(this.m_theme.labelPriorities=e.labelPriorities),void 0===this.m_theme.styles&&(this.m_theme.styles={}),this.m_theme.styles=null!==(i=e.styles)&&void 0!==i?i:{},this.m_theme.definitions=e.definitions,r.clearBackgroundDataSource();for(const e of this.m_mapView.dataSources)await e.setTheme(this.m_theme)}updateCache(){this.updateImages(this.m_theme.images,this.m_theme.imageTextures),this.m_mapView.sceneEnvironment.updateLighting(this.m_theme.lights),this.m_mapView.sceneEnvironment.updateSkyBackground(this.m_theme.sky,this.m_theme.clearColor)}get imageCache(){return this.m_imageCache}dispose(){this.m_imageCache.clear()}async loadPoiTables(e){this.m_mapView.poiTableManager.clear(),await this.m_mapView.poiTableManager.loadPoiTables(e)}cancelThemeUpdate(){for(var e=0;e<this.m_abortControllers.length;e++)this.m_abortControllers[e].abort();this.m_abortControllers=[],this.m_imageCache.clear(),this.m_mapView.poiManager.clear(),this.m_mapView.poiTableManager.clear()}createAbortController(){return this.m_abortControllers.push(new AbortController),this.m_abortControllers[this.m_abortControllers.length-1]}async updateImages(e,t){if(this.m_imageCache.clear(),this.m_mapView.poiManager.clear(),void 0!==e)for(const t of Object.keys(e)){const i=e[t];this.m_imageCache.addImage(t,i.url,!0===i.preload),"string"==typeof i.atlas&&await this.m_mapView.poiManager.addTextureAtlas(t,i.atlas,this.createAbortController().signal)}void 0!==t&&t.forEach((e=>{this.m_mapView.poiManager.addImageTexture(e)}))}}},468:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathBlockingElement=void 0;const r=i(84428);t.PathBlockingElement=class{constructor(e){this.points=e,this.screenSpaceLines=new Array(e.length>=2?e.length-1:0);for(let e=0;e<this.screenSpaceLines.length;e++)this.screenSpaceLines[e]=new r.Line3(new r.Vector3,new r.Vector3)}}},67180:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickHandler=t.PickObjectType=void 0;const r=i(96500),n=i(32941),o=i(84428),a=i(71540),s=i(98633),l=i(31489),c=i(83829);var u;!function(e){e[e.Unspecified=0]="Unspecified",e[e.Point=1]="Point",e[e.Line=2]="Line",e[e.Area=3]="Area",e[e.Text=4]="Text",e[e.Icon=5]="Icon",e[e.Object3D=6]="Object3D"}(u=t.PickObjectType||(t.PickObjectType={}));const d=new o.Vector3,h=new n.OrientedBox3;function m(e,t,i,r,n){for(const o of e.dependencies){const a=o.mortonCode();if(r.has(a))continue;r.add(a);const s=n.visibleTileSet.getCachedTile(e.dataSource,o,e.offset,n.frameNumber);void 0!==s&&i.intersectObjects(s.objects,!0,t)}}t.PickHandler=class{constructor(e,t,i=!1){this.mapView=e,this.camera=t,this.enablePickTechnique=i,this.m_pickingRaycaster=new s.PickingRaycaster(e.renderer.getSize(new o.Vector2))}intersectMapObjects(e,t,i){const r=this.mapView.getNormalizedScreenCoordinates(e,t),n=this.setupRaycaster(e,t),a=new l.PickListener(i);if(void 0!==this.mapView.textElementsRenderer){const{clientWidth:e,clientHeight:t}=this.mapView.canvas,i=r.x*e*.5,n=r.y*t*.5,s=new o.Vector2(i,n);this.mapView.textElementsRenderer.pickTextElements(s,a)}const s=[],c=this.getIntersectedTiles(n),u=new Set;for(const{tile:e,distance:t}of c){if(a.done&&a.furthestResult.distance<t)break;s.length=0,n.intersectObjects(e.objects,!0,s),m(e,s,n,u,this.mapView);for(const t of s)a.addResult(this.createResult(t,e))}s.length=0;for(const e of this.mapView.mapAnchors.children){n.intersectObject(e,!0,s);for(const e of s)a.addResult(this.createResult(e))}return a.finish(),a.results}raycasterFromScreenPoint(e,t){return this.m_pickingRaycaster.setFromCamera(this.mapView.getNormalizedScreenCoordinates(e,t),this.camera),this.mapView.renderer.getSize(this.m_pickingRaycaster.canvasSize),this.m_pickingRaycaster}createResult(e,t){var i,n,o;const a={type:u.Unspecified,point:e.point,distance:e.distance,dataSourceName:null===(i=e.object.userData)||void 0===i?void 0:i.dataSource,dataSourceOrder:null===(n=null==t?void 0:t.dataSource)||void 0===n?void 0:n.dataSourceOrder,intersection:e,tileKey:null==t?void 0:t.tileKey};if(void 0===e.object.userData||void 0===e.object.userData.feature)return a;this.enablePickTechnique&&(a.technique=e.object.userData.technique),a.renderOrder=null===(o=e.object)||void 0===o?void 0:o.renderOrder;const s=e.object.userData.feature;if(this.addObjInfo(s,e,a),a.userData){const e=r.getFeatureId(a.userData);a.featureId=0===e?void 0:e}let l;switch(s.geometryType){case r.GeometryType.Point:case r.GeometryType.Text:l=u.Point;break;case r.GeometryType.Line:case r.GeometryType.ExtrudedLine:case r.GeometryType.SolidLine:case r.GeometryType.TextPath:l=u.Line;break;case r.GeometryType.Polygon:case r.GeometryType.ExtrudedPolygon:l=u.Area;break;case r.GeometryType.Object3D:l=u.Object3D;break;default:l=u.Unspecified}return a.type=l,a}getIntersectedTiles(e){const t=new Array;return this.mapView.visibleTileSet.dataSourceTileList.forEach((i=>{i.dataSource.enablePicking&&i.renderedTiles.forEach((i=>{h.copy(i.boundingBox),h.position.sub(this.mapView.worldCenter);const r=i.computeWorldOffsetX();h.position.x+=r;const n=h.intersectsRay(e.ray);void 0!==n&&t.push({tile:i,distance:n})}))})),t.sort(((e,t)=>e.distance-t.distance)),t}addObjInfo(e,t,i){if(void 0===e.objInfos)return;if(i.intersection.object instanceof a.MapViewPoints)return void(i.userData=e.objInfos[t.index]);if(void 0===e.starts||0===e.starts.length||"number"!=typeof t.faceIndex&&void 0===t.index)return void(1===e.objInfos.length&&(i.userData=e.objInfos[0]));if(1===e.starts.length)return void(i.userData=e.objInfos[0]);const r="number"==typeof t.faceIndex?3*t.faceIndex:t.index;let n=0;for(const t of e.starts){if(t>r)break;n++}i.userData=e.objInfos[n-1]}setupRaycaster(e,t){const i=this.mapView.camera,r=this.raycasterFromScreenPoint(e,t),n=this.mapView.getWorldPositionAt(e,t,!0),o=i.position.distanceTo(n)/this.mapView.camera.getWorldDirection(d).dot(r.ray.direction);return r.params.Line.threshold=c.MapViewUtils.calculateWorldSizeByFocalLength(this.mapView.focalLength,o,1),r}}},31489:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickListener=void 0;const r=i(38338);function n(e,t){var i,r;const n=null!==(i=e.dataSourceOrder)&&void 0!==i?i:0,o=null!==(r=t.dataSourceOrder)&&void 0!==r?r:0;if(n!==o)return o-n;const a=e.distance-t.distance,s=void 0!==e.renderOrder&&void 0!==t.renderOrder;return Math.abs(a)>1e-4||!s?a:t.renderOrder-e.renderOrder}t.PickListener=class{constructor(e){this.m_parameters=e,this.m_results=[],this.m_sorted=!0,this.m_finished=!0}addResult(e){const t=this.m_results.findIndex((t=>{var i,r,n,o;const a=t.type===e.type,s=null===(r=null===(i=e.intersection)||void 0===i?void 0:i.object.userData)||void 0===r?void 0:r.dataSource,l=s&&(null===(o=null===(n=t.intersection)||void 0===n?void 0:n.object.userData)||void 0===o?void 0:o.dataSource)===s,c=void 0!==e.featureId&&t.featureId===e.featureId,u=void 0===e.featureId&&void 0===t.featureId,d=e.userData&&t.userData===e.userData;return a&&l&&(c||u&&d)}));if(t<0)return this.m_sorted=!1,this.m_finished=!1,void this.m_results.push(e);const i=this.m_results[t];n(e,i)<0&&(this.m_results[t]=e,this.m_sorted=!1,this.m_finished=!1)}get done(){return!!this.maxResults&&this.m_results.length>=this.maxResults}finish(){this.sortResults(),this.maxResults&&this.m_results.length>this.maxResults&&(this.m_results.length=this.maxResults),this.m_finished=!0}get results(){return r.assert(this.m_finished,"finish() was not called before getting the results"),this.m_results}get closestResult(){return this.sortResults(),this.m_results.length>0?this.m_results[0]:void 0}get furthestResult(){return this.sortResults(),this.m_results.length>0?this.m_results[this.m_results.length-1]:void 0}get maxResults(){var e,t;const i=null!==(t=null===(e=this.m_parameters)||void 0===e?void 0:e.maxResultCount)&&void 0!==t?t:0;return i>0?i:void 0}sortResults(){if(this.m_sorted)return;const e=[],t=[];this.m_results.sort(n).forEach((i=>(0===i.distance?e:t).push(i))),this.m_results=e.concat(t),this.m_sorted=!0}}},98633:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickingRaycaster=void 0;const r=i(84428),n=i(38125);function o(e,t,i,r){if(e.layers.test(t.layers)&&e.visible){const r=n.MapObjectAdapter.get(e);r&&!r.isPickable()||e.raycast(t,i)}if(!0===r)for(const r of e.children)o(r,t,i,!0)}class a extends r.Raycaster{constructor(e){super(),this.canvasSize=e}intersectObject(e,t,i){const r=null!=i?i:[];return o(e,this,r,t),r}intersectObjects(e,t,i){const r=null!=i?i:[];for(const i of e)o(i,this,r,t);return r}}t.PickingRaycaster=a},28496:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneViewBounds=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(83829);t.PlaneViewBounds=class{constructor(e,t,i){this.camera=e,this.projection=t,this.m_options=i,this.m_groundPlaneNormal=new o.Vector3(0,0,1),this.m_groundPlane=new o.Plane(this.m_groundPlaneNormal.clone()),n.assert(t.type===r.ProjectionType.Planar)}generate(){const e=[];if(this.addCanvasCornerIntersection(e),4===e.length)return this.createPolygon(e);this.addHorizonIntersection(e);const t=(new o.Frustum).setFromProjectionMatrix((new o.Matrix4).multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse)),i=this.getWorldConers(this.projection);if(this.m_options.tileWrappingEnabled||[i.ne,i.nw,i.se,i.sw].forEach((i=>{this.addPointInFrustum(i,t,e)})),this.m_options.tileWrappingEnabled){const r=(new o.Vector3).subVectors(i.sw,i.se).normalize(),n=(new o.Vector3).subVectors(i.se,i.sw).normalize();[new o.Ray(i.se,r),new o.Ray(i.se,n),new o.Ray(i.ne,r),new o.Ray(i.ne,n)].forEach((i=>{this.addFrustumIntersection(i,t,e)}))}else[new o.Line3(i.sw,i.se),new o.Line3(i.ne,i.nw),new o.Line3(i.se,i.ne),new o.Line3(i.nw,i.sw)].forEach((i=>{this.addFrustumIntersection(i,t,e)}));return this.createPolygon(e)}createPolygon(e){if(e.length>2)return new r.GeoPolygon(e,!0)}getWorldConers(e){const t=e.worldExtent(0,0);return{sw:t.min,se:new o.Vector3(t.max.x,t.min.y,0),nw:new o.Vector3(t.min.x,t.max.y,0),ne:t.max}}addNDCRayIntersection(e,t){e.forEach((e=>{const i=a.MapViewUtils.rayCastWorldCoordinates({camera:this.camera,projection:this.projection},e[0],e[1]);i&&this.validateAndAddToGeoPolygon(i,t)}))}addHorizonIntersection(e){const t=this.getVerticalHorizonPositionInNDC();t&&this.addNDCRayIntersection([[-1,t],[1,t]],e)}addCanvasCornerIntersection(e){this.addNDCRayIntersection([[-1,-1],[1,-1],[1,1],[-1,1]],e)}validateAndAddToGeoPolygon(e,t){this.isInVisibleMap(e)&&t.push(this.projection.unprojectPoint(e))}isInVisibleMap(e){return!(e.y<0||e.y>r.EarthConstants.EQUATORIAL_CIRCUMFERENCE||!this.m_options.tileWrappingEnabled&&(e.x<0||e.x>r.EarthConstants.EQUATORIAL_CIRCUMFERENCE))}addPointInFrustum(e,t,i){if(t.containsPoint(e)){const t=this.projection.unprojectPoint(e);t.altitude=0,i.push(t)}}addFrustumIntersection(e,t,i){t.planes.forEach((t=>{let r=null;const n=new o.Vector3;if(e instanceof o.Ray&&e.intersectsPlane(t)?r=e.intersectPlane(t,n):e instanceof o.Line3&&t.intersectsLine(e)&&(r=t.intersectLine(e,n)),r&&a.MapViewUtils.closeToFrustum(r,this.camera)){const e=this.projection.unprojectPoint(r);e.altitude=0,i.push(e)}}))}getVerticalHorizonPositionInNDC(){const e=new o.Vector3(-1,-1,1).unproject(this.camera).add(new o.Vector3(1,-1,1).unproject(this.camera)).multiplyScalar(.5),t=new o.Vector3(-1,1,1).unproject(this.camera).add(new o.Vector3(1,1,1).unproject(this.camera)).multiplyScalar(.5),i=new o.Line3(e,t),r=new o.Vector3;if(this.m_groundPlane.intersectLine(i,r))return r.project(this.camera).y}}},16875:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PolarTileDataSource=void 0;const r=i(96500),n=i(17550),o=i(32941),a=i(84428),s=i(86140),l=i(37337),c=i(38125),u=i(37581),d=i(84070);class h extends s.DataSource{constructor({name:e="polar",styleSetName:t="polar",minDataLevel:i,maxDataLevel:r,minDisplayLevel:n,maxDisplayLevel:s,storageLevelOffset:l=-2,geometryLevelOffset:c=1,debugTiles:u=!1}){super({name:e,styleSetName:t,minDataLevel:i,maxDataLevel:r,minDisplayLevel:n,maxDisplayLevel:s,storageLevelOffset:l}),this.m_tilingScheme=o.polarTilingScheme,this.m_maxLatitude=a.MathUtils.radToDeg(o.MercatorConstants.MAXIMUM_LATITUDE),this.m_geometryLevelOffset=c,this.m_debugTiles=u,this.cacheable=!1,this.enablePicking=!1}dispose(){this.m_northPoleEntry&&(this.m_northPoleEntry.material.dispose(),delete this.m_northPoleEntry),this.m_southPoleEntry&&(this.m_southPoleEntry.material.dispose(),delete this.m_southPoleEntry),this.m_styleSetEvaluator&&delete this.m_styleSetEvaluator}createTechiqueEntry(e){if(!this.m_styleSetEvaluator)return;const t=new n.MapEnv({$geometryType:"polygon",$layer:"earth",kind:e}),i=this.m_styleSetEvaluator.getMatchingTechniques(t);if(0===i.length)return;const r=i[0],o=l.createMaterial(this.mapView.renderer.capabilities,{technique:r,env:this.mapView.env});return o?{material:o,technique:r}:void 0}async setTheme(e){let t;e=await u.ThemeLoader.load(e),void 0!==this.styleSetName&&void 0!==e.styles&&(t=e.styles[this.styleSetName]),this.m_styleSetEvaluator=new n.StyleSetEvaluator({styleSet:null!=t?t:[],definitions:e.definitions,priorities:e.priorities,labelPriorities:e.labelPriorities}),this.m_northPoleEntry=this.createTechiqueEntry("north_pole"),this.m_southPoleEntry=this.createTechiqueEntry("south_pole"),this.mapView.markTilesDirty(this)}canGetTile(e,t){if(e!==t.level||t.level<1)return!1;const{north:i,south:r}=this.m_tilingScheme.getGeoBox(t);return i>this.m_maxLatitude||r<-this.m_maxLatitude}shouldSubdivide(e,t){if(e<=t.level)return!1;const{north:i,south:r}=this.m_tilingScheme.getGeoBox(t);return i>this.m_maxLatitude||r<-this.m_maxLatitude}getTilingScheme(){return this.m_tilingScheme}getTile(e){const t=new d.Tile(this,e);return this.createTileGeometry(t),t}get geometryLevelOffset(){return this.m_geometryLevelOffset}set geometryLevelOffset(e){this.m_geometryLevelOffset=e}intersectEdge(e,t,i){const r=t.latitude,n=i.latitude;let a=t.longitude,s=i.longitude;90===Math.abs(r)&&(a=s),90===Math.abs(n)&&(s=a);const l=s-a,c=(e-r)/(n-r);return new o.GeoCoordinates(e,a+l*c,0)}createTileGeometry(e){const{north:t,south:i}=e.geoBox,n=t>0&&i>=0,s=n?this.m_northPoleEntry:this.m_southPoleEntry;if(void 0===s)return void e.forceHasGeometry(!0);const l=this.m_tilingScheme.projection,u=this.projection,d=this.m_maxLatitude,h=n?d:-d,m=this.m_tilingScheme.boundingBoxGenerator.getWorldBox(e.tileKey),p=l.unprojectPoint(new a.Vector3(m.min.x,m.min.y,0)),f=l.unprojectPoint(new a.Vector3(m.max.x,m.min.y,0)),g=l.unprojectPoint(new a.Vector3(m.max.x,m.max.y,0)),y=l.unprojectPoint(new a.Vector3(m.min.x,m.max.y,0));let v,_=!1;if(1===e.tileKey.level){const e=0===m.min.x,t=e?m.max.x:m.min.x,i=(m.max.y+m.min.y)/2,r=l.unprojectPoint(new a.Vector3(t,i,0)),o=e?p:f;v=n?e?[r,g,o,f]:[r,p,o,y]:e?[r,f,o,g]:[r,y,o,p],_=!0}else{v=n?[p,f,g,y]:[p,y,g,f];const e=v.map((e=>e.latitude)),t=Math.max(...e),i=Math.min(...e);if(n?t<h:i>h)return;if(_=n?i<h:t>h,_){const r=e.indexOf(n?t:i);if(0!==r)for(let e=0;e<r;e++)v.push(v.shift())}}if(_){const t=(m.min.x+m.max.x)/2,i=(m.min.y+m.max.y)/2,r=l.unprojectPoint(new a.Vector3(t,i,0));o.TransverseMercatorUtils.alignLongitude(v,r);const n=v[0],s=v[1],c=v[2],u=v[3],p=Math.abs(s.latitude)>=d,f=Math.abs(u.latitude)>=d,g=p?this.intersectEdge(h,s,c):this.intersectEdge(h,n,s),y=f?this.intersectEdge(h,u,c):this.intersectEdge(h,n,u);v.splice(p?2:1,4,g);const _=e.tileKey.level-this.storageLevelOffset+this.m_geometryLevelOffset,b=360/(1<<Math.max(0,_)),S=Math.floor((g.longitude+180)/b),T=Math.ceil((y.longitude+180)/b);for(let e=S+1;e<T;e++)v.push(new o.GeoCoordinates(h,e*b-180,0));v.push(y),f&&v.push(u)}const b=new a.BufferGeometry,S=v.map((t=>{const i=u.projectPoint(t,new a.Vector3);return i.sub(e.center),i}));b.setFromPoints(S);const T=[];for(let e=1;e<S.length-1;e++)n?T.push(0,e,e+1):T.push(0,e+1,e);b.setIndex(T);const E=new a.Mesh(b,s.material);if(E.userData={dataSource:this.name,tileKey:e.tileKey},this.m_debugTiles){const t=Math.round(16777215*Math.abs(Math.sin(11*e.tileKey.mortonCode())));E.material=new a.MeshBasicMaterial({color:t,transparent:!0,opacity:.5}),e.objects.push(new a.Mesh(b,new a.MeshBasicMaterial({color:t,wireframe:!0})))}c.MapObjectAdapter.create(E,{dataSource:this,technique:s.technique,kind:[n?r.StandardGeometryKind.Water:r.StandardGeometryKind.Background]}),e.objects.push(E)}}t.PolarTileDataSource=h},9660:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenCollisionsDebug=t.ScreenCollisions=t.isLineWithBound=t.DetailedCollisionBox=t.CollisionBox=void 0;const r=i(38338),n=i(84428),o=i(61712),a=i(82582),s=r.LoggerManager.instance.create("ScreenCollissions");class l extends r.Math2D.Box{constructor(e){super(),void 0!==e&&this.copy(e)}copy(e){return e instanceof r.Math2D.Box?this.set(e.x,e.y,e.w,e.h):e instanceof n.Box2?this.set(e.min.x,e.min.y,e.max.x-e.min.x,e.max.y-e.min.y):this.set(e.minX,e.minY,e.maxX-e.minX,e.maxY-e.minY),this}get minX(){return this.x}set minX(e){this.x=e}get maxX(){return this.x+this.w}set maxX(e){this.w=e-this.x}get minY(){return this.y}set minY(e){this.y=e}get maxY(){return this.y+this.h}set maxY(e){this.h=e-this.y}}t.CollisionBox=l;class c extends l{constructor(e,t){super(e),this.detailBoxes=t}}function u(e){return void 0!==e.line}t.DetailedCollisionBox=c,t.isLineWithBound=u;const d=new l;class h{constructor(){this.screenBounds=new r.Math2D.Box,this.rtree=new a}reset(){this.rtree.clear()}update(e,t){this.screenBounds.set(e/-2,t/-2,e,t),this.reset()}allocate(e){const t=e instanceof l?e:new l(e);this.rtree.insert(t)}allocateIBoxes(e){this.rtree.load(e)}search(e){return this.rtree.search(e)}isAllocated(e){const t=e instanceof l?e:d.copy(e),i=this.search(t);return this.intersectsDetails(t,i)}isVisible(e){return this.screenBounds.intersects(e)}isFullyVisible(e){return this.screenBounds.containsBox(e)}intersectsDetails(e,t){for(const i of t)if(i instanceof c){for(const t of i.detailBoxes)if(t.intersects(e))return!0}else{if(!u(i))return!0;{const t=i;if(this.intersectsLine(e,t))return!0}}return!1}intersectsLine(e,t){const i=t.line,r=i.end.x-i.start.x;let n,o,a,s;if(0!==r){const t=i.end.y-i.start.y,l=t,c=-r,u=i.start.y-t/r*i.start.x;n=Math.sign(e.minX*l+(e.minY-u)*c),o=Math.sign(e.maxX*l+(e.minY-u)*c),a=Math.sign(e.minX*l+(e.maxY-u)*c),s=Math.sign(e.maxX*l+(e.maxY-u)*c)}else n=Math.sign(e.minX-i.start.x),o=Math.sign(e.maxX-i.start.x),a=Math.sign(e.minX-i.start.x),s=Math.sign(e.maxX-i.start.x);return n!==o||n!==a||n!==s}}t.ScreenCollisions=h,t.ScreenCollisionsDebug=class extends h{constructor(e){super(),this.m_renderContext=null,this.m_renderingEnabled=!1,this.m_numAllocations=0,this.m_numSuccessfulTests=0,this.m_numFailedTests=0,this.m_numSuccessfulVisibilityTests=0,this.m_numFailedVisibilityTests=0,null!=e&&(this.m_renderContext=e.getContext("2d"))}reset(){super.reset(),this.m_numAllocations=0,this.m_numSuccessfulTests=0,this.m_numFailedTests=0,this.m_numSuccessfulVisibilityTests=0,this.m_numFailedVisibilityTests=0}update(e,t){this.m_renderingEnabled&&s.log(`Allocations: ${this.m_numAllocations} Successful Tests: ${this.m_numSuccessfulTests} Failed Tests: ${this.m_numFailedTests}  Successful Visibility Tests: ${this.m_numSuccessfulVisibilityTests}  Failed Visibility Tests: ${this.m_numFailedVisibilityTests} `),super.update(e,t),null!==this.m_renderContext&&(this.m_renderContext.canvas.width=e,this.m_renderContext.canvas.height=t),this.m_renderingEnabled=o.debugContext.getValue("DEBUG_SCREEN_COLLISIONS")}allocate(e){super.allocate(e),this.m_numAllocations++,this.m_renderingEnabled&&null!==this.m_renderContext&&(this.m_renderContext.strokeStyle="#6666ff",this.m_renderContext.strokeRect(e.x-this.screenBounds.x,this.screenBounds.y+this.screenBounds.h-e.y,e.w,-e.h))}allocateIBoxes(e){for(const t of e)this.m_numAllocations++,this.m_renderingEnabled&&null!==this.m_renderContext&&(this.m_renderContext.strokeStyle="#aa2222",this.m_renderContext.strokeRect(t.minX-this.screenBounds.x,this.screenBounds.y+this.screenBounds.h-t.minY,t.maxX-t.minX,-(t.maxY-t.minY)));super.allocateIBoxes(e)}intersectsDetails(e,t){const i=super.intersectsDetails(e,t);if(this.m_renderingEnabled&&null!==this.m_renderContext){const t=i?2:1;this.m_renderContext.strokeStyle=i?"#FF0000":"#00ff00",this.m_renderContext.strokeRect(e.x-this.screenBounds.x-t,this.screenBounds.y+this.screenBounds.h-e.y+t,e.w+2*t,-e.h-2*t)}return i?this.m_numFailedTests++:this.m_numSuccessfulTests++,i}isVisible(e){const t=super.isVisible(e);return t?this.m_numSuccessfulVisibilityTests++:this.m_numFailedVisibilityTests++,t}}},71043:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenProjector=void 0;const r=i(84428);function n(e){return e.z>-1&&e.z<1}class o{constructor(e){this.m_camera=e,this.m_width=0,this.m_height=0}get width(){return this.m_width}get height(){return this.m_height}project(e,t=new r.Vector2){const i=this.projectVector(e,o.tempV3);return this.ndcToScreen(i,t)}projectToScreen(e,t=new r.Vector2){const i=this.projectVector(e,o.tempV3);if(n(i))return this.ndcToScreen(i,t)}projectAreaToScreen(e,t,i,a=new r.Vector2){t*=2,i*=2;const s=this.projectVector(e,o.tempV3);if(n(s)&&s.x+t>=-1&&s.x-t<=1&&s.y+i>=-1&&s.y-i<=1)return this.ndcToScreen(s,a)}project3(e,t=new r.Vector3){const i=this.projectVector(e,o.tempV3);if(i.z>-1&&i.z<1)return t.set(i.x*this.m_width/2,i.y*this.m_height/2,i.z),t}projectVector(e,t){return t.set(e.x,e.y,e.z).project(this.m_camera),t}onScreen(e){return(t=this.projectVector(e,o.tempV3)).z>-1&&t.z<1&&t.x>=-1&&t.x<=1&&t.y>=-1&&t.y<=1;var t}update(e,t,i){this.m_camera=e,this.m_width=t,this.m_height=i}ndcToScreen(e,t){return t.set(e.x*this.m_width/2,e.y*this.m_height/2)}}t.ScreenProjector=o,o.tempV2=new r.Vector2,o.tempV3=new r.Vector3},40270:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyBackground=void 0;const r=i(27107),n=i(44924);t.SkyBackground=class{constructor(e,t,i){switch(this.m_sky=e,this.m_projectionType=t,this.m_sky.type){case"gradient":this.m_skyTexture=new n.SkyGradientTexture(this.m_sky,this.m_projectionType),this.updateCamera(i);break;case"cubemap":this.m_skyTexture=new r.SkyCubemapTexture(this.m_sky)}}dispose(){this.m_skyTexture.dispose()}get texture(){return this.m_skyTexture.texture}updateCamera(e){"gradient"===this.m_sky.type&&this.m_skyTexture.update(e)}updateTexture(e,t){const i=this.m_sky.type===e.type&&this.m_projectionType===t;switch(e.type){case"gradient":i?this.m_skyTexture.updateTexture(e):this.m_skyTexture=new n.SkyGradientTexture(e,t);break;case"cubemap":i?this.m_skyTexture.updateTexture(e):this.m_skyTexture=new r.SkyCubemapTexture(e)}this.m_projectionType=t,this.m_sky=e}}},27107:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyCubemapTexture=t.SkyCubemapFaceId=t.SKY_CUBEMAP_FACE_COUNT=void 0;const r=i(38338),n=i(84428),o=r.LoggerManager.instance.create("SkyCubemapTexture");var a;t.SKY_CUBEMAP_FACE_COUNT=6,function(e){e[e.positiveX=0]="positiveX",e[e.negativeX=1]="negativeX",e[e.positiveY=2]="positiveY",e[e.negativeY=3]="negativeY",e[e.positiveZ=4]="positiveZ",e[e.negativeZ=5]="negativeZ"}(a=t.SkyCubemapFaceId||(t.SkyCubemapFaceId={})),t.SkyCubemapTexture=class{constructor(e){const t=this.createCubemapFaceArray(e);this.m_skybox=void 0!==t?(new n.CubeTextureLoader).load(t):new n.CubeTexture}dispose(){this.m_skybox.dispose()}get texture(){return this.m_skybox}updateTexture(e){const t=this.createCubemapFaceArray(e);void 0!==t&&(this.m_skybox=(new n.CubeTextureLoader).load(t))}createCubemapFaceArray(e){const i=[void 0,void 0,void 0,void 0,void 0,void 0];for(let r=0;r<t.SKY_CUBEMAP_FACE_COUNT;++r){const t=e[a[r]];if(void 0===t)return void o.error(`Face "${a[r]}" was not defined.`);i[r]=t}return i}}},44924:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyGradientTexture=t.DEFAULT_MONOMIAL_POWER=t.DEFAULT_TEXTURE_SIZE=void 0;const r=i(32941),n=i(38338),o=i(84428);t.DEFAULT_TEXTURE_SIZE=512,t.DEFAULT_MONOMIAL_POWER=1;const a=[new o.Vector3(1,0,0),new o.Vector3(-1,0,0),new o.Vector3(0,-1,0),new o.Vector3(0,1,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1)],s=[new o.Vector3(0,0,-1),new o.Vector3(0,0,1),new o.Vector3(1,0,0),new o.Vector3(1,0,0),new o.Vector3(1,0,0),new o.Vector3(-1,0,0)],l=[new o.Vector3(0,1,0),new o.Vector3(0,1,0),new o.Vector3(0,0,1),new o.Vector3(0,0,-1),new o.Vector3(0,1,0),new o.Vector3(0,1,0)];t.SkyGradientTexture=class{constructor(e,i,n=t.DEFAULT_TEXTURE_SIZE){this.m_projectionType=i,this.m_height=n;const a=new o.Color(e.topColor),s=new o.Color(e.bottomColor),l=new o.Color(e.groundColor);this.m_width=this.m_projectionType===r.ProjectionType.Planar?1:this.m_height,this.m_faceCount=this.m_projectionType===r.ProjectionType.Planar?1:6,this.m_faces=[];for(let t=0;t<this.m_faceCount;++t){const i=new Uint8Array(3*this.m_width*this.m_height);this.fillTextureData(i,t,a,s,l,e.monomialPower);const r=new o.DataTexture(i,this.m_width,this.m_height,o.RGBFormat);r.needsUpdate=!0,r.unpackAlignment=1,this.m_faces.push(r)}this.m_projectionType===r.ProjectionType.Spherical?(this.m_skybox=new o.CubeTexture(this.m_faces),this.m_skybox.needsUpdate=!0):(this.m_farClipPlaneDividedVertically=new o.Line3,this.m_groundPlane=new o.Plane(new o.Vector3(0,0,1)),this.m_bottomMidFarPoint=new o.Vector3,this.m_topMidFarPoint=new o.Vector3,this.m_horizonPosition=new o.Vector3,this.m_farClipPlaneCorners=[new o.Vector3,new o.Vector3,new o.Vector3,new o.Vector3])}dispose(){for(let e=0;e<this.m_faceCount;++e)this.m_faces[e].dispose();this.m_projectionType===r.ProjectionType.Spherical&&this.m_skybox.dispose()}get texture(){return this.m_projectionType===r.ProjectionType.Planar?this.m_faces[0]:this.m_skybox}update(e){this.m_projectionType===r.ProjectionType.Planar&&(this.setHorizonPosition(e),this.updateTexturePosition())}updateTexture(e){for(let t=0;t<this.m_faceCount;++t)this.fillTextureData(this.m_faces[t].image.data,t,new o.Color(e.topColor),new o.Color(e.bottomColor),new o.Color(e.groundColor),e.monomialPower),this.m_faces[t].needsUpdate=!0;this.m_projectionType===r.ProjectionType.Spherical&&(this.m_skybox.needsUpdate=!0)}fillTextureData(e,i,c,u,d,h){const m=new o.Color,p=new o.Vector3,f=new o.Vector3,g=new o.Vector3,y=new o.Vector3(0,0,1);for(let o=0;o<this.m_height;++o)for(let v=0;v<this.m_width;++v){if(this.m_projectionType===r.ProjectionType.Spherical){const e=f.copy(s[i]).multiplyScalar((v+.5)/this.m_width*2-1),r=g.copy(l[i]).multiplyScalar((o+.5)/this.m_height*2-1);p.copy(a[i]).add(e).add(r).normalize();const _=Math.max(y.dot(p),0);m.copy(d).lerp(u,Math.min(100*_,1)).lerp(c,_**n.getOptionValue(h,t.DEFAULT_MONOMIAL_POWER)).multiplyScalar(255)}else{const e=o/this.m_height;0===o?m.copy(d).multiplyScalar(255):m.copy(u).lerp(c,e**n.getOptionValue(h,t.DEFAULT_MONOMIAL_POWER)).multiplyScalar(255)}e[o*this.m_width*3+3*v]=m.r,e[o*this.m_width*3+3*v+1]=m.g,e[o*this.m_width*3+3*v+2]=m.b}}setHorizonPosition(e){this.m_farClipPlaneCorners[0].set(-1,-1,1).unproject(e),this.m_farClipPlaneCorners[1].set(1,-1,1).unproject(e),this.m_farClipPlaneCorners[2].set(-1,1,1).unproject(e),this.m_farClipPlaneCorners[3].set(1,1,1).unproject(e),this.m_bottomMidFarPoint.copy(this.m_farClipPlaneCorners[0]).add(this.m_farClipPlaneCorners[1]).multiplyScalar(.5),this.m_topMidFarPoint.copy(this.m_farClipPlaneCorners[2]).add(this.m_farClipPlaneCorners[3]).multiplyScalar(.5),this.m_farClipPlaneDividedVertically.set(this.m_bottomMidFarPoint,this.m_topMidFarPoint),this.m_groundPlane.intersectLine(this.m_farClipPlaneDividedVertically,this.m_horizonPosition)||this.m_horizonPosition.set(0,0,0)}updateTexturePosition(){const e=this.m_bottomMidFarPoint.distanceTo(this.m_horizonPosition)/this.m_farClipPlaneDividedVertically.distance(),t=0===this.m_horizonPosition.length()?1:e-2/this.m_height;this.m_faces[0].offset.set(0,this.m_bottomMidFarPoint.z<=0?-t:e)}}},72557:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SphereHorizon=t.previousCanvasSide=t.nextCanvasSide=t.CanvasSide=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(81621),s=i(83829),l=2*Math.PI;var c;function u(e){return(e+1)%4}!function(e){e[e.Bottom=0]="Bottom",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Left=3]="Left"}(c=t.CanvasSide||(t.CanvasSide={})),t.nextCanvasSide=u,t.previousCanvasSide=function(e){return(e+3)%4},t.SphereHorizon=class{constructor(e,t){this.m_camera=e,this.m_cornerIntersects=t,this.m_intersections=[],this.m_isFullyVisible=!0;const i=r.EarthConstants.EQUATORIAL_RADIUS*r.EarthConstants.EQUATORIAL_RADIUS,n=(new o.Vector3).setFromMatrixColumn(e.matrixWorld,0).normalize(),a=e.position.clone().normalize(),l=(new o.Vector3).crossVectors(a,n),c=e.position.length();this.m_normalToTangentAngle=Math.asin(r.EarthConstants.EQUATORIAL_RADIUS/c);const u=Math.sqrt(c*c-i);this.m_distanceToHorizonCenter=u*Math.cos(this.m_normalToTangentAngle);const d=c-this.m_distanceToHorizonCenter;this.m_radius=Math.sqrt(i-d*d),this.m_cameraPitch=s.MapViewUtils.extractAttitude({projection:r.sphereProjection},this.m_camera).pitch;const h=(new o.Vector3).copy(a).setLength(d);this.m_matrix=(new o.Matrix4).makeBasis(n,l,a).setPosition(h),this.computeIntersections()}getPoint(e,t=0,i=1,r=new o.Vector3){const n=t*l,a=n+e*((i>=t?i*l:(i+1)*l)-n);return r.set(this.m_radius*Math.cos(a),this.m_radius*Math.sin(a),0),r.applyMatrix4(this.m_matrix),r}getDivisionPoints(e,t=0,i=1,r=10){const n=Math.max(Math.ceil(((i<t?1+i:i)-t)*r),1);for(let r=0;r<n;r++)e(this.getPoint(r/n,t,i))}get isFullyVisible(){return this.m_isFullyVisible}getSideIntersections(e){return this.m_intersections[e]}isTangentVisible(e){switch(e){case c.Top:{const e=this.m_normalToTangentAngle-this.m_cameraPitch;return a.CameraUtils.getTopFov(this.m_camera)>=Math.abs(e)}case c.Bottom:{const e=this.m_normalToTangentAngle+this.m_cameraPitch;return a.CameraUtils.getBottomFov(this.m_camera)>=Math.abs(e)}case c.Left:{const e=this.m_normalToTangentAngle;return a.CameraUtils.getLeftFov(this.m_camera)>=Math.abs(e)&&this.m_cameraPitch<=a.CameraUtils.getBottomFov(this.m_camera)}case c.Right:{const e=this.m_normalToTangentAngle;return a.CameraUtils.getRightFov(this.m_camera)>=Math.abs(e)&&this.m_cameraPitch<=a.CameraUtils.getBottomFov(this.m_camera)}}}getTangentOnSide(e){switch(e){case c.Bottom:return.75;case c.Right:return 0;case c.Top:return.25;case c.Left:return.5}}computeIntersections(){const e=this.m_distanceToHorizonCenter*Math.tan(this.m_cameraPitch-a.CameraUtils.getBottomFov(this.m_camera));let t,i;for(let r=c.Bottom;r<4;r++){if(this.isTangentVisible(r)){this.m_intersections.push([this.getTangentOnSide(r)]);continue}const n=new Array;switch(this.m_isFullyVisible=!1,r){case c.Bottom:n.push(...this.computeTBIntersections(e));break;case c.Right:{const r=a.CameraUtils.getRightFov(this.m_camera),o=this.computeLRIntersections(e,r);o&&([t,i]=o,n.push(void 0!==i?1+i:void 0,t));break}case c.Top:{const e=this.m_distanceToHorizonCenter*Math.tan(this.m_cameraPitch+a.CameraUtils.getTopFov(this.m_camera));n.push(...this.computeTBIntersections(e).reverse());break}case c.Left:{const r=a.CameraUtils.getLeftFov(this.m_camera);if(r===a.CameraUtils.getRightFov(this.m_camera))n.push(void 0!==t?.5-t:void 0,void 0!==i?.5-i:void 0);else{const t=this.computeLRIntersections(e,r);t&&n.push(.5-t[0],void 0!==t[1]?.5-t[1]:void 0)}break}}const o=[this.m_cornerIntersects[r],this.m_cornerIntersects[u(r)]];this.m_intersections.push(n.filter(((e,t)=>void 0!==e&&!o[t])))}}computeTBIntersections(e){const t=this.m_radius*this.m_radius,i=Math.sqrt(t-e*e),r=Math.atan2(e,i)/l;return[.5-r,r>0?r:1+r]}computeLRIntersections(e,t){const i=this.m_distanceToHorizonCenter/Math.cos(this.m_cameraPitch),r=this.m_distanceToHorizonCenter*Math.tan(this.m_cameraPitch),o=i*Math.tan(t),s=a.CameraUtils.getBottomFov(this.m_camera),c=o*(this.m_distanceToHorizonCenter*Math.cos(s)/Math.cos(this.m_cameraPitch-s))/i,u=n.Math2D.intersectLineAndCircle(c,e,o,r,this.m_radius);if(!u)return;const d=u.y1;return[Math.atan2(d,u.x1)/l,-d>=e&&void 0!==u.x2?Math.atan2(u.y2,u.x2)/l:void 0]}}},68693:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SphereViewBounds=t.computeEdgeDivisions=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(72557),s=i(83829);function l(e,t){const i=Math.abs(t.latitude-e.latitude),r=e.minLongitudeSpanTo(t);return Math.ceil(Math.max(i/20,r/5))}t.computeEdgeDivisions=l;const c=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}];t.SphereViewBounds=class{constructor(e,t){this.camera=e,this.projection=t,n.assert(t.type===r.ProjectionType.Spherical)}generate(){const e=this.findBoundsIntersections();return this.wrapAroundPoles(e),e.length>2?new r.GeoPolygon(e,!1,!0):void 0}addSideSegmentSubdivisions(e,t,i,r,n){e.push(r);const a=l(r,n);if(a<=1)return;const c=new o.Vector2(i.x-t.x,i.y-t.y).multiplyScalar(1/a),u=new o.Vector2(t.x,t.y);for(let t=0;t<a-1;t++){u.add(c);const t=s.MapViewUtils.rayCastWorldCoordinates({camera:this.camera,projection:this.projection},u.x,u.y);t&&e.push(this.projection.unprojectPoint(t))}}addSideIntersections(e,t,i,r,o){const s=c[t],l=c[a.nextCanvasSide(t)];if(i&&r)return void this.addSideSegmentSubdivisions(e,s,l,i,r);if(!o)return;const u=o.getSideIntersections(t);if(0!==u.length){if(i){const t=o.getPoint(u[u.length-1]),r=this.projection.unprojectPoint(t);this.addSideSegmentSubdivisions(e,s,t.project(this.camera),i,r)}else{const i=a.previousCanvasSide(t);let r=o.getSideIntersections(i);0===r.length&&(r=o.getSideIntersections(a.previousCanvasSide(i))),n.assert(r.length>0),o.getDivisionPoints((t=>{e.push(this.projection.unprojectPoint(t))}),r[r.length-1],u[0])}if(u.length>1){const t=o.getPoint(u[0]),i=o.getPoint(u[1]),r=this.projection.unprojectPoint(t),n=this.projection.unprojectPoint(i);this.addSideSegmentSubdivisions(e,t.project(this.camera),i.project(this.camera),r,n)}if(r){const t=o.getPoint(u[0]),i=this.projection.unprojectPoint(t);this.addSideSegmentSubdivisions(e,t.project(this.camera),l,i,r)}}}findBoundsIntersections(){const e=[],[t,i]=this.addCanvasCornerIntersection(),r=i<4?new a.SphereHorizon(this.camera,t.map((e=>void 0!==e))):void 0;if(0===i&&r.isFullyVisible)return r.getDivisionPoints((t=>{e.push(this.projection.unprojectPoint(t))})),e;for(let i=a.CanvasSide.Bottom;i<4;i++){const n=t[i],o=t[a.nextCanvasSide(i)];this.addSideIntersections(e,i,n,o,r)}return e}wrapAroundPoles(e){const t=new o.Vector3(0,0,r.EarthConstants.EQUATORIAL_RADIUS),i=new o.Vector3(0,0,-r.EarthConstants.EQUATORIAL_RADIUS),n=s.MapViewUtils.closeToFrustum(t,this.camera),a=s.MapViewUtils.closeToFrustum(i,this.camera);if(!n&&!a)return;const l=this.projection.unprojectPoint(this.camera.position).lng,c=n?90:-90,u=n?l+180:l-180,d=new r.GeoCoordinates(c,u),h=d.normalized(),m=h.lng;let p=e[e.length-1].lng,f=!1;const g=e.findIndex((e=>{const t=r.isAntimeridianCrossing(p,e.lng);return Math.sign(m-e.lng)===Math.sign(m-p)===t?(f=t,!0):(p=e.lng,!1)}));if(g<0)return;const y=n?90:-90,v=n?1e-5:-1e-5,_=new r.GeoCoordinates(c,l+y).normalized(),b=new r.GeoCoordinates(c,l).normalized(),S=new r.GeoCoordinates(c,l-y).normalized(),T=new r.GeoCoordinates(c,u+v).normalized(),E=e[(g+e.length-1)%e.length],C=e[g];let w=r.GeoCoordinates.lerp(E,C,.01,f);f&&n?w.longitude-=360:w=w.normalized(),e.splice(g,0,u<-180?d:h,_,b,S,T,w)}addCanvasCornerIntersection(){const e=new Array;let t=0;return c.forEach((i=>{const r=s.MapViewUtils.rayCastWorldCoordinates({camera:this.camera,projection:this.projection},i.x,i.y);r?(e.push(this.projection.unprojectPoint(r)),++t):e.push(void 0)})),[e,t]}}},61257:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceStatistics=t.FrameStatsArray=t.FrameStats=t.Statistics=t.MultiStageTimer=t.computeArrayAverage=t.computeArrayStats=t.SampledTimer=t.SimpleTimer=t.RingBuffer=void 0;const r=i(38338),n=r.LoggerManager.instance.create("Statistics");class o{constructor(e){this.capacity=e,this.buffer=new Array(e),this.capacity=e,this.head=this.tail=this.size=0}clear(){this.head=this.tail=this.size=0}enqOne(e){let t=this.head+1;t>=this.capacity&&(t=0),this.size<this.capacity&&this.size++,this.buffer[this.head]=e,this.head=t,this.size===this.capacity&&(this.tail=this.head)}enq(...e){for(const t of e)this.enqOne(t)}deq(){if(0===this.size)throw new Error("Ringbuffer underrun");const e=this.buffer[this.tail];let t=this.tail+1;return t>=this.capacity&&(t=0),this.size>0&&this.size--,this.tail=t,e}get top(){if(0===this.size)throw new Error("Ringbuffer underrun");return this.buffer[this.tail]}get bottom(){if(0===this.size)throw new Error("Ringbuffer underrun");let e=this.head-1;return e<0&&(e=this.capacity-1),this.buffer[e]}iterator(){return new o.Iterator(this)}asArray(){const e=new Array;for(let t=0;t<this.size;t++)e.push(this.buffer[(this.tail+t)%this.capacity]);return e}}t.RingBuffer=o,function(e){e.Iterator=class{constructor(e,t=0){this.m_buffer=e,this.m_index=t}get value(){return this.m_buffer.buffer[(this.m_buffer.tail+this.m_index)%this.m_buffer.capacity]}next(){return this.m_index++,this.m_index<this.m_buffer.size}}}(o=t.RingBuffer||(t.RingBuffer={}));class a{constructor(e,t){this.statistics=e,this.name=t,this.running=!1}get value(){return this.m_currentValue}setValue(e){this.m_currentValue=e}reset(){this.m_currentValue=void 0}start(){if(!this.statistics.enabled)return-1;if(this.running)throw new Error("Timer '"+this.name+"' is already running");return this.running=!0,this.m_currentValue=r.PerformanceTimer.now()}stop(){var e;if(!this.statistics.enabled)return-1;if(this.running){const t=r.PerformanceTimer.now()-(null!==(e=this.m_currentValue)&&void 0!==e?e:0);return this.m_currentValue=t,this.setValue(t),this.running=!1,t}throw new Error("Timer '"+this.name+"' has not been started")}now(){var e;if(!this.statistics.enabled)return-1;if(this.running)return r.PerformanceTimer.now()-(null!==(e=this.m_currentValue)&&void 0!==e?e:0);throw new Error("Timer '"+this.name+"' has not been started")}}t.SimpleTimer=a;class s extends a{constructor(e,t){super(e,t),this.statistics=e,this.name=t,this.numResets=0,this.maxNumSamples=1e3,this.samples=new o(this.maxNumSamples)}reset(){super.reset(),this.getStats(),this.samples.clear(),this.numResets++}setValue(e){super.setValue(e),void 0!==e&&this.samples.enqOne(e)}getStats(){return l(this.samples.asArray())}}function l(e){if(0===e.length)return;e.sort(((e,t)=>e-t));const t=e[0],i=e[e.length-1];let r,n,o,a,s,l,c;if(1===e.length)n=o=a=s=l=c=r=e[0];else if(2===e.length)r=.5*e[0]+.5*e[1],n=o=a=s=l=c=e[1];else{const t=Math.floor(e.length/2);r=e.length%2==0?.5*e[t-1]+.5*e[t]:e[t],n=e[Math.round(.75*e.length)-1],o=e[Math.round(.9*e.length)-1],a=e[Math.round(.95*e.length)-1],s=e[Math.round(.97*e.length)-1],l=e[Math.round(.99*e.length)-1],c=e[Math.round(.999*e.length)-1]}let u=0;for(let t=0,i=e.length;t<i;t++)u+=e[t];return{min:t,max:i,avg:u/e.length,median:r,median75:n,median90:o,median95:a,median97:s,median99:l,median999:c,numSamples:e.length}}t.SampledTimer=s,t.computeArrayStats=l,t.computeArrayAverage=function(e){if(0===e.length)return;let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i];return t/e.length},t.MultiStageTimer=class{constructor(e,t,i){if(this.statistics=e,this.name=t,this.stages=i,i.length<1)throw new Error("MultiStageTimer needs stages");i.forEach((t=>{if(!e.hasTimer(t))throw new Error("Unknown timer: "+t)}))}get value(){return this.statistics.getTimer(this.stages[this.stages.length-1]).value}reset(){this.statistics.enabled&&this.stages.forEach((e=>{this.statistics.getTimer(e).reset()}))}start(){var e;return this.stage=this.stages[0],null!==(e=this.statistics.getTimer(this.stages[0]).value)&&void 0!==e?e:-1}stop(){return this.stage=void 0,void 0!==this.value?this.value:-1}get stage(){return this.currentStage}set stage(e){this.currentStage!==e&&(this.statistics.enabled&&void 0!==this.currentStage&&this.statistics.getTimer(this.currentStage).stop(),this.currentStage=e,this.statistics.enabled&&void 0!==this.currentStage&&this.statistics.getTimer(this.currentStage).start())}},t.Statistics=class{constructor(e,t=!1){this.name=e,this.enabled=t,this.timers=new Map,this.nullTimer=new a(this,"<null>")}createTimer(e,t=!0){const i=t?new s(this,e):new a(this,e);return this.addTimer(i)}addTimer(e){if(void 0!==this.timers.get(e.name))throw new Error("Duplicate timer name: '"+e.name+"'");return this.timers.set(e.name,e),e}getTimer(e){if(!this.enabled)return this.nullTimer;const t=this.timers.get(e);return void 0===t?this.nullTimer:t}hasTimer(e){return void 0!==this.timers.get(e)}reset(){this.timers.forEach((e=>{e.reset()}))}log(e,t){void 0===e&&void 0===this.name||n.log(void 0!==e?e:this.name);let i=0;this.timers.forEach((e=>{i=Math.max(i,e.name.length)}));const r=e=>void 0!==e?e.toFixed(5):"?";this.timers.forEach((e=>{let t=e.name+": "+" ".repeat(i-e.name.length);if(t+=r(e.value),e instanceof s){const i=e.getStats();void 0!==i&&(t+=`  [ min=${r(i.min)}, max=${r(i.max)}, avg=${r(i.avg)}, med=${r(i.median)}, med95=${r(i.median95)}, med99=${r(i.median99)}, N=${r(i.numSamples)} ]`)}n.log(t)})),void 0!==t&&n.log(t)}};class c{constructor(){this.entries=new Map,this.messages=void 0}getValue(e){return this.entries.get(e)}setValue(e,t){this.entries.set(e,t)}addValue(e,t){const i=this.entries.get(e);this.entries.set(e,t+(void 0===i?0:i))}addMessage(e){void 0===this.messages&&(this.messages=[]),this.messages.push(e)}reset(){this.entries.forEach(((e,t)=>{this.entries.set(t,0)})),this.messages=void 0}}t.FrameStats=c;class u{constructor(e=0){this.capacity=e,this.frameEntries=new Map,this.messages=new o(e)}get length(){return this.messages.size}reset(){this.frameEntries.forEach(((e,t)=>{e.clear()})),this.messages.clear()}addFrame(e){const t=this.length,i=this.frameEntries;e.entries.forEach(((e,r)=>{let n=i.get(r);if(void 0===n){n=new o(this.capacity);for(let e=0;e<t;e++)n.enqOne(0);this.frameEntries.set(r,n)}n.enqOne(e)})),this.messages.enq(e.messages)}log(){let e=0;this.frameEntries.forEach(((t,i)=>{e=Math.max(e,i.length)}));const t=e=>void 0!==e?e.toFixed(5):"?";this.frameEntries.forEach(((i,r)=>{let o=r+": "+" ".repeat(e-r.length);const a=l(i.asArray());void 0!==a&&(o+=`  [ min=${t(a.min)}, max=${t(a.max)}, avg=${t(a.avg)}, med=${t(a.median)}, med95=${t(a.median95)}, med99=${t(a.median99)}, N=${t(a.numSamples)} ]`),n.log(o)}))}}t.FrameStatsArray=u;class d{constructor(e=!0,t=1e3){this.enabled=e,this.maxNumFrames=t,this.currentFrame=new c,this.appResults=new Map,this.configs=new Map,d.m_instance=this,this.m_frameEvents=new u(t)}get isFull(){return this.m_frameEvents.length>=this.maxNumFrames}static get instance(){return void 0===d.m_instance&&(d.m_instance=new d(!1,0)),d.m_instance}get frameEvents(){return this.m_frameEvents}clear(){this.clearFrames(),this.configs.clear(),this.appResults.clear()}clearFrames(){this.m_frameEvents.reset(),this.currentFrame.reset()}addWebGLInfo(e){void 0!==e.render&&(this.currentFrame.setValue("gl.numCalls",null===e.render.calls?0:e.render.calls),this.currentFrame.setValue("gl.numPoints",null===e.render.points?0:e.render.points),this.currentFrame.setValue("gl.numLines",null===e.render.lines?0:e.render.lines),this.currentFrame.setValue("gl.numTriangles",null===e.render.triangles?0:e.render.triangles)),void 0!==e.memory&&(this.currentFrame.setValue("gl.numGeometries",null===e.memory.geometries?0:e.memory.geometries),this.currentFrame.setValue("gl.numTextures",null===e.memory.textures?0:e.memory.textures)),void 0!==e.programs&&this.currentFrame.setValue("gl.numPrograms",null===e.programs?0:e.programs.length)}addMemoryInfo(){if(void 0!==window&&void 0!==window.performance){const e=window.performance.memory;void 0!==e&&(this.currentFrame.setValue("memory.totalJSHeapSize",e.totalJSHeapSize),this.currentFrame.setValue("memory.usedJSHeapSize",e.usedJSHeapSize),this.currentFrame.setValue("memory.jsHeapSizeLimit",e.jsHeapSizeLimit))}}storeAndClearFrameInfo(){return!(this.m_frameEvents.length>=this.maxNumFrames||(this.m_frameEvents.addFrame(this.currentFrame),this.currentFrame.reset(),0))}log(e,t){n.log(void 0!==e?e:"PerformanceStatistics"),this.appResults.forEach(((e,t)=>{n.log(t,e)})),this.configs.forEach(((e,t)=>{n.log(t,e)})),this.m_frameEvents.log(),void 0!==t&&n.log(t)}getAsPlainObject(e=!1){const t={},i={},r={},n={configs:i,appResults:t,frames:r};if(this.appResults.forEach(((e,i)=>{t[i]=e})),this.configs.forEach(((e,t)=>{i[t]=e})),e)for(const[e,t]of this.m_frameEvents.frameEntries)r[e]=t.bottom;else for(const[e,t]of this.m_frameEvents.frameEntries)r[e]=t.asArray();return n.messages=this.m_frameEvents.messages.asArray(),n}getLastFrameStatistics(){return this.getAsPlainObject(!0)}getAsSimpleFrameStatistics(e=!1){const t=new Map,i=new Map,r=new Map,n={configs:t,appResults:i,frames:r,messages:this.m_frameEvents.messages.asArray()};if(this.appResults.forEach(((e,t)=>{i.set(t,e)})),this.configs.forEach(((e,i)=>{t.set(i,e)})),e)for(const[e,t]of this.m_frameEvents.frameEntries)r.set(e,t.bottom);else for(const[e,t]of this.m_frameEvents.frameEntries)r.set(e,t.asArray());return n}}t.PerformanceStatistics=d,d.m_instance=void 0},30924:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextureLoader=void 0;const r=i(84428);t.TextureLoader=class{constructor(){this.m_textureLoader=new r.TextureLoader}async load(e,t,i,n=!0){if(void 0===t)return await this.loadWithThreeLoader(e);const o=await fetch(e,{headers:t,signal:i,mode:n?"cors":"no-cors"}),a=await o.blob(),s=await this.loadWithThreeLoader(URL.createObjectURL(a)),l="image/jpeg/"===a.type||e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);return s.format=l?r.RGBFormat:r.RGBAFormat,s}loadWithThreeLoader(e){return new Promise(((t,i)=>{this.m_textureLoader.setCrossOrigin(""),this.m_textureLoader.load(e,(e=>t(e)),void 0,(()=>i(new Error("failed to load texture"))))}))}}},51771:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLight=t.toTextureFilter=t.toWrappingMode=t.toTextureDataType=t.toPixelFormat=void 0;const r=i(84428);t.toPixelFormat=function(e){switch(e){case"Alpha":return r.AlphaFormat;case"RGB":return r.RGBFormat;case"RGBA":return r.RGBAFormat;case"Luminance":return r.LuminanceFormat;case"LuminanceAlpha":return r.LuminanceAlphaFormat;case"RGBE":return r.RGBEFormat;case"Depth":return r.DepthFormat;case"DepthStencil":return r.DepthStencilFormat;case"Red":return r.RedFormat;default:throw new Error(`invalid pixel format: ${e}`)}},t.toTextureDataType=function(e){switch(e){case"UnsignedByte":return r.UnsignedByteType;case"Byte":return r.ByteType;case"Short":return r.ShortType;case"UnsignedShort":return r.UnsignedShortType;case"Int":return r.IntType;case"UnsignedInt":return r.UnsignedIntType;case"Float":return r.FloatType;case"HalfFloat":return r.HalfFloatType;default:throw new Error(`invalid texture data type: ${e}`)}},t.toWrappingMode=function(e){switch(e){case"clamp":return r.ClampToEdgeWrapping;case"repeat":return r.RepeatWrapping;case"mirror":return r.MirroredRepeatWrapping;default:throw new Error(`invalid wrapping mode: ${e}`)}},t.toTextureFilter=function(e){switch(e){case"nearest":return r.NearestFilter;case"nearestMipMapNearest":return r.NearestMipMapNearestFilter;case"nearestMipMapLinear":return r.NearestMipMapLinearFilter;case"linear":return r.LinearFilter;case"linearMipMapNearest":return r.LinearMipMapNearestFilter;case"linearMipMapLinear":return r.LinearMipMapLinearFilter;default:throw new Error(`invalid texture filter: ${e}`)}},t.createLight=function(e){switch(e.type){case"ambient":{const t=new r.AmbientLight(e.color,e.intensity);return t.name=e.name,t}case"directional":{const t=new r.DirectionalLight(e.color,e.intensity);return t.name=e.name,void 0!==e.castShadow&&(t.castShadow=e.castShadow),t.castShadow&&(t.shadow.bias=1e-5,t.shadow.mapSize.width=1024,t.shadow.mapSize.height=1024),t.position.set(e.direction.x,e.direction.y,e.direction.z),t.position.normalize(),t}}}},37581:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeLoader=t.DEFAULT_MAX_THEME_INTHERITANCE_DEPTH=void 0,i(76254);const r=i(96500),n=i(78510),o=i(38338),a=i(27107);t.DEFAULT_MAX_THEME_INTHERITANCE_DEPTH=4;class s{static async load(e,t){var i;if(t=null!=t?t:{},"string"==typeof e){const i=t.uriResolver,r=void 0!==i?i.resolveUri(e):e,n=await fetch(r,{signal:t.signal});if(!n.ok)throw new Error(`ThemeLoader#load: cannot load theme: ${n.statusText}`);(e=await n.json()).url=r,e=this.resolveUrls(e,t)}else void 0===e.url?(e.url=o.getAppBaseUrl(),e=this.resolveUrls(e,t)):e=this.convertFlatTheme(e);if(null==e)throw new Error("ThemeLoader#load: loaded resource is not valid JSON");s.checkTechniqueSupport(e);const r=o.getOptionValue(t.resolveDefinitions,!1);if(e=await s.resolveBaseThemes(e,t),r){const r=new o.ContextLogger(null!==(i=t.logger)&&void 0!==i?i:console,`when processing Theme ${e.url}:`);s.resolveThemeReferences(e,r)}return e}static isThemeLoaded(e){return void 0===e.extends&&!Array.isArray(e.styles)}static async loadAsync(e){return await s.load(e)}static resolveUrls(e,t){if(void 0===(e=s.convertFlatTheme(e)).url)return e;const i=o.composeUriResolvers(null==t?void 0:t.uriResolver,new o.RelativeUriResolver(e.url)),r=void 0===t||!(!1===t.resolveIncludeUris);return e.extends&&r&&(e.extends=(Array.isArray(e.extends)?e.extends:[e.extends]).map((r=>"string"==typeof r?i.resolveUri(r):void 0!==r.url?r:(r.url=e.url,this.resolveUrls(r,t))))),s.convertFlatTheme(e)?((void 0===t||!(!1===t.resolveResourceUris))&&s.resolveResources(e,i),e):e}static checkTechniqueSupport(e){if(void 0!==e.styles)for(const t in e.styles)if(e.styles.hasOwnProperty(t))for(const i of e.styles[t])i.technique}static resolveThemeReferences(e,t){if(void 0!==e.styles)for(const i in e.styles)e.styles.hasOwnProperty(i)&&(t.pushAttr("styles"),t.pushAttr(i),e.styles[i]=s.resolveStyleSet(e.styles[i],e.definitions,t),t.pop(),t.pop());return e}static resolveStyleSet(e,t,i){const r=[];for(let n=0;n<e.length;++n){const o=e[n];i.pushIndex(n);const a=s.resolveStyle(o,t,i);void 0!==a?r.push(a):i.warn("invalid style, ignored"),i.pop()}return r}static resolveStyle(e,t,i){if(Array.isArray(e.when)){i.pushAttr("when");const r=this.resolveExpressionReferences(e.when,t,i);if(i.pop(),void 0===r)return;e.when=r}if(void 0!==e.attr){const r=e.attr;i.pushAttr("attr");for(const e in r){if(!r.hasOwnProperty(e))continue;const n=r[e];if(!Array.isArray(n))continue;i.pushAttr(e);const o=this.resolveExpressionReferences(n,t,i);i.pop(),void 0!==o?r[e]=o:delete r[e]}i.pop()}return e}static resolveExpressionReferences(e,t,i){let o=!1;const a=function e(a){if(n.isJsonExprReference(a)){const e=a[1],s=t&&t[e];return void 0===s?(i.warn(`invalid reference '${e}' - not found`),void(o=!0)):r.isJsonExpr(s)?s:n.getDefinitionValue(s)}if(Array.isArray(a)){const t=[...a];for(let i=1;i<t.length;++i)t[i]=e(t[i]);return t}return a}(e);if(!o)return a}static async resolveBaseThemes(e,i){if(i=null!=i?i:{},void 0===e.extends)return e;const r=o.getOptionValue(i.maxInheritanceDepth,t.DEFAULT_MAX_THEME_INTHERITANCE_DEPTH);if(r<=0)throw new Error("maxInheritanceDepth reached when attempting to load base theme");const n=Array.isArray(e.extends)?e.extends:[e.extends];delete e.extends;let a={};for(const e of n){const t=await s.load(e,Object.assign(Object.assign({},i),{resolveDefinitions:!1,maxInheritanceDepth:r-1}));a=s.mergeThemes(t,a)}return s.mergeThemes(e,a)}static mergeThemes(e,t){const i=Object.assign(Object.assign({},t.definitions),e.definitions);let r;if(t.styles&&e.styles){const i=Object.keys(t.styles),n=Object.keys(e.styles);r={},i.forEach((i=>{const o=n.indexOf(i);if(-1!==o){const a=t.styles[i],s=[],l=new Map;a.forEach((e=>{"string"==typeof e.id&&l.set(e.id,s.length),s.push(e)})),e.styles[i].forEach((e=>{if("string"==typeof e.extends&&l.has(e.extends)){const t=l.get(e.extends),i=s[t];return s[t]=Object.assign(Object.assign({},i),e),void(s[t].extends=void 0)}if("string"==typeof e.id&&l.has(e.id)){const t=l.get(e.id);s[t]=e}else s.push(e)})),r[i]=s,n.splice(o,1)}else r[i]=t.styles[i]})),n.forEach((t=>{r[t]=e.styles[t]}))}else t.styles?r=Object.assign({},t.styles):e.styles&&(r=Object.assign({},e.styles));return Object.assign(Object.assign(Object.assign(Object.assign({},t),e),s.mergeImageTextures(e,t)),{definitions:i,styles:r})}static mergeImageTextures(e,t){const i=Object.assign(Object.assign({},t.images),e.images);let r=[];return!t.imageTextures&&e.imageTextures?r=e.imageTextures:t.imageTextures&&!e.imageTextures?r=t.imageTextures:t.imageTextures&&e.imageTextures&&(r=e.imageTextures.slice(),t.imageTextures.forEach((e=>{r.find((({name:t})=>t===e.name))||r.push(e)}))),{images:i,imageTextures:r}}static convertFlatTheme(e){if(Array.isArray(e.styles)){const t={};e.styles.forEach((e=>{if(r.isJsonExpr(e))throw new Error("invalid usage of theme reference");const i=e.styleSet;if(void 0===i)throw new Error("missing reference to style set");t[i]||(t[i]=[]),t[i].push(e)})),e.styles=t}return e}static resolveResources(e,t){if(e.sky&&"cubemap"===e.sky.type)for(let i=0;i<a.SKY_CUBEMAP_FACE_COUNT;++i){const r=e.sky[a.SkyCubemapFaceId[i]];void 0!==r&&(e.sky[a.SkyCubemapFaceId[i]]=t.resolveUri(r))}if(e.images)for(const i of Object.keys(e.images)){const r=e.images[i];r.url=t.resolveUri(r.url),void 0!==r.atlas&&(r.atlas=t.resolveUri(r.atlas))}if(e.fontCatalogs)for(const i of e.fontCatalogs)i.url=t.resolveUri(i.url);if(e.poiTables)for(const i of e.poiTables)i.url=t.resolveUri(i.url);if(void 0!==e.styles)for(const i in e.styles){if(!e.styles.hasOwnProperty(i))continue;const r=e.styles[i];for(const e of r)e.attr&&["map","normalMap","displacementMap","roughnessMap"].forEach((i=>{const r=e.attr[i];r&&"string"==typeof r&&(e.attr[i]=t.resolveUri(r))}))}}}t.ThemeLoader=s},84070:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tile=t.getFeatureDataSize=void 0;const r=i(32941),n=i(38338),o=i(84428),a=i(95740),s=i(63978),l=i(85480),c=i(10772),u=i(61257),d=i(11970),h=i(48533),m=i(51195),p=i(31049),f=n.LoggerManager.instance.create("Tile");t.getFeatureDataSize=function(e){let t=100;return void 0!==e.starts&&(t+=8*e.starts.length),void 0!==e.objInfos&&(t+=16*e.objInfos.length),t},t.Tile=class{constructor(e,t,i=0,n){this.dataSource=e,this.tileKey=t,this.objects=[],this.dependencies=[],this.frameNumLastRequested=-1,this.frameNumVisible=-1,this.frameNumLastVisible=-1,this.numFramesVisible=0,this.visibilityCounter=-1,this.levelOffset=0,this.skipRendering=!1,this.delayRendering=!1,this.m_boundingBox=new r.OrientedBox3,this.m_disposed=!1,this.m_forceHasGeometry=void 0,this.m_textElementGroups=new m.TextElementGroupPriorityList,this.m_pathBlockingElements=[],this.m_worldCenter=new o.Vector3,this.m_visibleArea=0,this.m_elevationRange={minElevation:0,maxElevation:0},this.m_ownedTextures=new WeakSet,this.geoBox=this.dataSource.getTilingScheme().getGeoBox(this.tileKey),this.updateBoundingBox(),this.m_worldCenter.copy(this.boundingBox.position),this.m_localTangentSpace=null!=n&&n,this.m_textStyleCache=new p.TileTextStyleCache(this),this.m_offset=i,this.m_uniqueKey=r.TileKeyUtils.getKeyForTileKeyAndOffset(this.tileKey,this.offset),e.useGeometryLoader&&(this.m_tileGeometryLoader=new l.TileGeometryLoader(this,this.mapView.taskQueue),this.attachGeometryLoadedCallback())}get isVisible(){try{return this.frameNumLastRequested>=this.dataSource.mapView.frameNumber-1}catch(e){return f.debug(e),!1}}set isVisible(e){this.frameNumLastRequested=e?this.dataSource.mapView.frameNumber:-1,e||!this.m_tileGeometryLoader||this.m_tileGeometryLoader.isSettled||this.m_tileGeometryLoader.cancel()}get projection(){return this.dataSource.projection}get mapView(){return this.dataSource.mapView}get localTangentSpace(){return this.m_localTangentSpace}get memoryUsage(){return void 0===this.m_resourceInfo&&this.computeResourceInfo(),this.m_resourceInfo.heapSize}get center(){return this.m_worldCenter}get uniqueKey(){return this.m_uniqueKey}get offset(){return this.m_offset}set offset(e){this.m_offset!==e&&(this.m_uniqueKey=r.TileKeyUtils.getKeyForTileKeyAndOffset(this.tileKey,e)),this.m_offset=e}getResourceInfo(){return void 0===this.m_resourceInfo&&this.computeResourceInfo(),this.m_resourceInfo}invalidateResourceInfo(){this.m_resourceInfo=void 0}addOwnedTexture(e){this.m_ownedTextures.add(e)}get userTextElements(){let e=this.m_textElementGroups.groups.get(d.TextElement.HIGHEST_PRIORITY);return void 0===e&&(e=new h.TextElementGroup(d.TextElement.HIGHEST_PRIORITY),this.m_textElementGroups.groups.set(e.priority,e)),e}addUserTextElement(e){e.priority=d.TextElement.HIGHEST_PRIORITY,this.addTextElement(e)}removeUserTextElement(e){return e.priority=d.TextElement.HIGHEST_PRIORITY,this.removeTextElement(e)}addTextElement(e){this.textElementGroups.add(e),!1===this.m_textElementsChanged&&(this.m_textElementGroups=this.textElementGroups.clone()),this.textElementsChanged=!0}addBlockingElement(e){this.m_pathBlockingElements.push(e)}removeTextElement(e){const t=this.textElementGroups;return!!t.remove(e)&&(!1===this.m_textElementsChanged&&(this.m_textElementGroups=t.clone()),this.textElementsChanged=!0,!0)}get textElementGroups(){return this.m_textElementGroups}get textElementsChanged(){var e;return null!==(e=this.m_textElementsChanged)&&void 0!==e&&e}set textElementsChanged(e){this.m_textElementsChanged=e}hasTextElements(){return this.m_textElementGroups.count()>0}get blockingElements(){return this.m_pathBlockingElements}willRender(e){return!this.skipRendering&&!this.delayRendering}didRender(){}get visibleArea(){return this.m_visibleArea}set visibleArea(e){this.m_visibleArea=e,void 0!==this.tileLoader&&(this.tileLoader.priority=e)}get elevationRange(){return this.m_elevationRange}set elevationRange(e){var t;e.minElevation===this.m_elevationRange.minElevation&&e.maxElevation===this.m_elevationRange.maxElevation&&e.calculationStatus===this.m_elevationRange.calculationStatus||(this.m_elevationRange.minElevation=e.minElevation,this.m_elevationRange.maxElevation=e.maxElevation,this.m_elevationRange.calculationStatus=e.calculationStatus,this.elevateGeoBox(),void 0===this.m_maxGeometryHeight&&void 0===this.m_minGeometryHeight||(n.assert(void 0===(null===(t=this.decodedTile)||void 0===t?void 0:t.boundingBox)),this.updateBoundingBox()))}get decodedTile(){return this.m_decodedTile}set decodedTile(e){var t,i;if(this.m_decodedTile=e,this.invalidateResourceInfo(),void 0===e)return;0===e.geometries.length&&this.forceHasGeometry(!0),this.m_maxGeometryHeight=e.boundingBox?void 0:null!==(t=e.maxGeometryHeight)&&void 0!==t?t:0,this.m_minGeometryHeight=e.boundingBox?void 0:null!==(i=e.minGeometryHeight)&&void 0!==i?i:0,this.elevateGeoBox(),this.updateBoundingBox(e.boundingBox);const r=u.PerformanceStatistics.instance;r.enabled&&void 0!==e.decodeTime&&(r.currentFrame.addValue("decode.decodingTime",e.decodeTime),r.currentFrame.addValue("decode.decodedTiles",1)),void 0!==e.copyrightHolderIds&&(this.copyrightInfo=e.copyrightHolderIds.map((e=>({id:e})))),this.dataSource.requestUpdate()}shouldDisposeObjectGeometry(e){return!0}shouldDisposeObjectMaterial(e){return!0}shouldDisposeTexture(e){return this.m_ownedTextures.has(e)}get disposed(){return this.m_disposed}get allGeometryLoaded(){var e,t;return null!==(t=null===(e=this.m_tileGeometryLoader)||void 0===e?void 0:e.isFinished)&&void 0!==t?t:this.hasGeometry}get hasGeometry(){return void 0===this.m_forceHasGeometry?0!==this.objects.length:this.m_forceHasGeometry}forceHasGeometry(e){this.m_forceHasGeometry=e}resetVisibilityCounter(){this.visibilityCounter=-1}get tileLoader(){return this.m_tileLoader}set tileLoader(e){this.m_tileLoader=e}async load(){const e=this.tileLoader;if(void 0===e)return await Promise.resolve();if(this.m_tileGeometryLoader){const e=this.m_tileGeometryLoader.isSettled;this.m_tileGeometryLoader.reset(),e&&this.attachGeometryLoadedCallback()}return await e.loadAndDecode().then((t=>{var i;n.assert(t===c.TileLoaderState.Ready);const o=e.decodedTile;this.decodedTile=o,null===(i=null==o?void 0:o.dependencies)||void 0===i||i.forEach((e=>{this.dependencies.push(r.TileKey.fromMortonCode(e))}))})).catch((e=>{e===c.TileLoaderState.Failed?this.dispose():e!==c.TileLoaderState.Canceled&&f.error("Unknown error"+e)}))}get textStyleCache(){return this.m_textStyleCache}clear(){const e=e=>{Object.getOwnPropertyNames(e).forEach((t=>{const i=e[t];if(void 0!==i&&i instanceof o.Texture){const e=i;this.shouldDisposeTexture(e)&&e.dispose()}})),e.dispose()},t=t=>{if(this.shouldDisposeObjectGeometry(t)&&(void 0!==t.geometry&&t.geometry.dispose(),void 0!==t.geometries))for(const e of t.geometries)e.dispose();void 0!==t.material&&this.shouldDisposeObjectMaterial(t)&&(t.material instanceof Array?t.material.forEach((t=>{void 0!==t&&e(t)})):e(t.material))};this.objects.forEach((e=>{e.traverse((e=>{t(e)})),t(e)})),this.objects.length=0,this.preparedTextPaths&&(this.preparedTextPaths=[]),this.m_textStyleCache.clear(),this.clearTextElements(),this.invalidateResourceInfo()}clearTextElements(){this.hasTextElements()&&(this.textElementsChanged=!0,this.m_pathBlockingElements.splice(0),this.textElementGroups.forEach((e=>{e.dispose()})),this.textElementGroups.clear())}addDisposeCallback(e){this.m_disposeCallback=n.chainCallbacks(this.m_disposeCallback,e)}dispose(){var e;this.m_disposed||(this.m_tileLoader&&(this.m_tileLoader.cancel(),this.m_tileLoader=void 0),this.clear(),this.frameNumLastRequested=0,this.m_disposed=!0,null===(e=this.m_tileGeometryLoader)||void 0===e||e.dispose(),this.m_disposeCallback&&this.m_disposeCallback(this))}computeWorldOffsetX(){return this.projection.worldExtent(0,0).max.x*this.offset}update(e){for(const t of this.objects)t instanceof a.LodMesh&&t.setLevelOfDetail(e-this.tileKey.level)}get boundingBox(){return this.m_boundingBox}updateGeometry(e,t,i){if(!this.m_tileGeometryLoader)return!1;if(this.m_tileGeometryLoader.isSettled)return!0;if(this.dataSource.isDetached())return this.m_tileGeometryLoader.cancel(),!0;if(this.tileLoader){if(!this.tileLoader.isFinished)return!0;if(!this.decodedTile)return this.m_tileGeometryLoader.finish(),!0}return void 0!==e&&(this.m_tileGeometryLoader.priority=e),this.m_tileGeometryLoader.update(t,i),!0}get loadedGeometryKinds(){var e;return null===(e=this.m_tileGeometryLoader)||void 0===e?void 0:e.availableGeometryKinds}loadingFinished(){}attachGeometryLoadedCallback(){n.assert(void 0!==this.m_tileGeometryLoader),this.m_tileGeometryLoader.waitFinished().then((()=>{this.loadingFinished(),this.removeDecodedTile()})).catch((()=>{this.disposed||this.dataSource.isDetached()||this.mapView.visibleTileSet.disposeTile(this)}))}removeDecodedTile(){this.m_decodedTile=void 0,this.invalidateResourceInfo()}updateBoundingBox(e){e?(this.m_boundingBox.copy(e),this.m_worldCenter.copy(this.boundingBox.position)):this.projection.projectBox(this.geoBox,this.boundingBox)}elevateGeoBox(){var e,t;this.geoBox.southWest.altitude=this.m_elevationRange.minElevation+(null!==(e=this.m_minGeometryHeight)&&void 0!==e?e:0),this.geoBox.northEast.altitude=this.m_elevationRange.maxElevation+(null!==(t=this.m_maxGeometryHeight)&&void 0!==t?t:0)}computeResourceInfo(){let e=0,t=0,i=0;const r={heapSize:0,gpuSize:0},n=new Map;for(const e of this.objects)e.visible&&t++,s.Object3DUtils.estimateSize(e,r,n);for(const e of this.textElementGroups.groups)i+=e[1].elements.length;e+=312*i,void 0!==this.m_decodedTile&&void 0!==this.m_decodedTile.tileInfo&&(r.heapSize+=this.m_decodedTile.tileInfo.numBytes),this.m_resourceInfo={heapSize:r.heapSize+e,gpuSize:r.gpuSize,num3dObjects:t,numTextElements:i,numUserTextElements:0}}}},81887:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileObjectRenderer=void 0;const r=i(96500),n=i(45886),o=i(67862),a=i(38125);t.TileObjectRenderer=class{constructor(e,t){this.m_env=e,this.m_renderer=t,this.m_renderOrderStencilValues=new Map,this.m_stencilValue=1}render(e,t,i,r,n){const o=e.computeWorldOffsetX();if(e.willRender(t)){for(const s of e.objects){const l=a.MapObjectAdapter.get(s);this.processTileObject(e,t,i,s,l)&&(this.updateStencilRef(s),s.position.copy(e.center),void 0!==s.displacement&&s.position.add(s.displacement),s.position.x+=o,s.position.sub(r),e.localTangentSpace&&s.setRotationFromMatrix(e.boundingBox.getRotationMatrix()),s.frustumCulled=!1,n.add(s))}e.didRender()}}prepareRender(){this.m_stencilValue=1,this.m_renderOrderStencilValues.clear()}setupRenderer(){const e=(e,t)=>e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.object.userData.tileKey&&t.object.userData.tileKey&&e.object.userData.tileKey.mortonCode()!==t.object.userData.tileKey.mortonCode()?e.object.userData.tileKey.mortonCode()-t.object.userData.tileKey.mortonCode():e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id;this.m_renderer.setOpaqueSort(((t,i)=>{var r,o,s,l;const c=a.MapObjectAdapter.get(t.object),u=a.MapObjectAdapter.get(i.object),d=null===(r=null==c?void 0:c.dataSource)||void 0===r?void 0:r.dataSourceOrder,h=null===(o=null==u?void 0:u.dataSource)||void 0===o?void 0:o.dataSourceOrder;if(void 0!==d&&void 0!==h&&d!==h)return d-h;if(t.renderOrder===n.BackgroundDataSource.GROUND_RENDER_ORDER||i.renderOrder===n.BackgroundDataSource.GROUND_RENDER_ORDER)return e(t,i);if(void 0!==(null==c?void 0:c.level)&&void 0!==(null==u?void 0:u.level)){const r=void 0!==(null===(s=c.kind)||void 0===s?void 0:s.find((e=>"building"===e)))||void 0!==(null===(l=u.kind)||void 0===l?void 0:l.find((e=>"building"===e)));return c.level===u.level||r?e(t,i):c.level-u.level}return e(t,i)}))}updateStencilRef(e){if(void 0!==e.renderOrder&&e instanceof o.SolidLineMesh){const t=e.material;Array.isArray(t)?t.forEach((t=>t.stencilRef=this.getStencilValue(e.renderOrder))):t.stencilRef=this.getStencilValue(e.renderOrder)}}allocateStencilValue(e){const t=this.m_stencilValue++;return this.m_renderOrderStencilValues.set(e,t),t}getStencilValue(e){var t;return null!==(t=this.m_renderOrderStencilValues.get(e))&&void 0!==t?t:this.allocateStencilValue(e)}processTileObject(e,t,i,n,o){return!(!n.visible||!this.processTileObjectFeatures(e,t,i,n)||o&&(o.ensureUpdated(e.mapView),!o.isVisible()&&o.pickability!==r.Pickability.all))}processTileObjectFeatures(e,t,i,n){var o,a;const s=n.userData.technique,l=r.getPropertyValue(null==s?void 0:s.minZoomLevel,this.m_env),c=r.getPropertyValue(null==s?void 0:s.maxZoomLevel,this.m_env);if("number"==typeof l&&i<l)return!1;if("number"==typeof c&&i>=c)return!1;if(void 0===(null==s?void 0:s.enabled))return!0;const u=n.userData.feature;if(!u||!r.Expr.isExpr(s.enabled))return Boolean(r.getPropertyValue(s.enabled,this.m_env));const{starts:d,objInfos:h}=u;if(!Array.isArray(h)||!Array.isArray(d))return!0;const m=n.geometry;if(!m||!m.isBufferGeometry)return!0;const p=null!==(a=null===(o=m.getIndex())||void 0===o?void 0:o.count)&&void 0!==a?a:m.attributes.position.count;let f;return m.clearGroups(),h.forEach(((t,i)=>{var n,o;const a=r.getFeatureId(t);let l=!0;if(r.Expr.isExpr(s.enabled)){const i=e.dataSource.getFeatureState(a),n=i?new r.MapEnv(i):null,o="object"==typeof t?new r.MapEnv(t,this.m_env):this.m_env,c=new r.MapEnv({$state:n},o);l=Boolean(r.getPropertyValue(s.enabled,c))}if(!l)return;const c=null!==(n=d[i])&&void 0!==n?n:0,u=(null!==(o=d[i+1])&&void 0!==o?o:p)-c;c===f?m.groups[m.groups.length-1].count+=u:m.addGroup(c,u),f=c+u})),m.groups.length>0}}},83829:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileOffsetUtils=t.MapViewUtils=void 0;const r=i(32941),n=i(459),o=i(38338),a=i(84428),s=i(81621),l=i(63978),c=o.LoggerManager.instance.create("MapViewUtils"),u=new a.Vector3(0,0,1),d=new a.Plane(u.clone()),h=new a.Sphere(void 0,n.EarthConstants.EQUATORIAL_RADIUS),m=new a.Raycaster,p={x:new a.Vector3,y:new a.Vector3,z:new a.Vector3},f={x:new a.Vector3,y:new a.Vector3,z:new a.Vector3},g={box3:[new a.Box3],obox3:[new r.OrientedBox3],quaternions:[new a.Quaternion,new a.Quaternion],vector2:[new a.Vector2,new a.Vector2],vector3:[new a.Vector3,new a.Vector3,new a.Vector3,new a.Vector3],matrix4:[new a.Matrix4,new a.Matrix4],transforms:[{xAxis:new a.Vector3,yAxis:new a.Vector3,zAxis:new a.Vector3,position:new a.Vector3}]},y=new a.PerspectiveCamera;var v;!function(e){function t(t,i,n,o,l,u){var d,h,m;const p=s.CameraUtils.getPrincipalPoint(t.camera,g.vector2[0]),f=e.rayCastWorldCoordinates(t,p.x,p.y);if(null===f)return;let y;if("number"==typeof i)y=g.vector2[1].set(i,n);else{const e=i;y=null!==(d=e.center)&&void 0!==d?d:p,o=null!==(h=e.deltaAzimuth)&&void 0!==h?h:0,l=null!==(m=e.deltaTilt)&&void 0!==m?m:0,u=e.maxTiltAngle}const v=y.x===p.x&&y.y===p.y?f:e.rayCastWorldCoordinates(t,y.x,y.y);if(null===v)return;!function(e,t,i){const r=e.camera,n=e.projection.surfaceNormal(t,g.vector3[0]),o=g.quaternions[0].setFromAxisAngle(n,i);r.quaternion.premultiply(o),r.position.sub(t),r.position.applyQuaternion(o),r.position.add(t)}(t,v,-o);const _=new a.Vector3(1,0,0).applyQuaternion(t.camera.quaternion);!function(t,i,r,n){const o=t.camera,a=o.position.clone(),s=o.quaternion.clone(),l=g.quaternions[0].setFromAxisAngle(n,r);o.quaternion.premultiply(l),o.position.sub(i),o.position.applyQuaternion(l),o.position.add(i),null===e.rayCastWorldCoordinates(t,0,0)&&(c.warn("Target got invalidated during rotation."),o.position.copy(a),o.quaternion.copy(s))}(t,v,function(e,t,i,n,o,s,l){const c=e.camera,u=e.projection,d=P(u,c,o,l);if(d+i<0)return-d;if(i<=0)return i;if(o.equals(s)||t<0)return r.MathUtils.clamp(i+d,0,n)-d;const h=P(u,c,s,l),m=a.MathUtils.degToRad(89);if(h>m)return 0;let p=0;if(u===r.sphereProjection){const e=u.surfaceNormal(s,g.vector3[0]).projectOnPlane(l).normalize(),t=u.surfaceNormal(o,g.vector3[1]);p=e.angleTo(t)}const f=a.MathUtils.degToRad(90),y=f+p-(2*f-(2*f-(f+p-h+(f+d)))-f-n);return r.MathUtils.clamp(i+h,0,Math.min(y,m))-h}(t,y.y-p.y,l,u,f,v,_),_)}function i(e,t,i){const o=g.vector3[0].copy(e.position),s=e.getWorldDirection(g.vector3[1]);m.set(o,s),void 0!==i&&(d.constant-=i,h.radius+=i);const l=new a.Vector3,c=t.type===r.ProjectionType.Planar?m.ray.intersectPlane(d,l):m.ray.intersectSphere(h,l);return void 0!==i&&(d.constant=0,h.radius=n.EarthConstants.EQUATORIAL_RADIUS),c}function u(t,i,n){const o={target:t,distance:i},l=n.worldMaxBounds,c=n.camera,u=n.projection;if(!l)return o;const d=l.getSize(g.vector3[1]),h=n.renderer.getSize(g.vector2[0]),m=s.CameraUtils.convertScreenToWorldSize(n.focalLength,o.distance,h.height),p=m*c.aspect,f=Math.max(p/d.x,m/d.y),y=new a.Vector3(p/2,m/2,0),v={target:o.target.clone(),distance:o.distance};if(u.type===r.ProjectionType.Planar){if(f>1)v.distance/=f,c.getWorldDirection(c.position).multiplyScalar(-v.distance).add(l.getCenter(v.target));else{if(g.box3[0].copy(l).expandByVector(y.multiplyScalar(-1)).clampPoint(o.target,v.target).setZ(o.target.z),v.target.equals(o.target))return o;c.position.x+=v.target.x-o.target.x,c.position.y+=v.target.y-o.target.y}return v}if(f>1)l.getCenter(v.target),v.target.setLength(o.target.length()),v.distance/=f;else{const e=g.obox3[0];e.copy(l),e.position.setLength(o.target.length()),e.extents.sub(y);const t=e.getRotationMatrix(g.matrix4[0]),i=g.vector3[1].copy(v.target).sub(e.position).applyMatrix4(g.matrix4[1].copy(t).transpose()).setZ(0),r=g.vector3[2].copy(i).clamp(g.vector3[3].copy(e.extents).multiplyScalar(-1),e.extents);if(r.equals(i))return o;v.target.copy(r).applyMatrix4(t).add(e.position);const n=e.position.lengthSq(),a=v.target.distanceToSquared(e.position),s=Math.sqrt(n)-Math.sqrt(n-a);v.target.addScaledVector(e.zAxis,-s),v.target.setLength(o.target.length())}return e.panCameraAroundGlobe(n,g.vector3[1].copy(v.target),g.vector3[2].copy(o.target)),c.getWorldDirection(c.position).multiplyScalar(-v.distance).add(v.target),v}function v(e,t,i,o,s,l=new a.Vector3){const c=a.MathUtils.degToRad(o),u=Math.cos(c)*t,d=a.MathUtils.degToRad(i);s.projectPoint(e,l);const h=t*Math.sin(c);if(s.type===r.ProjectionType.Planar)l.x=l.x+Math.sin(d)*h,l.y=l.y-Math.cos(d)*h,l.z=l.z+u;else if(s.type===r.ProjectionType.Spherical){f.z.copy(l).normalize(),f.y.set(0,0,1).projectOnPlane(f.z).normalize(),g.quaternions[0].setFromAxisAngle(f.z,d-Math.PI),f.y.applyQuaternion(g.quaternions[0]),f.y.setLength(h);const e=t*Math.cos(c);l.add(f.y).add(f.z.setLength(e));const i=n.EarthConstants.EQUATORIAL_RADIUS+u,r=Math.sin(c)*t,o=Math.sqrt(i*i+r*r);l.setLength(o)}return l}function _(e,t){const i=t.clone().normalize();for(const r of e)if(r.angleTo(t)>Math.PI/2){const e=r.length();r.projectOnPlane(i).setLength(e)}}function b(e,t,i){const r=g.vector3[0].copy(t).sub(i.position).length(),n=s.CameraUtils.getPrincipalPoint(i);let o=r;const a=(e,t)=>Math.abs(e)>1?Math.abs((e-t)/(.99*Math.sign(e)-t)):1;for(const t of e){const e=-g.vector3[0].copy(t).applyMatrix4(i.matrixWorldInverse).z,s=g.vector3[0].applyMatrix4(i.projectionMatrix),l=Math.max(a(s.x,n.x),a(s.y,n.y));if(l>1){const t=r-e,i=Math.abs(e)*l+t;o=Math.max(o,i)}}return o}function S(e,t,i,o){const s=g.vector3[0].set(t,i,0);e.camera.updateMatrixWorld();const l=g.vector3[1].copy(e.camera.position);g.matrix4[0].extractRotation(e.camera.matrixWorld),g.matrix4[1].multiplyMatrices(g.matrix4[0],g.matrix4[1].copy(e.camera.projectionMatrix).invert());const c=s.applyMatrix4(g.matrix4[1]);m.set(l,c.normalize()),void 0!==o&&(d.constant-=o,h.radius+=o);const u=new a.Vector3,p=e.projection.type===r.ProjectionType.Planar?m.ray.intersectPlane(d,u):m.ray.intersectSphere(h,u);return void 0!==o&&(d.constant=0,h.radius=n.EarthConstants.EQUATORIAL_RADIUS),p}function T(e,t,i){e.camera.position.x+=t,e.camera.position.y+=i}function E(e,t,i){g.quaternions[0].setFromUnitVectors(t.normalize(),i.normalize()).invert(),g.matrix4[0].makeRotationFromQuaternion(g.quaternions[0]),e.camera.applyMatrix4(g.matrix4[0]),e.camera.updateMatrixWorld()}function C(e,t,i,r,n=new a.Quaternion){const o=g.transforms[0];return e.localTangentSpace(t,o),g.matrix4[0].makeBasis(o.xAxis,o.yAxis,o.zAxis),n.setFromRotationMatrix(g.matrix4[0]),g.quaternions[0].setFromAxisAngle(g.vector3[1].set(0,0,1),a.MathUtils.degToRad(i)),g.quaternions[1].setFromAxisAngle(g.vector3[1].set(1,0,0),a.MathUtils.degToRad(r)),n.multiply(g.quaternions[0]),n.multiply(g.quaternions[1]),n}function w(t,i){if(i.type===r.ProjectionType.Planar){const e=t.getWorldDirection(g.vector3[0]).normalize(),r=i.surfaceNormal(t.position,g.vector3[1]).negate(),n=e.dot(r);return Math.acos(a.MathUtils.clamp(n,-1,1))}{o.assert(i.type===r.ProjectionType.Spherical);const n=e.getGeoTargetFromCamera(t,i);return null!==n?e.extractTiltAngleFromLocation(i,t,n):(c.warn("MapView camera is pointing in the void, using maxTilt: ",e.MAX_TILT_RAD),e.MAX_TILT_RAD)}}function x(e,t){g.vector3[1].setFromMatrixPosition(t.matrixWorld),e.projection.localTangentSpace(g.vector3[1],{xAxis:f.x,yAxis:f.y,zAxis:f.z,position:g.vector3[0]}),g.matrix4[1].makeBasis(f.x,f.y,f.z),g.matrix4[0].copy(g.matrix4[1]).invert().multiply(t.matrixWorld),p.x.setFromMatrixColumn(g.matrix4[0],0),p.y.setFromMatrixColumn(g.matrix4[0],1),p.z.setFromMatrixColumn(g.matrix4[0],2);let i=0,r=0,n=0;const o=p.z.dot(g.vector3[1].set(0,0,1));return o<1-Number.EPSILON?o>-1+Number.EPSILON?(i=Math.atan2(p.z.x,-p.z.y),r=Math.acos(p.z.z),n=Math.atan2(p.x.z,p.y.z)):(i=-Math.atan2(-p.y.x,p.x.x),r=180,n=0):(i=Math.atan2(-p.y.x,p.x.x),r=0,n=0),{yaw:i,pitch:r,roll:n}}function P(e,t,i,r){e.localTangentSpace(i,{xAxis:f.x,yAxis:f.y,zAxis:f.z,position:g.vector3[0]});const n=g.vector3[2].copy(t.position).sub(g.vector3[0]);r&&(n.projectOnPlane(r),f.z.projectOnPlane(r).normalize());const o=n.length();if(o<1e-5)return c.error("Can not calculate tilt for the zero length vector!"),0;n.divideScalar(o);const s=n.dot(f.z);return s>=1-Number.EPSILON?0:Math.acos(a.MathUtils.clamp(s,-1,1))}function O(e,t){const i=n.EarthConstants.EQUATORIAL_CIRCUMFERENCE/Math.pow(2,t);return e.focalLength*i/256}e.MAX_TILT_DEG=89,e.MAX_TILT_RAD=e.MAX_TILT_DEG*a.MathUtils.DEG2RAD,e.zoomOnTargetPosition=function(i,n,o,a,s=e.MAX_TILT_RAD){const{elevationProvider:l,camera:c,projection:d}=i,h=l?l.getHeight(d.unprojectPoint(c.position),4):void 0,m=S(i,n,o,h),p=e.getTargetAndDistance(d,c,l).target,f=O(i,a);if(i.geoMaxBounds&&u(p,f,i).distance!==f)return a>=i.zoomLevel;if(c.getWorldDirection(c.position).multiplyScalar(-f).add(p),d.type===r.ProjectionType.Spherical){const e=w(c,d)-s;e>0&&t(i,{deltaTilt:e,maxTiltAngle:s})}const g=S(i,n,o,h);return!m||!g||(d.type===r.ProjectionType.Planar?(m.sub(g),T(i,m.x,m.y)):d.type===r.ProjectionType.Spherical&&E(i,m,g),!0)},e.orbitAroundScreenPoint=t,e.getGeoTargetFromCamera=function(e,t,r){const n=i(e,t,r);return null!==n?t.unprojectPoint(n):null},e.getWorldTargetFromCamera=i,e.constrainTargetAndDistanceToViewBounds=u,e.getTargetAndDistance=function(t,o,a){const s=x({projection:t},o).pitch,l=a?a.getHeight(t.unprojectPoint(o.position),4):void 0,c=!a||void 0!==l,u=s<e.MAX_TILT_RAD?i(o,t,l):null;if(null!==u)return{target:u,distance:o.position.distanceTo(u),final:c};{const i=t.groundDistance(o.position),a=Math.max(i-(null!=l?l:0),0),u=t.type===r.ProjectionType.Planar?a/Math.cos(Math.min(s,e.MAX_TILT_RAD)):Math.sqrt(Math.pow(a+n.EarthConstants.EQUATORIAL_RADIUS,2)-Math.pow(n.EarthConstants.EQUATORIAL_RADIUS,2)),d=o.getWorldDirection(g.vector3[0]);d.multiplyScalar(u);const h=g.vector3[1];return h.copy(o.position).add(d),{target:h,distance:u,final:c}}},e.getCameraPositionFromTargetCoordinates=v,e.wrapGeoPointsToScreen=function(e,t){let i=0;void 0===t&&(t=r.GeoCoordinates.fromObject(e[0]),i=1);let n=t.latitude,o=t.latitude,a=r.MathUtils.normalizeLongitudeDeg(t.longitude),s=0,l=t.longitude,c=t.longitude;const u=[];u.push(new r.GeoCoordinates(n,a));for(let t=i;t<e.length;t++){const i=r.GeoCoordinates.fromObject(e[t]);i.latitude>n?n=i.latitude:i.latitude<o&&(o=i.latitude);let d=r.MathUtils.normalizeLongitudeDeg(i.longitude);const h=r.MathUtils.angleDistanceDeg(a,d);d=a-h,h<0&&-h>s/2?(l=Math.max(l,a-h),s=l-c,a=(l+c)/2):h>0&&h>s/2&&(c=Math.min(c,d),s=l-c,a=(l+c)/2),u.push(new r.GeoCoordinates(i.latitude,d))}return u},e.wrapWorldPointsToView=_,e.geoBoxToGeoPoints=function(e){const t=e.center;return[new r.GeoCoordinates(e.north,e.west),new r.GeoCoordinates(e.north,e.east),new r.GeoCoordinates(t.latitude,e.west),new r.GeoCoordinates(t.latitude,e.east),new r.GeoCoordinates(e.south,e.west),new r.GeoCoordinates(e.south,e.east),new r.GeoCoordinates(e.north,t.longitude),new r.GeoCoordinates(e.south,t.longitude)]},e.getFitBoundsDistance=b,e.getFitBoundsLookAtParams=function(e,t,i,n){const{tilt:o,heading:a,projection:s}=n,l=n.minDistance,c=n.camera.clone();return C(s,e,-a,o,c.quaternion),v(e,l,-a,o,s,c.position),c.updateMatrixWorld(!0),s.type===r.ProjectionType.Spherical&&_(i,c.position),{target:e,distance:b(i,t,c),heading:a,tilt:o}},e.getCameraCoordinatesFromTargetCoordinates=function(e,t,i,r,n){return n.projection.unprojectPoint(v(e,t,i,r,n.projection,g.vector3[1]))},e.rayCastWorldCoordinates=S,e.panCameraAboveFlatMap=T,e.panCameraAroundGlobe=E,e.rotate=function(t,i,o=0,s=Math.PI/4){if(t.camera.rotateOnWorldAxis(t.projection.type===r.ProjectionType.Spherical?g.vector3[0].copy(t.camera.position).normalize():g.vector3[0].set(0,0,1),a.MathUtils.degToRad(-i)),t.camera.updateMatrixWorld(),0===o)return;const l=e.extractAttitude(t,t.camera).pitch;let c=a.MathUtils.clamp(l+a.MathUtils.degToRad(o),0,s);if(t.projection.type===r.ProjectionType.Spherical){const e=Math.asin(n.EarthConstants.EQUATORIAL_RADIUS*Math.sin(Math.PI-s)/t.camera.position.length());c=Math.min(c,e)}t.camera.rotateX(c-l)},e.getCameraRotationAtTarget=C,e.setRotation=function(e,t,i){C(e.projection,e.geoCenter,t,i,e.camera.quaternion)},e.extractCameraTilt=w,e.extractAttitude=x,e.extractSphericalCoordinatesFromLocation=function(e,t,i){e.projection.localTangentSpace(i,{xAxis:f.x,yAxis:f.y,zAxis:f.z,position:g.vector3[0]});let r=0,n=0;return g.vector3[1].copy(t.position).sub(g.vector3[0]).normalize(),g.vector3[1].dot(f.z)>1-Number.EPSILON?(n=Math.PI-x(e,t).yaw,n=Math.atan2(Math.sin(n),Math.cos(n)),r=0,{tilt:r,azimuth:n}):(r=g.vector3[1].angleTo(f.z),g.vector3[1].copy(t.position).sub(g.vector3[0]).projectOnPlane(f.z).normalize(),n=g.vector3[1].angleTo(f.y),g.vector3[1].cross(f.y).dot(f.z)<0&&(n=-n),{tilt:r,azimuth:n})},e.extractTiltAngleFromLocation=P,e.getCameraFrustumPlanes=function(e){const t=e.near,i=e.far;let r=t*Math.tan(a.MathUtils.degToRad(.5*e.fov))/e.zoom,n=2*r,o=e.aspect*n,s=-.5*o;const l=e.view;if(null!==l&&l.enabled){const e=l.fullWidth,t=l.fullHeight;s+=l.offsetX*o/e,r-=l.offsetY*n/t,o*=l.width/e,n*=l.height/t}return s+=0!==e.filmOffset?t*e.filmOffset/e.getFilmWidth():0,{left:s,right:s+o,top:r,bottom:r-n,near:t,far:i}},e.rayCastGeoCoordinates=function(e,t,i){const r=S(e,t,i);return r?e.projection.unprojectPoint(r):null},e.calculateDistanceToGroundFromZoomLevel=function(e,t){const i=x(e,e.camera).pitch,r=n.EarthConstants.EQUATORIAL_CIRCUMFERENCE/Math.pow(2,t);return e.focalLength*r/256*Math.cos(i)},e.calculateDistanceFromZoomLevel=O,e.calculateZoomLevelFromDistance=function(e,t){const i=256*t/e.focalLength;return function(e){const t=Math.ceil(e);return t-e<1e-6?t:e}(a.MathUtils.clamp(Math.log2(n.EarthConstants.EQUATORIAL_CIRCUMFERENCE/i),e.minZoomLevel,e.maxZoomLevel))},e.calculateDepthFromClipDistance=function(e,t){const i=t,r=i.far-i.near,n=e*i.far;return(1-i.near/n)*(i.far/r)},e.cameraToWorldDistance=function(e,t){return e*t.far},e.calculateVerticalFovByHorizontalFov=function(e,t){return 2*Math.atan(Math.tan(e/2)/t)},e.calculateHorizontalFovByVerticalFov=function(e,t){return y.fov=a.MathUtils.radToDeg(e),y.aspect=t,s.CameraUtils.getHorizontalFov(y)},e.calculateFocalLengthByVerticalFov=function(e,t){return s.CameraUtils.setPrincipalPoint(y,new a.Vector2),s.CameraUtils.setVerticalFov(y,e,t),s.CameraUtils.getFocalLength(y)},e.calculateFovByFocalLength=function(e,t){return s.CameraUtils.setPrincipalPoint(y,new a.Vector2),s.CameraUtils.setFocalLength(y,e,t),y.fov},e.calculateScreenSizeByFocalLength=s.CameraUtils.convertWorldToScreenSize,e.calculateWorldSizeByFocalLength=s.CameraUtils.convertScreenToWorldSize,e.estimateObject3dSize=l.Object3DUtils.estimateSize,e.mapViewIsLoading=function(e){let t=0;for(const i of e.visibleTileSet.dataSourceTileList){t+=i.numTilesLoading;for(const e of i.visibleTiles)e.allGeometryLoaded||t++}let i=t>0;return void 0!==e.textElementsRenderer&&(i=i||e.textElementsRenderer.loading),i=i||!e.poiTableManager.finishedLoading||!e.visibleTileSet.allVisibleTilesLoaded,i},e.closeToFrustum=function(e,t,i=1e-13){const r=(new a.Vector3).copy(e).project(t);return Math.abs(r.x)-i<1&&Math.abs(r.y)-i<1&&Math.abs(r.z)-i<1},e.getBrowserLanguages=o.DOMUtils.getBrowserLanguages}(t.MapViewUtils||(t.MapViewUtils={})),(v=t.TileOffsetUtils||(t.TileOffsetUtils={})).getKeyForTileKeyAndOffset=r.TileKeyUtils.getKeyForTileKeyAndOffset,v.extractOffsetAndMortonKeyFromKey=r.TileKeyUtils.extractOffsetAndMortonKeyFromKey,v.getParentKeyFromKey=r.TileKeyUtils.getParentKeyFromKey},96393:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisibleTileSet=t.ResourceComputationType=void 0;const r=i(32941),n=i(45772),o=i(38338),a=i(84428),s=i(45886),l=i(56870),c=i(17624);var u,d;!function(e){e[e.EstimationInMb=0]="EstimationInMb",e[e.NumberOfTiles=1]="NumberOfTiles"}(u=t.ResourceComputationType||(t.ResourceComputationType={})),function(e){e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.BOTH=3]="BOTH"}(d||(d={}));const h=1/1048576;class m{constructor(e,t=u.EstimationInMb){this.m_disposedTiles=[],this.m_resourceComputationType=t,this.m_tileCache=new n.LRUCache(e,(e=>this.m_resourceComputationType===u.EstimationInMb?e.memoryUsage*h:1)),this.m_tileCache.evictionCallback=(e,t)=>{void 0!==t.tileLoader&&t.tileLoader.cancel(),this.m_disposedTiles.push(t)},this.m_tileCache.canEvict=(e,t)=>!t.isVisible}static getKey(e,t,i){return`${i.name}_${e}_${t}`}static getKeyForTile(e){return m.getKey(e.tileKey.mortonCode(),e.offset,e.dataSource)}get resourceComputationType(){return this.m_resourceComputationType}get capacity(){return this.m_tileCache.capacity}get size(){return this.m_tileCache.size}setCapacity(e,t){this.m_resourceComputationType=t,this.m_tileCache.setCapacityAndMeasure(e,(e=>this.m_resourceComputationType===u.EstimationInMb?e.memoryUsage*h:1))}get(e,t,i){return this.m_tileCache.get(m.getKey(e,t,i))}set(e,t,i,r){this.m_tileCache.set(m.getKey(e,t,i),r)}delete(e){const t=m.getKeyForTile(e);this.deleteByKey(t)}deleteByKey(e){this.m_tileCache.delete(e)}disposeTiles(){this.m_disposedTiles.forEach((e=>{e.dispose()})),this.m_disposedTiles.length=0}shrinkToCapacity(){this.m_tileCache.shrinkToCapacity()}evictAll(){this.m_tileCache.evictAll()}evictSelected(e){this.m_tileCache.evictSelected(e)}forEach(e,t){this.m_tileCache.forEach(((i,r)=>{void 0!==t&&i.dataSource!==t||e(i,r)}))}}const p=(e,t)=>{const i=e.distance-t.distance,r=1e-6*(e.distance+t.distance);return Math.abs(i)<r?e.tileKey.mortonCode()-t.tileKey.mortonCode():i};t.VisibleTileSet=class{constructor(e,t,i,r){var n;this.m_frustumIntersection=e,this.m_tileGeometryManager=t,this.options=i,this.m_taskQueue=r,this.dataSourceTileList=[],this.allVisibleTilesLoaded=!1,this.m_cameraOverride=new a.PerspectiveCamera,this.m_viewRange={near:.1,far:1/0,minimum:.1,maximum:1/0},this.m_coveringMap=new Map,this.m_resourceComputationType=u.EstimationInMb,this.options=i,this.options.maxTilesPerFrame=Math.floor(null!==(n=this.options.maxTilesPerFrame)&&void 0!==n?n:0),this.m_resourceComputationType=void 0===i.resourceComputationType?u.EstimationInMb:i.resourceComputationType,this.m_dataSourceCache=new m(this.options.tileCacheSize,this.m_resourceComputationType)}getDataSourceCacheSize(){return this.options.tileCacheSize}setDataSourceCacheSize(e,t=u.EstimationInMb){this.options.tileCacheSize=e,this.resourceComputationType=t}getNumberOfVisibleTiles(){return this.options.maxVisibleDataSourceTiles}setNumberOfVisibleTiles(e){this.options.maxVisibleDataSourceTiles=e}get maxTilesPerFrame(){return this.options.maxTilesPerFrame}set maxTilesPerFrame(e){if(e<0)throw new Error("Invalid value, this will result in no tiles ever showing");this.options.maxTilesPerFrame=Math.floor(e)}get resourceComputationType(){return this.m_resourceComputationType}set resourceComputationType(e){this.m_resourceComputationType=e,this.m_dataSourceCache.setCapacity(this.options.tileCacheSize,e)}updateClipPlanes(e,t){void 0!==e&&(this.options.clipPlanesEvaluator.maxElevation=e),void 0!==t&&(this.options.clipPlanesEvaluator.minElevation=t);const{camera:i,projection:r,elevationProvider:n}=this.m_frustumIntersection.mapView;return this.m_viewRange=this.options.clipPlanesEvaluator.evaluateClipPlanes(i,r,n),this.m_viewRange}updateRenderList(e,t,i,r,n){let a=!0;const s=this.getVisibleTileKeysForDataSources(t,i,n);this.dataSourceTileList=[],this.m_coveringMap.clear();for(const{dataSource:i,visibleTileKeys:n}of s.tileKeys){n.sort(p);const o=i.getDataZoomLevel(t),s=this.processVisibleTiles(n,i,r,{newTilesPerFrame:0},!0),l=this.processVisibleTiles(s.dependentTiles,i,r,{newTilesPerFrame:0},!1);this.m_tileGeometryManager.updateTiles(s.visibleTiles),this.m_tileGeometryManager.updateTiles(l.visibleTiles),this.dataSourceTileList.push({dataSource:i,storageLevel:e,zoomLevel:o,allVisibleTileLoaded:s.allDataSourceTilesLoaded&&l.allDataSourceTilesLoaded,numTilesLoading:s.numTilesLoading+l.numTilesLoading,visibleTiles:[...s.visibleTiles,...l.visibleTiles],renderedTiles:new Map}),a=a&&s.allDataSourceTilesLoaded}let l,c;this.allVisibleTilesLoaded=a&&s.allBoundingBoxesFinal,this.populateRenderedTiles(),this.forEachCachedTile((e=>{e.isVisible||e.allGeometryLoaded||this.disposeTile(e)})),this.m_dataSourceCache.shrinkToCapacity(),this.dataSourceTileList.forEach((e=>{e.renderedTiles.forEach((t=>{t.update(e.zoomLevel),l=o.MathUtils.min2(l,t.geoBox.minAltitude),c=o.MathUtils.max2(c,t.geoBox.maxAltitude)}))})),void 0===l&&(l=0),void 0===c&&(c=0);let u=!1;const d=this.m_viewRange,h=this.updateClipPlanes(c,l);var m,f;return u=0==(f=d,(m=h).far===f.far&&m.maximum===f.maximum&&m.minimum===f.minimum&&m.near===f.near),{viewRanges:h,viewRangesChanged:u}}getTile(e,t,i,r){return this.getTileImpl(e,t,i,!1,r)}getCachedTile(e,t,i,r){return o.assert(e.cacheable),this.getTileImpl(e,t,i,!0,r)}getRenderedTile(e,t,i=0){const n=this.dataSourceTileList.find((t=>t.dataSource===e));if(void 0!==n)return n.renderedTiles.get(r.TileKeyUtils.getKeyForTileKeyAndOffset(t,i))}getRenderedTileAtLocation(e,t,i=0){const n=this.dataSourceTileList.find((t=>t.dataSource===e));if(void 0===n)return;const o=e.getTilingScheme(),a=n.zoomLevel,s=o.getTileKey(t,a);if(!s)return;let l=n.renderedTiles.get(r.TileKeyUtils.getKeyForTileKeyAndOffset(s,i));if(void 0!==l)return l;const{searchLevelsUp:c,searchLevelsDown:u}=this.getSearchDirection(e,a);let d=s;for(let e=1;e<=c;++e)if(d=d.parent(),l=n.renderedTiles.get(r.TileKeyUtils.getKeyForTileKeyAndOffset(d,i)),void 0!==l)return l;const h=o.projection.projectPoint(t);for(let e=1;e<=u;++e){const t=a+e,s=r.TileKeyUtils.worldCoordinatesToTileKey(o,h,t);if(s&&(l=n.renderedTiles.get(r.TileKeyUtils.getKeyForTileKeyAndOffset(s,i)),void 0!==l))return l}}removeDataSource(e){this.clearTileCache(e),this.dataSourceTileList=this.dataSourceTileList.filter((t=>t.dataSource!==e))}clearTileCache(e,t){void 0!==e?this.m_dataSourceCache.evictSelected(((i,r)=>i.dataSource===e&&(void 0===t||t(i)))):void 0!==t?this.m_dataSourceCache.evictSelected(t):this.m_dataSourceCache.evictAll()}markTilesDirty(e,t){if(void 0===e)this.dataSourceTileList.forEach((e=>{this.markDataSourceTilesDirty(e,t)}));else{const i=this.dataSourceTileList.find((t=>t.dataSource===e));if(void 0===i)return;this.markDataSourceTilesDirty(i,t)}}disposePendingTiles(){this.m_dataSourceCache.disposeTiles()}forEachVisibleTile(e){for(const t of this.dataSourceTileList)t.renderedTiles.forEach(e)}forEachCachedTile(e,t){this.m_dataSourceCache.forEach(((t,i)=>e(t)),t)}disposeTile(e){this.m_dataSourceCache.delete(e),e.dispose()}processVisibleTiles(e,t,i,r,n){var o;let a=!0,s=0;const c=[],u=[];for(let d=0;d<e.length&&c.length<this.options.maxVisibleDataSourceTiles;d++){const h=e[d],m=this.getTile(t,h.tileKey,h.offset,i);if(void 0!==m&&(c.push(m),a=a&&m.allGeometryLoaded,m.allGeometryLoaded?(this.skipOverlappedTiles(t,m),this.processDelayTileRendering(m,r.newTilesPerFrame,i)&&r.newTilesPerFrame++):s++,m.visibleArea=h.area,m.elevationRange=null!==(o=h.elevationRange)&&void 0!==o?o:{minElevation:0,maxElevation:0},n))for(const t of m.dependencies)void 0===e.find((e=>e.tileKey.mortonCode()===t.mortonCode()))&&void 0===u.find((e=>e.tileKey.mortonCode()===t.mortonCode()))&&u.push(new l.TileKeyEntry(t,0))}return{allDataSourceTilesLoaded:a,numTilesLoading:s,visibleTiles:c,dependentTiles:u}}processDelayTileRendering(e,t,i){let r=!1;return 0!==this.options.maxTilesPerFrame&&t>this.options.maxTilesPerFrame&&e.frameNumLastVisible!==i-1?(e.delayRendering=!0,e.mapView.update()):(e.frameNumVisible<0&&(e.frameNumVisible=i,r=!0),e.numFramesVisible++,e.delayRendering=!1),r}skipOverlappedTiles(e,t){if(this.options.projection.type!==r.ProjectionType.Spherical&&e.isFullyCovering()){const i=t.uniqueKey,r=this.m_coveringMap.get(i);void 0===r?(t.skipRendering=!1,this.m_coveringMap.set(i,t)):r.dataSource instanceof s.BackgroundDataSource?r.skipRendering=!0:e instanceof s.BackgroundDataSource&&(t.skipRendering=!0)}}getSearchDirection(e,t){const i=Math.min(this.options.quadTreeSearchDistanceUp,Math.max(0,t-e.minDataLevel)),r=Math.min(this.options.quadTreeSearchDistanceDown,Math.max(0,e.maxDataLevel-t));return{searchDirection:r>0&&i>0?d.BOTH:r>0?d.DOWN:i>0?d.UP:d.NONE,searchLevelsUp:i,searchLevelsDown:r}}populateRenderedTiles(){this.dataSourceTileList.forEach((e=>{const t=e.renderedTiles,i=[];e.visibleTiles.forEach((e=>{e.levelOffset=0,e.hasGeometry&&!e.delayRendering?t.set(e.uniqueKey,e):i.push(e.uniqueKey)}));const r=e.dataSource;if(0===i.length||!1===r.allowOverlappingTiles)return;const n=e.zoomLevel,{searchDirection:o}=this.getSearchDirection(r,n),a=new Map;for(const e of i)(o!==d.BOTH&&o!==d.UP||!this.findUp(e,n,t,a,r))&&(o!==d.BOTH&&o!==d.DOWN||this.findDown(e,n,t,r))}))}findDown(e,t,i,n){const{offset:o,mortonCode:a}=r.TileKeyUtils.extractOffsetAndMortonKeyFromKey(e),s=r.TileKey.fromMortonCode(a),l=n.getTilingScheme();for(const e of l.getSubTileKeys(s)){const a=r.TileKeyUtils.getKeyForTileKeyAndOffset(e,o),s=this.m_dataSourceCache.get(e.mortonCode(),o,n),l=Math.abs(e.level-t);void 0===s||!s.hasGeometry||s.delayRendering?l<this.options.quadTreeSearchDistanceDown&&this.findDown(a,t,i,n):(i.set(a,s),s.levelOffset=l)}}findUp(e,t,i,n,o){const a=r.TileKeyUtils.getParentKeyFromKey(e);if(void 0!==i.get(a))return!0;const s=n.get(a);if(void 0!==s)return s;const{offset:l,mortonCode:c}=r.TileKeyUtils.extractOffsetAndMortonKeyFromKey(a),u=this.m_dataSourceCache.get(c,l,o),d=u?u.tileKey:r.TileKey.fromMortonCode(c),h=Math.abs(t-d.level);if(void 0!==u&&u.hasGeometry&&!u.delayRendering)return n.set(a,!0),i.set(a,u),u.levelOffset=-h,!0;if(n.set(a,!1),h<this.options.quadTreeSearchDistanceUp&&0!==d.level){const e=this.findUp(a,t,i,n,o);if(n.set(a,e),e)return!0}return!1}getTileImpl(e,t,i,r,n){function o(e){e.frameNumLastRequested=n}if(!e.cacheable&&!r){const i=e.getTile(t,!0);return void 0!==i&&(this.addToTaskQueue(i),o(i)),i}const a=this.m_dataSourceCache;let s=a.get(t.mortonCode(),i,e);return void 0!==s&&s.offset===i?(o(s),s):r?void 0:(s=e.getTile(t,!0),void 0!==s&&(this.addToTaskQueue(s),s.offset=i,o(s),a.set(t.mortonCode(),i,e,s)),s)}addToTaskQueue(e){this.m_taskQueue.add({execute:e.load.bind(e),group:c.TileTaskGroups.FETCH_AND_DECODE,getPriority:()=>{var t,i;return null!==(i=null===(t=null==e?void 0:e.tileLoader)||void 0===t?void 0:t.priority)&&void 0!==i?i:0},isExpired:()=>!(null==e?void 0:e.isVisible),estimatedProcessTime:()=>1})}markDataSourceTilesDirty(e,t){const i=this.m_dataSourceCache,r=new Set,n=e=>{var t;const i=m.getKeyForTile(e);r.has(i)||(r.add(i),null===(t=e.tileLoader)||void 0===t||t.cancel(),this.addToTaskQueue(e))};e.visibleTiles.forEach((e=>{(void 0===t||t(e))&&n(e)})),e.renderedTiles.forEach((e=>{(void 0===t||t(e))&&n(e)})),i.forEach(((e,n)=>{void 0!==t&&!t(e)||r.has(n)||(i.deleteByKey(n),e.dispose())}),e.dataSource)}getVisibleTileKeysForDataSources(e,t,i){const r=Array();let n=!0;if(0===t.length)return{tileKeys:r,allBoundingBoxesFinal:n};const o=new Map;t.forEach((e=>{const t=e.getTilingScheme(),i=o.get(t);void 0===i?o.set(t,[e]):i.push(e)})),void 0!==i?(this.m_cameraOverride.copy(this.m_frustumIntersection.camera),this.m_cameraOverride.near=Math.min(this.m_cameraOverride.near,this.m_viewRange.minimum),this.m_cameraOverride.far=Math.max(this.m_cameraOverride.far,this.m_viewRange.maximum),this.m_cameraOverride.updateProjectionMatrix(),this.m_frustumIntersection.updateFrustum(this.m_cameraOverride.projectionMatrix)):this.m_frustumIntersection.updateFrustum();for(const[t,a]of o){const o=a.map((t=>t.getDataZoomLevel(e))),s=this.m_frustumIntersection.compute(t,i,o,a);n=n&&s.calculationFinal;for(const t of a){const i=[],n=t.getDataZoomLevel(e);for(const e of s.tileKeyEntries.get(n).values())t.canGetTile(n,e.tileKey)&&i.push(e);r.push({dataSource:t,visibleTileKeys:i})}}return{tileKeys:r,allBoundingBoxesFinal:n}}}},64665:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerBasedDecoder=void 0;const r=i(96500);let n=0;t.WorkerBasedDecoder=class{constructor(e,t){this.workerSet=e,this.decoderServiceType=t,this.m_serviceCreated=!1,this.workerSet.addReference(),this.serviceId=`${this.decoderServiceType}-${n++}`}dispose(){this.m_serviceCreated&&this.workerSet.broadcastRequest(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:r.WorkerServiceProtocol.Requests.DestroyService,targetServiceId:this.serviceId}).catch((()=>{})),this.workerSet.removeReference()}async connect(){await this.workerSet.connect(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID),this.m_serviceCreated||(await this.workerSet.broadcastRequest(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:r.WorkerServiceProtocol.Requests.CreateService,targetServiceType:this.decoderServiceType,targetServiceId:this.serviceId}),this.m_serviceCreated=!0)}decodeTile(e,t,i,n){const o=t.mortonCode(),a={type:r.WorkerDecoderProtocol.Requests.DecodeTileRequest,tileKey:o,data:e,projection:r.getProjectionName(i)},s=e instanceof ArrayBuffer?[e]:void 0;return this.workerSet.invokeRequest(this.serviceId,a,s,n)}getTileInfo(e,t,i,n){const o=t.mortonCode(),a={type:r.WorkerDecoderProtocol.Requests.TileInfoRequest,tileKey:o,data:e,projection:r.getProjectionName(i)},s=e instanceof ArrayBuffer?[e]:void 0;return this.workerSet.invokeRequest(this.serviceId,a,s,n)}configure(e,t){const i=Object.assign(Object.assign({service:this.serviceId,type:r.WorkerDecoderProtocol.DecoderMessageName.Configuration},e),{options:t});this.workerSet.broadcastMessage(i)}get workerCount(){return this.workerSet.workerCount}}},56009:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerBasedTiler=void 0;const r=i(96500);let n=0;t.WorkerBasedTiler=class{constructor(e,t){this.workerSet=e,this.tilerServiceType=t,this.m_serviceCreated=!1,this.workerSet.addReference(),this.serviceId=`${this.tilerServiceType}-${n++}`}dispose(){this.m_serviceCreated&&this.workerSet.broadcastRequest(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:r.WorkerServiceProtocol.Requests.DestroyService,targetServiceId:this.serviceId}).catch((()=>{})),this.workerSet.removeReference()}async connect(){await this.workerSet.connect(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID),this.m_serviceCreated||(await this.workerSet.broadcastRequest(r.WorkerServiceProtocol.WORKER_SERVICE_MANAGER_SERVICE_ID,{type:r.WorkerServiceProtocol.Requests.CreateService,targetServiceType:this.tilerServiceType,targetServiceId:this.serviceId}),this.m_serviceCreated=!0)}registerIndex(e,t){const i={type:r.WorkerTilerProtocol.Requests.RegisterIndex,id:e,input:t instanceof URL?t.href:t};return this.workerSet.invokeRequest(this.serviceId,i)}updateIndex(e,t){const i={type:r.WorkerTilerProtocol.Requests.UpdateIndex,id:e,input:t instanceof URL?t.href:t};return this.workerSet.invokeRequest(this.serviceId,i)}getTile(e,t){const i=t.mortonCode(),n={type:r.WorkerTilerProtocol.Requests.TileRequest,index:e,tileKey:i};return this.workerSet.invokeRequest(this.serviceId,n)}}},3469:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LowResRenderPass=void 0;const r=i(30462),n=i(84428),o=i(62289);class a extends o.Pass{constructor(e){super(),this.lowResPixelRatio=e,this.m_renderTarget=null,this.m_localCamera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_quadScene=new n.Scene,this.m_quadUniforms=r.CopyShader.uniforms,this.m_quadMaterial=new r.CopyMaterial(this.m_quadUniforms),this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),this.m_quadMaterial),this.m_savedWidth=0,this.m_savedHeight=0,this.m_quad.frustumCulled=!1,this.m_quadScene.add(this.m_quad),this.m_pixelRatio=e}dispose(){this.m_quadMaterial.dispose(),this.m_quad.geometry.dispose(),null!==this.m_renderTarget&&(this.m_renderTarget.dispose(),this.m_renderTarget=null)}set pixelRatio(e){this.m_pixelRatio=e,this.m_renderTarget&&void 0!==this.pixelRatio&&this.m_renderTarget.setSize(Math.floor(this.m_savedWidth*this.pixelRatio),Math.floor(this.m_savedHeight*this.pixelRatio))}get pixelRatio(){return this.m_pixelRatio}render(e,t,i,r,o){if(!this.enabled||void 0===this.pixelRatio)return;null===this.m_renderTarget&&(this.m_savedWidth=o.width,this.m_savedHeight=o.height,this.m_renderTarget=new n.WebGLRenderTarget(Math.floor(this.m_savedWidth*this.pixelRatio),Math.floor(this.m_savedHeight*this.pixelRatio),{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat,depthBuffer:!0,stencilBuffer:!0}),this.m_renderTarget.texture.name="LowResRenderPass.sample"),this.m_quadUniforms.tDiffuse.value=this.m_renderTarget.texture,this.m_quadUniforms.opacity.value=1;const a=e.getRenderTarget();e.setRenderTarget(this.m_renderTarget),e.clear(),e.render(t,i),e.setRenderTarget(this.renderToScreen?null:r),e.clear(),e.render(this.m_quadScene,this.m_localCamera),e.setRenderTarget(a)}setSize(e,t){this.m_savedWidth=e,this.m_savedHeight=t,this.m_renderTarget&&void 0!==this.pixelRatio&&this.m_renderTarget.setSize(Math.floor(e*this.pixelRatio),Math.floor(t*this.pixelRatio))}}t.LowResRenderPass=a},77979:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSAARenderPass=t.MSAASampling=void 0;const r=i(30462),n=i(84428),o=i(62289);var a;!function(e){e[e.Level_0=0]="Level_0",e[e.Level_1=1]="Level_1",e[e.Level_2=2]="Level_2",e[e.Level_3=3]="Level_3",e[e.Level_4=4]="Level_4",e[e.Level_5=5]="Level_5"}(a=t.MSAASampling||(t.MSAASampling={}));class s extends o.Pass{constructor(){super(),this.samplingLevel=a.Level_1,this.m_renderTarget=null,this.m_localCamera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_quadScene=new n.Scene,this.m_quadUniforms=r.CopyShader.uniforms,this.m_quadMaterial=new r.MSAAMaterial(this.m_quadUniforms),this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2),this.m_quadMaterial),this.m_tmpColor=new n.Color,this.m_quad.frustumCulled=!1,this.m_quadScene.add(this.m_quad)}dispose(){null!==this.m_renderTarget&&(this.m_renderTarget.dispose(),this.m_renderTarget=null)}render(e,t,i,r,o){if(!this.enabled)return;null===this.m_renderTarget&&(this.m_renderTarget=new n.WebGLRenderTarget(o.width,o.height,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat}),this.m_renderTarget.texture.name="MSAARenderPass.sample"),this.m_quadUniforms.tDiffuse.value=this.m_renderTarget.texture;const a=s.OffsetVectors[this.samplingLevel],l=e.getClearColor(this.m_tmpColor),c=void 0!==l?l.getHex():0,u={enabled:null!==i.view&&i.view.enabled,fullWidth:o.width,fullHeight:o.height,x:0,y:0,width:o.width,height:o.height};u.enabled&&null!==i.view&&(u.fullWidth=i.view.fullWidth,u.fullHeight=i.view.fullHeight,u.x=i.view.offsetX,u.y=i.view.offsetY,u.width=i.view.width,u.height=i.view.height);const d=e.getRenderTarget();for(let n=0;n<a.length;n++){const o=a[n];i.setViewOffset(u.fullWidth,u.fullHeight,u.x+o[0]/16,u.y+o[1]/16,u.width,u.height);const s=(n+.5)/a.length-.5,d=1/a.length+s/32;this.m_quadUniforms.opacity.value=d,e.setRenderTarget(this.m_renderTarget),e.clear(),e.render(t,i),e.setRenderTarget(this.renderToScreen?null:r),0===n&&(e.setClearColor(0),e.clear()),e.render(this.m_quadScene,this.m_localCamera),0===n&&void 0!==l&&e.setClearColor(c)}e.setRenderTarget(d),null!==i.view&&(i.view.enabled=u.enabled,i.view.offsetX=u.x,i.view.offsetY=u.y)}setSize(e,t){this.m_renderTarget&&this.m_renderTarget.setSize(e,t)}}t.MSAARenderPass=s,s.OffsetVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]]},96774:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapRenderingManager=void 0;const r=i(30462),n=i(84428),o=i(3469),a=i(77979),s=i(16017),l=i(62289),c=i(72328),u=a.MSAASampling.Level_1,d=a.MSAASampling.Level_4;t.MapRenderingManager=class{constructor(e,t,i,s={msaaEnabled:!1}){this.bloom={enabled:!1,strength:1.5,radius:.4,threshold:.85},this.outline={enabled:!1,thickness:.005,color:"#000000",ghostExtrudedPolygons:!1,needsUpdate:!1},this.vignette={enabled:!1,offset:1,darkness:1},this.sepia={enabled:!1,amount:.5},this.m_width=1,this.m_height=1,this.m_renderPass=new l.RenderPass,this.m_target1=new n.WebGLRenderTarget(1,1),this.m_target2=new n.WebGLRenderTarget(1,1),this.m_sepiaPass=new l.ShaderPass(r.SepiaShader),this.m_vignettePass=new l.ShaderPass(r.VignetteShader),this.m_readBuffer=new n.WebGLRenderTarget(e,t),this.m_msaaPass=new a.MSAARenderPass,this.m_msaaPass.enabled=void 0!==s&&!0===s.msaaEnabled,this.m_dynamicMsaaSamplingLevel=void 0===s.dynamicMsaaSamplingLevel?u:s.dynamicMsaaSamplingLevel,this.m_staticMsaaSamplingLevel=void 0===s.staticMsaaSamplingLevel?d:s.staticMsaaSamplingLevel,this.m_lowResPass=new o.LowResRenderPass(i),this.m_lowResPass.enabled=void 0!==i}updateOutline(e){this.outline.color=e.color,this.outline.thickness=e.thickness,this.outline.ghostExtrudedPolygons=e.ghostExtrudedPolygons,this.outline.needsUpdate=!0}render(e,t,i,r){if(!r&&void 0!==this.m_lowResPass.pixelRatio)return this.m_lowResPass.renderToScreen=!0,void this.m_lowResPass.render(e,t,i,null,this.m_readBuffer);const o=this.bloom.enabled||this.outline.enabled||this.vignette.enabled||this.sepia.enabled;let a=null;if((this.bloom.enabled||this.vignette.enabled||this.sepia.enabled)&&(e.setRenderTarget(this.m_target1),e.clearDepth()),this.m_msaaPass.enabled?(this.m_msaaPass.samplingLevel=r?this.m_staticMsaaSamplingLevel:this.m_dynamicMsaaSamplingLevel,this.m_msaaPass.renderToScreen=!o,this.m_msaaPass.render(e,t,i,null,this.m_readBuffer)):this.bloom.enabled||this.vignette.enabled||this.sepia.enabled?(a=this.m_target1,this.m_renderPass.render(e,t,i,this.m_target1,null)):(!this.outline.enabled||this.outline.enabled&&!this.bloom.enabled)&&e.render(t,i),this.outline.enabled){void 0===this.m_outlineEffect&&(this.m_outlineEffect=new s.OutlineEffect(e)),this.outline.needsUpdate&&(this.m_outlineEffect.color=this.outline.color,this.m_outlineEffect.thickness=this.outline.thickness,this.m_outlineEffect.ghostExtrudedPolygons=this.outline.ghostExtrudedPolygons,this.outline.needsUpdate=!1);const r=this.bloom.enabled||this.vignette.enabled||this.sepia.enabled;r&&(a=this.m_target1),e.setRenderTarget(r?a:null),this.m_outlineEffect.render(t,i)}if(this.bloom.enabled){void 0===this.m_bloomPass&&(this.m_bloomPass=new c.BloomPass(new n.Vector2(this.m_width,this.m_height),this.bloom.strength,this.bloom.radius,this.bloom.threshold));const r=this.vignette.enabled||this.sepia.enabled;this.m_bloomPass.renderToScreen=!r,this.m_bloomPass.radius=this.bloom.radius,this.m_bloomPass.strength=this.bloom.strength,this.m_bloomPass.threshold=this.bloom.threshold,this.m_bloomPass.render(e,t,i,null,a)}else void 0!==this.m_bloomPass&&(this.m_bloomPass.dispose(),this.m_bloomPass=void 0);if(this.vignette.enabled){const r=a,n=this.sepia.enabled;this.m_vignettePass.uniforms.offset.value=this.vignette.offset,this.m_vignettePass.uniforms.darkness.value=this.vignette.darkness,this.m_vignettePass.renderToScreen=!n,n&&(a=a===this.m_target1?this.m_target2:this.m_target1),this.m_vignettePass.render(e,t,i,a,r)}this.sepia.enabled&&(this.m_sepiaPass.renderToScreen=!0,this.m_sepiaPass.uniforms.amount.value=this.sepia.amount,this.m_sepiaPass.render(e,t,i,null,a))}setSize(e,t){this.m_readBuffer.setSize(e,t),this.m_msaaPass.setSize(e,t),void 0!==this.m_bloomPass&&this.m_bloomPass.setSize(e,t),this.m_lowResPass.setSize(e,t),this.m_target1.setSize(e,t),this.m_target2.setSize(e,t),this.m_width=e,this.m_height=t}get lowResPixelRatio(){return this.m_lowResPass.pixelRatio}set lowResPixelRatio(e){this.m_lowResPass.pixelRatio=e,this.m_lowResPass.enabled=void 0!==e}set dynamicMsaaSamplingLevel(e){this.m_dynamicMsaaSamplingLevel=e}get dynamicMsaaSamplingLevel(){return this.m_dynamicMsaaSamplingLevel}set msaaEnabled(e){this.m_msaaPass.enabled=e}get msaaEnabled(){return this.m_msaaPass.enabled}set staticMsaaSamplingLevel(e){this.m_staticMsaaSamplingLevel=e}get staticMsaaSamplingLevel(){return this.m_staticMsaaSamplingLevel}}},16017:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutlineEffect=void 0;const r=i(30462),n=i(38338),o=i(84428);t.OutlineEffect=class{constructor(e){this.m_renderer=e,this.enabled=!0,this.m_defaultThickness=.02,this.m_defaultColor=new o.Color(0,0,0),this.m_defaultAlpha=1,this.m_defaultKeepAlive=!1,this.m_ghostExtrudedPolygons=!1,this.m_cache={},this.m_removeThresholdCount=60,this.m_originalMaterials={},this.m_originalOnBeforeRenders={},this.m_shaderIDs={MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical"},this.m_uniformsChunk={outlineThickness:{value:this.m_defaultThickness},outlineColor:{value:this.m_defaultColor},outlineAlpha:{value:this.m_defaultAlpha}},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap}set thickness(e){this.m_defaultThickness=e,this.m_uniformsChunk.outlineThickness.value=e,this.m_cache={}}set color(e){this.m_defaultColor.set(e),this.m_cache={}}set ghostExtrudedPolygons(e){this.m_ghostExtrudedPolygons=e}clear(e,t,i){this.m_renderer.clear(e,t,i)}getPixelRatio(){return this.m_renderer.getPixelRatio()}setPixelRatio(e){this.m_renderer.setPixelRatio(e)}getSize(e){return this.m_renderer.getSize(e)}setSize(e,t,i){this.m_renderer.setSize(e,t,i)}setViewport(e,t,i,r){this.m_renderer.setViewport(e,t,i,r)}setScissor(e,t,i,r){this.m_renderer.setScissor(e,t,i,r)}setScissorTest(e){this.m_renderer.setScissorTest(e)}setRenderTarget(e){this.m_renderer.setRenderTarget(e)}render(e,t){if(this.m_ghostExtrudedPolygons){if(!this.enabled)return void this.m_renderer.render(e,t);const i=this.m_renderer.autoClear;this.m_renderer.autoClear=this.autoClear,this.m_renderer.render(e,t),this.m_renderer.autoClear=i}this.renderOutline(e,t)}renderOutline(e,t){const i=this.m_renderer.autoClear,r=e.autoUpdate,n=e.background,o=this.m_renderer.shadowMap.enabled;e.autoUpdate=!1,e.background=null,this.m_renderer.autoClear=!1,this.m_renderer.shadowMap.enabled=!1,e.traverse(this.setOutlineMaterial.bind(this)),this.m_renderer.render(e,t),e.traverse(this.restoreOriginalMaterial.bind(this)),this.cleanupCache(),e.autoUpdate=r,e.background=n,this.m_renderer.autoClear=i,this.m_renderer.shadowMap.enabled=o}createInvisibleMaterial(){return new o.ShaderMaterial({name:"invisible",visible:!1})}createMaterial(e){if(e instanceof r.EdgeMaterial||!0===e.isDepthPrepassMaterial)return this.createInvisibleMaterial();const t=this.m_shaderIDs[e.type];let i,n=void 0!==e.shaderUniforms?e.shaderUniforms:e.uniforms;if(void 0!==t){const e=o.ShaderLib[t];n=e.uniforms,i=e.vertexShader}else if(!0===e.isRawShaderMaterial){if(i=e.vertexShader,!/attribute\s+vec3\s+position\s*;/.test(i)||!/attribute\s+vec3\s+normal\s*;/.test(i))return this.createInvisibleMaterial()}else{if(!0!==e.isShaderMaterial)return this.createInvisibleMaterial();i=e.vertexShader}const a=void 0!==e.shaderUniforms&&void 0!==e.shaderUniforms.extrusionRatio,s=r.FadingFeature.isDefined(e),l=Object.assign(Object.assign({},n),this.m_uniformsChunk),c=i.replace(/void\s+main\s*\(\s*\)/,"\n#ifdef USE_EXTRUSION\n  #ifndef HAS_EXTRUSION_PARS_VERTEX\n    #include <extrusion_pars_vertex>\n  #endif\n#endif\n\n#ifdef USE_FADING\n  #include <fading_pars_vertex>\n#endif\n\nuniform float outlineThickness;\n\nvec4 calculateOutline( vec4 pos, vec3 objectNormal, vec4 skinned ) {\n    float thickness = outlineThickness;\n    const float ratio = 1.0;\n    vec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + objectNormal, 1.0 );\n    vec4 norm = normalize( pos - pos2 );\n    return pos + norm * thickness * pos.w * ratio;\n}\nvoid main()").replace(/\}\s*$/,"\n#if ! defined( LAMBERT ) && ! defined( PHONG ) && ! defined( TOON ) && ! defined( STANDARD )\n    #ifndef USE_ENVMAP\n        vec3 objectNormal = normalize( normal );\n    #endif\n#endif\n\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n\n#ifdef DECLARE_TRANSFORMED\n    vec3 transformed = vec3( position );\n#endif\n\n#ifdef USE_EXTRUSION\n #ifndef HAS_EXTRUSION_VERTEX\n  #include <extrusion_vertex>\n #endif\n#endif\n\n#ifdef USE_FADING\n  #include <fading_vertex>\n#endif\n\n#ifdef USE_EXTRUSION\n  gl_Position = calculateOutline( projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 ),\n      objectNormal, vec4( transformed, 1.0 ) );\n#else\n  gl_Position = calculateOutline( gl_Position, objectNormal, vec4( transformed, 1.0 ) );\n#endif\n\n#include <fog_vertex>\n}").replace(/#include\s+<[\w_]*light[\w_]*>/g,""),u={};return/vec3\s+transformed\s*=/.test(i)||/#include\s+<begin_vertex>/.test(i)||(u.DECLARE_TRANSFORMED=!0),a&&(l.extrusionRatio={value:r.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN},u.USE_EXTRUSION=1),s&&(l.fadeNear={value:void 0!==n.fadeNear?n.fadeNear.value:r.FadingFeature.DEFAULT_FADE_NEAR},l.fadeFar={value:void 0!==n.fadeFar?n.fadeFar.value:r.FadingFeature.DEFAULT_FADE_FAR},u.USE_FADING=1),new o.ShaderMaterial({defines:u,uniforms:l,vertexShader:c,fragmentShader:"\n#include <common>\n#include <fog_pars_fragment>\n\n#ifdef USE_EXTRUSION\n  #include <extrusion_pars_fragment>\n#endif\n\n#ifdef USE_FADING\n  #include <fading_pars_fragment>\n#endif\n\nuniform vec3 outlineColor;\nuniform float outlineAlpha;\n\nvoid main() {\n\n    gl_FragColor = vec4( outlineColor, outlineAlpha );\n\n    #include <fog_fragment>\n\n    #ifdef USE_EXTRUSION\n      #include <extrusion_fragment>\n    #endif\n\n    #ifdef USE_FADING\n      #include <fading_fragment>\n    #endif\n}",side:o.BackSide,morphTargets:!1,morphNormals:!1,fog:!1,blending:o.CustomBlending,blendSrc:o.SrcAlphaFactor,blendDst:o.OneMinusSrcAlphaFactor,blendSrcAlpha:o.OneFactor,blendDstAlpha:o.OneMinusSrcAlphaFactor,transparent:!0,polygonOffset:!0,polygonOffsetFactor:10,polygonOffsetUnits:30})}getOutlineMaterialFromCache(e){let t=this.m_cache[e.uuid];return void 0===t&&(t={material:this.createMaterial(e),used:!0,keepAlive:this.m_defaultKeepAlive,count:0},this.m_cache[e.uuid]=t),t.used=!0,t.material}getOutlineMaterial(e){const t=this.getOutlineMaterialFromCache(e);return this.m_originalMaterials[t.uuid]=e,this.updateOutlineMaterial(t,e),t}setOutlineMaterial(e){if(void 0!==e.material){if(Array.isArray(e.material))for(let t=0,i=e.material.length;t<i;t++)e.material[t]=this.getOutlineMaterial(e.material[t]);else e.material=this.getOutlineMaterial(e.material);this.m_originalOnBeforeRenders[e.uuid]=e.onBeforeRender,e.onBeforeRender=n.chainCallbacks(e.onBeforeRender,this.onBeforeRender.bind(this))}}restoreOriginalMaterial(e){if(void 0!==e.material){if(Array.isArray(e.material))for(let t=0,i=e.material.length;t<i;t++)e.material[t]=this.m_originalMaterials[e.material[t].uuid];else e.material=this.m_originalMaterials[e.material.uuid];e.onBeforeRender=this.m_originalOnBeforeRenders[e.uuid]}}onBeforeRender(e,t,i,r,n,o){const a=this.m_originalMaterials[n.uuid];void 0!==a&&this.updateUniforms(n,a)}updateUniforms(e,t){var i;const n=t.userData.outlineParameters,o=e.uniforms;o.outlineAlpha.value=t.opacity;const a=void 0!==t.shaderUniforms?t.shaderUniforms:t.uniforms;if(void 0!==n&&(void 0!==n.thickness&&(o.outlineThickness.value=n.thickness),void 0!==n.color&&o.outlineColor.value.fromArray(n.color),void 0!==n.alpha&&(o.outlineAlpha.value=n.alpha)),void 0!==a&&void 0!==a.extrusionRatio){const i=t.shaderUniforms.extrusionRatio.value;e.extrusionRatio=i,e.uniforms.extrusionRatio.value=void 0!==i?i:r.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN}void 0!==(null===(i=e.defines)||void 0===i?void 0:i.USE_FADING)&&void 0!==a.fadeNear&&void 0!==a.fadeFar&&a.fadeFar.value>=0&&(o.fadeNear.value=a.fadeNear.value,o.fadeFar.value=a.fadeFar.value)}updateOutlineMaterial(e,t){if("invisible"===e.name)return;const i=t.userData.outlineParameters;e.skinning=t.skinning,e.morphTargets=t.morphTargets,e.morphNormals=t.morphNormals,e.fog=t.fog,void 0!==i?(e.visible=!1!==t.visible&&(void 0===i.visible||i.visible),void 0!==i.keepAlive&&(this.m_cache[t.uuid].keepAlive=i.keepAlive)):e.visible=t.visible,!0!==t.wireframe&&!1!==t.depthTest||(e.visible=!1)}cleanupCache(){let e;e=Object.keys(this.m_originalMaterials);for(let t=0,i=e.length;t<i;t++)this.m_originalMaterials[e[t]]=void 0;e=Object.keys(this.m_originalOnBeforeRenders);for(let t=0,i=e.length;t<i;t++)this.m_originalOnBeforeRenders[e[t]]=void 0;e=Object.keys(this.m_cache);for(const t of e)!1===this.m_cache[t].used?(this.m_cache[t].count++,!1===this.m_cache[t].keepAlive&&this.m_cache[t].count>this.m_removeThresholdCount&&delete this.m_cache[t]):(this.m_cache[t].used=!1,this.m_cache[t].count=0)}}},62289:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderPass=t.RenderPass=t.Pass=void 0;const r=i(84428);class n{constructor(){this.enabled=!1,this.renderToScreen=!1}setSize(e,t){}render(e,t,i,r,n,o){}}t.Pass=n,t.RenderPass=class extends n{constructor(){super()}render(e,t,i,r,n){e.setRenderTarget(this.renderToScreen?null:r),e.render(t,i)}},t.ShaderPass=class extends n{constructor(e,t="tDiffuse"){super(),this.textureID=t,e instanceof r.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):(this.uniforms=r.UniformsUtils.clone(e.uniforms),this.material=new r.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new o(this.material)}render(e,t,i,r,n,o){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,e.setRenderTarget(this.renderToScreen?null:r),this.fsQuad.render(e)}};class o{constructor(e){this.m_camera=new r.OrthographicCamera(-1,1,1,-1,0,1);const t=new r.PlaneBufferGeometry(2,2);this.m_mesh=new r.Mesh(t,e)}get material(){return this.m_mesh.material}set material(e){this.m_mesh.material=e}render(e){e.render(this.m_mesh,this.m_camera)}}},72328:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BloomPass=void 0;const r=i(30462),n=i(84428),o=i(62289),a=new n.Vector2(1,0),s=new n.Vector2(0,1);class l extends o.Pass{constructor(e,t,i,o){super(),this.resolution=new n.Vector2(256,256),this.m_renderTargetsHorizontal=[],this.m_renderTargetsVertical=[],this.m_nMips=5,this.m_separableBlurMaterials=[],this.m_camera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.m_scene=new n.Scene,this.m_basic=new n.MeshBasicMaterial,this.m_quad=new n.Mesh(new n.PlaneBufferGeometry(2,2)),this.m_bloomTintColors=[new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1),new n.Vector3(1,1,1)],this.strength=t,this.radius=i,this.threshold=o,this.resolution=e,this.m_quad.frustumCulled=!1,this.m_scene.add(this.m_quad);const a={minFilter:n.LinearFilter,magFilter:n.LinearFilter,format:n.RGBAFormat};let s=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);this.m_renderTargetBright=new n.WebGLRenderTarget(s,l,a),this.m_renderTargetBright.texture.name="UnrealBloomPass.bright",this.m_renderTargetBright.texture.generateMipmaps=!1;for(let e=0;e<this.m_nMips;e++){const t=new n.WebGLRenderTarget(s,l,a);t.texture.name="UnrealBloomPass.h"+e,t.texture.generateMipmaps=!1,this.m_renderTargetsHorizontal.push(t);const i=new n.WebGLRenderTarget(s,l,a);i.texture.name="UnrealBloomPass.v"+e,i.texture.generateMipmaps=!1,this.m_renderTargetsVertical.push(i),s=Math.round(s/2),l=Math.round(l/2)}this.m_highPassUniforms=n.UniformsUtils.clone(r.LuminosityHighPassShader.uniforms),this.m_highPassUniforms.luminosityThreshold.value=o,this.m_highPassUniforms.smoothWidth.value=.01,this.m_materialHighPassFilter=new n.ShaderMaterial({uniforms:this.m_highPassUniforms,vertexShader:r.LuminosityHighPassShader.vertexShader,fragmentShader:r.LuminosityHighPassShader.fragmentShader,defines:{}});const c=[3,5,7,9,11];s=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);for(let e=0;e<this.m_nMips;e++)this.m_separableBlurMaterials.push(this.getSeperableBlurMaterial(c[e])),this.m_separableBlurMaterials[e].uniforms.texSize.value=new n.Vector2(s,l),s=Math.round(s/2),l=Math.round(l/2);this.m_compositeMaterial=this.getCompositeMaterial(this.m_nMips),this.m_compositeMaterial.uniforms.blurTexture1.value=this.m_renderTargetsVertical[0].texture,this.m_compositeMaterial.uniforms.blurTexture2.value=this.m_renderTargetsVertical[1].texture,this.m_compositeMaterial.uniforms.blurTexture3.value=this.m_renderTargetsVertical[2].texture,this.m_compositeMaterial.uniforms.blurTexture4.value=this.m_renderTargetsVertical[3].texture,this.m_compositeMaterial.uniforms.blurTexture5.value=this.m_renderTargetsVertical[4].texture,this.m_compositeMaterial.uniforms.bloomStrength.value=t,this.m_compositeMaterial.uniforms.bloomRadius.value=.1,this.m_compositeMaterial.needsUpdate=!0,this.m_compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.m_compositeMaterial.uniforms.bloomTintColors.value=this.m_bloomTintColors,this.m_copyUniforms=n.UniformsUtils.clone(r.CopyShader.uniforms),this.m_copyUniforms.opacity.value=1,this.m_materialCopy=new n.ShaderMaterial({uniforms:this.m_copyUniforms,vertexShader:r.CopyShader.vertexShader,fragmentShader:r.CopyShader.fragmentShader,blending:n.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}dispose(){for(const e of this.m_renderTargetsHorizontal)e.dispose();for(const e of this.m_renderTargetsVertical)e.dispose();this.m_renderTargetBright.dispose()}setSize(e,t){let i=Math.round(e/2),r=Math.round(t/2);this.m_renderTargetBright.setSize(i,r);for(let e=0;e<this.m_nMips;e++)this.m_renderTargetsHorizontal[e].setSize(i,r),this.m_renderTargetsVertical[e].setSize(i,r),this.m_separableBlurMaterials[e].uniforms.texSize.value=new n.Vector2(i,r),i=Math.round(i/2),r=Math.round(r/2)}render(e,t,i,r,n){this.renderToScreen&&(this.m_quad.material=this.m_basic,this.m_basic.map=n.texture,e.setRenderTarget(null),e.clear(),e.render(this.m_scene,this.m_camera)),this.m_highPassUniforms.tDiffuse.value=n.texture,this.m_highPassUniforms.luminosityThreshold.value=this.threshold,this.m_quad.material=this.m_materialHighPassFilter,e.setRenderTarget(this.m_renderTargetBright),e.clear(),e.render(this.m_scene,this.m_camera);let o=this.m_renderTargetBright;for(let t=0;t<this.m_nMips;t++)this.m_quad.material=this.m_separableBlurMaterials[t],this.m_separableBlurMaterials[t].uniforms.colorTexture.value=o.texture,this.m_separableBlurMaterials[t].uniforms.direction.value=a,e.setRenderTarget(this.m_renderTargetsHorizontal[t]),e.clear(),e.render(this.m_scene,this.m_camera),this.m_separableBlurMaterials[t].uniforms.colorTexture.value=this.m_renderTargetsHorizontal[t].texture,this.m_separableBlurMaterials[t].uniforms.direction.value=s,e.setRenderTarget(this.m_renderTargetsVertical[t]),e.clear(),e.render(this.m_scene,this.m_camera),o=this.m_renderTargetsVertical[t];this.m_quad.material=this.m_compositeMaterial,this.m_compositeMaterial.uniforms.bloomStrength.value=this.strength,this.m_compositeMaterial.uniforms.bloomRadius.value=this.radius,this.m_compositeMaterial.uniforms.bloomTintColors.value=this.m_bloomTintColors,e.setRenderTarget(this.m_renderTargetsHorizontal[0]),e.clear(),e.render(this.m_scene,this.m_camera),this.m_quad.material=this.m_materialCopy,this.m_copyUniforms.tDiffuse.value=this.m_renderTargetsHorizontal[0].texture,this.renderToScreen?(e.setRenderTarget(null),e.render(this.m_scene,this.m_camera)):(e.setRenderTarget(n),e.render(this.m_scene,this.m_camera))}getSeperableBlurMaterial(e){return new n.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new n.Vector2(.5,.5)},direction:{value:new n.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }",fragmentShader:"#include <common>\n            varying vec2 vUv;\n            uniform sampler2D colorTexture;\n            uniform vec2 texSize;\n            uniform vec2 direction;\n\n            float gaussianPdf(in float x, in float sigma) {\n                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n            }\n            void main() {\n                vec2 invSize = 1.0 / texSize;\n                float fSigma = float(SIGMA);\n                float weightSum = gaussianPdf(0.0, fSigma);\n                vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n                    float x = float(i);\n                    float w = gaussianPdf(x, fSigma);\n                    vec2 uvOffset = direction * invSize * x;\n                    vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n                    vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n                    diffuseSum += (sample1 + sample2) * w;\n                    weightSum += 2.0 * w;\n                }\n                gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n            }"})}getCompositeMaterial(e){return new n.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fragmentShader:"varying vec2 vUv;\n                uniform sampler2D blurTexture1;\n                uniform sampler2D blurTexture2;\n                uniform sampler2D blurTexture3;\n                uniform sampler2D blurTexture4;\n                uniform sampler2D blurTexture5;\n                uniform sampler2D dirtTexture;\n                uniform float bloomStrength;\n                uniform float bloomRadius;\n                uniform float bloomFactors[NUM_MIPS];\n                uniform vec3 bloomTintColors[NUM_MIPS];\n\n                float lerpBloomFactor(const in float factor) {\n                    float mirrorFactor = 1.2 - factor;\n                    return mix(factor, mirrorFactor, bloomRadius);\n                }\n\n                void main() {\n                    gl_FragColor = bloomStrength * (\nlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\nlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\nlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\nlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\nlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n                }"})}}t.BloomPass=l},23193:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSAASampling=t.MSAARenderPass=t.Pass=t.MapRenderingManager=void 0;var r=i(96774);Object.defineProperty(t,"MapRenderingManager",{enumerable:!0,get:function(){return r.MapRenderingManager}});var n=i(62289);Object.defineProperty(t,"Pass",{enumerable:!0,get:function(){return n.Pass}});var o=i(77979);Object.defineProperty(t,"MSAARenderPass",{enumerable:!0,get:function(){return o.MSAARenderPass}}),Object.defineProperty(t,"MSAASampling",{enumerable:!0,get:function(){return o.MSAASampling}})},77391:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyrightCoverageProvider=void 0;const r=i(38338),n=i(82582);t.CopyrightCoverageProvider=class{constructor(){this.logger=r.LoggerManager.instance.create("CopyrightCoverageProvider")}getTree(){return void 0!==this.m_cachedTreePromise||(this.m_cachedTreePromise=this.getCopyrightCoverageData().then((e=>this.initRBush(e))).catch((e=>(this.logger.error(e),new n)))),this.m_cachedTreePromise}async getCopyrights(e,t){const i=[],n=(await this.getTree()).search({minX:e.west,minY:e.south,maxX:e.east,maxY:e.north});for(const e of n){const n=r.getOptionValue(e.minLevel,0),o=r.getOptionValue(e.maxLevel,1/0);t>=n&&t<=o&&void 0===i.find((t=>t.id===e.label))&&i.push({id:e.label})}return i}initRBush(e){const t=new n;if(!e)return this.logger.warn("No copyright coverage data provided"),t;for(const i of e){const{minLevel:e,maxLevel:r,label:n,alt:o}=i;if(i.boxes)for(const a of i.boxes){const[i,s,l,c]=a;t.insert({minX:s,minY:i,maxX:c,maxY:l,minLevel:e,maxLevel:r,label:n,alt:o})}else t.insert({minX:-180,minY:-90,maxX:180,maxY:180,minLevel:e,maxLevel:r,label:n,alt:o})}return t}}},74678:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyrightElementHandler=void 0;const r=i(38338),n=i(17624),o=i(11369);class a{constructor(e,t){if(this.m_defaults=new Map,this.m_mapViews=[],this.update=()=>{var e;const t=this.m_mapViews.map((e=>e.copyrightInfo)).reduce(o.CopyrightInfo.mergeArrays,null!==(e=this.staticInfo)&&void 0!==e?e:[]);if(0===t.length)return void(this.m_element.style.display="none");if(this.m_element.style.display="block",0!==this.m_defaults.size)for(const e of t){const t=this.m_defaults.get(e.id);void 0!==t&&(e.year=r.getOptionValue(e.year,t.year),e.label=r.getOptionValue(e.label,t.label),e.link=r.getOptionValue(e.link,t.link))}const i=o.CopyrightInfo.mergeArrays(t);this.m_element.innerHTML=o.CopyrightInfo.formatAsHtml(i)},"string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`CopyrightElementHandler: unable to find DOM element #${e}`);this.m_element=t}else this.m_element=e;void 0!==t&&this.attach(t)}static install(e,t){return new a(e,t)}destroy(){for(const e of this.m_mapViews)e.removeEventListener(n.MapViewEventNames.CopyrightChanged,this.update)}attach(e){return this.m_mapViews.push(e),e.addEventListener(n.MapViewEventNames.CopyrightChanged,this.update),this.update(),this}detach(e){return e.removeEventListener(n.MapViewEventNames.CopyrightChanged,this.update),this.m_mapViews=this.m_mapViews.filter((t=>t!==e)),this.update(),this}setDefaults(e){if(this.m_defaults.clear(),void 0!==e)for(const t of e)this.m_defaults.set(t.id,t);return this}setStaticCopyightInfo(e){return this.staticInfo=e,this}}t.CopyrightElementHandler=a},11369:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyrightInfo=void 0;const r=i(38338);var n;(n=t.CopyrightInfo||(t.CopyrightInfo={})).mergeArrays=function(e,t){const i=[];for(const n of[e,t])if(void 0!==n)for(const e of n){const t=i.find((t=>t.id===e.id||void 0!==t.label&&t.label===e.label));void 0===t?i.push(Object.assign({},e)):(t.year=r.MathUtils.max2(e.year,t.year),t.label=r.getOptionValue(e.label,t.label),t.link=r.getOptionValue(e.link,t.link))}return i},n.formatAsHtml=function(e){if(0===e.length)return"";const t=e.filter((e=>""!==e.label));return 0===t.length?"":" "+t.map((e=>{var t;const i=null!==(t=e.label)&&void 0!==t?t:e.id,r=void 0!==e.year?`${e.year} ${i}`:i,n=e.link;return n?`<a href="${n}" target="_blank" rel="noreferrer noopener">${r}</a>`:`${r}`})).join(", ")}},69598:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},25370:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlCopyrightProvider=void 0;const r=i(59571),n=i(77391);class o extends n.CopyrightCoverageProvider{constructor(e,t,i,n=r.TransferManager.instance()){super(),this.m_fetchURL=e,this.m_baseScheme=t,this.m_requestHeaders=i,this.m_transferManager=n}setRequestHeaders(e){this.m_requestHeaders=e}getCopyrightCoverageData(e){return void 0!==this.m_cachedCopyrightResponse||(this.m_cachedCopyrightResponse=this.m_transferManager.downloadJson(this.m_fetchURL,{headers:this.m_requestHeaders,signal:e}).then((e=>e[this.m_baseScheme])).catch((e=>(this.logger.error(e),[])))),this.m_cachedCopyrightResponse}}t.UrlCopyrightProvider=o},73553:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addGroundPlane=void 0;const r=i(96500),n=i(81028),o=i(56772),a=i(32941),s=i(30462),l=i(84428),c=i(95740),u=i(62414),d=i(54465),h=new l.Vector3;function m(e,t,i){const r=e.getAttribute("position"),n=r.array,o=new Float32Array(n.length);for(let e=0;e<r.array.length;e+=1)h.fromBufferAttribute(r,e),i.projection.reprojectPoint(t,h,h).sub(i.center),h.toArray(o,3*e);r.array=o,r.needsUpdate=!0}t.addGroundPlane=function(e,t,i=e.mapView.clearColor,h=1,p=!1,f=e.mapView.shadowsEnabled,g=!1!==e.mapView.enableMixedLod){const y=function(e,t,i,r,d,h){const{dataSource:p,projection:f}=e,g=p.getTilingScheme().projection,y=f.type===a.ProjectionType.Spherical,v=!y,_="number"==typeof r?function(e,t,i,r){return t?new s.MapMeshStandardMaterial({color:e,visible:!0,depthWrite:i,removeDiffuseLight:!0,opacity:r}):new s.MapMeshBasicMaterial({color:e,visible:!0,depthWrite:i,opacity:r})}(new l.Color(r),i,f.type===a.ProjectionType.Spherical,h):r,b=function(e,t,i,r){const{dataSource:n,projection:o}=e,a=n.getTilingScheme().projection,s=new l.Vector3,c=new l.BufferGeometry,d=u.projectTilePlaneCorners(e,a),h=[d.sw,d.se,d.nw,d.ne];if(t)for(const t of h)o.reprojectPoint(a,t,t).sub(e.center);const m=t?new Float32Array(12):new Float64Array(12),p=new l.BufferAttribute(m,3).copyVector3sArray(h);if(c.setAttribute("position",p),r){a.surfaceNormal(d.sw,s).negate();const e=new l.BufferAttribute(new Float32Array(12),3).copyVector3sArray(Array(4).fill(s));c.setAttribute("normal",e)}if(c.setIndex(new l.BufferAttribute(new Uint16Array([0,1,2,2,1,3]),1)),i){const e=new l.BufferAttribute(new Float32Array([0,0,1,0,0,1,1,1]),2);c.setAttribute("uv",e)}return c}(e,v,t,i);if(!y)return new l.Mesh(b,_);const S=[],T=new o.SphericalGeometrySubdivisionModifier(l.MathUtils.degToRad(10),g);if(!d)return T.modify(b),m(b,g,e),new l.Mesh(b,_);for(let t=0;t<4;++t){const i=Math.pow(2,t),r=b.clone();i>1&&new n.EdgeLengthGeometrySubdivisionModifier(i,e.geoBox,n.SubdivisionMode.All,g).modify(r),T.modify(r),m(r,g,e),S.push(r)}return new c.LodMesh(S,_)}(e,p,f,i,g,h);return y.receiveShadow=f,y.renderOrder=t,d.registerTileObject(e,y,r.GeometryKind.Background,{pickability:r.Pickability.transient}),e.objects.push(y),y}},5905:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplacedBufferAttribute=void 0;const r=i(38338),n=i(84428),o=i(71962);class a extends n.BufferAttribute{constructor(e,t,i,r){super(e.array,e.itemSize,e.normalized),this.originalAttribute=e,this.m_normals=t,this.m_uvs=i,this.m_textureWidth=0,this.m_textureHeight=0,this.m_cache=new o.VertexCache(a.MAX_CACHE_SIZE),this.m_lastPos=new n.Vector3,this.m_tmpNormal=new n.Vector3,this.resetTexture(r)}reset(e,t,i,r){this.array=e.array,this.itemSize=e.itemSize,this.count=this.array.length/this.itemSize,this.normalized=e.normalized,this.originalAttribute=e,this.m_normals=t,this.m_uvs=i,this.m_cache.clear(),this.m_lastBufferIndex=void 0,this.resetTexture(r)}getX(e){return this.getDisplacedCoordinate(e).x}getY(e){return this.getDisplacedCoordinate(e).y}getZ(e){return this.getDisplacedCoordinate(e).z}resetTexture(e){this.m_texture=new Float32Array(e.image.data.buffer),this.m_textureWidth=e.image.width,this.m_textureHeight=e.image.height}getDisplacedCoordinate(e){return e===this.m_lastBufferIndex||(this.m_lastBufferIndex=e,this.m_cache.get(e,this.m_lastPos)||(this.displacePosition(e),this.m_cache.set(e,this.m_lastPos))),this.m_lastPos}displacePosition(e){this.m_lastPos.fromBufferAttribute(this.originalAttribute,e);const t=this.m_normals;this.m_tmpNormal.fromBufferAttribute(t,e);const i=this.m_uvs,o=n.MathUtils.clamp(i.getX(e),0,1),a=n.MathUtils.clamp(i.getY(e),0,1),s=r.sampleBilinear(this.m_texture,this.m_textureWidth,this.m_textureHeight,o,a);this.m_lastPos.add(this.m_tmpNormal.multiplyScalar(s))}}t.DisplacedBufferAttribute=a,a.MAX_CACHE_SIZE=6},95010:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplacedBufferGeometry=t.displaceBox=void 0;const r=i(84428),n=i(5905),o=new r.Vector3,a=new r.Vector3,s=new r.Box3;function l(e,t,i){s.copy(e);const r=o.copy(i),n=a.copy(r);return e.translate(r.multiplyScalar(t.min)).union(s.translate(n.multiplyScalar(t.max))),e}t.displaceBox=l;class c extends r.BufferGeometry{constructor(e,t,i,o){super(),this.originalGeometry=e,this.displacementRange=i,this.m_originalBoundingBox=new r.Box3,this.m_displacedPositions=o||new n.DisplacedBufferAttribute(e.attributes.position,e.attributes.normal,e.attributes.uv,t),this.resetAttributes()}reset(e,t,i){this.originalGeometry=e;const r=e.attributes.position,n=e.attributes.normal,o=e.attributes.uv;this.m_displacedPositions.reset(r,n,o,t);const a=this.displacementRange.min!==i.min||this.displacementRange.max!==i.max;this.displacementRange=i,this.resetAttributes(),this.resetBoundingVolumes(a)}computeBoundingBox(){null===this.originalGeometry.boundingBox&&this.originalGeometry.computeBoundingBox();const e=this.m_originalBoundingBox.copy(this.originalGeometry.boundingBox);null===this.boundingBox?this.boundingBox=e.clone():this.boundingBox.copy(e),l(this.boundingBox,this.displacementRange,o.fromBufferAttribute(this.attributes.normal,0))}computeBoundingSphere(){null===this.boundingBox&&this.computeBoundingBox(),null===this.boundingSphere&&(this.boundingSphere=new r.Sphere),this.boundingBox.getBoundingSphere(this.boundingSphere)}needsBoundingBoxUpdate(e){return e||null!==this.boundingBox&&(!this.originalGeometry.boundingBox||!this.m_originalBoundingBox.equals(this.originalGeometry.boundingBox))}resetBoundingVolumes(e){this.needsBoundingBoxUpdate(e)&&(this.computeBoundingBox(),this.boundingSphere&&this.computeBoundingSphere())}resetAttributes(){this.index=this.originalGeometry.index,this.groups=this.originalGeometry.groups,this.drawRange=this.originalGeometry.drawRange,this.attributes=Object.assign({},this.originalGeometry.attributes),this.attributes.position=this.m_displacedPositions}}t.DisplacedBufferGeometry=c},2016:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplacedMesh=void 0;const r=i(30462),n=i(38338),o=i(84428),a=i(5905),s=i(95010);class l extends o.Mesh{constructor(e,t,i,r){super(e,t),this.m_getDisplacementRange=i,this.m_raycastStrategy=r}static getDisplacedPositionAttribute(e,t){return l.displacedPositions?l.displacedPositions.reset(e.attributes.position,e.attributes.normal,e.attributes.uv,t):l.displacedPositions=new a.DisplacedBufferAttribute(e.attributes.position,e.attributes.normal,e.attributes.uv,t),l.displacedPositions}raycast(e,t){const i=this.firstMaterial;if(!function(e){const t=r.hasDisplacementFeature(e);return n.assert(t,"Material does not support displacement maps."),t}(i)||!function(e){if(!e)return!1;const t=e instanceof o.DataTexture;return n.assert(t,"Material does not support displacement maps."),t}(i.displacementMap))return void super.raycast(e,t);const a=i.displacementMap,c=Object.assign({},this.m_getDisplacementRange());n.assert(this.geometry instanceof o.BufferGeometry,"Unsupported geometry type.");const u=this.geometry;this.displacedGeometry?this.displacedGeometry.reset(u,a,c):this.displacedGeometry=new s.DisplacedBufferGeometry(u,a,c,l.getDisplacedPositionAttribute(u,a)),this.geometry=this.displacedGeometry,this.m_raycastStrategy?this.m_raycastStrategy(this,e,t):super.raycast(e,t),super.geometry=this.displacedGeometry.originalGeometry}get firstMaterial(){return Array.isArray(this.material)?this.material[0]:this.material}}t.DisplacedMesh=l},95740:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LodMesh=void 0;const r=i(84428);class n extends r.Mesh{constructor(e,t){super(void 0,t),this.geometries=e}set geometries(e){this.m_geometries!==e&&this.disposeGeometries(),this.m_geometries=e,this.geometries&&this.m_geometries.length>0&&(this.geometry=this.m_geometries[0])}get geometries(){return this.m_geometries}setLevelOfDetail(e){this.m_geometries&&0!==this.m_geometries.length&&(e=r.MathUtils.clamp(e,0,this.m_geometries.length-1),this.geometry=this.m_geometries[e])}disposeGeometries(){if(this.m_geometries)for(const e of this.m_geometries)e.dispose();this.geometry.dispose()}}t.LodMesh=n},63978:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Object3DUtils=void 0;const r=i(30462),n=i(38338),o=i(84428),a=i(84070),s=n.LoggerManager.instance.create("Object3DUtils");!function(e){function t(e,t,i){if(null==e||void 0===e.image||null===e.image)return;if(void 0!==e.uuid&&!0===i.get(e.uuid))return;i.set(e.uuid,!0);const r=e.image,n=4*r.width*r.height;t.heapSize+=n,t.gpuSize+=n}function i(e,i,n){if(void 0===e.uuid||!0!==n.get(e.uuid))if(n.set(e.uuid,!0),e instanceof o.RawShaderMaterial||e instanceof o.ShaderMaterial){const r=e;for(const e in r.uniforms)if(void 0!==r.uniforms[e]){const a=r.uniforms[e];a instanceof o.Texture&&t(a,i,n)}}else if(e instanceof o.MeshBasicMaterial||e instanceof r.MapMeshBasicMaterial){const r=e;t(r.map,i,n),t(r.aoMap,i,n),t(r.specularMap,i,n),t(r.alphaMap,i,n),t(r.envMap,i,n)}else if(e instanceof r.MapMeshStandardMaterial){const r=e;t(r.map,i,n),t(r.lightMap,i,n),t(r.aoMap,i,n),t(r.emissiveMap,i,n),t(r.bumpMap,i,n),t(r.normalMap,i,n),t(r.displacementMap,i,n),t(r.roughnessMap,i,n),t(r.metalnessMap,i,n),t(r.alphaMap,i,n),t(r.envMap,i,n)}else e instanceof o.LineBasicMaterial||e instanceof o.LineDashedMaterial||e instanceof o.PointsMaterial||s.warn("estimateMeshSize: unidentified material: ",e)}function n(e,t,i,r){if(void 0===e.uuid&&(e.uuid=o.MathUtils.generateUUID()),!0===r.get(e.uuid))return;r.set(e.uuid,!0);let n=0,a=4;void 0!==e.array.BYTES_PER_ELEMENT&&(a=e.array.BYTES_PER_ELEMENT),e instanceof o.InterleavedBufferAttribute||e instanceof o.BufferAttribute?n=a*e.count*e.itemSize:s.warn("estimateMeshSize: unidentified attribute: ",t),i.heapSize+=n+56,i.gpuSize+=n}function l(e,t,i){if(void 0!==e.uuid&&!0===i.get(e.uuid))return;if(i.set(e.uuid,!0),void 0===e)return;const r=e.attributes;if(void 0!==r){for(const e in r)void 0!==r[e]&&n(r[e],e,t,i);null!==e.index&&n(e.index,"index",t,i)}else s.warn("estimateGeometrySize: unidentified geometry: ",e)}e.estimateSize=function e(t,r,n){const c=void 0!==r?r:{heapSize:0,gpuSize:0};if(void 0===n&&(n=new Map),function(e,t,r){if(e.isObject3D&&!(e instanceof o.Scene)&&(void 0===e.uuid||!0!==r.get(e.uuid)))if(r.set(e.uuid,!0),e.isMesh||e.isLine||e.isPoints){let n=1e3;const o=0,s=e;if(void 0!==s.material)if(Array.isArray(s.material)){const e=s.material;for(const n of e)i(n,t,r)}else i(s.material,t,r);if(void 0!==s.geometries)for(const e of s.geometries)l(e,t,r);else void 0!==s.geometry&&l(s.geometry,t,r);const c=void 0!==e.userData?e.userData.feature:void 0;void 0!==c&&(n+=a.getFeatureDataSize(c)),t.heapSize+=n,t.gpuSize+=o}else s.warn("estimateMeshSize: unidentified object",e)}(t,c,n),t.children.length>0)for(const i of t.children)e(i,c,n);return c}}(t.Object3DUtils||(t.Object3DUtils={}))},62414:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.projectTilePlaneCorners=void 0;const r=i(32941),n=i(84428);t.projectTilePlaneCorners=function(e,t){const{east:i,west:o,north:a,south:s}=e.geoBox;return{sw:t.projectPoint(new r.GeoCoordinates(s,o),new n.Vector3),se:t.projectPoint(new r.GeoCoordinates(s,i),new n.Vector3),nw:t.projectPoint(new r.GeoCoordinates(a,o),new n.Vector3),ne:t.projectPoint(new r.GeoCoordinates(a,i),new n.Vector3)}}},54465:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTileObject=void 0;const r=i(38125);t.registerTileObject=function(e,t,i,n){const o=i instanceof Set?Array.from(i.values()):Array.isArray(i)?i:[i];r.MapObjectAdapter.create(t,Object.assign({dataSource:e.dataSource,kind:o,level:e.tileKey.level},n)),void 0===t.userData&&(t.userData={});const a=t.userData;a.tileKey=e.tileKey,a.dataSource=e.dataSource.name,a.kind=o,e.resetVisibilityCounter()}},67862:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolidLineMesh=void 0;const r=i(32941),n=i(30462),o=i(38338),a=i(84428),s=i(95010),l=new a.Sphere,c=new a.Matrix4,u=new a.Ray,d=new a.Line3,h=new a.Box3,m=new r.OrientedBox3,p=new a.Plane,f=new a.Vector3,g=new a.Vector3,y=new a.Vector3,v=new a.Vector3;function _(e,t,i){let r;e instanceof s.DisplacedBufferGeometry&&(r=e.displacementRange,e=e.originalGeometry);const n=e.attributes.position,o=e.index.array,l=new a.Sphere,c=h.makeEmpty(),u=f;for(let e=t;e<i;e+=6)c.expandByPoint(u.fromBufferAttribute(n,o[e])),c.expandByPoint(u.fromBufferAttribute(n,o[e+2]));if(r){const t=g;return t.fromBufferAttribute(e.attributes.normal,0),s.displaceBox(c,r,t).getBoundingSphere(l)}return c.getBoundingSphere(l)}function b(e,t,i,r,n,o,s,l){if(s.equals(e.origin)&&0===e.direction.dot(o.normal)){const n=function(e,t,i,r,n){var o;const a=m;return t.getCenter(a.position),t.delta(a.xAxis).normalize(),a.yAxis.copy(i),a.zAxis.copy(r),a.extents.set(t.distance()/2,n,n),a.contains(e.origin)?0:null!==(o=a.intersectsRay(e))&&void 0!==o?o:1/0}(e,t,i,o.normal,r),s=function(e,t,i){const r=new a.Sphere(t.start,i),n=r.containsPoint(e.origin)?0:e.intersectSphere(r,v)?v.sub(e.origin).length():1/0;r.center.copy(t.end);const o=r.containsPoint(e.origin)?0:e.intersectSphere(r,v)?v.sub(e.origin).length():1/0;return Math.min(n,o)}(e,t,r),c=Math.min(n,s);return c!==1/0&&(e.at(c,l),!0)}return!(s.distanceToSquared(t.closestPointToPoint(s,!0,v))>n||(l.copy(s),0))}function S(e,t,i,r,n,o,a,s,c,u){const h=f,m=p,v=g,_=d,S=e.geometry,T=S.attributes,E=T.position,C=T.biTangent,w=S.index.array;if(l.copy(c),l.applyMatrix4(e.matrixWorld),l.radius+=r,t.ray.intersectsSphere(l))for(let r=a;r<s;r+=6){const a=w[r],s=w[r+2];if(_.start.fromBufferAttribute(E,a),_.end.fromBufferAttribute(E,s),h.set(C.getX(a),C.getY(a),C.getZ(a)).normalize(),m.setFromCoplanarPoints(_.start,y.copy(_.start).add(h),_.end),0===m.normal.manhattanLength())continue;if(!i.intersectPlane(m,v))continue;const l=y;if(!b(i,_,h,n,o,m,v,l))continue;const c=l.applyMatrix4(e.matrixWorld),d=t.ray.origin.distanceTo(c);d<t.near||d>t.far||u.push({distance:d,point:c.clone(),index:r,object:e})}}const T=[0],E=.01;function C(e,t,i,r,s,l,c){var u;const d=e.userData.feature.boundingVolumes;o.assert(e.geometry instanceof a.BufferGeometry,"Unsupported geometry type.");const h=e.geometry;o.assert(function(e){return Array.isArray(e)?e.every((e=>e instanceof n.SolidLineMaterial)):e instanceof n.SolidLineMaterial}(t),"Unsupported material type");const m=t,p=(m.lineWidth+m.outlineWidth)/2;o.assert(Math.abs(1-e.scale.x/e.scale.y)<E),o.assert(Math.abs(1-e.scale.x/e.scale.z)<E),o.assert(Math.abs(1-e.scale.y/e.scale.z)<E);const f=p/((e.scale.x+e.scale.y+e.scale.z)/3),g=f*f,y=null!==(u=e.userData.feature.starts)&&void 0!==u?u:T;let v=s,b=y[v];const C=y.length-1;for(;b<l;){const t=v,n=v<C?y[++v]:l;t>=d.length&&d.push(_(h,b,n)),S(e,i,r,p,f,g,b,n,d[t],c),b=n}return v}class w extends a.Mesh{static raycast(e,t,i){o.assert(e.geometry instanceof a.BufferGeometry,"Unsupported geometry type");const r=e.geometry;o.assert(null!==r.index,"Geometry does not have indices");const n=e.matrixWorld;c.copy(n).invert();const s=u.copy(t.ray).applyMatrix4(c);void 0===e.userData.feature&&(e.userData.feature={});const l=r.attributes.position,d=e.userData.feature.attributeInfo;(void 0===d||void 0===e.userData.feature.boundingVolumes||function(e,t){const i=!0===e.isBufferAttribute?e:e.data;return void 0===t||t.data!==i||e.isBufferAttribute&&t.version!==i.version}(l,d))&&(e.userData.feature.boundingVolumes=[],e.userData.feature.attributeInfo=function(e){const t=!0===e.isBufferAttribute?e:e.data;return{data:t,version:t.version}}(l));const h=r.index.array;if(Array.isArray(e.material)){let n=0;for(const o of r.groups)n=C(e,e.material[o.materialIndex],t,s,n,o.start+o.count,i)}else C(e,e.material,t,s,0,h.length,i)}constructor(e,t){super(e,t)}raycast(e,t){w.raycast(this,e,t)}}t.SolidLineMesh=w},27462:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileDataAccessor=void 0;const r=i(96500),n=i(38338),o=i(43867),a=n.LoggerManager.instance.create("TileDataAccessor");t.TileDataAccessor=class{constructor(e,t,i){this.tile=e,this.visitor=t;const r=!0===i.wantsAll;this.m_wantsPoints=r||!(!1===i.wantsPoints),this.m_wantsLines=r||!(!1===i.wantsLines),this.m_wantsAreas=r||!(!1===i.wantsAreas),this.m_wantsObject3D=r||!(!1===i.wantsObject3D)}visitAll(){const e=this.tile.objects;for(const t of e)this.visitObject(t)}visitObject(e){const t=void 0!==e.userData?e.userData.feature:void 0;if(void 0===t||void 0!==t.objInfos&&1===t.objInfos.length&&!this.visitor.wantsFeature(r.getFeatureId(t.objInfos[0])))return;const i=t.geometryType;if(void 0===i)return void a.warn("#visitObject: visiting object failed, no geometryType",e);switch(n.assert(void 0!==t.objInfos,"featureData.ids missing"),n.assert(void 0!==t.starts,"featureData.starts missing"),n.assert(Array.isArray(t.starts),"featureData.starts is not an array"),void 0!==t.objInfos&&void 0!==t.starts&&n.assert(t.objInfos.length===t.starts.length,"featureData.ids and featureData.starts have unequal length"),i){case r.GeometryType.Point:case r.GeometryType.Text:if(!this.m_wantsPoints)return;break;case r.GeometryType.SolidLine:case r.GeometryType.ExtrudedLine:case r.GeometryType.TextPath:if(!this.m_wantsLines)return;break;case r.GeometryType.Polygon:case r.GeometryType.ExtrudedPolygon:if(!this.m_wantsAreas)return;break;case r.GeometryType.Object3D:if(!this.m_wantsObject3D)return;break;default:a.warn("#visitObject: invalid geometryType")}if("Mesh"!==e.type)return void a.warn("#visitObject: visiting object failed, not of type 'Mesh'",e);const o=e;this.visitMesh(o,t)}getBufferGeometry(e){const t=e.geometry;if("BufferGeometry"!==t.type)return void a.warn("#visitObject: object does not have BufferGeometry");const i=t;if(i.getAttribute("position"))return i;a.warn("#visitLines: BufferGeometry has no position attribute")}getGeometryAccessor(e,t,i){switch(e){case r.GeometryType.Point:case r.GeometryType.Text:return;case r.GeometryType.SolidLine:case r.GeometryType.ExtrudedLine:case r.GeometryType.TextPath:return new o.BufferedGeometryLineAccessor(t,e,i);case r.GeometryType.Polygon:case r.GeometryType.ExtrudedPolygon:return;case r.GeometryType.Object3D:return new o.BufferedGeometryObject3dAccessor(t,e,i);default:a.warn("#getGeometryAccessor: invalid geometryType")}}getIndexedGeometryAccessor(e,t,i){switch(e){case r.GeometryType.Point:case r.GeometryType.Text:return;case r.GeometryType.SolidLine:case r.GeometryType.ExtrudedLine:case r.GeometryType.TextPath:return new o.IndexedBufferedGeometryLineAccessor(t,e,i);case r.GeometryType.Polygon:case r.GeometryType.ExtrudedPolygon:case r.GeometryType.Object3D:return;default:a.warn("#getIndexedGeometryAccessor: invalid geometryType")}}visitMesh(e,t){const{objInfos:i,starts:s}=t,l=t.geometryType;if(void 0===i||void 0===s||void 0===l)return;let c;for(let t=0;t<i.length;t++){const u=r.getFeatureId(i[t]);if(!this.visitor.wantsFeature(u))continue;const d=s[t];let h=-1;if(void 0===c){const t=this.getBufferGeometry(e);if(void 0===t)continue;if(c=null!==t.index?this.getIndexedGeometryAccessor(l,e,t):this.getGeometryAccessor(l,e,t),void 0===c){a.warn("#visitObject: no accessor geometryType",l);continue}}switch(h=t<s.length-1?s[t+1]:c.getCount(),c.setRange(d,h),l){case r.GeometryType.Point:case r.GeometryType.Text:this.visitor.visitPoint(u);break;case r.GeometryType.SolidLine:case r.GeometryType.ExtrudedLine:case r.GeometryType.TextPath:n.assert(o.isLineAccessor(c)),this.visitor.visitLine(u,c);break;case r.GeometryType.Polygon:case r.GeometryType.ExtrudedPolygon:this.visitor.visitArea(u);break;case r.GeometryType.Object3D:n.assert(o.isObject3dAccessor(c)),this.visitor.visitObject3D(u,c);break;default:a.warn("#visitObject: invalid geometryType")}}}}},43867:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedBufferedGeometryLineAccessor=t.IndexedBufferedGeometryAccessor=t.BufferedGeometryObject3dAccessor=t.BufferedGeometryLineAccessor=t.BufferedGeometryAccessor=t.BufferedGeometryAccessorBase=t.isObject3dAccessor=t.isLineAccessor=void 0;const r=i(96500),n=i(10791),o=i(38338),a=o.LoggerManager.instance.create("TileGeometry");t.isLineAccessor=function(e){return"function"==typeof e.isLineAccessor&&!0===e.isLineAccessor()},t.isObject3dAccessor=function(e){return"function"==typeof e.isObject3dAccessor&&!0===e.isObject3dAccessor()};class s{constructor(e,t,i){this.object=e,this.geometryType=t,this.bufferGeometry=i,this.start=-1,this.end=-1,this.startCapSize=0,this.endCapSize=0,o.assert(!!e),"BufferGeometry"!==i.type&&a.error("IndexedBufferedGeometryAccessor#constructor: BufferGeometry has wrong type"),o.assert("BufferGeometry"===i.type,"IndexedBufferedGeometryAccessor#constructor: BufferGeometry has wrong type"),this.position=this.bufferGeometry.getAttribute("position"),this.itemSize=this.position.itemSize,this.position||a.warn("BufferedGeometryAccessor#constructor: BufferGeometry has no position attribute"),this.position.array.constructor!==Float32Array&&a.warn("BufferedGeometryAccessor#constructor: BufferGeometry.position: unsupported ArrayBuffer")}getCount(){return this.position.count}get renderOrder(){return this.object.renderOrder}setRange(e,t,i=0,r=0){o.assert(e>=0),o.assert(t>=0),o.assert(e<=t),this.start=e,this.end=t,this.startCapSize=i,this.endCapSize=r}get color(){const e=e=>{const t=e;if("MeshBasicMaterial"===t.type||"MeshStandardMaterial"===t.type)return t.color;if("RawShaderMaterial"===t.type){const t=e;if("SolidLineMaterial"===t.name)return t.uniforms.diffuseColor.value;a.warn("BufferedGeometryAccessor#color: unknown shader material name",t.name)}else a.warn("BufferedGeometryAccessor#color: unknown material type",t.type)};if(Array.isArray(this.object.material)){const t=new Array,i=this.object.material;for(const r of i)t.push(e(r));return t}return e(this.object.material)}}t.BufferedGeometryAccessorBase=s;class l extends s{constructor(e,t,i,r){super(e,t,i),this.object=e,this.geometryType=t,this.bufferGeometry=i,this.stride=r}clear(){o.assert(this.checkSetUp(),"BufferedGeometryAccessor not setup");const e=this.position.array,t=this.start*this.itemSize,i=this.end*this.itemSize;for(let r=t;r<i;r++)e[r]=0;this.position.needsUpdate=!0}getVertices(){o.assert(this.checkSetUp(),"BufferedGeometryAccessor not setup");const e=this.start,t=this.end;return this.position.array.subarray(e*this.itemSize,t*this.itemSize)}checkSetUp(){return void 0!==this.position&&void 0!==this.start&&void 0!==this.end&&this.start>=0&&this.end<=this.position.count&&this.start<=this.end}}t.BufferedGeometryAccessor=l,t.BufferedGeometryLineAccessor=class extends l{constructor(e,t,i){super(e,t,i,3),this.object=e,this.geometryType=t,this.bufferGeometry=i}isLineAccessor(){return!0}get width(){o.assert(this.checkSetUp(),"RoBufferedGeometryLineAccessor not setup")}},t.BufferedGeometryObject3dAccessor=class extends l{constructor(e,t,i){super(e,t,i,1),this.object=e,this.geometryType=t,this.bufferGeometry=i}isObject3dAccessor(){return!0}getVertices(){return super.getVertices()}};class c extends s{constructor(e,t,i,r,n){super(e,t,i),this.object=e,this.geometryType=t,this.bufferGeometry=i,this.indices=null!==this.bufferGeometry.index?this.bufferGeometry.index.array:void 0,this.indices?this.indices instanceof Uint32Array||(a.warn("IndexedBufferedGeometryAccessor#constructor: BufferGeometry index has wrong type"),o.assert(this.indices instanceof Uint32Array)):(a.warn("IndexedBufferedGeometryAccessor#constructor: BufferGeometry has no index"),o.assert(!!this.indices))}getCount(){return this.indices.length}checkSetUp(){return!!this.indices&&void 0!==this.start&&void 0!==this.end&&this.start>=0&&this.end<=this.indices.length&&this.start<=this.end}}t.IndexedBufferedGeometryAccessor=c,t.IndexedBufferedGeometryLineAccessor=class extends c{constructor(e,t,i){super(e,t,i,3),this.object=e,this.geometryType=t,this.bufferGeometry=i}isLineAccessor(){return!0}get width(){if(o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup"),this.geometryType===r.GeometryType.ExtrudedLine){const e=this.start+this.startCapSize,t=this.position.array;return n.reconstructLineWidth(t,e)}}clear(){o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup");const e=this.start,t=this.end;for(let i=e;i<t;i++)this.indices[i]=0;null!==this.bufferGeometry.index&&(this.bufferGeometry.index.needsUpdate=!0)}getVertices(){o.assert(this.checkSetUp(),"RoIndexedBufferedGeometryLineAccessor not setup");const e=this.itemSize,t=this.start,i=this.end,r=new Float32Array((i-t)*e),n=this.position.array;if(2===e)for(let o=t,a=0;o<i;o++,a+=e){const t=this.indices[o];r[a+0]=n[t*e+0],r[a+1]=n[t*e+1]}if(3===e)for(let o=t,a=0;o<i;o++,a+=e){const t=this.indices[o];r[a+0]=n[t*e+0],r[a+1]=n[t*e+1],r[a+2]=n[t*e+2]}else for(let o=t,a=0;o<i;o++,a++){const t=this.indices[o];for(let i=0;i<e;i++)r[a*e+i]=n[t*e+i]}return r}}},63498:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileGeometryCreator=void 0;const r=i(96500),n=i(32941),o=i(30462),a=i(38338),s=i(84428),l=i(37337),c=i(47678),u=i(48874),d=i(468),h=i(81237),m=i(73553),p=i(54465),f=a.LoggerManager.instance.create("TileGeometryCreator"),g=new s.Vector3,y=new s.Vector2;class v{constructor(){this.bufferAttributes=new Map,this.interleavedAttributes=new Map}}class _ extends r.CallExpr{constructor(e){super("memo",[e]),this.m_cachedProperties=[],this.m_deps=Array.from(e.dependencies().properties),this.descriptor=this}call(e){let t=!1;return this.m_deps.forEach(((i,r)=>{const n=e.env.lookup(i);t||n===this.m_cachedProperties[r]||(t=!0),t&&(this.m_cachedProperties[r]=n)})),(t||void 0===this.m_cachedValue)&&(this.m_cachedValue=e.evaluate(this.args[0])),this.m_cachedValue}}class b{constructor(e,t,i){this.geometry=e,this.info=t,this.cache=i}getBufferAttribute(e){if(this.cache.bufferAttributes.has(e))return this.cache.bufferAttributes.get(e);const t=l.getBufferAttribute(e);return this.cache.bufferAttributes.set(e,t),t}getInterleavedBufferAttributes(e){const t=this.cache.interleavedAttributes.get(e);if(t)return t;const i=new(r.getArrayConstructor(e.type))(e.buffer),n=new s.InterleavedBuffer(i,e.stride),o=e.attributes.map((e=>{const t=new s.InterleavedBufferAttribute(n,e.itemSize,e.offset,!1);return{name:e.name,attribute:t}}));return this.cache.interleavedAttributes.set(e,o),o}}function S(e,t){if(Array.isArray(e)){const i=e;t.push(...i)}else t.push(e)}class T{constructor(){}static get instance(){return this.m_instance||(this.m_instance=new T)}initDecodedTile(e,t,i){for(const r of e.techniques){const e=r.kind;void 0===e||e instanceof Set&&0===e.size?r._kindState=!0:r._kindState=!(void 0!==i&&i.hasOrIntersects(e))||void 0!==t&&t.hasOrIntersects(e)}for(const t of e.geometries)for(const e of t.groups)e.createdOffsets=[]}createAllGeometries(e,t){const i=e=>!1!==e._kindState;let o=Promise.resolve();return this.createObjects(e,t,(t=>{o=Promise.all([o,t.then((t=>(e.addOwnedTexture(t),t.image?new Promise((i=>{t.onUpdate=()=>{t.onUpdate=null,i()},e.mapView.renderer.initTexture(t)})):Promise.resolve()))).catch((()=>{}))])}),i),this.preparePois(e,t),this.createTextElements(e,t,(e=>!!(r.isPoiTechnique(e)||r.isLineMarkerTechnique(e)||r.isTextTechnique(e))&&i(e))),this.createLabelRejectionElements(e,t),e.dataSource.addGroundPlane&&e.projection.type===n.ProjectionType.Planar&&m.addGroundPlane(e,-1),o}createLabelRejectionElements(e,t){if(void 0!==t.pathGeometries)for(const i of t.pathGeometries)e.addBlockingElement(new d.PathBlockingElement(i.path))}processTechniques(e,t,i){const n=e.decodedTile;if(void 0===n)return;this.initDecodedTile(n,t,i);const o=e.dataSource.exprPool;n.techniques.forEach((e=>{for(const t in e){if(!e.hasOwnProperty(t))continue;const i=e[t];if(r.isJsonExpr(i)&&"kind"!==t)try{let n=r.Expr.fromJSON(i);!0!==n.dependencies().volatile&&(n=new _(r.Expr.fromJSON(i))),e[t]=n.intern(o)}catch(e){f.error("Failed to compile expression:",e)}}}))}prepareTextPaths(e,t,i){const n=new Array,o=e.slice();for(;o.length>0;){const e=o.pop();if(void 0===e)break;const a=t.techniques[e.technique];r.isTextTechnique(a)&&(void 0===i||i(a))&&n.push(e)}return n}createTextElements(e,t,i){var n;const o=e.mapView,a=e.computeWorldOffsetX(),l=Math.floor(o.zoomLevel),c=new r.MapEnv({$zoom:l},o.env),u=new h.TextElementBuilder(c,e.textStyleCache,e.dataSource.dataSourceOrder);if(void 0!==t.textPathGeometries){const n=this.prepareTextPaths(t.textPathGeometries,t,i);for(const o of n){const n=t.techniques[o.technique];if(!1===n._kindState||!r.isTextTechnique(n)||void 0!==i&&!i(n))continue;const l=[];for(let e=0;e<o.path.length;e+=3)l.push(new s.Vector3(o.path[e]+a,o.path[e+1],o.path[e+2]));const c=u.withTechnique(n).build(o.text,l,e.offset,e.dataSource.name,e.dataSource.dataSourceOrder,o.objInfos,o.pathLengthSqr);e.addTextElement(c)}}if(void 0!==t.textGeometries)for(const o of t.textGeometries){if(void 0===o.technique||void 0===o.stringCatalog)continue;const l=t.techniques[o.technique];if(!1===l._kindState||!r.isTextTechnique(l)||void 0!==i&&!i(l))continue;const c=new s.BufferAttribute(new Float64Array(o.positions.buffer),o.positions.itemCount),d=c.count;if(!(d<1)){u.withTechnique(l);for(let t=0;t<d;++t){const i=c.getX(t)+a,r=c.getY(t),l=c.getZ(t),d=o.stringCatalog[o.texts[t]];if(void 0===d)continue;const h=null===(n=o.objInfos)||void 0===n?void 0:n[t],m=new s.Vector3(i,r,l),p=u.build(d,m,e.offset,e.dataSource.name,e.dataSource.dataSourceOrder,h);e.addTextElement(p)}}}}createObjects(e,t,i,d){var h,m,f,v,_,b;const T=e.mapView,E=[],C=[],w=T.animatedExtrusionHandler,x=Math.floor(T.zoomLevel),P=new r.MapEnv({$zoom:x},T.env),O=e.objects,A=T.viewRanges,D=void 0!==T.elevationProvider;for(const x of this.getAttachments(t)){const R=x.geometry,I=x.info.groups,M=I.length;for(let L=0;L<M;){const k=I[L++],N=k.start,U=k.technique,j=t.techniques[U];if(void 0===k.createdOffsets&&(k.createdOffsets=[]),k.createdOffsets.includes(e.offset)||!1===j._kindState||void 0!==d&&!d(j))continue;let F=k.count;for(k.createdOffsets.push(e.offset);L<M&&I[L].technique===U&&N+F===I[L].start;++L)F+=I[L].count,I[L].createdOffsets.push(e.offset);if(!l.usesObject3D(j))continue;const V=null!==(h=null==w?void 0:w.setAnimationProperties(j,P))&&void 0!==h&&h;let B=E[U];if(void 0===B){if(B=l.createMaterial(T.renderer.capabilities,{technique:j,env:T.env,fog:null!==T.scene.fog,shadowsEnabled:T.shadowsEnabled},i),void 0===B)continue;V&&o.hasExtrusionFeature(B)&&S(B,C),E[U]=B}const G=j.kind;r.isTerrainTechnique(j)&&this.setupTerrainMaterial(j,B,e.mapView.clearColor);const z=new s.BufferGeometry;null===(m=R.vertexAttributes)||void 0===m||m.forEach((e=>{const t=x.getBufferAttribute(e);z.setAttribute(e.name,t)})),null===(f=R.interleavedVertexAttributes)||void 0===f||f.forEach((e=>{x.getInterleavedBufferAttributes(e).forEach((({name:e,attribute:t})=>z.setAttribute(e,t)))}));const H=null!==(v=x.info.index)&&void 0!==v?v:R.index;if(H&&z.setIndex(x.getBufferAttribute(H)),!z.getAttribute("normal")&&r.needsVertexNormals(j)&&z.computeVertexNormals(),z.addGroup(N,F),r.isSolidLineTechnique(j)){a.assert(!o.isHighPrecisionLineMaterial(B));const t=B;!0===j.clipping&&e.projection.type===n.ProjectionType.Planar&&(e.boundingBox.getSize(g),y.set(g.x,g.y),t.clipTileSize=y),z.getAttribute("color")&&o.setShaderMaterialDefine(t,"USE_COLOR",!0)}const q=r.isSolidLineTechnique(j)&&void 0!==j.secondaryWidth,W=r.Expr.isExpr(j.enabled)&&R.featureStarts&&R.featureStarts.length>0,K=l.buildObject(j,z,W?[B]:B,e,D);if(K.renderOrder=r.getPropertyValue(j.renderOrder,T.env),void 0!==x.info.uuid&&(K.uuid=x.info.uuid,K.userData.geometryId=x.info.uuid),(r.isCirclesTechnique(j)||r.isSquaresTechnique(j))&&void 0!==j.enablePicking&&(K.enableRayTesting=j.enablePicking),r.isLineTechnique(j)||r.isSegmentsTechnique(j)){const e=this.getFadingParams(P,j);o.FadingFeature.addRenderHelper(K,A,e.fadeNear,e.fadeFar,!1)}if(r.isSolidLineTechnique(j)){const e=this.getFadingParams(P,j);o.FadingFeature.addRenderHelper(K,A,e.fadeNear,e.fadeFar,!1)}if(r.isExtrudedLineTechnique(j)&&void 0!==j.fadeFar){const e=this.getFadingParams(T.env,j);o.FadingFeature.addRenderHelper(K,A,e.fadeNear,e.fadeFar,!0)}if(this.addUserData(e,R,j,K),r.isExtrudedPolygonTechnique(j)?(K.castShadow=T.shadowsEnabled,K.receiveShadow=T.shadowsEnabled):(r.isStandardTechnique(j)||r.isFillTechnique(j))&&(K.receiveShadow=T.shadowsEnabled),(r.isExtrudedPolygonTechnique(j)||r.isStandardTechnique(j)||r.isFillTechnique(j))&&void 0!==j.fadeFar){const e=this.getFadingParams(P,j);o.FadingFeature.addRenderHelper(K,A,e.fadeNear,e.fadeFar,!0)}if(r.isExtrudedPolygonTechnique(j)&&c.isRenderDepthPrePassEnabled(j,P)){const t=c.createDepthPrePassMesh(K);this.addUserData(e,R,j,t),p.registerTileObject(e,t,G,{technique:j,pickability:r.Pickability.transient}),O.push(t),V&&S(t.material,C),c.setDepthPrePassStencil(t,K)}const $=r.transientToPickability(r.getPropertyValue(j.transient,T.env));if(p.registerTileObject(e,K,G,{technique:j,pickability:q?r.Pickability.transient:$}),O.push(K),r.isExtrudedPolygonTechnique(j)&&void 0!==x.info.edgeIndex){const t=r.Expr.isExpr(j.enabled)&&R.edgeFeatureStarts&&R.edgeFeatureStarts.length>0,i=j,n=new s.BufferGeometry;n.setAttribute("position",z.getAttribute("position"));const a=z.getAttribute("color");void 0!==a&&n.setAttribute("color",a);const l=z.getAttribute("extrusionAxis");void 0!==l&&n.setAttribute("extrusionAxis",l);const c=z.getAttribute("normal");void 0!==c&&n.setAttribute("normal",c);const d=z.getAttribute("uv");void 0!==d&&n.setAttribute("uv",d),n.setIndex(x.getBufferAttribute(x.info.edgeIndex));const h=j,m=this.getPolygonFadingParams(P,h),f={color:m.color,colorMix:m.colorMix,fadeNear:m.lineFadeNear,fadeFar:m.lineFadeFar,extrusionRatio:V?0:void 0,vertexColors:!!z.getAttribute("color"),rendererCapabilities:T.renderer.capabilities},g=new o.EdgeMaterial(f),y=new s.LineSegments(n,t?[g]:g);this.addUserData(e,R,j,y),y.renderOrder=K.renderOrder+.1,o.FadingFeature.addRenderHelper(y,A,m.lineFadeNear,m.lineFadeFar,!1),V&&S(y.material,C),p.registerTileObject(e,y,G,{technique:j,pickability:r.Pickability.transient}),u.MapMaterialAdapter.create(g,{color:i.lineColor,objectColor:i.color,opacity:i.opacity,lineWidth:e=>{const t=r.getPropertyValue(i.lineWidth,e.env);return"number"==typeof t?s.MathUtils.clamp(t,0,1):0}}),O.push(y)}if(r.isExtrudedPolygonTechnique(j)&&V&&(K.customDepthMaterial=new o.MapMeshDepthMaterial({depthPacking:s.RGBADepthPacking}),S(K.customDepthMaterial,C)),r.isFillTechnique(j)&&x.info.edgeIndex){const t=r.Expr.isExpr(j.enabled)&&R.edgeFeatureStarts&&R.edgeFeatureStarts.length>0,i=new s.BufferGeometry;i.setAttribute("position",z.getAttribute("position")),i.setIndex(x.getBufferAttribute(x.info.edgeIndex));const n=j,a=this.getPolygonFadingParams(T.env,n),l={color:a.color,colorMix:a.colorMix,fadeNear:a.lineFadeNear,fadeFar:a.lineFadeFar,vertexColors:!!z.getAttribute("color"),rendererCapabilities:T.renderer.capabilities},c=new o.EdgeMaterial(l),d=new s.LineSegments(i,t?[c]:c);d.renderOrder=K.renderOrder+.1,o.FadingFeature.addRenderHelper(d,A,a.lineFadeNear,a.lineFadeFar,!1),this.addUserData(e,R,j,d),p.registerTileObject(e,d,G,{technique:j,pickability:$}),u.MapMaterialAdapter.create(c,{color:n.lineColor,objectColor:n.color,opacity:n.opacity}),O.push(d)}if(q){const t=j,i=B.clone();l.applyBaseColorToMaterial(i,i.color,t,null!==(_=t.secondaryColor)&&void 0!==_?_:0,P),void 0!==t.secondaryCaps&&(i.caps=r.getPropertyValue(t.secondaryCaps,T.env));const n=l.buildObject(j,z,i,e,D);n.renderOrder=(null!==(b=r.getPropertyValue(t.secondaryRenderOrder,T.env))&&void 0!==b?b:0)-1e-7,this.addUserData(e,R,j,n);const a=this.getFadingParams(P,j);o.FadingFeature.addRenderHelper(n,A,a.fadeNear,a.fadeFar,!1);const s=l.buildMetricValueEvaluator(t.secondaryWidth,t.metricUnit);p.registerTileObject(e,n,G,{technique:j});const c=u.MapMaterialAdapter.get(B),d=u.MapMaterialAdapter.create(i,{color:t.secondaryColor,opacity:t.opacity,caps:t.secondaryCaps,lineWidth:e=>{if(!c)return;c.ensureUpdated(e);const t=c.currentStyledProperties.lineWidth,i=r.getPropertyValue(s,T.env),n=d.currentStyledProperties.opacity;return"number"==typeof t&&"number"==typeof i?i<=t&&(null==n||1===n)?0:i:0}});O.push(n)}}}C.length>0&&T.animatedExtrusionHandler.add(e,C)}preparePois(e,t){void 0!==t.poiGeometries&&e.mapView.poiManager.addPois(e,t)}*getAttachments(e){const t=new v;for(const i of e.geometries){const e={index:i.index,edgeIndex:i.edgeIndex,uuid:i.uuid,groups:i.groups};if(yield new b(i,e,t),i.attachments)for(const e of i.attachments)yield new b(i,e,t)}}setupTerrainMaterial(e,t,i){if(!e.map||!e.displacementMap){const e=t;return e.color.set(i),void o.setDisplacementMapToMaterial(null,e)}t.onBeforeCompile=e=>{e.fragmentShader=e.fragmentShader.replace("#include <map_pars_fragment>","#include <map_pars_fragment>\n    uniform sampler2D displacementMap;\n    uniform float displacementScale;\n    uniform float displacementBias;"),e.fragmentShader=e.fragmentShader.replace("#include <map_fragment>",`#ifdef USE_MAP\n    float minElevation = ${n.EarthConstants.MIN_ELEVATION.toFixed(1)};\n    float maxElevation = ${n.EarthConstants.MAX_ELEVATION.toFixed(1)};\n    float elevationRange = maxElevation - minElevation;\n\n    float disp = texture2D( displacementMap, vUv ).x * displacementScale + displacementBias;\n    vec4 texelColor = texture2D( map, vec2((disp - minElevation) / elevationRange, 0.0) );\n    texelColor = mapTexelToLinear( texelColor );\n    diffuseColor *= texelColor;\n#endif`),e.vertexShader=e.vertexShader.replace("#include <displacementmap_vertex>","")},t.displacementMap.needsUpdate=!0}addUserData(e,t,i,n){if(r.isTerrainTechnique(i)){a.assert(0===Object.keys(n.userData).length,"Unexpected user data in terrain object"),a.assert("object"==typeof t.objInfos[0],"Wrong attribute map type for terrain geometry");const i=t.objInfos[0],r={tileKey:e.tileKey,texture:new s.DataTexture(i.buffer,i.xCountVertices,i.yCountVertices,s.LuminanceFormat,s.FloatType),displacementMap:i,geoBox:e.geoBox};n.userData=r}else{const e="LineSegments"===n.type&&(r.isExtrudedPolygonTechnique(i)||r.isFillTechnique(i)),o={geometryType:t.type,starts:e?t.edgeFeatureStarts:t.featureStarts,objInfos:t.objInfos};n.userData.feature=o,n.userData.technique=i}}getFadingParams(e,t){return{fadeNear:void 0!==t.fadeNear?r.getPropertyValue(t.fadeNear,e):o.FadingFeature.DEFAULT_FADE_NEAR,fadeFar:void 0!==t.fadeFar?r.getPropertyValue(t.fadeFar,e):o.FadingFeature.DEFAULT_FADE_FAR}}getPolygonFadingParams(e,t){let i,n=o.EdgeMaterial.DEFAULT_COLOR_MIX;if(void 0!==t.lineColor&&(i=r.getPropertyValue(t.lineColor,e),r.isExtrudedPolygonTechnique(t))){const e=t;n=void 0!==e.lineColorMix?e.lineColorMix:o.EdgeMaterial.DEFAULT_COLOR_MIX}const a=void 0!==t.fadeNear?r.getPropertyValue(t.fadeNear,e):o.FadingFeature.DEFAULT_FADE_NEAR,s=void 0!==t.fadeFar?r.getPropertyValue(t.fadeFar,e):o.FadingFeature.DEFAULT_FADE_FAR,l=void 0!==t.lineFadeNear?r.getPropertyValue(t.lineFadeNear,e):a,c=void 0!==t.lineFadeFar?r.getPropertyValue(t.lineFadeFar,e):s;return void 0===i&&(i=o.EdgeMaterial.DEFAULT_COLOR),{color:i,colorMix:n,fadeNear:a,fadeFar:s,lineFadeNear:l,lineFadeFar:c}}}t.TileGeometryCreator=T},85480:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileGeometryLoader=t.TileGeometryLoaderState=void 0;const r=i(96500),n=i(38338),o=i(17624),a=i(61257),s=i(63498);function l(e){const t=a.PerformanceStatistics.instance;if(t.enabled){const i=e.dataSource.name,r=e.tileKey.level,n=e.tileKey.column,o=e.tileKey.row,a=e.disposed?"disposed":"invisible";t.currentFrame.addMessage(`Decoded tile: ${i} # lvl=${r} col=${n} row=${o} DISCARDED - ${a}`)}}var c;!function(e){e[e.Initialized=0]="Initialized",e[e.CreationQueued=1]="CreationQueued",e[e.CreatingGeometry=2]="CreatingGeometry",e[e.Finished=3]="Finished",e[e.Canceled=4]="Canceled",e[e.Disposed=5]="Disposed"}(c=t.TileGeometryLoaderState||(t.TileGeometryLoaderState={}));class u{constructor(e,t){this.m_tile=e,this.m_taskQueue=t,this.m_priority=0,this.m_state=c.Initialized,this.m_finishedPromise=new Promise(((e,t)=>{this.m_resolveFinishedPromise=e,this.m_rejectFinishedPromise=t}))}static prepareAvailableGeometryKinds(e){const t=new r.GeometryKindSet;for(const i of e.techniques){const e=u.compileGeometryKind(i);if(e instanceof Set)for(const i of e)t.add(i);else t.add(e)}return t}static compileGeometryKind(e){let t=e.kind;return void 0===t?(t=r.isFillTechnique(e)?r.GeometryKind.Area:r.isLineTechnique(e)||r.isSolidLineTechnique(e)||r.isSegmentsTechnique(e)||r.isExtrudedLineTechnique(e)?r.GeometryKind.Line:r.isExtrudedPolygonTechnique(e)?r.GeometryKind.Building:r.isPoiTechnique(e)||r.isLineMarkerTechnique(e)||r.isTextTechnique(e)?r.GeometryKind.Label:r.GeometryKind.All,e.kind=t):Array.isArray(t)&&(t=e.kind=new r.GeometryKindSet(t)),t}set priority(e){this.m_priority=e}getPriority(){return this.m_priority}get tile(){return this.m_tile}get hasDecodedTile(){return void 0!==this.m_decodedTile}get isFinished(){return this.m_state===c.Finished}get isSettled(){return this.isFinished||this.isCanceled||this.isDisposed}waitFinished(){return this.m_finishedPromise}setDecodedTile(e){return this.m_decodedTile=e,this.hasDecodedTile&&(this.m_availableGeometryKinds=u.prepareAvailableGeometryKinds(this.m_decodedTile)),this.m_decodedTile}get availableGeometryKinds(){return this.m_availableGeometryKinds}update(e,t){const i=this.tile;this.tile.hasGeometry&&!this.compareGeometryKinds(e,t)&&this.reset(),this.m_state!==c.Initialized&&this.m_state!==c.Canceled||void 0===i.decodedTile||(this.m_state===c.Initialized&&(s.TileGeometryCreator.instance.processTechniques(i,e,t),this.setGeometryKinds(e,t),this.setDecodedTile(i.decodedTile)),this.queueGeometryCreation(e,t))}cancel(){var e;l(this.tile),this.m_state=c.Canceled,null===(e=this.m_rejectFinishedPromise)||void 0===e||e.call(this)}dispose(){var e;l(this.tile),this.clear(),this.m_state=c.Disposed,null===(e=this.m_rejectFinishedPromise)||void 0===e||e.call(this)}reset(){this.clear(),this.isSettled&&(this.m_finishedPromise=new Promise(((e,t)=>{this.m_resolveFinishedPromise=e,this.m_rejectFinishedPromise=t}))),this.m_state=c.Initialized}finish(){var e;this.m_decodedTile=void 0,this.m_state=c.Finished,null===(e=this.m_resolveFinishedPromise)||void 0===e||e.call(this)}clear(){var e,t,i;null===(e=this.m_availableGeometryKinds)||void 0===e||e.clear(),null===(t=this.m_enabledKinds)||void 0===t||t.clear(),null===(i=this.m_disabledKinds)||void 0===i||i.clear(),this.m_decodedTile=void 0}queueGeometryCreation(e,t){this.m_state!==c.CreationQueued&&(this.m_taskQueue.add({execute:this.createGeometry.bind(this,e,t),group:o.TileTaskGroups.CREATE,getPriority:this.getPriority.bind(this),isExpired:()=>this.m_state!==c.CreationQueued,estimatedProcessTime:()=>{var e,t;return(null!==(t=null===(e=this.tile.decodedTile)||void 0===e?void 0:e.decodeTime)&&void 0!==t?t:30)/6}}),this.m_state=c.CreationQueued)}async createGeometry(e,t){if(this.m_state===c.CreatingGeometry)return;this.m_state=c.CreatingGeometry;const i=this.tile,r=this.m_decodedTile;if(void 0===r)return void this.finish();const o=a.PerformanceStatistics.instance;let l=0;o.enabled&&(l=n.PerformanceTimer.now());const u=s.TileGeometryCreator.instance;i.clear(),u.initDecodedTile(r,e,t),await u.createAllGeometries(i,r),o.enabled&&this.addStats(o,l),this.finish(),i.dataSource.requestUpdate()}addStats(e,t){const i=this.tile,r=this.m_decodedTile;if(void 0===r)return;const o=n.PerformanceTimer.now()-t,a=e.currentFrame;a.addValue("render.fullFrameTime",o),a.addValue("render.geometryCreationTime",o),a.addValue("geometry.geometryCreationTime",o),a.addValue("geometryCount.numGeometries",r.geometries.length),a.addValue("geometryCount.numTechniques",r.techniques.length),a.addValue("geometryCount.numPoiGeometries",void 0!==r.poiGeometries?r.poiGeometries.length:0),a.addValue("geometryCount.numTextGeometries",void 0!==r.textGeometries?r.textGeometries.length:0),a.addValue("geometryCount.numTextPathGeometries",void 0!==r.textPathGeometries?r.textPathGeometries.length:0),a.addValue("geometryCount.numPathGeometries",void 0!==r.pathGeometries?r.pathGeometries.length:0),a.addMessage(`Decoded tile: ${i.dataSource.name} # lvl=${i.tileKey.level} col=${i.tileKey.column} row=${i.tileKey.row}`)}setGeometryKinds(e,t){var i,n;void 0!==e&&(this.m_enabledKinds=Object.assign(null!==(i=this.m_enabledKinds)&&void 0!==i?i:new r.GeometryKindSet,e)),void 0!==t&&(this.m_disabledKinds=Object.assign(null!==(n=this.m_disabledKinds)&&void 0!==n?n:new r.GeometryKindSet,t))}compareGeometryKinds(e,t){const i=this.m_enabledKinds===e,r=this.m_disabledKinds===t;if(i&&r)return!0;const n=!(void 0!==this.m_enabledKinds&&0!==this.m_enabledKinds.size||void 0!==e&&0!==e.size),o=!(void 0!==this.m_disabledKinds&&0!==this.m_disabledKinds.size||void 0!==t&&0!==t.size);if(n&&o||i&&o||r&&n)return!0;if(!n){if(void 0===e||void 0===this.m_enabledKinds)return!1;if(!e.has(this.m_enabledKinds))return!1}if(!o){if(void 0===t||void 0===this.m_disabledKinds)return!1;if(!t.has(this.m_disabledKinds))return!1}return!0}get isCanceled(){return this.m_state===c.Canceled}get isDisposed(){return this.m_state===c.Disposed}}t.TileGeometryLoader=u},69476:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileGeometryManager=void 0;const r=i(96500),n=i(38125);t.TileGeometryManager=class{constructor(e){this.mapView=e,this.enableFilterByKind=!0,this.enabledKinds=new r.GeometryKindSet,this.disabledKinds=new r.GeometryKindSet,this.hiddenKinds=new r.GeometryKindSet,this.m_visibilityCounter=1}get enabledGeometryKinds(){return this.enabledKinds}set enabledGeometryKinds(e){this.enabledKinds=e}get disabledGeometryKinds(){return this.disabledKinds}set disabledGeometryKinds(e){this.disabledKinds=e}get hiddenGeometryKinds(){return this.hiddenKinds}set hiddenGeometryKinds(e){this.hiddenKinds=e,this.incrementVisibilityCounter()}get visibilityCounter(){return this.m_visibilityCounter}updateTiles(e){let t=0;for(const i of e){const e=t++;i.updateGeometry(e,this.enableFilterByKind?this.enabledGeometryKinds:void 0,this.enableFilterByKind?this.disabledGeometryKinds:void 0)&&this.m_tileUpdateCallback&&this.m_tileUpdateCallback(i)}this.updateTileObjectVisibility(e)&&this.mapView.update()}clear(){this.enabledKinds.clear(),this.disabledKinds.clear(),this.hiddenKinds.clear()}enableKind(e,t=!0){this.enableDisableKinds(this.enabledKinds,e,t)}disableKind(e,t=!0){this.enableDisableKinds(this.disabledKinds,e,t)}hideKind(e,t=!0){let i=!1;if(Array.isArray(e)||e instanceof Set)for(const r of e){const e=this.addRemove(this.hiddenKinds,r,t);i=i||e}else i=this.addRemove(this.hiddenKinds,e,t);i&&this.incrementVisibilityCounter()}getAvailableKinds(e){const t=new r.GeometryKindSet;for(const i of e){const e=i.loadedGeometryKinds;if(void 0!==e)for(const i of e)t.add(i)}return t}updateTileObjectVisibility(e){let t=!1;for(const i of e)if(0!==i.objects.length&&i.visibilityCounter!==this.visibilityCounter){i.visibilityCounter=this.visibilityCounter;for(const e of i.objects){const i=n.MapObjectAdapter.get(e),r=null==i?void 0:i.kind;if(void 0!==r){const i=!r.some((e=>this.hiddenKinds.has(e)));t=t||e.visible!==i,e.visible=i}}}return t}setTileUpdateCallback(e){this.m_tileUpdateCallback=e}incrementVisibilityCounter(){return++this.m_visibilityCounter}enableDisableKinds(e,t,i){if(Array.isArray(t))for(const r of t)this.addRemove(e,r,i);else if(t instanceof Set){const r=t;for(const t of r)this.addRemove(e,t,i)}else void 0!==t&&this.addRemove(e,t,i)}addRemove(e,t,i){if(i){if(!e.has(t))return e.add(t),!0}else if(e.has(t))return e.delete(t),!0;return!1}}},71962:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VertexCache=void 0;const r=i(38338);var n;!function(e){e[e.VertexId=0]="VertexId",e[e.OlderIdx=1]="OlderIdx",e[e.NewerIdx=2]="NewerIdx",e[e.X=3]="X",e[e.Y=4]="Y",e[e.Z=5]="Z",e[e.Count=6]="Count"}(n||(n={}));const o=-1;t.VertexCache=class{constructor(e){this.maxVertexCount=e,this.m_cache=[],this.m_vertexCount=0,this.m_oldestIdx=0,this.m_newestIdx=0,this.m_cache.length=this.maxVertexCount*n.Count,this.clear()}clear(){this.m_cache.fill(o),this.m_vertexCount=0}get(e,t){const i=this.find(e);return void 0!==i&&(this.promoteEntry(i),this.getVertex(i,t),!0)}set(e,t){let i=o;this.m_vertexCount<this.maxVertexCount?(i=this.m_vertexCount*n.Count,this.m_vertexCount++):i=this.m_oldestIdx,1===this.m_vertexCount?this.m_oldestIdx=this.m_newestIdx=i:this.promoteEntry(i),this.setVertex(i,e,t)}find(e){const t=this.m_cache.length;for(let i=0;i<t;i+=n.Count)if(this.m_cache[i]===e)return i}promoteEntry(e){if(e===this.m_newestIdx)return;const t=this.getNewerIdx(e),i=this.getOlderIdx(e);t!==o&&(r.assert(this.getOlderIdx(t)===e),this.setOlderIdx(t,i)),i!==o&&(r.assert(this.getNewerIdx(i)===e),this.setNewerIdx(i,t)),e===this.m_oldestIdx&&(this.m_oldestIdx=t),this.setNewerIdx(e,o),this.setOlderIdx(e,this.m_newestIdx),r.assert(this.m_newestIdx!==o),r.assert(this.getNewerIdx(this.m_newestIdx)===o),this.setNewerIdx(this.m_newestIdx,e),this.m_newestIdx=e}getOlderIdx(e){return this.m_cache[e+n.OlderIdx]}setOlderIdx(e,t){this.m_cache[e+n.OlderIdx]=t}getNewerIdx(e){return this.m_cache[e+n.NewerIdx]}setNewerIdx(e,t){this.m_cache[e+n.NewerIdx]=t}getVertex(e,t){t.x=this.m_cache[e+n.X],t.y=this.m_cache[e+n.Y],t.z=this.m_cache[e+n.Z]}setVertex(e,t,i){this.m_cache[e]=t,this.m_cache[e+n.X]=i.x,this.m_cache[e+n.Y]=i.y,this.m_cache[e+n.Z]=i.z}}},58512:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overlayOnElevation=t.overlayTextElement=void 0;const r=i(96500),n=i(30462),o=i(38338);function a(e,t){if(!("material"in e))return;const i=n.setDisplacementMapToMaterial.bind(null,t),r=e.material;Array.isArray(r)?r.forEach(i):r&&i(r)}function s(e,t,i,r){const n=r.unprojectPoint(e);if(i.geoBox.contains(n))n.altitude=t.sampleHeight(n,i);else if(n.altitude=t.getHeight(n,i.tileKey.level),void 0===n.altitude)return!1;return r.projectPoint(n,e),!0}t.overlayTextElement=function(e,t,i,r){o.assert(!e.elevated),i&&(e.elevated=e.path?function(e,t,i,r){for(const n of e)if(!s(n,t,i,r))return!1;return!0}(e.path,t,i,r):s(e.position,t,i,r))},t.overlayOnElevation=function(e){const t=e.mapView.elevationProvider;if(void 0===t||0===e.objects.length)return;const i=e.objects[0];if(!i.userData||!i.userData.kind||!i.userData.kind.find((e=>e!==r.GeometryKind.All&&e!==r.GeometryKind.Terrain)))return;const n=t.getDisplacementMap(e.tileKey);if(void 0!==n)for(const t of e.objects)a(t,n.texture)}},49140:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageItem=void 0;const r=i(38338),n=i(84428),o=i(48671),a=r.LoggerManager.instance.create("loadImage"),s=new o.MipMapGenerator;t.ImageItem=class{constructor(e,t){this.url=e,this.image=t}get loaded(){return void 0!==this.image&&void 0!==this.mipMaps}get loading(){return void 0!==this.loadingPromise}loadImage(){return this.loaded?Promise.resolve(this):(this.loading||(this.loadingPromise=new Promise(((e,t)=>{if(this.image){const i=this.image;i instanceof HTMLImageElement&&!i.complete?(i.addEventListener("load",this.finalizeImage.bind(this,i,e)),i.addEventListener("error",t)):this.finalizeImage(this.image,e)}else a.debug(`Loading image: ${this.url}`),!0===this.cancelled?(a.debug(`Cancelled loading image: ${this.url}`),e(void 0)):(new n.ImageLoader).load(this.url,(t=>{if(!0===this.cancelled)return a.debug(`Cancelled loading image: ${this.url}`),void e(void 0);this.finalizeImage(t,e)}),void 0,(e=>{a.error(`... loading image failed: ${this.url} : ${e}`),this.loadingPromise=void 0,t(`... loading image failed: ${this.url} : ${e}`)}))}))),this.loadingPromise)}finalizeImage(e,t){this.image=e,this.mipMaps=s.generateTextureAtlasMipMap(this),this.loadingPromise=void 0,t(this)}}},86870:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageCache=void 0;const r=i(49140);class n{constructor(){this.m_images=new Map}static get instance(){return void 0===n.m_instance&&(n.m_instance=new n),n.m_instance}static dispose(){n.m_instance=void 0}registerImage(e,t,i){let n=this.findImageCacheItem(t);return n?(void 0===e||n.owners.includes(e)||n.owners.push(e),n.imageItem):(n={imageItem:new r.ImageItem(t,i),owners:[e]},this.m_images.set(t,n),n.imageItem)}removeImage(e,t){const i=this.m_images.get(e);return void 0!==i&&(this.unlinkCacheItem(i,t),!0)}findImage(e){const t=this.m_images.get(e);if(void 0!==t)return t.imageItem}clear(e){this.m_images.forEach((t=>{this.unlinkCacheItem(t,e)}))}get size(){return this.m_images.size}findImageCacheItem(e){return this.m_images.get(e)}cancelLoading(e){e.loading&&(e.cancelled=!0)}unlinkCacheItem(e,t){const i=e.owners.indexOf(t);i>=0&&e.owners.splice(i,1),0===e.owners.length&&(this.m_images.delete(e.imageItem.url),this.cancelLoading(e.imageItem))}}t.ImageCache=n},50921:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewImageCache=void 0;const r=i(38338),n=i(86870);t.MapViewImageCache=class{constructor(){this.m_name2Url=new Map,this.m_urlNameCount=new Map}addImage(e,t,i=!0){if("string"==typeof t){const r=t,n=this.registerImage(e,r);return i?n.loadImage():n}const r=t;return this.registerImage(e,void 0,r)}removeImage(e){const t=this.m_name2Url.get(e);if(void 0!==t){this.m_name2Url.delete(e);let i=1;if(e!==t){const e=this.m_urlNameCount.get(t);r.assert(void 0!==e),i=e,r.assert(i>0)}return i>1?this.m_urlNameCount.set(t,i-1):(this.m_urlNameCount.delete(t),n.ImageCache.instance.removeImage(t,this)),!0}return!1}findImageByName(e){const t=this.m_name2Url.get(e);if(void 0!==t)return n.ImageCache.instance.findImage(t)}clear(){n.ImageCache.instance.clear(this),this.m_name2Url.clear(),this.m_urlNameCount.clear()}registerImage(e,t,i){var o;if(this.hasName(e))throw new Error("duplicate name in cache");if(void 0===t&&(r.assert(void 0!==i),t=e),t!==e){const e=null!==(o=this.m_urlNameCount.get(t))&&void 0!==o?o:0;this.m_urlNameCount.set(t,e+1)}return this.m_name2Url.set(e,t),n.ImageCache.instance.registerImage(this,t,i)}hasName(e){return void 0!==this.m_name2Url.get(e)}}},48671:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MipMapGenerator=void 0;const r=i(84428),n="undefined"==typeof window;class o{constructor(){n||(this.m_paddingCanvas=document.createElement("canvas"),this.m_paddingContext=this.m_paddingCanvas.getContext("2d"),this.m_resizeCanvas=document.createElement("canvas"),this.m_resizeContext=this.m_resizeCanvas.getContext("2d"))}static getPaddedSize(e,t){return{width:r.MathUtils.ceilPowerOfTwo(e),height:r.MathUtils.ceilPowerOfTwo(t)}}generateTextureAtlasMipMap(e){if(n)throw new Error("MipMapGenerator only works in browser.");if(void 0===e.image)throw new Error("Can not generate mip maps. Image data not loaded!");const t=e.image,i=[],{width:r,height:a}=o.getPaddedSize(t.width,t.height);this.copyImageWithPadding(t,r,a),i.push(this.m_paddingContext.getImageData(0,0,r,a));let s=.5*r,l=.5*a;for(;s>=1||l>=1;){const e=i[i.length-1];i.push(this.resizeImage(e,Math.max(s,1),Math.max(l,1))),s*=.5,l*=.5}return i}copyImageWithPadding(e,t,i){return this.m_paddingCanvas.width=t,this.m_paddingCanvas.height=i,this.m_paddingContext.clearRect(0,0,t,i),e instanceof ImageData?this.m_paddingContext.putImageData(e,0,0):this.m_paddingContext.drawImage(e,0,0),e.width!==t&&this.m_paddingContext.drawImage(this.m_paddingCanvas,e.width-1,0,1,e.height,e.width,0,t-e.width,e.height),e.height!==i&&this.m_paddingContext.drawImage(this.m_paddingCanvas,0,e.height-1,t,1,0,e.height,t,i-e.height),this.m_paddingCanvas}resizeImage(e,t,i){const r=this.copyImageWithPadding(e,e.width,e.height);return this.m_resizeCanvas.width=t,this.m_resizeCanvas.height=i,this.m_resizeContext.clearRect(0,0,t,i),this.m_resizeContext.drawImage(r,0,0,t,i),this.m_resizeContext.getImageData(0,0,t,i)}}t.MipMapGenerator=o},20075:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BoxBuffer=t.BoxBufferMesh=void 0;const r=i(38338),n=i(84428),o=i(29945);class a extends n.Mesh{constructor(e,t){super(e,t),this.type="BoxBufferMesh"}get isEmpty(){if(void 0===this.geometry)return!0;{const e=this.geometry;return null===e.index||0===e.index.count}}}t.BoxBufferMesh=a;class s{constructor(e,t=0,i=0,r=32768){this.m_material=e,this.m_renderOrder=t,this.m_maxElementCount=r,this.m_size=0,this.resizeBuffer(i),this.m_pickInfos=new Array}clone(){return new s(this.m_material,this.m_renderOrder)}dispose(){void 0!==this.m_geometry&&(this.m_geometry.dispose(),this.m_geometry=void 0),this.m_mesh=void 0}get size(){return this.m_size}reset(){void 0!==this.m_positionAttribute&&(this.m_positionAttribute.count=0,this.m_colorAttribute.count=0,this.m_uvAttribute.count=0,this.m_indexAttribute.count=0,this.m_pickInfos.length=0)}canAddElements(e=1){const t=this.m_indexAttribute;if(t.count+6*e>=t.array.length){if(t.array.length>=6*this.m_maxElementCount)return!1;const e=Math.min(this.m_maxElementCount,0===this.size?256:2*this.size);this.resize(e)}return!0}saveState(){return{positionAttributeCount:this.m_positionAttribute.count,colorAttributeCount:this.m_colorAttribute.count,uvAttributeCount:this.m_uvAttribute.count,indexAttributeCount:this.m_indexAttribute.count,pickInfoCount:this.m_pickInfos.length}}restoreState(e){this.m_positionAttribute.count=e.positionAttributeCount,this.m_colorAttribute.count=e.colorAttributeCount,this.m_uvAttribute.count=e.uvAttributeCount,this.m_indexAttribute.count=e.indexAttributeCount,this.m_pickInfos.length=e.pickInfoCount}addBox(e,t,i,r,n,o){if(!this.canAddElements())return!1;const{s0:a,t0:s,s1:l,t1:c}=t,{x:u,y:d,w:h,h:m}=e,p=Math.round(i.r*r*255),f=Math.round(i.g*r*255),g=Math.round(i.b*r*255),y=Math.round(255*r),v=this.m_positionAttribute,_=this.m_colorAttribute,b=this.m_uvAttribute,S=this.m_indexAttribute,T=v.count,E=S.count;return v.setXYZ(T,u,d,n),v.setXYZ(T+1,u+h,d,n),v.setXYZ(T+2,u,d+m,n),v.setXYZ(T+3,u+h,d+m,n),_.setXYZW(T,p,f,g,y),_.setXYZW(T+1,p,f,g,y),_.setXYZW(T+2,p,f,g,y),_.setXYZW(T+3,p,f,g,y),b.setXY(T,a,s),b.setXY(T+1,l,s),b.setXY(T+2,a,c),b.setXY(T+3,l,c),S.setX(E,T),S.setX(E+1,T+1),S.setX(E+2,T+2),S.setX(E+3,T+2),S.setX(E+4,T+1),S.setX(E+5,T+3),v.count+=4,_.count+=4,b.count+=4,S.count+=6,this.m_pickInfos.push(o),!0}updateBufferGeometry(){const e=this.m_positionAttribute,t=this.m_colorAttribute,i=this.m_uvAttribute,r=this.m_indexAttribute;e.count>0&&(e.needsUpdate=!0,e.updateRange.offset=0,e.updateRange.count=4*e.count),t.count>0&&(t.needsUpdate=!0,t.updateRange.offset=0,t.updateRange.count=4*t.count),i.count>0&&(i.needsUpdate=!0,i.updateRange.offset=0,i.updateRange.count=4*i.count),r.count>0&&(r.needsUpdate=!0,r.updateRange.offset=0,r.updateRange.count=r.count),void 0!==this.m_geometry&&(this.m_geometry.clearGroups(),this.m_geometry.addGroup(0,this.m_indexAttribute.count))}cleanUp(){0===this.m_indexAttribute.count&&this.size>0&&this.clearAttributes()}get isEmpty(){return this.m_mesh.isEmpty}get mesh(){return void 0===this.m_mesh&&this.resize(),this.m_mesh}pickBoxes(e,t,i){const n=this.m_pickInfos.length,o=this.m_pickInfos,a=this.m_positionAttribute,s=e.x,l=e.y;for(let e=0;e<n;e++){const n=4*e,c=a.getX(n);if(s<c)continue;const u=a.getX(n+1);if(s>u)continue;const d=a.getY(n);if(l<d)continue;const h=a.getY(n+2);if(l>h)continue;const m=new r.Math2D.Box(c,d,u-c,h-d);void 0!==i&&void 0!==o[e].poiInfo&&void 0!==o[e].poiInfo.uvBox&&this.isPixelTransparent(i,s,l,m,o[e].poiInfo.uvBox,document.createElement("canvas"))||void 0!==o[e]&&t(o[e])}}resize(e,t){return void 0!==this.m_geometry&&this.m_geometry.dispose(),this.m_geometry=new n.BufferGeometry,void 0!==e&&(!0===t||e>this.size)&&this.resizeBuffer(e),this.m_geometry.setAttribute("position",this.m_positionAttribute),this.m_geometry.setAttribute("color",this.m_colorAttribute),this.m_geometry.setAttribute("uv",this.m_uvAttribute),this.m_geometry.setIndex(this.m_indexAttribute),this.m_geometry.addGroup(0,this.m_indexAttribute.count),void 0===this.m_mesh?(this.m_mesh=new a(this.m_geometry,this.m_material),this.m_mesh.renderOrder=this.m_renderOrder):this.m_mesh.geometry=this.m_geometry,this.m_mesh}updateMemoryUsage(e){const t=3*this.m_positionAttribute.count*4+4*this.m_colorAttribute.count+4*this.m_uvAttribute.count*4+4*this.m_indexAttribute.count;e.heapSize+=t,e.gpuSize+=t}isPixelTransparent(e,t,i,r,n,a){const{u:s,v:l}=o.screenToUvCoordinates(t,i,r,n),{width:c,height:u}=e instanceof SVGImageElement?e.getBBox():e,d=c*s,h=u*l,m=o.getPixelFromImage(d,h,e,a);return void 0!==m&&0===m[3]}clearAttributes(){this.m_positionAttribute=void 0,this.m_colorAttribute=void 0,this.m_uvAttribute=void 0,this.m_indexAttribute=void 0,this.resize(0,!0)}resizeBuffer(e){const t=new Float32Array(4*e*3);if(void 0!==this.m_positionAttribute&&this.m_positionAttribute.array.length>0){const e=this.m_positionAttribute.count;t.set(this.m_positionAttribute.array),this.m_positionAttribute.array=t,this.m_positionAttribute.count=e}else this.m_positionAttribute=new n.BufferAttribute(t,3),this.m_positionAttribute.count=0,this.m_positionAttribute.setUsage(n.DynamicDrawUsage);const i=new Uint8Array(4*e*4);if(void 0!==this.m_colorAttribute){const e=this.m_colorAttribute.count;i.set(this.m_colorAttribute.array),this.m_colorAttribute.array=i,this.m_colorAttribute.count=e}else this.m_colorAttribute=new n.BufferAttribute(i,4,!0),this.m_colorAttribute.count=0,this.m_colorAttribute.setUsage(n.DynamicDrawUsage);const r=new Float32Array(4*e*4);if(void 0!==this.m_uvAttribute){const e=this.m_uvAttribute.count;r.set(this.m_uvAttribute.array),this.m_uvAttribute.array=r,this.m_uvAttribute.count=e}else this.m_uvAttribute=new n.BufferAttribute(r,4),this.m_uvAttribute.count=0,this.m_uvAttribute.setUsage(n.DynamicDrawUsage);const o=6*e*1,a=o>65535?new Uint32Array(o):new Uint16Array(o);if(void 0!==this.m_indexAttribute){const e=this.m_indexAttribute.count;a.set(this.m_indexAttribute.array),this.m_indexAttribute.array=a,this.m_indexAttribute.count=e}else this.m_indexAttribute=new n.BufferAttribute(a,1),this.m_indexAttribute.count=0,this.m_indexAttribute.setUsage(n.DynamicDrawUsage);this.m_size=e}}t.BoxBuffer=s},29945:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPixelFromImageData=t.getPixelFromCanvasImageSource=t.screenToUvCoordinates=t.getPixelFromImage=void 0;const r=i(38338);function n(e,t,i,r){const{width:n,height:o}=e instanceof SVGImageElement?e.getBBox():e;if(t>n||t<0||i>o||i<0)return;let a;r.width=n,r.height=o;const s=r.getContext("2d");return null!==s&&(s.drawImage(e,0,0),a=s.getImageData(t,i,1,1).data),a}function o(e,t,i,r){if(!(t>e.width||t<0||i>e.height||i<0))return((e,t,i)=>{const r=t*i,n=e.data,o=new Uint8ClampedArray(i);for(let e=0;e<i;e++)o[0]=n[r+e];return o})(e,i*e.width+t,r)}t.getPixelFromImage=function(e,t,i,r){return i instanceof ImageData?o(i,e,t,i.data.length/(i.height*i.width)):(r||(r=document.createElement("canvas")),n(i,e,t,r))},t.screenToUvCoordinates=function(e,t,i,n){const o=i.x,a=i.x+i.w,s=i.y,l=i.y+i.h;return{u:r.MathUtils.map(e,o,a,n.s0,n.s1),v:r.MathUtils.map(t,s,l,n.t0,n.t1)}},t.getPixelFromCanvasImageSource=n,t.getPixelFromImageData=o},27771:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoiBuilder=void 0;const r=i(96500),n=i(38338),o=i(40160),a=n.LoggerManager.instance.create("PoiBuilder");t.PoiBuilder=class{constructor(e){this.m_env=e}withTechnique(e){var t,i,n,o,a,s,l,c;return this.m_imageTextureName=function(e,t){return void 0!==e.imageTexture?r.composeTechniqueTextureName(r.getPropertyValue(e.imageTexture,t),e):void 0}(e,this.m_env),this.m_iconMinZoomLevel=null!==(i=r.getPropertyValue(null!==(t=e.iconMinZoomLevel)&&void 0!==t?t:e.minZoomLevel,this.m_env))&&void 0!==i?i:void 0,this.m_iconMaxZoomLevel=null!==(o=r.getPropertyValue(null!==(n=e.iconMaxZoomLevel)&&void 0!==n?n:e.maxZoomLevel,this.m_env))&&void 0!==o?o:void 0,this.m_textMinZoomLevel=null!==(s=r.getPropertyValue(null!==(a=e.textMinZoomLevel)&&void 0!==a?a:e.minZoomLevel,this.m_env))&&void 0!==s?s:void 0,this.m_textMaxZoomLevel=null!==(c=r.getPropertyValue(null!==(l=e.textMaxZoomLevel)&&void 0!==l?l:e.maxZoomLevel,this.m_env))&&void 0!==c?c:void 0,this.m_technique=e,this}withIcon(e,t){return void 0!==e&&(this.m_imageTextureName=e),this.m_shieldGroupIndex=t,this}build(e){var t,i,s,l,c;n.assert(void 0!==this.m_technique);const u=this.m_technique,d=this.m_env,h=this.m_imageTextureName,m=void 0!==u.poiTable?null!==(t=u.poiName)&&void 0!==t?t:h:void 0;if(void 0!==h&&void 0!==m&&a.warn("Possible duplicate POI icon definition via imageTextureName and poiTable!"),void 0===h&&void 0===m)return e.minZoomLevel=null!==(i=e.minZoomLevel)&&void 0!==i?i:this.m_textMinZoomLevel,void(e.maxZoomLevel=null!==(s=e.maxZoomLevel)&&void 0!==s?s:this.m_textMaxZoomLevel);const p=!0===u.textIsOptional,f=!0===u.iconIsOptional,g=!(!1===u.renderTextDuringMovements),y=null!==(l=u.iconMayOverlap)&&void 0!==l?l:u.textMayOverlap,v=null!==(c=u.iconReserveSpace)&&void 0!==c?c:u.textReserveSpace,_=r.getPropertyValue(u.iconColor,d),b=null!==_?o.ColorCache.instance.getColor(_):void 0;return{technique:u,imageTextureName:h,poiTableName:u.poiTable,poiName:m,shieldGroupIndex:this.m_shieldGroupIndex,textElement:e,textIsOptional:p,iconIsOptional:f,renderTextDuringMovements:g,mayOverlap:y,reserveSpace:v,iconBrightness:u.iconBrightness,iconColor:b,iconMinZoomLevel:this.m_iconMinZoomLevel,iconMaxZoomLevel:this.m_iconMaxZoomLevel,textMinZoomLevel:this.m_textMinZoomLevel,textMaxZoomLevel:this.m_textMaxZoomLevel}}}},66437:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoiManager=void 0;const r=i(96500),n=i(38338),o=i(84428),a=i(81237),s=n.LoggerManager.instance.create("PoiManager");function l(e,t=0){if(e.imageTextures){const i=e.imageTextures[t];if(i>=0)return n.assert(e.imageTextures.length>t),e.stringCatalog[i]}}function c(e,t=0){return e.objInfos?e.objInfos[t]:void 0}function u(e,t,i=0){const r=(new o.Vector3).fromBufferAttribute(e,i);return r.x+=t,r}function d(e,t=0){var i;n.assert(e.texts.length>t);const r=e.texts[t];return n.assert(e.stringCatalog.length>r),null!==(i=e.stringCatalog[r])&&void 0!==i?i:""}class h{constructor(e){this.mapView=e,this.m_imageTextures=new Map,this.m_poiShieldGroups=new Map}static notifyMissingPoiTable(e,t){void 0===e&&(e="undefined"),void 0===h.m_missingPoiTableName.get(e)&&(h.m_missingPoiTableName.set(e,!0),void 0===t||t.loadedOk?s.error(`updatePoiFromPoiTable: No POI table with name '${e}' found!`):s.error(`updatePoiFromPoiTable: Could not load POI table '${e}'!`))}static notifyMissingPoi(e,t){void 0===e&&(e="undefined");const i=`${t}[${e}]`;void 0===h.m_missingPoiName.get(i)&&(h.m_missingPoiName.set(i,!0),s.warn(`updatePoiFromPoiTable: Cannot find POI info for '${e}' in table '${t}'.`))}addPois(e,t){const i=n.assertExists(t.poiGeometries),s=e.computeWorldOffsetX(),l=e.mapView,c=Math.floor(l.zoomLevel),u=new r.MapEnv({$zoom:c},l.env),d=new a.TextElementBuilder(u,e.textStyleCache,e.dataSource.dataSourceOrder);for(const a of i){n.assert(void 0!==a.technique);const i=n.assertExists(a.technique),l=t.techniques[i];if(!1===l._kindState||!r.isLineMarkerTechnique(l)&&!r.isPoiTechnique(l))continue;if(!1===l.showOnMap)continue;const c=new o.BufferAttribute(new Float64Array(a.positions.buffer),a.positions.itemCount);d.withTechnique(l),r.isLineMarkerTechnique(l)&&c.count>0?this.addLineMarker(d,e,a,c,s):r.isPoiTechnique(l)&&this.addPoi(d,e,a,c,s)}}async addTextureAtlas(e,t,i){const r=await fetch(t,{signal:i});if(!r.ok)throw new Error(`addTextureAtlas: Cannot load textureAtlas: ${r.statusText}`);try{const i=await r.json();if(void 0===i)return void s.info(`addTextureAtlas: TextureAtlas empty: ${t}`);s.debug(`addTextureAtlas: Loading textureAtlas '${t}' for image '${e}'`);for(const t of Object.getOwnPropertyNames(i)){const r=i[t],n={name:t,image:e,xOffset:r.x,yOffset:r.y,width:r.width,height:r.height};this.addImageTexture(n)}this.mapView.update()}catch(e){s.error(`addTextureAtlas: Failed to load textureAtlas '${t}' : ${e}`)}}addImageTexture(e){void 0!==e.name?(void 0!==this.m_imageTextures.get(e.name)&&s.warn(`addImageTexture: Name already used: ${e.name} (overriding it)`),this.m_imageTextures.set(e.name,e)):s.error("addImageTexture: Name required",e)}getImageTexture(e){return this.m_imageTextures.get(e)}updatePoiFromPoiTable(e){var t,i,n,o,s,l;const c=e.poiInfo;if(!c||void 0===c.poiTableName||void 0===c.poiName)return!0;const u=c.poiTableName,d=this.mapView.poiTableManager.getPoiTable(u);if(d&&d.isLoading)return!1;if(c.poiTableName=void 0,!d||!d.loadedOk)return h.notifyMissingPoiTable(u,d),!0;const m=c.poiName,p=d.getEntry(m);return p?(void 0!==p.iconName&&p.iconName.length>0&&(c.imageTextureName=r.composeTechniqueTextureName(p.iconName,c.technique)),e.visible=null!==(t=p.visible)&&void 0!==t?t:e.visible,e.priority=null!==(i=p.priority)&&void 0!==i?i:e.priority,c.iconMinZoomLevel=null!==(n=p.iconMinLevel)&&void 0!==n?n:c.iconMinZoomLevel,c.iconMaxZoomLevel=null!==(o=p.iconMaxLevel)&&void 0!==o?o:c.iconMaxZoomLevel,c.textMinZoomLevel=null!==(s=p.textMinLevel)&&void 0!==s?s:c.textMinZoomLevel,c.textMaxZoomLevel=null!==(l=p.textMaxLevel)&&void 0!==l?l:c.textMaxZoomLevel,a.TextElementBuilder.alignZoomLevelRanges(e),!0):(h.notifyMissingPoi(m,u),!0)}clear(){this.m_imageTextures.clear(),this.m_poiShieldGroups.clear()}addLineMarker(e,t,i,r,n){const o=d(i),a=l(i),s=a+"-"+o;let h=this.m_poiShieldGroups.get(s);void 0===h&&(h=this.m_poiShieldGroups.size,this.m_poiShieldGroups.set(s,h));const m=[];for(let e=0;e<r.count;e+=3)m.push(u(r,n,e));const p=e.withIcon(a,h).build(o,m,t.offset,t.dataSource.name,t.dataSource.dataSourceOrder,c(i));t.addTextElement(p)}addPoi(e,t,i,r,n){var o,a;for(let s=0;s<r.count;++s){const h=null!==(a=null===(o=i.offsetDirections)||void 0===o?void 0:o[s])&&void 0!==a?a:0,m=e.withIcon(l(i,s)).build(d(i,s),u(r,n,s),t.offset,t.dataSource.name,t.dataSource.dataSourceOrder,c(i,s),void 0,h);t.addTextElement(m)}}}t.PoiManager=h,h.m_missingPoiTableName=new Map,h.m_missingPoiName=new Map},29113:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoiRenderer=t.PoiBatchRegistry=t.PoiBuffer=void 0;const r=i(96500),n=i(30462),o=i(38338),a=i(84428),s=i(48671),l=i(20075),c=o.LoggerManager.instance.create("PoiRenderer"),u=new a.Color(1,1,1),d=new a.Color;class h{constructor(e,t,i){this.buffer=e,this.layer=t,this.m_onDispose=i,this.m_refCount=0}increaseRefCount(){return++this.m_refCount,this}decreaseRefCount(){return o.assert(this.m_refCount>0),0==--this.m_refCount&&this.dispose(),this}dispose(){this.layer.scene.remove(this.buffer.mesh),this.buffer.dispose(),this.m_onDispose()}}t.PoiBuffer=h;class m{constructor(e,t,i){this.m_rendererCapabilities=e,this.imageItem=t,this.m_onDispose=i;const r=new a.Texture(this.imageItem.image,a.UVMapping,void 0,void 0,(m.trilinear,a.LinearFilter),m.trilinear?a.LinearMipMapLinearFilter:a.LinearFilter,a.RGBAFormat);m.trilinear&&this.imageItem.mipMaps&&(r.mipmaps=this.imageItem.mipMaps,r.image=r.mipmaps[0]),r.flipY=!1,r.premultiplyAlpha=!0,r.needsUpdate=!0,this.m_material=new n.IconMaterial({rendererCapabilities:this.m_rendererCapabilities,map:r}),this.m_poiBuffers=new Map}getBuffer(e){let t=this.m_poiBuffers.get(e.id);if(t)return t.increaseRefCount();const i=new l.BoxBuffer(this.m_material,e.id),r=i.mesh;return r.frustumCulled=!1,e.scene.add(r),t=new h(i,e,(()=>{this.disposeBuffer(e.id)})),this.m_poiBuffers.set(e.id,t),t.increaseRefCount()}reset(){for(const e of this.m_poiBuffers.values())e.buffer.reset()}update(){for(const e of this.m_poiBuffers.values())e.buffer.updateBufferGeometry()}pickBoxes(e,t,i){for(const r of this.m_poiBuffers.values())r.buffer.pickBoxes(e,t,i)}updateMemoryUsage(e){if(void 0!==this.imageItem.image){const t=this.imageItem.image.width*this.imageItem.image.height*4;e.heapSize+=t,e.gpuSize+=t}for(const t of this.m_poiBuffers.values())t.buffer.updateMemoryUsage(e)}dispose(){this.m_poiBuffers.clear(),this.m_material.map.dispose(),this.m_material.dispose(),this.m_onDispose()}disposeBuffer(e){o.assert(this.m_poiBuffers.size>0),this.m_poiBuffers.delete(e),0===this.m_poiBuffers.size&&this.dispose()}}m.trilinear=!0;class p{constructor(e){this.m_rendererCapabilities=e,this.m_batchMap=new Map}registerPoi(e,t){var i;const{imageItem:r,imageTexture:n}=e;if(!r)return;o.assert(void 0!==e.imageTextureName);const a=null!==(i=null==n?void 0:n.image)&&void 0!==i?i:e.imageTextureName;let s=this.m_batchMap.get(a);return void 0===s&&(s=new m(this.m_rendererCapabilities,r,(()=>{this.deleteBatch(a)})),this.m_batchMap.set(a,s)),s.getBuffer(t)}addPoi(e,t,i,r){if(!1===e.isValid||!e.buffer)return void c.warn("PoiBatchRegistry: trying to add poiInfo without buffer prepared: ",e.poiName);let n;o.assert(void 0!==e.uvBox),void 0!==e.iconBrightness?(n=d.setScalar(e.iconBrightness),void 0!==e.iconColor&&(n=d.multiply(e.iconColor))):n=void 0!==e.iconColor?e.iconColor:u,e.buffer.buffer.addBox(t,e.uvBox,n,r,i,e.textElement)}reset(){for(const e of this.m_batchMap.values())e.reset()}update(){for(const e of this.m_batchMap.values())e.update()}pickTextElements(e,t){for(const i of this.m_batchMap.values())i.pickBoxes(e,t,i.imageItem.image)}updateMemoryUsage(e){for(const t of this.m_batchMap.values())t.updateMemoryUsage(e)}deleteBatch(e){this.m_batchMap.delete(e)}}t.PoiBatchRegistry=p;const f=new Map;class g{constructor(e,t,i){this.m_renderer=e,this.m_poiManager=t,this.m_imageCaches=i,this.m_tempScreenBox=new o.Math2D.Box,this.m_layers=[],this.m_poiBatchRegistry=new p(this.renderer.capabilities)}static computeIconScreenBox(e,t,i,n,a=new o.Math2D.Box){o.assert(void 0!==e.buffer);const s=e.computedWidth*i,l=e.computedHeight*i,c=e.technique,u=r.getPropertyValue(c.iconXOffset,n),d=r.getPropertyValue(c.iconYOffset,n),h=t.x+("number"==typeof u?u:0)*i,m=t.y+("number"==typeof d?d:0)*i;return a.x=h-s/2,a.y=m-l/2,a.w=s,a.h=l,a}get renderer(){return this.m_renderer}prepareRender(e,t){const i=e.poiInfo;return void 0!==i&&(void 0===i.buffer&&this.preparePoi(e,t),void 0!==i.buffer)}reset(){this.m_poiBatchRegistry.reset()}addPoi(e,t,i,r,n,a,s,l){o.assert(void 0!==e.buffer),g.computeIconScreenBox(e,t,n,l,this.m_tempScreenBox),a&&i.allocate(this.m_tempScreenBox),s>0&&(e.buffer||this.preparePoi(e.textElement,l),this.m_poiBatchRegistry.addPoi(e,this.m_tempScreenBox,r,s))}update(){this.m_poiBatchRegistry.update()}addLayer(e){let t=this.getLayer(e);return void 0===t&&(t={id:e,scene:new a.Scene},this.m_layers.push(t),this.m_layers.sort(((e,t)=>e.id-t.id))),t}getLayer(e){return this.m_layers.find((t=>t.id===e))}get layers(){return this.m_layers}render(e,t){this.m_renderer.render(t.scene,e)}pickTextElements(e,t){this.m_poiBatchRegistry.pickTextElements(e,t)}getMemoryUsage(e){this.m_poiBatchRegistry.updateMemoryUsage(e)}preparePoi(e,t){const i=e.poiInfo;if(!i||!e.visible)return;if(void 0!==i.buffer||!1===i.isValid)return;if(void 0!==i.poiTableName){if(!this.m_poiManager.updatePoiFromPoiTable(e))return;if(!e.visible)return}const r=i.imageTextureName;if(void 0===r)return void(i.isValid=!1);const n=this.m_poiManager.getImageTexture(r),a=function(e,t,i){var r;o.assert(void 0!==e.imageTextureName);const n=i?i.image:e.imageTextureName;for(const e of t){const t=e.findImageByName(n);if(t)return f.delete(n),t}const a=f.get(n);f.set(n,a?a+1:0),5===f.get(n)&&c.error(`PoiRenderer::findImageItem: No imageItem found with name:\n            '${null!==(r=null==i?void 0:i.image)&&void 0!==r?r:n}'\n            after 5 attempts.`)}(i,this.m_imageCaches,n);a?a.loaded?this.setupPoiInfo(i,a,t,n):a.loading||a.loadImage().then((e=>{(null==e?void 0:e.image)&&this.setupPoiInfo(i,e,t,n)})).catch((e=>{c.error(`preparePoi: Failed to load imageItem: '${a.url}`,e),i.isValid=!1})):i.imageItem=null}setupPoiInfo(e,t,i,n){if(o.assert(void 0===e.uvBox),!t.image)return c.error("setupPoiInfo: No imageItem/imageData found"),void(e.isValid=!1);const a=e.technique,l=t.image.width,u=t.image.height,d=s.MipMapGenerator.getPaddedSize(l,u),h=m.trilinear&&t.mipMaps,p=h?d.width:l,f=h?d.height:u,g=void 0!==(null==n?void 0:n.width)?n.width:l,y=void 0!==(null==n?void 0:n.height)?n.height:u,v=void 0!==(null==n?void 0:n.width)?n.width:l,_=void 0!==(null==n?void 0:n.height)?n.height:u,b=void 0!==(null==n?void 0:n.xOffset)?n.xOffset:0,S=void 0!==(null==n?void 0:n.yOffset)?n.yOffset:0,T=b/p,E=(b+v)/p,C=S/f,w=(S+_)/f;let x=void 0!==a.iconScale?a.iconScale:1,P=void 0!==a.iconScale?a.iconScale:1;const O=r.getPropertyValue(a.screenWidth,i);null!=O&&(P=x=O/g);const A=r.getPropertyValue(a.screenHeight,i);null!=A&&(P=A/y,void 0!==O&&(x=P)),e.computedWidth=g*x,e.computedHeight=y*P,e.uvBox={s0:T,t0:w,s1:E,t1:C},e.imageItem=t,e.imageTexture=n,e.buffer=this.m_poiBatchRegistry.registerPoi(e,this.addLayer(e.renderOrder)),e.isValid=!0}}t.PoiRenderer=g},22227:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoiTableManager=t.PoiTable=void 0;const r=i(96500),n=i(38338).LoggerManager.instance.create("PoiTable");class o{static verifyJSON(e){let t="string"==typeof e.name&&e.name.length>0&&(void 0===e.altNames||Array.isArray(e.altNames))&&(void 0===e.stackMode||"yes"===e.stackMode||"no"===e.stackMode||"parent"===e.stackMode)&&(void 0===e.visible||"boolean"==typeof e.visible)&&(void 0===e.priority||"number"==typeof e.priority)&&(void 0===e.iconMinLevel||"number"==typeof e.iconMinLevel)&&(void 0===e.iconMaxLevel||"number"==typeof e.iconMaxLevel)&&(void 0===e.textMinLevel||"number"==typeof e.textMinLevel)&&(void 0===e.textMaxLevel||"number"==typeof e.textMaxLevel);if(t&&void 0!==e.altNames){const i=e.altNames;for(const e in i)if("string"!=typeof e){t=!1;break}}return t}setup(e){switch(this.name=e.name,this.altNames=e.altNames,this.iconName=e.iconName,this.visible=e.visible,this.priority=e.priority,this.iconMinLevel=e.iconMinLevel,this.iconMaxLevel=e.iconMaxLevel,this.textMinLevel=e.textMinLevel,this.textMaxLevel=e.textMaxLevel,e.stackMode){case"yes":this.stackMode=r.PoiStackMode.Show;break;case"no":this.stackMode=r.PoiStackMode.Hide;break;case"parent":this.stackMode=r.PoiStackMode.ShowParent}}}class a{constructor(e,t){this.name=e,this.useAltNamesForKey=t,this.poiList=new Array,this.poiDict=new Map,this.m_isLoading=!1,this.m_loadedOk=void 0}get isLoading(){return this.m_isLoading}get loadedOk(){return!0===this.m_loadedOk}getEntry(e){const t=this.poiDict.get(e);if(void 0!==t){if(t<this.poiList.length)return this.poiList[t];throw new Error("Poi table entry index out of stored list!")}}async load(e,t){if(void 0!==this.m_loadedOk)return!0;this.m_loadedOk=!1;const i=await fetch(e,{signal:t});if(!i.ok)throw new Error(`load: Cannot load POI table at ${e}: ${i.statusText}`);const r=await i.json();if(void 0===r)return n.info(`load: TextureAtlas empty: ${e}`),!0;this.startLoading();try{if(n.debug(`load: Loading POI table '${e}' for table '${this.name}'`),void 0!==r.poiList&&Array.isArray(r.poiList))for(const t of r.poiList)if(o.verifyJSON(t)){const i=new o;i.setup(t);const r=this.poiList.push(i)-1;if(this.useAltNamesForKey)if(void 0!==i.altNames&&i.altNames.length>0)for(const e of i.altNames)this.poiDict.set(e,r);else n.debug(`load: Invalid entry in POI table '${e}' : No alternative names set in entry: ${JSON.stringify(t)}.`);else void 0===i.name?n.warn(`load: Invalid entry in POI table '${e}' : . No name set in entry: ${t}.`):this.poiDict.set(i.name,r)}else n.warn(`load: Invalid entry in POI table '${e}' : ${JSON.stringify(t)}`);this.m_loadedOk=!0,this.finishedLoading()}catch(t){return n.error(`load: Failed to load POI table '${e}' : ${t}`),this.m_loadedOk=!1,this.finishedLoading(),!1}return!0}startLoading(){this.m_isLoading=!0}finishedLoading(){this.m_isLoading=!1}}t.PoiTable=a,t.PoiTableManager=class{constructor(e){this.mapView=e,this.m_isLoading=!1,this.m_poiTables=new Map,this.m_abortControllers=new Map}async loadPoiTables(e){return new Promise((t=>{if(this.clear(),void 0!==e){this.startLoading();const i=new Array;e.forEach((e=>{var t;if(void 0!==e&&void 0!==e.name&&"string"==typeof e.name){const r=new a(e.name,!1!==e.useAltNamesForKey);void 0!==e.url&&"string"==typeof e.url?(this.addTable(r),this.m_abortControllers.set(e.name,new AbortController),i.push(r.load(e.url,null===(t=this.m_abortControllers.get(e.name))||void 0===t?void 0:t.signal))):n.error(`POI table definition has no valid url: ${e}`)}else n.error(`POI table definition has no valid name: ${e}`)})),i.length>0?Promise.all(i).finally((()=>{this.finishLoading(),t()})):(this.finishLoading(),t())}else this.finishLoading(),t()}))}clear(){this.m_poiTables=new Map,this.m_abortControllers.forEach(((e,t)=>{e.abort(),this.m_abortControllers.delete(t)}))}get poiTables(){return this.m_poiTables}addTable(e){this.m_poiTables.set(e.name,e)}getPoiTable(e){return void 0===e?void 0:this.m_poiTables.get(e)}get finishedLoading(){return!this.m_isLoading}startLoading(){this.m_isLoading=!0}finishLoading(){this.m_isLoading=!1}}},80178:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadFontCatalog=void 0;const r=i(49515),n=i(38338).LoggerManager.instance.create("FontCatalogLoader");t.loadFontCatalog=async function(e,t,i){return await r.FontCatalog.load(e.url,1024).then(t.bind(void 0,e.name)).catch((t=>{n.error("Failed to load FontCatalog: ",e.name,t),i&&i(t)}))}},18309:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutState=void 0;const r=i(49515);t.LayoutState=class{constructor(e){this.m_hAlign=r.DefaultTextStyle.DEFAULT_HORIZONTAL_ALIGNMENT,this.m_vAlign=r.DefaultTextStyle.DEFAULT_VERTICAL_ALIGNMENT,this.textPlacement=e}set textPlacement(e){this.m_hAlign=r.hAlignFromPlacement(e.h),this.m_vAlign=r.vAlignFromPlacement(e.v)}get textPlacement(){return{h:r.hPlacementFromAlignment(this.m_hAlign),v:r.vPlacementFromAlignment(this.m_vAlign)}}reset(e){this.m_hAlign=e.horizontalAlignment,this.m_vAlign=e.verticalAlignment}get horizontalAlignment(){return this.m_hAlign}get verticalAlignment(){return this.m_vAlign}}},86241:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapViewState=void 0;const r=i(84428);t.MapViewState=class{constructor(e,t){this.m_mapView=e,this.m_renderedTilesChangeCheck=t,this.m_lookAtVector=new r.Vector3}get worldCenter(){return this.m_mapView.worldCenter}get cameraIsMoving(){return this.m_mapView.cameraIsMoving}get maxVisibilityDist(){return this.m_mapView.viewRanges.maximum}get zoomLevel(){return this.m_mapView.zoomLevel}get env(){return this.m_mapView.env}get frameNumber(){return this.m_mapView.frameNumber}get lookAtVector(){return this.m_mapView.camera.getWorldDirection(this.m_lookAtVector)}get lookAtDistance(){return this.m_mapView.targetDistance}get isDynamic(){return this.m_mapView.isDynamicFrame}get hiddenGeometryKinds(){return void 0===this.m_mapView.tileGeometryManager?void 0:this.m_mapView.tileGeometryManager.hiddenGeometryKinds}get renderedTilesChanged(){return this.m_renderedTilesChangeCheck()}get projection(){return this.m_mapView.projection}get elevationProvider(){return this.m_mapView.elevationProvider}}},59552:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorldPosition=t.isPathLabelTooSmall=t.placePathLabel=t.placePointLabel=t.placeIcon=t.PlacementResult=t.newPointLabelTextMarginPercent=t.persistentPointLabelTextMargin=t.checkReadyForPlacement=t.PrePlacementResult=t.getMaxViewDistance=t.pointToPlaneDistance=t.computeViewDistance=void 0;const r=i(96500),n=i(32941),o=i(49515),a=i(38338),s=i(84428),l=i(29113),c=i(9660),u=i(11970),d=i(59491),h=new s.Vector3(0,0,0),m=new s.Vector3(0,0,0),p=new s.Vector3(0,0,0);function f(e,t,i,r){let n;const o=e.path;if(o&&o.length>1)if(void 0!==t&&o&&o.length>t)n=g(o[t],i,r);else{const e=g(o[0],i,r),t=g(o[o.length-1],i,r);n=Math.min(e,t)}else n=g(e.position,i,r);return n}function g(e,t,i){return p.copy(e).sub(t).dot(i)}var y;t.computeViewDistance=f,t.pointToPlaneDistance=g,t.getMaxViewDistance=function(e,t){return e.maxVisibilityDist*t},function(e){e[e.Ok=0]="Ok",e[e.NotReady=1]="NotReady",e[e.Invisible=2]="Invisible",e[e.TooFar=3]="TooFar",e[e.Duplicate=4]="Duplicate",e[e.Count=5]="Count"}(y=t.PrePlacementResult||(t.PrePlacementResult={}));const v=new s.Vector3;t.checkReadyForPlacement=function(e,t,i,r,o){let s;return e.visible?r.updatePoiFromPoiTable(e)?e.visible&&i.zoomLevel!==e.maxZoomLevel&&a.MathUtils.isClamped(i.zoomLevel,e.minZoomLevel,e.maxZoomLevel)?(s=void 0===o?f(e,t,i.worldCenter,i.lookAtVector):function(e,t,i,r,o,a){const s=f(e,t,i,r);return o!==n.ProjectionType.Spherical?s<=a?s:void 0:(h.copy(e.position).normalize(),m.copy(i).normalize(),h.dot(m)>.5877852522924731&&s<=a?s:void 0)}(e,t,i.worldCenter,i.lookAtVector,i.projection.type,o),void 0===s?{result:y.TooFar,viewDistance:s}:{result:y.Ok,viewDistance:s}):{result:y.Invisible,viewDistance:s}:{result:y.NotReady,viewDistance:s}:{result:y.Invisible,viewDistance:s}};const _=new s.Box2,b=new s.Box2,S=[],T={},E=[],C=new c.CollisionBox,w=new s.Vector2,x=new s.Vector2,P=new a.Math2D.Box,O=new s.Vector2,A=new s.Vector2;var D;function R(e,i,n,l,c,h,m,p,f){const g=e.element;a.assert(void 0!==g.glyphs),a.assert(void 0!==g.layoutStyle);const y=!g.bounds||p,v=y?b:g.bounds;y&&(I(c,n),T.outputCharacterBounds=void 0,T.path=void 0,T.pathOverflow=!1,T.letterCaseArray=g.glyphCaseArray,c.measureText(g.glyphs,v,T));const S=function(e,t,i,n,l,c=new s.Vector2){switch(a.assert(e.type===d.TextElementType.PoiLabel||e.type===d.TextElementType.LineMarker),a.assert(void 0!==e.layoutStyle),c.x=e.xOffset,c.y=e.yOffset,i.h){case o.HorizontalPlacement.Left:c.x-=t.max.x;break;case o.HorizontalPlacement.Right:c.x-=t.min.x}switch(i.v){case o.VerticalPlacement.Top:c.y-=t.min.y;break;case o.VerticalPlacement.Center:c.y-=.5*(t.max.y+t.min.y);break;case o.VerticalPlacement.Bottom:c.y-=t.max.y}if(void 0!==e.poiInfo&&u.poiIsRenderable(e.poiInfo)){a.assert(void 0!==e.poiInfo.computedWidth),a.assert(void 0!==e.poiInfo.computedHeight),c.x+=e.poiInfo.computedWidth*(.5+i.h),c.y+=e.poiInfo.computedHeight*(.5+i.v);const t=o.hPlacementFromAlignment(e.layoutStyle.horizontalAlignment),n=o.vPlacementFromAlignment(e.layoutStyle.verticalAlignment);if(t!==i.h||n!==i.v){const a=e.poiInfo.technique;let s=r.getPropertyValue(a.iconXOffset,l),u=r.getPropertyValue(a.iconYOffset,l);s="number"==typeof s?s:0,u="number"==typeof u?u:0;const d=t-i.h,h=n-i.v,m=s-e.xOffset,p=u-e.yOffset;t===o.HorizontalPlacement.Center||n===o.VerticalPlacement.Center?(c.x+=2*Math.abs(d)*m,c.y-=2*h*Math.abs(m),c.y+=2*Math.abs(h)*p,c.x-=2*d*Math.abs(p)):(c.x+=2*Math.min(Math.abs(d),.5)*m,c.y-=2*Math.sign(h)*Math.min(Math.abs(h),.5)*Math.abs(m),c.y+=2*Math.min(Math.abs(h),.5)*p,c.x-=2*Math.sign(d)*Math.min(Math.abs(d),.5)*Math.abs(p))}}return c.multiplyScalar(n),c}(g,v,n,l,h,x).add(i);return f.set(S.x,S.y,e.renderDistance),_.copy(v).expandByVector(t.persistentPointLabelTextMargin).translate(S),_.getCenter(O),_.getSize(A),A.multiplyScalar(l),P.set(O.x-A.x/2,O.y-A.y/2,A.x,A.y),m.isVisible(P)?(y&&(_.getSize(A),A.multiplyScalar(l*(1+t.newPointLabelTextMarginPercent)),P.set(O.x-A.x/2,O.y-A.y/2,A.x,A.y)),!g.textMayOverlap&&m.isAllocated(P)?D.Rejected:(g.textReservesSpace&&m.allocate(P),y?(g.textBufferObject=void 0,g.bounds=g.bounds?g.bounds.copy(v):v.clone()):I(c,n),e.textPlacement=n,D.Ok)):D.Invisible}function I(e,t){e.textLayoutStyle.horizontalAlignment=o.hAlignFromPlacement(t.h),e.textLayoutStyle.verticalAlignment=o.vAlignFromPlacement(t.v)}t.persistentPointLabelTextMargin=new s.Vector2(2,2),t.newPointLabelTextMarginPercent=.1,function(e){e[e.Ok=0]="Ok",e[e.Rejected=1]="Rejected",e[e.Invisible=2]="Invisible"}(D=t.PlacementResult||(t.PlacementResult={})),t.placeIcon=function(e,t,i,r,n,o){return l.PoiRenderer.computeIconScreenBox(t,i,r,n,P),o.isVisible(P)?!0!==t.mayOverlap&&o.isAllocated(P)?D.Rejected:D.Ok:D.Invisible},t.placePointLabel=function(e,t,i,r,n,o,s,l=!1){a.assert(void 0!==e.element.layoutStyle);const c=e.element.layoutStyle;return(l=l&&void 0!==c.placements&&c.placements.length>1)?function(e,t,i,r,n,o,s){a.assert(void 0!==e.element.layoutStyle);const l=e.element,c=e.visible,u=e.textPlacement,d=l.layoutStyle.placements,h=d.length,m=d.findIndex((e=>e.h===u.h&&e.v===u.v));a.assert(m>=0);let p=!0;for(let a=m;a<h+m;++a){const l=a===m&&c,u=R(e,t,d[a%h],i,r,n,o,!l,v);if(u===D.Ok)return s.copy(v),D.Ok;l&&s.copy(v),p=p&&u===D.Invisible}return p?D.Invisible:D.Rejected}(e,t,i,r,n,o,s):function(e,t,i,r,n,o,s){a.assert(void 0!==e.element.layoutStyle);return R(e,t,e.textPlacement,i,r,n,o,!e.visible,s)}(e,t,i,r,n,o,s)},t.placePathLabel=function(e,t,i,r,n){if(T.path=t,T.outputCharacterBounds=S,T.letterCaseArray=e.element.glyphCaseArray,!r.measureText(e.element.glyphs,_,T))return D.Rejected;if(C.copy(_.translate(i)),!n.isVisible(C))return D.Invisible;let o,a=!1;e.element.textMayOverlap||(o=n.search(C),a=o.length>0),E.length=S.length;for(let e=0;e<S.length;++e){const t=S[e].translate(i);let r=E[e];if(void 0===r?(r=new c.CollisionBox(t),E[e]=r):r.copy(t),a&&n.intersectsDetails(r,o))return D.Rejected}if(e.element.textReservesSpace){const e=new c.DetailedCollisionBox(C,E.slice());E.length=0,n.allocate(e)}return D.Ok},t.isPathLabelTooSmall=function(e,t,i){a.assert(e.type===d.TextElementType.PathLabel),i.length=0;let r=!1;for(const n of e.points)void 0!==(r?t.project(n,w):t.projectToScreen(n,w))&&(r=!0,i.push(w.clone()));if(!r)return!0;const n=5*e.text.length;return _.setFromPoints(i),_.max.sub(_.min).lengthSq()<n*n&&(e.dbgPathTooSmall=!0,!0)};const M=new n.OrientedBox3;t.getWorldPosition=function(e,t,i,n){var o,a;const l=r.getPropertyValue(null===(a=null===(o=e.poiInfo)||void 0===o?void 0:o.technique)||void 0===a?void 0:a.worldOffset,i);if(null==n||n.copy(e.position),null!=l&&void 0!==e.offsetDirection){t.localTangentSpace(e.position,M);const i=M.yAxis,r=s.MathUtils.degToRad(e.offsetDirection);i.applyAxisAngle(M.zAxis.negate(),r),n.addScaledVector(M.yAxis,l)}return n}},41639:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlacementStats=void 0,t.PlacementStats=class{constructor(e){this.m_logger=e,this.totalGroups=0,this.resortedGroups=0,this.total=0,this.uninitialized=0,this.tooFar=0,this.numNotVisible=0,this.numPathTooSmall=0,this.numCannotAdd=0,this.numRenderedPoiIcons=0,this.numRenderedPoiTexts=0,this.numPoiTextsInvisible=0,this.numRenderedTextElements=0}clear(){this.totalGroups=0,this.resortedGroups=0,this.total=0,this.uninitialized=0,this.tooFar=0,this.numNotVisible=0,this.numPathTooSmall=0,this.numCannotAdd=0,this.numRenderedPoiIcons=0,this.numRenderedPoiTexts=0,this.numPoiTextsInvisible=0,this.numRenderedTextElements=0}log(){const e=this.uninitialized+this.numPoiTextsInvisible+this.tooFar+this.numNotVisible+this.numCannotAdd;this.m_logger.debug("Total groups",this.totalGroups),this.m_logger.debug("Resorted groups",this.resortedGroups),this.m_logger.debug("Total labels",this.total),this.m_logger.debug("Rendered labels",this.numRenderedTextElements),this.m_logger.debug("Rejected labels",e),this.m_logger.debug("Unitialized labels",this.uninitialized),this.m_logger.debug("Rendered poi icons",this.numRenderedPoiIcons),this.m_logger.debug("Rendered poi texts",this.numRenderedPoiTexts),this.m_logger.debug("Poi text invisible",this.numPoiTextsInvisible),this.m_logger.debug("Too far",this.tooFar),this.m_logger.debug("Not visible",this.numNotVisible),this.m_logger.debug("Path too small",this.numPathTooSmall),this.m_logger.debug("Rejected, max glyphs reached",this.numCannotAdd)}}},22715:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderState=t.DEFAULT_FADE_TIME=t.FadingState=void 0;const r=i(38338),n=i(84428);var o;!function(e){e[e.Undefined=0]="Undefined",e[e.FadingIn=1]="FadingIn",e[e.FadedIn=2]="FadedIn",e[e.FadingOut=-1]="FadingOut",e[e.FadedOut=-2]="FadedOut"}(o=t.FadingState||(t.FadingState={})),t.DEFAULT_FADE_TIME=800,t.RenderState=class{constructor(e=t.DEFAULT_FADE_TIME){this.fadeTime=e,this.value=0,this.startTime=0,this.opacity=0,this.m_state=o.Undefined}reset(){this.m_state=o.Undefined,this.value=0,this.startTime=0,this.opacity=0}isUndefined(){return this.m_state===o.Undefined}isFading(){return this.m_state===o.FadingIn||this.m_state===o.FadingOut}isFadingIn(){return this.m_state===o.FadingIn}isFadingOut(){return this.m_state===o.FadingOut}isFadedIn(){return this.m_state===o.FadedIn}isFadedOut(){return this.m_state===o.FadedOut}isVisible(){return this.m_state!==o.FadedOut&&this.m_state!==o.Undefined&&this.opacity>0}startFadeIn(e,t){if(this.m_state!==o.FadingIn&&this.m_state!==o.FadedIn){if(!0===t)return this.value=1,this.opacity=1,this.m_state=o.FadedIn,void(this.startTime=e);this.m_state===o.FadingOut?(this.value=1-this.value,this.startTime=e-this.value*this.fadeTime):(this.startTime=e,this.value=0,this.opacity=0),this.m_state=o.FadingIn}}startFadeOut(e){this.m_state!==o.FadingOut&&this.m_state!==o.FadedOut&&this.m_state!==o.Undefined&&(this.m_state===o.FadingIn?(this.startTime=e-this.value*this.fadeTime,this.value=1-this.value):(this.startTime=e,this.value=0,this.opacity=1),this.m_state=o.FadingOut)}updateFading(e,t){if(this.m_state!==o.FadingIn&&this.m_state!==o.FadingOut)return;0===this.startTime&&(this.startTime=e);const i=e-this.startTime,a=this.m_state===o.FadingIn?0:1,s=this.m_state===o.FadingIn?1:0;t||i>=this.fadeTime?(this.value=1,this.opacity=s,this.m_state=this.m_state===o.FadingIn?o.FadedIn:o.FadedOut):(this.value=i/this.fadeTime,this.opacity=n.MathUtils.clamp(r.MathUtils.smootherStep(a,s,this.value),0,1),r.assert(this.isFading()))}}},62960:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimplePath=t.PathParam=t.SimpleLineCurve=void 0;const r=i(84428);class n extends r.LineCurve{constructor(e,t){super(e,t)}getLengths(){return void 0===this.m_lengths&&(this.m_lengths=[0,this.v2.distanceTo(this.v1)]),this.m_lengths}}t.SimpleLineCurve=n;class o{constructor(e,t,i){this.path=e,this.index=t,this.t=i}get curve(){return this.path.curves[this.index]}get point(){return void 0===this.m_point&&(this.m_point=this.curve.getPoint(this.t)),this.m_point}}t.PathParam=o;class a extends r.Path{constructor(){super()}getLengths(){if(this.m_cache)return this.m_cache;let e=0;const t=new Array;return t.push(0),this.curves.forEach((i=>{const r=i;e+=r.v1.distanceTo(r.v2),t.push(e)})),this.m_cache=t,t}getParamAt(e){const t=e*this.getLength(),i=this.getCurveLengths();for(let e=0;e<i.length;++e){if(i[e]<t)continue;const r=i[e]-t,n=this.curves[e].getLength();return new o(this,e,0===n?0:1-r/n)}return null}}t.SimplePath=a},4665:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextCanvasFactory=void 0;const r=i(49515),n=i(38338);t.TextCanvasFactory=class{constructor(e){this.m_renderer=e,this.m_minGlyphCount=0,this.m_maxGlyphCount=0}setGlyphCountLimits(e,t){this.m_minGlyphCount=e,this.m_maxGlyphCount=t}createTextCanvas(e,t){return n.assert(this.m_maxGlyphCount>0),new r.TextCanvas({renderer:this.m_renderer,fontCatalog:e,minGlyphCount:this.m_minGlyphCount,maxGlyphCount:this.m_maxGlyphCount,name:t})}}},11970:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElement=t.LoadingState=t.poiIsRenderable=void 0;const r=i(49515),n=i(84428),o=i(59491);var a;t.poiIsRenderable=function(e){return void 0!==e.buffer},(a=t.LoadingState||(t.LoadingState={}))[a.Requested=0]="Requested",a[a.Loaded=1]="Loaded",a[a.Initialized=2]="Initialized";class s{constructor(e,t,i,a,s=0,l=0,c=0,u,d,h,m,p,f,g,y){this.text=e,this.points=t,this.renderParams=i,this.layoutParams=a,this.priority=s,this.xOffset=l,this.yOffset=c,this.featureId=u,this.style=d,this.fadeNear=h,this.fadeFar=m,this.tileOffset=p,this.offsetDirection=f,this.dataSourceName=g,this.dataSourceOrder=y,this.visible=!0,this.distanceScale=.5,this.renderOrder=0,this.elevated=!1,i instanceof r.TextRenderStyle&&(this.renderStyle=i),a instanceof r.TextLayoutStyle&&(this.layoutStyle=a),this.type=t instanceof n.Vector3?o.TextElementType.PoiLabel:o.TextElementType.PathLabel}get position(){return this.points instanceof Array?this.points[0]:this.points}get path(){if(this.points instanceof Array)return this.points}get textMayOverlap(){return!0===this.mayOverlap}set textMayOverlap(e){this.mayOverlap=e}get textReservesSpace(){return!1!==this.reserveSpace}set textReservesSpace(e){this.reserveSpace=e}get poiInfo(){return this.m_poiInfo}set poiInfo(e){if(this.m_poiInfo=e,void 0!==e){void 0!==this.path&&(this.type=o.TextElementType.LineMarker);const t=void 0!==this.renderOrder?this.renderOrder:0;e.renderOrder=t}}get renderStyle(){return this.m_renderStyle}set renderStyle(e){this.m_renderStyle=e}get layoutStyle(){return this.m_layoutStyle}set layoutStyle(e){this.m_layoutStyle=e}hasFeatureId(){return void 0!==this.featureId&&("number"==typeof this.featureId?0!==this.featureId:this.featureId.length>0)}dispose(){var e;const t=null===(e=this.poiInfo)||void 0===e?void 0:e.buffer;t&&t.decreaseRefCount()}}t.TextElement=s,s.HIGHEST_PRIORITY=Number.MAX_SAFE_INTEGER},81237:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementBuilder=void 0;const r=i(96500),n=i(49515),o=i(38338),a=i(27771),s=i(11970),l=i(54504),c=o.LoggerManager.instance.create("TextElementBuilder");class u{constructor(e,t,i){if(this.m_env=e,this.m_styleCache=t,this.m_baseRenderOrder=i,this.m_distanceScale=l.DEFAULT_TEXT_DISTANCE_SCALE,this.m_renderOrder=i,Number.isInteger(i))this.renderOrderUpBound=u.RENDER_ORDER_UP_BOUND;else{const e=Math.abs(i);this.renderOrderUpBound=(e-Math.floor(e))*u.RENDER_ORDER_UP_BOUND}this.isValidRenderOrder(i)||c.warn(`Large base render order (${i}) might cause precision issues.`)}static alignZoomLevelRanges(e){var t,i;if(!e.poiInfo)return;const r=e.poiInfo;e.minZoomLevel=null!==(t=e.minZoomLevel)&&void 0!==t?t:o.MathUtils.min2(r.iconMinZoomLevel,r.textMinZoomLevel),e.maxZoomLevel=null!==(i=e.maxZoomLevel)&&void 0!==i?i:o.MathUtils.max2(r.iconMaxZoomLevel,r.textMaxZoomLevel)}static composeRenderOrder(e,t){return e*u.RENDER_ORDER_UP_BOUND+t}withTechnique(e){var t,i,n,a,s,d,h;this.m_technique=e,this.m_priority=null!==(t=r.getPropertyValue(e.priority,this.m_env))&&void 0!==t?t:0,this.m_fadeNear=null!==(i=r.getPropertyValue(e.fadeNear,this.m_env))&&void 0!==i?i:void 0,this.m_fadeFar=null!==(n=r.getPropertyValue(e.fadeFar,this.m_env))&&void 0!==n?n:void 0,this.m_minZoomLevel=null!==(a=r.getPropertyValue(e.minZoomLevel,this.m_env))&&void 0!==a?a:void 0,this.m_maxZoomLevel=null!==(s=r.getPropertyValue(e.maxZoomLevel,this.m_env))&&void 0!==s?s:void 0,this.m_distanceScale=null!==(d=e.distanceScale)&&void 0!==d?d:l.DEFAULT_TEXT_DISTANCE_SCALE,this.m_renderStyle=this.m_styleCache.getRenderStyle(e),this.m_layoutStype=this.m_styleCache.getLayoutStyle(e),this.m_xOffset=r.getPropertyValue(e.xOffset,this.m_env),this.m_yOffset=r.getPropertyValue(e.yOffset,this.m_env);const m=null!==(h=r.getPropertyValue(e.renderOrder,this.m_env))&&void 0!==h?h:0;if(!this.isValidRenderOrder(m)){const e=`Unsupported large render order (${m})`;c.error(e),o.assert(!1,e)}return this.m_renderOrder=u.composeRenderOrder(this.m_baseRenderOrder,m),r.isTextTechnique(e)?this.withTextTechnique(e):this.withPoiTechnique(e),this}withIcon(e,t){return o.assert(void 0!==this.m_poiBuilder),this.m_poiBuilder.withIcon(e,t),this}build(e,t,i,a,l,c,d,h){var m;const p=r.getFeatureId(c);o.assert(void 0!==this.m_technique),o.assert(void 0!==this.m_renderStyle),o.assert(void 0!==this.m_layoutStype);const f=this.m_technique,g=this.m_renderStyle,y=this.m_layoutStype,v=new s.TextElement(n.ContextualArabicConverter.instance.convert(e),t,g,y,this.m_priority,this.m_xOffset,this.m_yOffset,p,f.style,this.m_fadeNear,this.m_fadeFar,i,h,a,l);return v.minZoomLevel=this.m_minZoomLevel,v.maxZoomLevel=this.m_maxZoomLevel,v.distanceScale=this.m_distanceScale,v.mayOverlap=this.m_mayOverlap,v.reserveSpace=this.m_reserveSpace,v.kind=f.kind,v.userData=c,v.textFadeTime=void 0!==f.textFadeTime?1e3*f.textFadeTime:void 0,v.pathLengthSqr=d,v.alwaysOnTop=this.m_alwaysOnTop,v.renderOrder=this.m_renderOrder,v.poiInfo=null===(m=this.m_poiBuilder)||void 0===m?void 0:m.build(v),u.alignZoomLevelRanges(v),v}withTextTechnique(e){this.m_mayOverlap=!0===e.mayOverlap,this.m_reserveSpace=!1!==e.reserveSpace,this.m_poiBuilder=void 0}withPoiTechnique(e){this.m_mayOverlap=!0===e.textMayOverlap,this.m_reserveSpace=!1!==e.textReserveSpace,this.m_alwaysOnTop=!0===e.alwaysOnTop,this.m_poiBuilder||(this.m_poiBuilder=new a.PoiBuilder(this.m_env)),this.m_poiBuilder.withTechnique(e)}isValidRenderOrder(e){return Math.abs(e)<this.renderOrderUpBound}}t.TextElementBuilder=u,u.RENDER_ORDER_UP_BOUND=1e7},48533:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementGroup=void 0;const r=i(38338);class n extends r.PriorityListGroup{}t.TextElementGroup=n},51195:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementGroupPriorityList=void 0;const r=i(38338);class n extends r.GroupedPriorityList{}t.TextElementGroupPriorityList=n},30867:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementGroupState=void 0;const r=i(38338),n=i(8861),o=i(59491);t.TextElementGroupState=class{constructor(e,t,i){this.group=e,this.tileKey=t,this.m_visited=!1,r.assert(e.elements.length>0);const a=e.elements.length;this.m_textElementStates=[],this.m_visited=!0;for(let t=0;t<a;++t){const r=e.elements[t];if(r.type===o.TextElementType.LineMarker&&void 0!==r.path){const e=r.path.length;for(let t=0;t<e;t++){const e=new n.TextElementState(r,t),o=i(e);e.update(o),this.m_textElementStates.push(e)}}else{const e=new n.TextElementState(r),t=i(e);e.update(t),this.m_textElementStates.push(e)}}}get visited(){return this.m_visited}set visited(e){this.m_visited=e}get priority(){return this.group.priority}updateFading(e,t){for(const i of this.m_textElementStates)void 0!==i&&i.updateFading(e,t)}traverseVisibleElements(e){for(const t of this.m_textElementStates)void 0!==t&&t.visible&&e(t)}updateElements(e){for(const t of this.m_textElementStates){const i=e(t);t.update(i)}}get size(){return this.m_textElementStates.length}get textElementStates(){return this.m_textElementStates}}},8861:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLineMarkerElementState=t.TextElementState=void 0;const r=i(49515),n=i(38338),o=i(18309),a=i(22715),s=i(59491);t.TextElementState=class{constructor(e,t){this.element=e,this.m_lineMarkerIndex=t}get initialized(){return void 0!==this.m_textRenderState||void 0!==this.m_iconRenderState}get visible(){if(void 0!==this.m_textRenderState&&this.m_textRenderState.isVisible())return!0;const e=this.iconRenderState;return!(void 0===e||!e.isVisible())}get textPlacement(){const e=this.element.layoutStyle,t=this.m_textLayoutState;return void 0!==t?t.textPlacement:{h:r.hPlacementFromAlignment(e.horizontalAlignment),v:r.vPlacementFromAlignment(e.verticalAlignment)}}set textPlacement(e){void 0===this.m_textLayoutState&&!0===this.isBaseTextPlacement(e)||(void 0===this.m_textLayoutState?this.m_textLayoutState=new o.LayoutState(e):this.m_textLayoutState.textPlacement=e)}isBaseTextPlacement(e){const t=this.element.layoutStyle;if(void 0!==t)return r.hAlignFromPlacement(e.h)===t.horizontalAlignment&&r.vAlignFromPlacement(e.v)===t.verticalAlignment}reset(){void 0!==this.m_textRenderState&&this.m_textRenderState.reset(),void 0!==this.m_textLayoutState&&(void 0!==this.element.layoutStyle?this.m_textLayoutState.reset(this.element.layoutStyle):this.m_textLayoutState=void 0),this.iconRenderState&&this.m_iconRenderState.reset(),this.m_viewDistance=void 0,this.element.textBufferObject=void 0,this.element.bounds=void 0}replace(e){this.m_textRenderState=e.m_textRenderState,this.m_textLayoutState=e.m_textLayoutState,this.m_iconRenderState=e.m_iconRenderState,e.m_textRenderState=void 0,e.m_textLayoutState=void 0,e.m_iconRenderState=void 0,void 0===this.element.glyphs&&(this.element.glyphs=e.element.glyphs,this.element.glyphCaseArray=e.element.glyphCaseArray),this.element.bounds=void 0,this.element.textBufferObject=void 0}get viewDistance(){return this.m_viewDistance}update(e){this.initialized||void 0===e||this.initializeRenderStates(),this.setViewDistance(e)}setViewDistance(e){this.m_viewDistance=e}get renderDistance(){return!0===this.element.alwaysOnTop?0:void 0!==this.m_viewDistance?-this.m_viewDistance:0}get textRenderState(){return this.m_textRenderState}get iconRenderState(){return this.m_iconRenderState}get lineMarkerIndex(){return this.m_lineMarkerIndex}get position(){return void 0!==this.element.path&&void 0!==this.m_lineMarkerIndex?this.element.path[this.m_lineMarkerIndex]:this.element.position}updateFading(e,t){void 0!==this.m_textRenderState&&this.m_textRenderState.updateFading(e,t),void 0!==this.iconRenderState&&this.iconRenderState.updateFading(e,t)}initializeRenderStates(){var e;n.assert(void 0===this.m_textRenderState),n.assert(void 0===this.m_textLayoutState),n.assert(void 0===this.m_iconRenderState);const{textFadeTime:t}=this.element;if(this.m_textRenderState=new a.RenderState(t),this.element.type===s.TextElementType.PoiLabel||this.element.type===s.TextElementType.LineMarker){const i=null===(e=this.element.poiInfo)||void 0===e?void 0:e.technique.iconFadeTime,r=void 0!==i?1e3*i:t;this.m_iconRenderState=new a.RenderState(r)}}},t.isLineMarkerElementState=function(e){return void 0!==e.m_lineMarkerIndex}},40429:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementStateCache=void 0;const r=i(38338),n=i(30867),o=i(8861),a=i(59491),s=r.LoggerManager.instance.create("TextElementsStateCache",{level:r.LogLevel.Log}),l={entries:[],index:-1};function c(e){return e.hasFeatureId()?e.featureId:e.text}function u(e,t,i,r){return void 0!==e.pathLengthSqr&&void 0!==i.pathLengthSqr&&e.pathLengthSqr>i.pathLengthSqr}function d(e,t,i,r){return t<r}t.TextElementStateCache=class{constructor(){this.m_referenceMap=new Map,this.m_textMap=new Map}getOrSet(e,t,i){let r=this.get(e);return void 0!==r?(r.updateElements(i),[r,!0]):(r=new n.TextElementGroupState(e,t,i),this.set(e,r),[r,!1])}get size(){return this.m_referenceMap.size}get cacheSize(){return this.m_textMap.size}get sortedGroupStates(){return void 0===this.m_sortedGroupStates&&(this.m_sortedGroupStates=Array.from(this.m_referenceMap.values()),this.m_sortedGroupStates.sort(((e,t)=>t.group.priority-e.group.priority))),r.assert(this.m_referenceMap.size===this.m_sortedGroupStates.length),this.m_sortedGroupStates}update(e,t,i,r){const n=i?this.replaceElement.bind(this,r):void 0;let o=!1;for(const[r,a]of this.m_referenceMap.entries())a.visited?a.updateFading(e,t):(i&&a.traverseVisibleElements(n),this.m_referenceMap.delete(r),this.m_sortedGroupStates=void 0,o=!0);return o}clearVisited(){for(const e of this.m_referenceMap.values())e.visited=!1}clearTextCache(){this.m_textMap.clear()}clear(){this.m_referenceMap.clear(),this.m_sortedGroupStates=void 0,this.m_textMap.clear()}deduplicateElement(e,t){const i=this.findDuplicate(t,e);if(void 0===i)return this.m_textMap.set(c(t.element),[t]),!0;if(-1===i.index)return i.entries.push(t),!0;const r=i.entries[i.index];return!(r.visible||!t.visible||(i.entries[i.index]=t,r.reset(),0))}replaceElement(e,t){r.assert(t.visible);const i=this.findDuplicate(t,e);if(void 0===i||-1===i.index)return!1;const n=i.entries[i.index];return r.assert(!n.visible),n.replace(t),!0}get(e){const t=this.m_referenceMap.get(e);return void 0!==t&&(t.visited=!0),t}set(e,t){r.assert(e.elements.length>0),this.m_referenceMap.set(e,t),this.m_sortedGroupStates=void 0}findDuplicate(e,t){const i=e.element,n=this.m_textMap.get(c(i));if(void 0===n)return;l.entries=n;const h=i.hasFeatureId()?function(e,t){const i=e.element,n=t.findIndex((e=>e.element.tileOffset===i.tileOffset));if(-1===n)return-1;const o=t[n].element;if(r.assert(i.featureId===o.featureId),o.text===i.text)return n;s.debug(`Text feature id ${i.featureId} collision between "${i.text} and              ${o.text}`)}(e,n):function(e,t,i){const r=e.element,n=function(e){return 100<<(Math.min(4,13-Math.min(13,Math.floor(e)))<<2)}(i),s=t.length,l=e.position,c=e.visible,h=o.isLineMarkerElementState(e);let m,p=-1,f=1/0;const g=r.type===a.TextElementType.PathLabel?u:d;for(let e=0;e<s;++e){const i=t[e],a=i.element,s=r.type!==a.type||h!==o.isLineMarkerElementState(i),u=c&&i.visible;if(s||u)continue;const d=l.distanceToSquared(a.position);d>n||(void 0===m||g(a,d,m,f))&&(p=e,m=a,f=d)}return p}(e,n,t);return void 0===h?(i.featureId=void 0,this.findDuplicate(e,t)):(l.index=h,l)}}},59491:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementType=void 0,(i=t.TextElementType||(t.TextElementType={}))[i.PoiLabel=0]="PoiLabel",i[i.PathLabel=1]="PathLabel",i[i.LineMarker=2]="LineMarker"},54504:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextElementsRenderer=t.DEFAULT_TEXT_DISTANCE_SCALE=t.DEFAULT_FONT_CATALOG_NAME=void 0;const r=i(49515),n=i(38338),o=i(84428),a=i(61712),s=i(58512),l=i(67180),c=i(29113),u=i(9660),d=i(80178),h=i(59552),m=(i(41639),i(62960)),p=i(4665),f=i(11970),g=i(21211),y=i(40429),v=i(59491),_=i(22469);var b;i(13399),function(e){e[e.PersistentLabels=0]="PersistentLabels",e[e.NewLabels=1]="NewLabels"}(b||(b={})),t.DEFAULT_FONT_CATALOG_NAME="default",t.DEFAULT_TEXT_DISTANCE_SCALE=.5;const S=n.LoggerManager.instance.create("TextElementsRenderer",{level:n.LogLevel.Log}),T=new o.Vector3,E=new o.Vector2,C=[],w=new o.Vector2,x={},P={},O={},A={vector2:[new o.Vector2]};class D{constructor(e,t){this.tile=e,this.group=t}}class R{constructor(e){this.lists=e}get priority(){return n.assert(this.lists.length>0),this.lists[0].group.priority}count(){let e=0;for(const t of this.lists)e+=t.group.elements.length;return e}}function I(e,t,i,r,n){P.path=r,P.pathOverflow=n,P.layer=e.renderOrder,P.letterCaseArray=e.glyphCaseArray,P.pickingData=e.userData?e:void 0,t.addText(e.glyphs,i,P)}function M(e){return void 0!==e&&(n.PerformanceTimer.now()-e>10&&(S.debug("Placement time limit exceeded."),!0))}t.TextElementsRenderer=class{constructor(e,t,i,r,n,a,s,l,d){this.m_viewState=e,this.m_screenProjector=t,this.m_poiManager=i,this.m_renderer=r,this.m_imageCaches=n,this.m_loadPromisesCount=0,this.m_textCanvases=new Map,this.m_tmpVector=new o.Vector2,this.m_tmpVector3=new o.Vector3,this.m_cameraLookAt=new o.Vector3,this.m_overloaded=!1,this.m_cacheInvalidated=!1,this.m_addNewLabels=!0,this.m_forceNewLabelsPass=!1,this.m_textElementStateCache=new y.TextElementStateCache,this.m_camera=new o.OrthographicCamera(-1,1,1,-1),this.m_textStyleCache=new _.TextStyleCache,this.m_screenCollisions=new u.ScreenCollisions,this.m_isUpdatePending=!1,this.m_options=Object.assign({},a),g.initializeDefaultOptions(this.m_options),d?this.m_screenCollisions=d:void 0!==this.m_options.collisionDebugCanvas&&null!==this.m_options.collisionDebugCanvas&&(this.m_screenCollisions=new u.ScreenCollisionsDebug(this.m_options.collisionDebugCanvas)),this.m_textCanvasFactory=null!=s?s:new p.TextCanvasFactory(this.m_renderer),this.m_textCanvasFactory.setGlyphCountLimits(this.m_options.minNumGlyphs,this.m_options.maxNumGlyphs),this.m_poiRenderer=null!=l?l:new c.PoiRenderer(this.m_renderer,this.m_poiManager,this.m_imageCaches),this.initializeCamera(),this.initializeDefaultFontCatalog(),this.m_textStyleCache.updateTextCanvases(this.m_textCanvases)}set disableFading(e){this.m_options.disableFading=e}get disableFading(){return!0===this.m_options.disableFading}get styleCache(){return this.m_textStyleCache}get delayLabelsUntilMovementFinished(){return!0===this.m_options.delayLabelsUntilMovementFinished}set delayLabelsUntilMovementFinished(e){this.m_options.delayLabelsUntilMovementFinished=e}get showReplacementGlyphs(){return!0===this.m_options.showReplacementGlyphs}set showReplacementGlyphs(e){this.m_options.showReplacementGlyphs=e,this.m_textCanvases.forEach((t=>{(null==t?void 0:t.fontCatalog)&&(t.fontCatalog.showReplacementGlyphs=e)}))}restoreRenderers(e){this.m_renderer=e,this.m_poiRenderer=new c.PoiRenderer(this.m_renderer,this.m_poiManager,this.m_imageCaches)}async updateFontCatalogs(e){if(this.m_defaultFontCatalogConfig&&(e&&-1!==e.findIndex((e=>e.name===t.DEFAULT_FONT_CATALOG_NAME))?this.m_textCanvases.has(t.DEFAULT_FONT_CATALOG_NAME)&&this.m_textCanvases.delete(t.DEFAULT_FONT_CATALOG_NAME):(e||(e=[]),e.unshift(this.m_defaultFontCatalogConfig))),e&&e.length>0){for(const[t]of this.m_textCanvases)e.findIndex((e=>e.name===t))<0&&this.m_textCanvases.delete(t);for(const t of e)await this.addTextCanvas(t)}else this.m_textCanvases.clear();this.m_textStyleCache.updateTextCanvases(this.m_textCanvases)}async updateTextStyles(e,t){this.m_textStyleCache.updateTextStyles(e,t),await this.waitLoaded(),this.m_textStyleCache.updateTextCanvases(this.m_textCanvases),this.invalidateCache()}renderText(e){let t;this.m_camera.far=e,this.updateGlyphDebugMesh(),this.m_poiRenderer.update();for(const e of this.m_poiRenderer.layers){for(const[,i]of this.m_textCanvases)null==i||i.render(this.m_camera,null==t?void 0:t.id,e.id,void 0,!1);this.m_poiRenderer.render(this.m_camera,e),t=e}for(const[,e]of this.m_textCanvases)null==e||e.render(this.m_camera,null==t?void 0:t.id,void 0,void 0,!1)}invalidateCache(){this.m_cacheInvalidated=!0}movementStarted(){this.delayLabelsUntilMovementFinished&&(this.m_addNewLabels=!1)}movementFinished(){this.invalidateCache(),this.delayLabelsUntilMovementFinished&&(this.m_addNewLabels=!0)}get overloaded(){return this.m_overloaded}placeText(e,t){const i=function(e){let t=!1;return e.forEach((({renderedTiles:e})=>{e.forEach((e=>{e.textElementsChanged&&(e.textElementsChanged=!1,t=!0)}))})),t}(e),r=this.hasOverlayText()||i||function(e){for(let t=0;t<e.length;t++)for(const[i,r]of e[t].renderedTiles)if(r.hasTextElements())return!0;return!1}(e);if(this.m_isUpdatePending=!1,!r&&!this.m_cacheInvalidated&&!this.m_viewState.renderedTilesChanged)return;const n=this.m_cacheInvalidated||i||this.m_viewState.renderedTilesChanged,o=n&&this.m_addNewLabels;o&&(this.m_textElementStateCache.clearVisited(),this.updateTextElements(e));const a=this.m_textElementStateCache.update(t,this.m_options.disableFading,o,this.m_viewState.zoomLevel);this.reset(),this.m_addNewLabels&&this.prepopulateScreenWithBlockingElements(e);const s=(n||a)&&this.m_addNewLabels;this.placeTextElements(t,s),this.placeOverlayTextElements()}addOverlayText(e){0!==e.length&&(this.m_overlayTextElements=void 0===this.m_overlayTextElements?e.slice():this.m_overlayTextElements.concat(e))}clearOverlayText(){this.m_overlayTextElements=[]}hasOverlayText(){return void 0!==this.m_overlayTextElements&&this.m_overlayTextElements.length>0}get overlayText(){return this.m_overlayTextElements}pickTextElements(e,t){const i=(i,r)=>{if(void 0===i)return;const n=i,o={type:r,point:e,distance:0,renderOrder:n.renderOrder,featureId:n.featureId,userData:n.userData,dataSourceName:n.dataSourceName,dataSourceOrder:n.dataSourceOrder,text:n.text};t.addResult(o)};for(const[,t]of this.m_textCanvases)null==t||t.pickText(e,(e=>{i(e,l.PickObjectType.Text)}));this.m_poiRenderer.pickTextElements(e,(e=>{i(e,l.PickObjectType.Icon)}))}get loading(){return this.m_loadPromisesCount>0}get isUpdatePending(){return this.m_isUpdatePending}async waitLoaded(){if(void 0!==this.m_loadPromise)return await this.m_loadPromise}clearRenderStates(){this.m_textElementStateCache.clear()}getMemoryUsage(){const e={heapSize:0,gpuSize:0};for(const[,t]of this.m_textCanvases)null==t||t.getMemoryUsage(e);return this.m_poiRenderer.getMemoryUsage(e),e}async addDefaultTextCanvas(){!this.m_textCanvases.has(t.DEFAULT_FONT_CATALOG_NAME)&&this.m_defaultFontCatalogConfig&&(await this.addTextCanvas(this.m_defaultFontCatalogConfig),this.m_textStyleCache.updateTextCanvases(this.m_textCanvases))}reset(){this.m_cameraLookAt.copy(this.m_viewState.lookAtVector),this.m_screenCollisions.reset();for(const[,e]of this.m_textCanvases)null==e||e.clear();this.m_poiRenderer.reset()}prepopulateScreenWithBlockingElements(e){const t=[];e.forEach((e=>{const i=new o.Vector3,r=new o.Vector3;for(const n of e.renderedTiles.values())for(const e of n.blockingElements)if(!(e.points.length<2)){this.m_screenProjector.project3(e.points[0],i);for(let n=1;n<e.points.length;n++){this.m_screenProjector.project3(e.points[n],r);const o=e.screenSpaceLines[n-1];o.start.copy(i),o.end.copy(r);const a={minX:Math.min(i.x,r.x),maxX:Math.max(i.x,r.x),minY:Math.min(i.y,r.y),maxY:Math.max(i.y,r.y),line:o};t.push(a),i.copy(r)}}})),this.m_screenCollisions.allocateIBoxes(t)}placeTextElementGroup(e,t,i,o){var a;n.assert(e.visited);const l=[],c=this.m_viewState.hiddenGeometryKinds,u=this.m_viewState.projection,d=this.m_viewState.elevationProvider,m=null==d?void 0:d.getDisplacementMap(e.tileKey);for(const n of e.textElementStates){if(o===b.PersistentLabels);else if(void 0!==i&&t.numRenderedTextElements>=i)return S.debug("Placement label limit exceeded."),!1;if(!n.initialized)continue;if(void 0===n.viewDistance||n.viewDistance<0)continue;const e=n.visible;if(o===b.PersistentLabels&&!e||o===b.NewLabels&&e)continue;const p=n.element,f=this.m_textStyleCache.getTextElementStyle(p.style),g=f.textCanvas;if(void 0!==c&&void 0!==p.kind&&c.hasOrIntersects(p.kind))continue;if(void 0!==d&&!p.elevated){if(!m){this.m_isUpdatePending=!0,this.m_forceNewLabelsPass=!0;continue}s.overlayTextElement(p,d,m,u)}const y=p.type;if(y===v.TextElementType.PathLabel&&h.isPathLabelTooSmall(p,this.m_screenProjector,C)){p.dbgPathTooSmall,n.reset();continue}const _=!0;if(g){if(!this.initializeGlyphs(p,f,_))continue;const e=g.getLayer(null!==(a=p.renderOrder)&&void 0!==a?a:r.DEFAULT_TEXT_CANVAS_LAYER);if(void 0!==e&&e.storage.drawCount+p.glyphs.length>e.storage.capacity){S.warn("layer glyph storage capacity exceeded.");continue}g.textRenderStyle=p.renderStyle,g.textLayoutStyle=p.layoutStyle}switch(y){case v.TextElementType.PoiLabel:this.addPoiLabel(n,g,t);break;case v.TextElementType.LineMarker:this.addLineMarkerLabel(n,l,g,t);break;case v.TextElementType.PathLabel:g&&this.addPathLabel(n,C,g,t)}}return!0}initializeGlyphs(e,t,i){if(e.loadingState===f.LoadingState.Initialized)return void 0!==e.glyphs;n.assert(void 0!==t.textCanvas);const o=t.textCanvas;if(void 0===e.loadingState)if(e.loadingState=f.LoadingState.Requested,void 0===e.renderStyle&&(e.renderStyle=new r.TextRenderStyle(Object.assign(Object.assign({},t.renderParams),e.renderParams))),void 0===e.layoutStyle&&(e.layoutStyle=new r.TextLayoutStyle(Object.assign(Object.assign({},t.layoutParams),e.layoutParams))),""===e.text)e.loadingState=f.LoadingState.Loaded;else{const t=o.fontCatalog.loadCharset(e.text,e.renderStyle).then((()=>{--this.m_loadPromisesCount,e.loadingState=f.LoadingState.Loaded,this.m_isUpdatePending=!0,this.m_forceNewLabelsPass=this.m_forceNewLabelsPass||i}));0===this.m_loadPromisesCount&&(this.m_loadPromise=void 0),++this.m_loadPromisesCount,this.m_loadPromise=void 0===this.m_loadPromise?t:Promise.all([this.m_loadPromise,t])}return e.loadingState===f.LoadingState.Loaded&&(o.textRenderStyle=e.renderStyle,o.textLayoutStyle=e.layoutStyle,e.glyphCaseArray=[],e.bounds=void 0,e.glyphs=o.fontCatalog.getGlyphs(e.text,o.textRenderStyle,e.glyphCaseArray),e.loadingState=f.LoadingState.Initialized),void 0!==e.glyphs}initializeCamera(){this.m_camera.position.z=1,this.m_camera.near=0}updateCamera(){const{width:e,height:t}=this.m_renderer.getSize(A.vector2[0]);this.m_camera.left=e/-2,this.m_camera.right=e/2,this.m_camera.bottom=t/-2,this.m_camera.top=t/2,this.m_camera.updateProjectionMatrix(),this.m_camera.updateMatrixWorld(!1),this.m_screenCollisions.update(e,t)}initializeDefaultFontCatalog(){var e;this.m_options.fontCatalog&&(this.m_defaultFontCatalogConfig=(e=this.m_options.fontCatalog,{name:t.DEFAULT_FONT_CATALOG_NAME,url:e}),this.addDefaultTextCanvas())}async addTextCanvas(e){const t=(e,t)=>{if(this.m_textCanvases.has(e)){const i=this.m_textCanvasFactory.createTextCanvas(t,e);t.showReplacementGlyphs=this.showReplacementGlyphs,this.m_textCanvases.set(e,i)}},i=()=>{this.m_textCanvases.delete(e.name)};if(this.m_textCanvases.has(e.name))return Promise.resolve();{this.m_textCanvases.set(e.name,void 0);const r=d.loadFontCatalog(e,t,i).then((()=>{--this.m_loadPromisesCount})).catch((e=>{S.info("rendering without font catalog, only icons possible",e),--this.m_loadPromisesCount}));return 0===this.m_loadPromisesCount&&(this.m_loadPromise=void 0),++this.m_loadPromisesCount,this.m_loadPromise=void 0===this.m_loadPromise?r:Promise.all([this.m_loadPromise,r]),r}}updateGlyphDebugMesh(){const e=a.debugContext.getValue("DEBUG_GLYPHS");void 0!==e&&(e&&void 0===this.m_debugGlyphTextureCacheMesh&&this.initializeGlyphDebugMesh(),n.assert(void 0!==this.m_debugGlyphTextureCacheMesh),n.assert(void 0!==this.m_debugGlyphTextureCacheWireMesh),this.m_debugGlyphTextureCacheMesh.visible=e,this.m_debugGlyphTextureCacheWireMesh.visible=e)}initializeGlyphDebugMesh(){if(0===this.m_textCanvases.size)return;const e=this.m_textCanvases.values().next().value,t=e.fontCatalog,i=new o.PlaneGeometry(t.textureSize.width/2.5,t.textureSize.height/2.5,t.textureSize.width/t.maxWidth,t.textureSize.height/t.maxHeight),n=new o.MeshBasicMaterial({transparent:!0,depthWrite:!1,depthTest:!1,map:t.texture});this.m_debugGlyphTextureCacheMesh=new o.Mesh(i,n),this.m_debugGlyphTextureCacheMesh.renderOrder=1e4,this.m_debugGlyphTextureCacheMesh.visible=!1,this.m_debugGlyphTextureCacheMesh.name="glyphDebug";const a=new o.WireframeGeometry(i),s=new o.LineBasicMaterial({transparent:!0,color:10066329,depthWrite:!1,depthTest:!1});this.m_debugGlyphTextureCacheWireMesh=new o.LineSegments(a,s),this.m_debugGlyphTextureCacheWireMesh.renderOrder=9999,this.m_debugGlyphTextureCacheWireMesh.visible=!1,this.m_debugGlyphTextureCacheWireMesh.name="glyphDebug",e.getLayer(r.DEFAULT_TEXT_CANVAS_LAYER).storage.scene.add(this.m_debugGlyphTextureCacheMesh,this.m_debugGlyphTextureCacheWireMesh)}updateTextElements(e){this.m_textElementStateCache.clearTextCache(),this.m_cacheInvalidated=!1,this.checkIfOverloaded(e);const t=this.overloaded&&this.m_viewState.isDynamic?n.PerformanceTimer.now():void 0;e.forEach((e=>{this.updateTextElementsFromSource(e.dataSource,e.storageLevel,Array.from(e.renderedTiles.values()),t)}))}updateTextElementsFromSource(e,t,i,r){const o=i;o.sort(((e,t)=>e.tileKey.mortonCode()-t.tileKey.mortonCode()));const a=[];this.createSortedGroupsForSorting(e,t,o,a);let s=0;for(const e of a)if(this.selectTextElementsToUpdateByDistance(e),void 0!==r){if(n.PerformanceTimer.now()-r>5){S.debug("Update time limit exceeded.");break}if(s+=e.count(),s>=100){S.debug("Update label limit exceeded.");break}}}prepareTextElementGroup(e,t,i){if(0===e.elements.length)return;const[,r]=this.m_textElementStateCache.getOrSet(e,t,(e=>{let{result:t,viewDistance:r}=h.checkReadyForPlacement(e.element,e.element.type===v.TextElementType.LineMarker?e.lineMarkerIndex:void 0,this.m_viewState,this.m_poiManager,i);return t!==h.PrePlacementResult.Ok||this.m_textElementStateCache.deduplicateElement(this.m_viewState.zoomLevel,e)||(t=h.PrePlacementResult.Duplicate,r=void 0),r}))}createSortedGroupsForSorting(e,t,i,r){if(0===i.length)return;const n=[];for(const r of i)e.shouldRenderText(t,r.tileKey)&&n.push(r);const o=new Map;for(const e of n)for(const t of e.textElementGroups.groups.values()){if(0===t.elements.length)continue;const i=o.get(t.priority);void 0===i?o.set(t.priority,new R([new D(e,t)])):i.lists.push(new D(e,t))}if(0!==o.size){for(const e of o){const t=e[1];r.push(t)}r.sort(((e,t)=>t.priority-e.priority))}}selectTextElementsToUpdateByDistance(e){const t=Math.max(this.m_options.maxDistanceRatioForTextLabels,this.m_options.maxDistanceRatioForPoiLabels),i=h.getMaxViewDistance(this.m_viewState,t);for(const t of e.lists)this.prepareTextElementGroup(t.group,t.tile.tileKey,i)}placeTextElements(e,t){const i={numRenderedTextElements:0,fadeAnimationRunning:!1,time:e},r=this.overloaded&&this.m_viewState.isDynamic?n.PerformanceTimer.now():void 0;if(0===this.m_textElementStateCache.size)return void S.debug("Text element cache empty.");const o=this.m_forceNewLabelsPass||t;this.m_forceNewLabelsPass&&(this.m_forceNewLabelsPass=!1);const a=this.m_options.maxNumVisibleLabels,s=this.m_textElementStateCache.sortedGroupStates;let l=s[0].priority,c=0;for(let e=0;e<s.length;++e){const t=s[e],n=t.priority;if(o&&l!==n){if(this.placeNewTextElements(c,e,i),M(r))break;l=n,c=e}if(!this.placeTextElementGroup(t,i,a,b.PersistentLabels))break;if(M(r))break}o&&this.placeNewTextElements(c,s.length,i),i.fadeAnimationRunning&&(this.m_isUpdatePending=!0)}placeNewTextElements(e,t,i){const r=this.m_textElementStateCache.sortedGroupStates;for(let n=e;n<t&&this.placeTextElementGroup(r[n],i,this.m_options.maxNumVisibleLabels,b.NewLabels);++n);}placeOverlayTextElements(){var e;if(void 0===this.m_overlayTextElements||0===this.m_overlayTextElements.length)return;const t=this.m_tmpVector.set(this.m_screenProjector.width,this.m_screenProjector.height),i=-t.width/2,n=t.height/2;for(const a of this.m_overlayTextElements){const s=this.m_textStyleCache.getTextElementStyle(a.style),l=s.textCanvas;if(void 0===l)continue;const c=!1;if(this.initializeGlyphs(a,s,c),a.loadingState!==f.LoadingState.Initialized)continue;const u=l.getLayer(null!==(e=a.renderOrder)&&void 0!==e?e:r.DEFAULT_TEXT_CANVAS_LAYER);if(void 0!==u&&u.storage.drawCount+a.glyphs.length>u.storage.capacity)continue;let d;if(l.textRenderStyle=a.renderStyle,l.textLayoutStyle=a.layoutStyle,a.type!==v.TextElementType.PathLabel)E.x=i+a.position.x*t.width,E.y=n-a.position.y*t.height,void 0!==a.xOffset&&(E.x+=a.xOffset),void 0!==a.yOffset&&(E.y-=a.yOffset),T.x=E.x,T.y=E.y,T.z=0,I(a,l,T);else{E.x=i,E.y=n,void 0!==a.xOffset&&(E.x+=a.xOffset),void 0!==a.yOffset&&(E.y-=a.yOffset);const e=[];for(const i of a.path){const r=E.x+i.x*t.width,n=E.y-i.y*t.height;e.push(new o.Vector2(r,n))}d=new m.SimplePath;for(let t=0;t<e.length-1;++t)d.add(new o.LineCurve(e[t],e[t+1]));I(a,l,T,d,!0)}}}getDistanceScalingFactor(e,t,i){let r=i/t;return r=1+(r-1)*e.distanceScale,r=Math.max(r,this.m_options.labelDistanceScaleMin),r=Math.min(r,this.m_options.labelDistanceScaleMax),r}getDistanceFadingFactor(e,t,i){let r=1;const n=t.viewDistance;if(void 0!==n&&void 0!==e.fadeFar&&e.fadeFar>0){const t=void 0===e.fadeNear?0:e.fadeNear,a=e.fadeFar;a>t&&(r=1-o.MathUtils.clamp((n/i-t)/(a-t),0,1))}return r}addPointLabel(e,t,i,r,o){var a;const s=e.element,l=e.textRenderState,c=s.type===v.TextElementType.LineMarker,u=e.iconRenderState;n.assert(void 0!==u),E.x=w.x=i.x,E.y=w.y=i.y;const d=h.pointToPlaneDistance(t,this.m_viewState.worldCenter,this.m_cameraLookAt);if(void 0!==s.fadeFar&&(s.fadeFar<=0||s.fadeFar*this.m_viewState.maxVisibilityDist<d))return!1;e.setViewDistance(d);const m=s.poiInfo;let p=!1;const f=void 0!==m&&n.MathUtils.isClamped(this.m_viewState.zoomLevel,m.iconMinZoomLevel,m.iconMaxZoomLevel)&&!1!==m.isValid,g=this.getDistanceScalingFactor(s,d,this.m_viewState.lookAtDistance),y=f&&this.m_poiRenderer.prepareRender(s,this.m_viewState.env);let _=!1;if(y){const e=h.placeIcon(u,m,w,g,this.m_viewState.env,this.m_screenCollisions);_=e===h.PlacementResult.Invisible,p=e===h.PlacementResult.Rejected,_&&u.reset()}else f&&null!==(null==m?void 0:m.imageItem)&&(this.m_forceNewLabelsPass=!0,this.m_isUpdatePending=!0);const b=this.getDistanceFadingFactor(s,e,this.m_viewState.maxVisibilityDist);if(r&&function(e,t,i){const r=e.textRenderState,o=e.element,a=o.poiInfo;if(n.assert(o.type!==v.TextElementType.PathLabel),void 0===r||""===o.text)return!1;if(void 0!==a&&!n.MathUtils.isClamped(t.zoomLevel,a.textMinZoomLevel,a.textMaxZoomLevel))return!1;const s=h.getMaxViewDistance(t,i.maxDistanceRatioForPoiLabels);return!(!(!0===o.ignoreDistance||void 0===e.viewDistance||e.viewDistance<s&&e.viewDistance>0)||a&&!0!==a.isValid&&!0!==a.iconIsOptional)}(e,this.m_viewState,this.m_options)){const t=!e.visible,i=p&&t?h.PlacementResult.Rejected:h.placePointLabel(e,E,g,r,this.m_viewState.env,this.m_screenCollisions,T,!c),n=i===h.PlacementResult.Invisible;if(n){if(!f||_)return e.reset(),!1;l.reset()}const u=!0===(null==m?void 0:m.iconIsOptional),d=p&&y&&!u||i===h.PlacementResult.Rejected;if(!p&&!_){const e=!0===(null===(a=s.poiInfo)||void 0===a?void 0:a.textIsOptional);p=d&&!e}d&&l.startFadeOut(o.time),!n&&(!d&&function(e,t){const i=e.element.poiInfo;return!t.cameraIsMoving||void 0===i||!0===i.renderTextDuringMovements}(e,this.m_viewState)||l.isFading())&&(d||l.startFadeIn(o.time,this.m_options.disableFading),o.fadeAnimationRunning=o.fadeAnimationRunning||l.isFading(),function(e,t,i,r,n){const o=e.element,a=e.textRenderState.opacity*r*o.renderStyle.opacity;if(0===a)return!1;x.letterCaseArray=o.glyphCaseArray,void 0===o.textBufferObject&&(o.textBufferObject=t.createTextBufferObject(o.glyphs,x));const s=o.renderStyle.backgroundOpacity>0&&t.textRenderStyle.fontSize.backgroundSize>0;O.layer=o.renderOrder,O.position=i,O.scale=n,O.opacity=a,O.backgroundOpacity=s?O.opacity*o.renderStyle.backgroundOpacity:0,O.pickingData=o.userData?o:void 0,t.addTextBufferObject(o.textBufferObject,O)}(e,r,T,b,g))}if(y&&!_){p?u.startFadeOut(o.time):u.startFadeIn(o.time,this.m_options.disableFading),o.fadeAnimationRunning=o.fadeAnimationRunning||u.isFading();const t=u.opacity*b;if(t>0){const i=!1!==m.reserveSpace&&!p;this.m_poiRenderer.addPoi(m,w,this.m_screenCollisions,e.renderDistance,g,i,t,this.m_viewState.env)}}return o.numRenderedTextElements++,!0}addPoiLabel(e,t,i){const r=h.getWorldPosition(e.element,this.m_viewState.projection,this.m_viewState.env,this.m_tmpVector3);return!!this.labelPotentiallyVisible(r,E)&&this.addPointLabel(e,r,E,t,i)}addLineMarkerLabel(e,t,i,r){var o;const a=e.element,s=a.poiInfo;if(!(null===(o=this.m_poiRenderer)||void 0===o?void 0:o.prepareRender(a,this.m_viewState.env)))return;let l;void 0!==s.shieldGroupIndex&&(l=t[s.shieldGroupIndex],void 0===l&&(l=[],t[s.shieldGroupIndex]=l));const c=s.technique,u=void 0!==c.minDistance?c.minDistance*c.minDistance:0;if(u>0&&void 0!==l){let t=0;const o=e.position;if(this.labelPotentiallyVisible(o,E)){let a=!1;for(let e=0;e<l.length&&(a=n.Math2D.distSquared(l[e],l[e+1],E.x,E.y)<u,!a);e+=2);a||this.addPointLabel(e,o,E,i,r)&&(l.push(E.x,E.y),t++)}0===t&&e.reset()}else{const t=e.position;this.labelPotentiallyVisible(t,E)&&this.addPointLabel(e,t,E,i,r)}}addPathLabel(e,t,i,r){const n=h.getMaxViewDistance(this.m_viewState,this.m_options.maxDistanceRatioForTextLabels),a=e.element;if(!(!0===a.ignoreDistance||void 0===e.viewDistance||e.viewDistance<n))return e.textRenderState.reset(),!1;if(void 0!==a.fadeFar&&(a.fadeFar<=0||a.fadeFar*this.m_viewState.maxVisibilityDist<e.renderDistance))return e.textRenderState.reset(),!1;let s=new o.Path;E.copy(t[0]);for(let e=0;e<t.length-1;++e)s.add(new m.SimpleLineCurve(t[e],t[e+1]));if(s.getPoint(.5).x-s.getPoint(.51).x>0){E.copy(t[t.length-1]),s=new o.Path;for(let e=t.length-1;e>0;--e)s.add(new m.SimpleLineCurve(t[e],t[e-1]))}e.setViewDistance(h.computeViewDistance(a,void 0,this.m_viewState.worldCenter,this.m_cameraLookAt));const l=-e.renderDistance,c=this.getDistanceScalingFactor(a,l,this.m_viewState.lookAtDistance),u=i.textRenderStyle.fontSize.size;if(i.textRenderStyle.fontSize.size*=c,h.placePathLabel(e,s,E,i,this.m_screenCollisions)!==h.PlacementResult.Ok)return i.textRenderStyle.fontSize.size=u,e.textRenderState.reset(),!1;e.textRenderState.startFadeIn(r.time,this.m_options.disableFading);let d=a.renderStyle.opacity;if(e.textRenderState.isFading()&&(d*=e.textRenderState.opacity,r.fadeAnimationRunning=!0),0===e.textRenderState.opacity)return i.textRenderStyle.fontSize.size=u,!1;const p=i.textRenderStyle.opacity,f=i.textRenderStyle.backgroundOpacity,g=this.getDistanceFadingFactor(a,e,this.m_viewState.maxVisibilityDist);return i.textRenderStyle.opacity=d*g,i.textRenderStyle.backgroundOpacity=i.textRenderStyle.opacity*a.renderStyle.backgroundOpacity,T.z=e.renderDistance,I(a,i,T,s),r.numRenderedTextElements++,i.textRenderStyle.fontSize.size=u,i.textRenderStyle.opacity=p,i.textRenderStyle.backgroundOpacity=f,!0}checkIfOverloaded(e){let t=0;e.forEach((e=>{for(const i of e.renderedTiles.values())t+=i.textElementGroups.count()}));const i=t>2e4;return i&&!this.m_overloaded&&S.debug("Overloaded Mode enabled."),this.m_overloaded=i,this.m_overloaded}labelPotentiallyVisible(e,t){var i;const r=o.MathUtils.clamp(null!==(i=this.m_options.maxPoiDistanceToBorder)&&void 0!==i?i:0,0,1);return void 0!==this.m_screenProjector.projectAreaToScreen(e,r,r,t)}}},21211:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeDefaultOptions=void 0,t.initializeDefaultOptions=function(e){void 0===e.minNumGlyphs&&(e.minNumGlyphs=1024),void 0===e.maxNumGlyphs&&(e.maxNumGlyphs=32768),void 0===e.labelDistanceScaleMin&&(e.labelDistanceScaleMin=.7),void 0===e.labelDistanceScaleMax&&(e.labelDistanceScaleMax=1.5),void 0===e.maxDistanceRatioForTextLabels&&(e.maxDistanceRatioForTextLabels=.99),void 0===e.maxDistanceRatioForPoiLabels&&(e.maxDistanceRatioForPoiLabels=.99),void 0===e.disableFading&&(e.disableFading=!1),void 0===e.delayLabelsUntilMovementFinished&&(e.delayLabelsUntilMovementFinished=!0),void 0===e.showReplacementGlyphs&&(e.showReplacementGlyphs=!1),void 0===e.maxPoiDistanceToBorder&&(e.maxPoiDistanceToBorder=.2)}},22469:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextStyleCache=void 0;const r=i(96500),n=i(49515),o=i(38338),a=i(40160),s=i(37337),l=i(54504),c=o.LoggerManager.instance.create("TextStyleCache"),u=new n.TextRenderStyle({fontSize:{unit:n.FontUnit.Pixel,size:32,backgroundSize:8},color:a.ColorCache.instance.getColor("#6d7477"),opacity:1,backgroundColor:a.ColorCache.instance.getColor("#f7fbfd"),backgroundOpacity:.5}),d=new n.TextLayoutStyle({verticalAlignment:n.VerticalAlignment.Center,horizontalAlignment:n.HorizontalAlignment.Center,placements:[]}),h="default";function m(e,t,i){const o=i?function(e){const t=[];return(e?e.toUpperCase().replace(" ","").split(","):[]).forEach((e=>{const i=function(e){if(e.length<1||e.length>2)return;const t={h:n.HorizontalPlacement.Center,v:n.VerticalPlacement.Center};let i=e.charAt(0),o=!0;switch(i){case r.PlacementToken.Top:case r.PlacementToken.North:t.v=n.VerticalPlacement.Top;break;case r.PlacementToken.Bottom:case r.PlacementToken.South:t.v=n.VerticalPlacement.Bottom;break;default:if(o=!1,2===e.length)return}if(o&&1===e.length)return t;switch(i=1===e.length?e.charAt(0):e.charAt(1),i){case r.PlacementToken.Right:case r.PlacementToken.East:t.h=n.HorizontalPlacement.Right;break;case r.PlacementToken.Left:case r.PlacementToken.West:t.h=n.HorizontalPlacement.Left;break;default:return}return t}(e);void 0!==i&&t.push(i)})),t}(i):void 0;return n.resolvePlacementAndAlignment(function(e){return"Left"===e||"Center"===e||"Right"===e?n.HorizontalAlignment[e]:d.horizontalAlignment}(e),function(e){return"Above"===e||"Center"===e||"Below"===e?n.VerticalAlignment[e]:d.verticalAlignment}(t),o)}t.TextStyleCache=class{constructor(){this.m_textStyles=new Map,this.m_defaultStyle={name:h,fontCatalog:void 0,renderParams:u.params,layoutParams:d.params},this.updateDefaultTextStyle()}updateTextStyles(e,t){this.m_textStyles.clear(),null==e||e.forEach((e=>{this.m_textStyles.set(e.name,this.createTextElementStyle(e,e.name))})),this.updateDefaultTextStyle(t,e)}updateTextCanvases(e){this.initializeTextCanvas(this.m_defaultStyle,e);for(const[,t]of this.m_textStyles)this.initializeTextCanvas(t,e)}getTextElementStyle(e){let t;return void 0===e?t=this.m_defaultStyle:(t=this.m_textStyles.get(e),void 0===t&&(t=this.m_defaultStyle)),t}createRenderStyle(e,t){const i=e.mapView,l=i.zoomLevel,c=Math.floor(l),u=new r.MapEnv({$zoom:c},i.env),d=this.m_defaultStyle.renderParams,h=o.getOptionValue(d.opacity,1);let m,p=r.getPropertyValue(o.getOptionValue(t.opacity,h),u);if(void 0!==t.color){let e=s.evaluateColorProperty(t.color,u);void 0!==e&&(r.ColorUtils.hasAlphaInHex(e)&&(p*=r.ColorUtils.getAlphaFromHex(e),e=r.ColorUtils.removeAlphaFromHex(e)),m=a.ColorCache.instance.getColor(e))}const f=o.getOptionValue(d.fontSize.backgroundSize,0),g=r.getPropertyValue(o.getOptionValue(t.backgroundSize,f),u),y=void 0!==t.backgroundColor&&void 0!==t.backgroundSize&&g>0,v=o.getOptionValue(d.backgroundOpacity,0);let _,b=r.getPropertyValue(o.getOptionValue(t.backgroundOpacity,y?1:v),u);if(void 0!==t.backgroundColor){let e=s.evaluateColorProperty(t.backgroundColor,u);void 0!==e&&(r.ColorUtils.hasAlphaInHex(e)&&(b*=r.ColorUtils.getAlphaFromHex(e),e=r.ColorUtils.removeAlphaFromHex(e)),_=a.ColorCache.instance.getColor(e))}const S={fontName:o.getOptionValue(t.fontName,d.fontName),fontSize:{unit:n.FontUnit.Pixel,size:r.getPropertyValue(o.getOptionValue(t.size,d.fontSize.size),u),backgroundSize:g},fontStyle:"Regular"===t.fontStyle||"Bold"===t.fontStyle||"Italic"===t.fontStyle||"BoldItalic"===t.fontStyle?n.FontStyle[t.fontStyle]:d.fontStyle,fontVariant:"Regular"===t.fontVariant||"AllCaps"===t.fontVariant||"SmallCaps"===t.fontVariant?n.FontVariant[t.fontVariant]:d.fontVariant,rotation:o.getOptionValue(t.rotation,d.rotation),color:o.getOptionValue(m,o.getOptionValue(d.color,n.DefaultTextStyle.DEFAULT_COLOR)),backgroundColor:o.getOptionValue(_,o.getOptionValue(d.backgroundColor,n.DefaultTextStyle.DEFAULT_BACKGROUND_COLOR)),opacity:p,backgroundOpacity:b},T=this.getTextElementStyle(t.style).renderParams;return new n.TextRenderStyle(Object.assign(Object.assign({},T),S))}createLayoutStyle(e,t){var i,o,a,s,l,c;const u=e.mapView,d=Math.floor(e.mapView.zoomLevel),h=new r.MapEnv({$zoom:d},u.env),p=this.m_defaultStyle.layoutParams,f=r.getPropertyValue(t.hAlignment,h),g=r.getPropertyValue(t.vAlignment,h),y=r.isPoiTechnique(t)?r.getPropertyValue(t.placements,h):null,{horizontalAlignment:v,verticalAlignment:_,placements:b}=m(f,g,y),S=r.getPropertyValue(t.wrappingMode,h),T="None"===S||"Character"===S||"Word"===S?n.WrappingMode[S]:p.wrappingMode,E={tracking:null!==(i=r.getPropertyValue(t.tracking,h))&&void 0!==i?i:p.tracking,leading:null!==(o=r.getPropertyValue(t.leading,h))&&void 0!==o?o:p.leading,maxLines:null!==(a=r.getPropertyValue(t.maxLines,h))&&void 0!==a?a:p.maxLines,lineWidth:null!==(s=r.getPropertyValue(t.lineWidth,h))&&void 0!==s?s:p.lineWidth,canvasRotation:null!==(l=r.getPropertyValue(t.canvasRotation,h))&&void 0!==l?l:p.canvasRotation,lineRotation:null!==(c=r.getPropertyValue(t.lineRotation,h))&&void 0!==c?c:p.lineRotation,wrappingMode:T,horizontalAlignment:v,verticalAlignment:_,placements:b},C=this.getTextElementStyle(t.style);return new n.TextLayoutStyle(Object.assign(Object.assign({},C),E))}updateDefaultTextStyle(e,t){var i,r;this.m_defaultStyle.fontCatalog=void 0;const n=null!==(r=null!==(i=null==t?void 0:t.find((e=>e.name===h)))&&void 0!==i?i:e)&&void 0!==r?r:null==t?void 0:t[0];n&&(this.m_defaultStyle=this.createTextElementStyle(n,h)),this.m_defaultStyle.textCanvas=void 0}initializeTextCanvas(e,t){var i;if(!e.textCanvas){if(void 0!==e.fontCatalog){const i=t.get(e.fontCatalog);if(e.textCanvas=i,t.has(e.fontCatalog)&&!i)return void c.info(`fontCatalog(${e.fontCatalog}), not yet loaded`)}if(void 0===e.textCanvas){void 0!==e.fontCatalog&&e.fontCatalog!==l.DEFAULT_FONT_CATALOG_NAME&&c.warn(`FontCatalog '${e.fontCatalog}' set in TextStyle\n                     '${e.name}' not found`);let r=t.get(l.DEFAULT_FONT_CATALOG_NAME);if(!r&&t.size>0)for(const[,e]of t)if(e){r=e;break}r&&(e.textCanvas=r,void 0!==e.fontCatalog&&c.info(`fontCatalog: '${e.fontCatalog}' not found,\n                      using default fontCatalog(${null===(i=e.textCanvas)||void 0===i?void 0:i.name}).`))}}}createTextElementStyle(e,t){var i;const{horizontalAlignment:r,verticalAlignment:s,placements:l}=m(e.hAlignment,e.vAlignment,e.placements);return{name:t,fontCatalog:o.getOptionValue(e.fontCatalogName,this.m_defaultStyle.fontCatalog),renderParams:{fontName:e.fontName,fontSize:{unit:n.FontUnit.Pixel,size:32,backgroundSize:null!==(i=e.backgroundSize)&&void 0!==i?i:8},fontStyle:"Regular"===e.fontStyle||"Bold"===e.fontStyle||"Italic"===e.fontStyle||"BoldItalic"===e.fontStyle?n.FontStyle[e.fontStyle]:void 0,fontVariant:"Regular"===e.fontVariant||"AllCaps"===e.fontVariant||"SmallCaps"===e.fontVariant?n.FontVariant[e.fontVariant]:void 0,rotation:e.rotation,color:void 0!==e.color?a.ColorCache.instance.getColor(e.color):void 0,backgroundColor:void 0!==e.backgroundColor?a.ColorCache.instance.getColor(e.backgroundColor):void 0,opacity:e.opacity,backgroundOpacity:e.backgroundOpacity},layoutParams:{tracking:e.tracking,leading:e.leading,maxLines:e.maxLines,lineWidth:e.lineWidth,canvasRotation:e.canvasRotation,lineRotation:e.lineRotation,wrappingMode:"None"===e.wrappingMode||"Character"===e.wrappingMode||"Word"===e.wrappingMode?n.WrappingMode[e.wrappingMode]:n.WrappingMode.Word,verticalAlignment:s,horizontalAlignment:r,placements:l}}}}},31049:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileTextStyleCache=void 0,t.TileTextStyleCache=class{constructor(e){this.textRenderStyles=[],this.textLayoutStyles=[],this.tile=e}clear(){this.textRenderStyles.length=0,this.textLayoutStyles.length=0}getRenderStyle(e){let t=this.textRenderStyles[e._index];return void 0===t&&(t=this.textRenderStyles[e._index]=this.tile.mapView.textElementsRenderer.styleCache.createRenderStyle(this.tile,e)),t}getLayoutStyle(e){let t=this.textLayoutStyles[e._index];return void 0===t&&(t=this.textLayoutStyles[e._index]=this.tile.mapView.textElementsRenderer.styleCache.createLayoutStyle(this.tile,e)),t}}},13399:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateStats=void 0;const r=i(59552);t.UpdateStats=class{constructor(e){this.m_logger=e,this.tiles=0,this.totalGroups=0,this.newGroups=0,this.totalLabels=0,this.results=new Array(r.PrePlacementResult.Count),this.results.fill(0)}clear(){this.tiles=0,this.totalGroups=0,this.newGroups=0,this.totalLabels=0,this.results.fill(0)}log(){this.m_logger.debug("Tiles",this.tiles),this.m_logger.debug("Total groups",this.totalGroups),this.m_logger.debug("New groups",this.newGroups),this.m_logger.debug("Total labels",this.totalLabels),this.m_logger.debug("Placed labels",this.results[r.PrePlacementResult.Ok]),this.m_logger.debug("Invisible",this.results[r.PrePlacementResult.Invisible]),this.m_logger.debug("Poi not ready",this.results[r.PrePlacementResult.NotReady]),this.m_logger.debug("Too far",this.results[r.PrePlacementResult.TooFar]),this.m_logger.debug("Duplicate",this.results[r.PrePlacementResult.Duplicate])}}},45971:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerBootstrapResponse=t.isWorkerBootstrapRequest=void 0,t.isWorkerBootstrapRequest=function(e){return e&&"worker-bootstrap-request"===e.type&&Array.isArray(e.dependencies)},t.isWorkerBootstrapResponse=function(e){return e&&"worker-bootstrap-response"===e.type&&Array.isArray(e.resolvedDependencies)}},75249:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerLoader=void 0,i(76254);const r=i(38338),n=i(45971),o=r.LoggerManager.instance.create("WorkerLoader");class a{static startWorker(e,t=1e4){return e.startsWith("blob:")?this.startWorkerImmediately(e,t):this.directlyFallbackToBlobBasedLoading?this.startWorkerBlob(e,t):this.startWorkerImmediately(e,t).catch((i=>{if("undefined"!=typeof window){const n=window.location.href,s=new URL(e,n).href;if(r.getUrlOrigin(s)===r.getUrlOrigin(n))throw i;return o.log("#startWorker: cross-origin worker construction failed, trying load with blob"),this.directlyFallbackToBlobBasedLoading=!0,a.startWorkerBlob(e,t)}throw i}))}static startWorkerImmediately(e,t){try{const i=new Worker(e);return this.waitWorkerInitialized(i,t)}catch(e){return Promise.reject(e)}}static startWorkerBlob(e,t){return this.fetchScriptSourceToBlobUrl(e).then((e=>this.startWorkerImmediately(e,t)))}static fetchScriptSourceToBlobUrl(e){let t=this.sourceLoaderCache.get(e);return void 0!==t||(t=fetch(e).then((e=>e.text())).catch((e=>{throw new Error(`WorkerLoader#fetchScriptSourceToBlob: failed to load worker script: ${e}`)})).then((t=>{this.sourceLoaderCache.delete(e);const i=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(i)})),this.sourceLoaderCache.set(e,t)),t}static waitWorkerInitialized(e,t){return new Promise(((i,r)=>{const o=t=>{const o=t.data;if(n.isWorkerBootstrapRequest(o)){const t=o.dependencies,i=[];for(const e of t){const t=this.dependencyUrlMapping[e];if(!t)return s(),void r(new Error(`#waitWorkerInitialized: Unable to resolve '${e}' as needed by worker script.`));i.push(t)}const n={type:"worker-bootstrap-response",resolvedDependencies:i};e.postMessage(n)}else s(),i(e),setTimeout((()=>{e.dispatchEvent(t)}),0)},a=e=>{s();let t="Error during worker initialization";e.message&&(t+=`: ${e.message}`),"string"==typeof e.filename&&"number"==typeof e.lineno&&(t+=` in ${e.filename}:${e.lineno}`),r(new Error(t))},s=()=>{clearTimeout(l),e.removeEventListener("message",o),e.removeEventListener("error",a)};e.addEventListener("error",a),e.addEventListener("message",o);const l=setTimeout((()=>{s(),r(new Error("Timeout exceeded when waiting for first message from worker."))}),t)}))}}t.WorkerLoader=a,a.directlyFallbackToBlobBasedLoading=!1,a.sourceLoaderCache=new Map,a.dependencyUrlMapping={}},30462:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(63181),t),n(i(19740),t),n(i(35457),t),n(i(40169),t),n(i(22343),t),n(i(679),t),n(i(63806),t),n(i(60739),t),n(i(92287),t),n(i(59748),t),n(i(41676),t),n(i(68405),t),n(i(87655),t),n(i(25190),t),n(i(18368),t),n(i(12071),t),n(i(79995),t),n(i(23167),t)},63181:function(e,t,i){"use strict";var r=this&&this.__rest||function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]])}return i};Object.defineProperty(t,"__esModule",{value:!0}),t.CirclePointsMaterial=void 0;const n=i(84428),o=i(87655),a=i(79995);class s extends o.RawShaderMaterial{constructor(e){const t=new n.Color;let i,o,l,c;if(e){const{size:a,color:u,opacity:d}=e,h=r(e,["size","color","opacity"]);i=a,o=u,l=d,h.name="CirclePointsMaterial",h.vertexShader="\nuniform float size;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nattribute vec3 position;\n\nvoid main() {\n    vec3 transformed = vec3(position);\n    vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n    gl_Position = projectionMatrix * mvPosition;\n    gl_PointSize = size;\n}\n",h.fragmentShader="\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuseColor;\nuniform float opacity;\n\nvoid main() {\n    float alpha = opacity;\n\n    float radius = 0.5;\n    vec2 coords = gl_PointCoord.xy - vec2(0.5);\n    float len = length(coords);\n    float falloff = fwidth(len);\n    float threshold = 1.0 - smoothstep(radius - falloff, radius, len);\n    alpha *= threshold;\n\n    gl_FragColor = vec4(diffuseColor, alpha);\n}",h.uniforms=n.UniformsUtils.merge([{size:new n.Uniform(s.DEFAULT_CIRCLE_SIZE),diffuseColor:new n.Uniform(t),opacity:new n.Uniform(1)},n.UniformsLib.fog]),h.depthTest=!1,h.extensions=Object.assign(Object.assign({},h.extensions),{derivatives:!0}),c=h}super(c),a.enforceBlending(this),this.type="CirclePointsMaterial",this.setOpacity(1),void 0!==i&&(this.size=i),void 0!==o&&(this.color=o),void 0!==l&&this.setOpacity(l)}get size(){return this.uniforms.size.value}set size(e){this.uniforms.size.value=e}get color(){return this.uniforms.diffuseColor.value}set color(e){this.uniforms.diffuseColor.value.copy(e)}}t.CirclePointsMaterial=s,s.DEFAULT_CIRCLE_SIZE=1},19740:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyMaterial=t.CopyShader=void 0;const r=i(84428);t.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform float opacity;\n    uniform sampler2D tDiffuse;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        gl_FragColor = opacity * texel;\n    }"};class n extends r.ShaderMaterial{constructor(e){super({name:"CopyMaterial",uniforms:e,vertexShader:t.CopyShader.vertexShader,fragmentShader:t.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!1,blending:r.NoBlending,depthTest:!1,depthWrite:!1})}}t.CopyMaterial=n},35457:(e,t)=>{"use strict";function i(e){return"displacementMap"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.setDisplacementMapToMaterial=t.hasDisplacementFeature=void 0,t.hasDisplacementFeature=i,t.setDisplacementMapToMaterial=function(e,t){i(t)&&t.displacementMap!==e&&(t.displacementMap=e,t.needsUpdate=!0,null!==t.displacementMap&&(t.displacementMap.needsUpdate=!0))}},40169:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EdgeMaterial=void 0;const r=i(84428),n=i(41676),o=i(59748),a=i(87655),s=i(79995);class l extends a.RawShaderMaterial{constructor(e){var t;let i;if(e){const a={},c=void 0!==e.extrusionRatio&&e.extrusionRatio>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN&&e.extrusionRatio<o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX;e.displacementMap&&s.setShaderDefine(a,"USE_DISPLACEMENTMAP",!0),c&&s.setShaderDefine(a,"USE_EXTRUSION",!0),!0===e.vertexColors&&s.setShaderDefine(a,"USE_COLOR",!0),i={name:"EdgeMaterial",vertexShader:"\n#define EDGE_DEPTH_OFFSET 0.0001\n\n#ifdef USE_COLOR\nattribute vec4 color;\n#else\nuniform vec3 color;\n#endif\n\n// SHADER_NAME may be defined by THREE.JS own shaders in which case these attributes & uniforms are\n// already defined\n#ifndef SHADER_NAME\nattribute vec3 position;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n#endif\n\nuniform vec3 edgeColor;\nuniform float edgeColorMix;\n\n#ifdef USE_DISPLACEMENTMAP\nattribute vec3 normal;\nattribute vec2 uv;\nuniform sampler2D displacementMap;\n#endif\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_vertex>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\nvoid main() {\n\n    vColor = mix(edgeColor.rgb, color.rgb, edgeColorMix);\n\n    vec3 transformed = vec3( position );\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_vertex>\n    #endif\n\n    #ifdef USE_DISPLACEMENTMAP\n    transformed += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n\n    vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n    gl_Position = projectionMatrix * mvPosition;\n    // After projection gl_Position contains clip space coordinates of each vertex\n    // before perspective division (1 / w), thus only vertexes with -w < z < w should\n    // be displayed and offset. We offset only those edges which z coordinate in NDC\n    // space is between: -inf < z < 1\n    float depthOffset = step(-1.0, -gl_Position.z / gl_Position.w) * EDGE_DEPTH_OFFSET;\n    gl_Position.z -= depthOffset;\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nvarying vec3 vColor;\n\n#ifdef USE_EXTRUSION\n#include <extrusion_pars_fragment>\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\nvoid main() {\n    float alphaValue = 1.0;\n    gl_FragColor = vec4(vColor, alphaValue);\n\n    #ifdef USE_EXTRUSION\n    #include <extrusion_fragment>\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n}",uniforms:{color:new r.Uniform(new r.Color(l.DEFAULT_COLOR)),edgeColor:new r.Uniform(new r.Color(l.DEFAULT_COLOR)),edgeColorMix:new r.Uniform(l.DEFAULT_COLOR_MIX),fadeNear:new r.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new r.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),extrusionRatio:new r.Uniform(o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX),displacementMap:new r.Uniform(null!==(t=e.displacementMap)&&void 0!==t?t:new r.Texture)},depthWrite:!1,defines:a,rendererCapabilities:e.rendererCapabilities}}super(i),s.enforceBlending(this),n.FadingFeature.patchGlobalShaderChunks(),n.ExtrusionFeature.patchGlobalShaderChunks(),void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.colorMix&&(this.colorMix=e.colorMix),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap),void 0!==e.extrusionRatio&&(this.extrusionRatio=e.extrusionRatio))}get objectColor(){return this.uniforms.color.value}set objectColor(e){this.uniforms.color.value.copy(e)}get color(){return this.uniforms.edgeColor.value}set color(e){this.uniforms.edgeColor.value.copy(e)}get lineWidth(){return this.linewidth}set lineWidth(e){this.linewidth=e,this.linewidth<=0?this.visible=!1:this.visible=!0}get colorMix(){return this.uniforms.edgeColorMix.value}set colorMix(e){this.uniforms.edgeColorMix.value!==e&&(this.uniforms.edgeColorMix.value=e)}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){this.uniforms.fadeFar.value!==e&&(this.uniforms.fadeFar.value=e,s.setShaderMaterialDefine(this,"USE_FADING",e>0))}get extrusionRatio(){return this.uniforms.extrusionRatio.value}set extrusionRatio(e){if(this.uniforms.extrusionRatio.value===e)return;this.uniforms.extrusionRatio.value=e;const t=e>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN;s.setShaderMaterialDefine(this,"USE_EXTRUSION",t)}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){if(this.uniforms.displacementMap.value===e)return;this.uniforms.displacementMap.value=e;const t=null!==e;t&&(this.uniforms.displacementMap.value.needsUpdate=!0),s.setShaderMaterialDefine(this,"USE_DISPLACEMENTMAP",t)}}t.EdgeMaterial=l,l.DEFAULT_COLOR=0,l.DEFAULT_COLOR_MIX=0},22343:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroundAtmosphereMaterial=t.GroundAtmosphereShader=void 0;const r=i(84428),n=i(87655),o=i(1709),a=i(79995);t.GroundAtmosphereShader={uniforms:{u_eyePositionWorld:new r.Uniform(new r.Vector3),u_lightDirectionWorld:new r.Uniform(new r.Vector3(0,1,0)),u_modelViewProjection:new r.Uniform(new r.Matrix4),u_atmosphereEnv:new r.Uniform(new r.Vector3(6384515.136999999,6537590.425,0)),u_hsvCorrection:new r.Uniform(new r.Vector3(0,0,0)),topColor:new r.Uniform(new r.Color(30719)),bottomColor:new r.Uniform(new r.Color(16777215)),offset:new r.Uniform(33),exponent:new r.Uniform(.6),fogColor:new r.Uniform(new r.Color(30719)),fogNear:new r.Uniform(new r.Color(30719)),fogFar:new r.Uniform(new r.Color(16777215))},vertexShader:`\n\n    #define IMPROVE_INTERSECT_PRECISION 1\n    #define IMPROVE_DOT_PRECISION 1\n\n    precision highp float;\n    precision highp int;\n\n    attribute vec4 position;\n\n    // Base mandatory uniforms\n    uniform mat4 u_modelViewProjection;\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_hsvCorrection;\n\n    const float Pi = 3.141592653589793;\n    const float Kr = 0.0025;\n    const float Km = 0.0015;\n    const float Kr4PI = Kr * 4.0 * Pi;\n    const float Km4PI = Km * 4.0 * Pi;\n    const float ESun = 25.0; // should be 15.0\n    const float KmESun = Km * ESun;\n    const float KrESun = Kr * ESun;\n    const vec3 InvWavelength = vec3(\n        1.0 / pow(0.650, 4.0), // Red\n        1.0 / pow(0.570, 4.0), // Green\n        1.0 / pow(0.475, 4.0)); // Blue\n\n    const int nSamples = 2;\n    const float fSamples = 2.0;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n    varying vec3 v_vertToOrigin;\n\n    ${o.default.atmosphere_vertex_utils}\n\n    //\n    // Computes rayleight and mia atmosphere factors for ground.\n    //\n    // Code based on GPU Gems article.\n    //\n    // Author: Sean O'Neil\n    //\n    // Copyright (c) 2004 Sean O'Neil\n    //\n    // https://developer.nvidia.com/gpugems/gpugems2/part-ii-shading-lighting-and-shadows/chapter-16-accurate-atmospheric-scattering\n    //\n    // Further modifications by HERE.\n    //\n    AtmosphereColor computeGroundAtmosphere(vec3 v3Pos, vec3 vLightDir)\n    {\n        // Retrieve environment variables\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        // All that may be moved to const or define(s) at further optimizations:\n        float fScale = 1.0 / (fOuterRadius - fInnerRadius);\n        float fScaleOverScaleDepth = fScale / RayleighScaleDepth;\n        float fCameraHeight2 = fCameraHeight * fCameraHeight;\n        float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\n        // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n        vec3 v3Ray = v3Pos - u_eyePositionWorld;\n        float fFar = length(v3Ray);\n        v3Ray /= fFar;\n\n#if !defined(IMPROVE_DOT_PRECISION)\n        vec3 v3Dir = normalize(v3Pos);\n#endif\n\n#ifdef CAMERA_IN_SPACE\n\n        // Calculate first point of camera ray and sphere intersection.\n        float fNear = getNearSphereIntersect(u_eyePositionWorld, v3Ray, fCameraHeight2, fOuterRadius2);\n        // Make far relative to first atmosphere intersection, setting it to\n        // the length of ray passed through atmosphere\n        fFar -= fNear;\n\n        // Compute the ray's starting position within the atmosphere, then\n        // calculate its scattering offset\n        vec3 v3Start = u_eyePositionWorld + v3Ray * fNear;\n        float fDepth = exp((fInnerRadius - fOuterRadius) / RayleighScaleDepth);\n\n#else // CAMERA_IN_ATMOSPHERE\n\n        // The ray starts already in atmosphere\n        vec3 v3Start = u_eyePositionWorld;\n        // Virtually fNear is just at eye position, so ray passing through atmosphere does not shorten\n        // fFar -= 0.0;\n        float fDepth = exp((fInnerRadius - fCameraHeight) / RayleighScaleDepth);\n#endif\n\n#if defined(IMPROVE_DOT_PRECISION)\n        float fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\n#else\n        float fCameraAngle = dot(-v3Ray, v3Dir);\n#endif\n        float fCameraScale = scale(fCameraAngle);\n\n#ifdef DYNAMIC_LIGHT\n        // When we want the atmosphere to be uniform over the globe so it is set to 1.0.\n        #if defined(IMPROVE_DOT_PRECISION)\n            // The light angle for given light source may be calculated as:\n            // angle = dot(vLightDir, v3Dir) / length(v3Dir);\n            // where v3Dir holds normalized vertex position, but for precision issues we v3Pos (un-normalized)\n            float fLightAngle = dot(vLightDir, v3Pos) / length(v3Pos);\n        #else\n            float fLightAngle = dot(vLightDir, v3Dir);\n        #endif\n#else\n        float fLightAngle = 1.0;\n#endif\n        float fLightScale = scale(fLightAngle);\n\n        float fCameraOffset = fDepth * fCameraScale;\n        float fTemp = (fLightScale + fCameraScale);\n\n        // Initialize the scattering loop variables\n        float fSampleLength = fFar / fSamples;\n        float fScaledLength = fSampleLength * fScale;\n        vec3 v3SampleRay = v3Ray * fSampleLength;\n        vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n        // Now loop through the sample rays\n        vec3 v3BaseColor = vec3(0.0);\n        vec3 v3Attenuate = vec3(0.0);\n        for(int i = 0; i < nSamples; i++)\n        {\n            float fHeight = length(v3SamplePoint);\n            float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\n            float fScatter = fDepth * fTemp - fCameraOffset;\n            // Compute color factors\n            v3Attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n            v3BaseColor += v3Attenuate * (fDepth * fScaledLength);\n            // Move to the next point\n            v3SamplePoint += v3SampleRay;\n        }\n\n        AtmosphereColor color;\n        color.mie = v3BaseColor * (InvWavelength * KrESun + KmESun);\n        // Calculate the attenuation factor for the ground\n        color.rayleigh = v3Attenuate;\n\n        return color;\n    }\n\n    void main(void)\n    {\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        AtmosphereColor atmColor = computeGroundAtmosphere(position.xyz, vLightDir);\n        v_mieColor = atmColor.mie;\n        v_rayleighColor = atmColor.rayleigh;\n        v_vertToCamera = u_eyePositionWorld - position.xyz;\n        v_vertToOrigin = normalize(position.xyz);\n\n        gl_Position = u_modelViewProjection * position;\n    }\n    `,fragmentShader:`\n\n    // Exposure correction gives more subtle gradients on the ground.\n    #define CORRECT_EXPOSURE 1\n    #define FADE_DEPTH 1\n    #define NIGHT_LOCAL 1\n\n    precision highp float;\n    precision highp int;\n\n    #ifdef CORRECT_COLOR\n    uniform vec3 u_hsvCorrection; // Hue, saturation, brightness\n    #endif\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    const float g = -0.95;\n    const float g2 = g * g;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n    varying vec3 v_vertToOrigin;\n\n    ${o.default.atmosphere_fragment_utils}\n\n    void main(void)\n    {\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        // GPU gems mix of ground solution, with custom alpha settings\n        vec3 cRgb = v_mieColor + 0.25 * v_rayleighColor;\n\n        // Not needed for HDR frame buffer\n    #if !defined(HDR_FRAME_BUFFER) && defined(CORRECT_EXPOSURE)\n        // Interesting results with exposure factor: 2.0, 3.5, 4.0\n        cRgb = correctExposure(cRgb, 3.0);\n    #endif\n\n    #ifdef CORRECT_COLOR\n        cRgb = correctColor(cRgb, u_hsvCorrection);\n    #endif\n\n        // Base atmosphere opacity\n        float fAtmosphereAlpha = 1.0;\n\n        // Factor based on the distance of camera atmosphere and ground, results are:\n        // 0.0 = camera on the ground surface,\n        // 1.0 = at the outer edge of the atmosphere.\n        float fDepthFactor = clamp((fCameraHeight - fInnerRadius) /\n            (fOuterRadius - fInnerRadius), 0.0, 1.0);\n    #ifdef FADE_DEPTH\n        // Fade alpha based on the distance of camera between atmosphere layers\n        #ifdef FADE_DEPTH_LINEAR\n            fAtmosphereAlpha *= fDepthFactor;\n        #else\n            fAtmosphereAlpha *= pow(fDepthFactor, 1.5);\n        #endif\n    #endif\n\n#if defined(FADE_NIGHT) || defined(DARKEN_NIGHT)\n    #ifdef DYNAMIC_LIGHT\n        // Adjust factor based on time of day, results are:\n        // 0.0 = night,\n        // 1.0 = day.\n        #ifdef NIGHT_GLOBAL\n            // Global night fade based on camera and light orientation\n            float fNightFactor = clamp(dot(normalize(u_eyePositionWorld), vLightDir), 0.0, 1.0);\n            fNightFactor = pow(fNightFactor, 0.5);\n        #else // NIGHT_LOCAL\n            float fNightFactor =\n                clamp(dot(v_vertToOrigin, vLightDir) / length(v_vertToOrigin), 0.0, 1.0);\n            fNightFactor = pow(fNightFactor, 0.8);\n        #endif\n    #else\n        float fNightFactor = 1.0;\n    #endif\n#endif\n\n    #ifdef FADE_NIGHT\n        // Adjust alpha for night side of the globe\n        fAtmosphereAlpha *= fNightFactor;\n    #endif\n\n    #ifdef DARKEN_NIGHT\n        // Change the brightness depending on night / day side.\n        // NOTE: Darkening should be rather applied in HSV space, without loss on saturation,\n        // but it is much more GPU consuming.\n        const float minBrightness = 0.5;\n        float fDarkenFactor = clamp(fNightFactor, minBrightness, 1.0);\n        cRgb *= fDarkenFactor;\n    #endif\n\n    #ifdef EXPOSURE_DEPTH\n        // Control exposure depending from ground distance\n        float exposureBoost = 3.0 - fDepthFactor;\n        cRgb = correctExposure(cRgb, exposureBoost);\n    #endif\n\n        // Experimental fading out of focus point - similar to fresnel effect in top view.\n        // This fade is handy to better expose cartographic/map features in screen center.\n        float fFocusFactor = 1.0 - clamp(dot(normalize(v_vertToCamera), v_vertToOrigin), 0.0, 1.0) + 0.1;\n        fFocusFactor = pow(fFocusFactor, 2.5);\n        fAtmosphereAlpha *= fFocusFactor;\n\n        // Integrate all features\n        gl_FragColor = vec4(cRgb, fAtmosphereAlpha);\n    }\n    `};class s extends n.RawShaderMaterial{constructor(e){let i;e&&(i={name:"GroundAtmosphereMaterial",vertexShader:t.GroundAtmosphereShader.vertexShader,fragmentShader:t.GroundAtmosphereShader.fragmentShader,uniforms:t.GroundAtmosphereShader.uniforms,transparent:!0,depthTest:!1,depthWrite:!1,side:r.FrontSide,blending:r.NormalBlending,fog:!1,rendererCapabilities:e.rendererCapabilities}),super(i)}setDynamicLighting(e){a.setShaderMaterialDefine(this,"DYNAMIC_LIGHT",e)}set outerRadius(e){this.uniforms.u_atmosphereEnv.value.y=e}get outerRadius(){return this.uniforms.u_atmosphereEnv.value.y}set innerRadius(e){this.uniforms.u_atmosphereEnv.value.x=e}get innerRadius(){return this.uniforms.u_atmosphereEnv.value.x}updateUniforms(e,t,i,r){const n=this.getCameraInfo(t,i);if(void 0===e||!e.isMaterial)throw Error("Wrong object used, only Material objects are supported");if(!(e.uniforms&&e.uniforms.u_atmosphereEnv&&e.uniforms.u_hsvCorrection&&e.uniforms.u_eyePositionWorld&&e.uniforms.u_modelViewProjection&&e.uniforms.u_lightDirectionWorld))throw Error("Atmosphere material has missing uniforms");{const t=n.eyePos,i=n.modelViewProjection,o=n.eyeHeight;e.uniforms.u_eyePositionWorld.value.copy(t),e.uniforms.u_modelViewProjection.value.copy(i),e.uniforms.u_atmosphereEnv.value.z=o,e.uniforms.u_lightDirectionWorld.value=r.clone();const s=o>this.outerRadius,l=a.setShaderDefine(e.defines,"CAMERA_IN_SPACE",s),c=a.setShaderDefine(e.defines,"CAMERA_IN_ATMOSPHERE",!s);e.needsUpdate=e.needsUpdate||l||c}}getCameraInfo(e,t,i=!1){if(i){const i=(new r.Matrix4).identity(),n=(new r.Matrix4).copy(e.matrixWorld).invert().transpose(),o=t.projectionMatrix,a=new r.Matrix4;a.multiplyMatrices(n,i),a.multiplyMatrices(o,a);const s=new r.Vector3;e.getWorldPosition(s);const l=new r.Vector3;return t.getWorldPosition(l),{modelViewProjection:a,eyePos:s,eyeHeight:l.distanceTo(s)}}{const i=e.matrixWorld,n=t.matrixWorldInverse,o=t.projectionMatrix,a=new r.Matrix4;a.multiplyMatrices(n,i),a.multiplyMatrices(o,a);const s=new r.Vector3;t.getWorldPosition(s);const l=new r.Vector3;e.getWorldPosition(l);const c=l.distanceTo(s);return s.sub(l),{modelViewProjection:a,eyePos:s,eyeHeight:c}}}}t.GroundAtmosphereMaterial=s},679:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHighPrecisionLineMaterial=t.HighPrecisionLineMaterial=void 0;const r=i(84428),n=i(87655),o=i(32789);class a extends n.RawShaderMaterial{constructor(e){Object.assign(r.ShaderChunk,o.default);const t=e?{name:"HighPrecisionLineMaterial",vertexShader:"\n#ifdef USE_COLOR\nattribute vec4 color;\nvarying vec3 vColor;\n#endif\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 position;        // high part\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuseColor;\nuniform float opacity;\n\n#ifdef USE_COLOR\nvarying vec3 color;\n#endif\n\nvoid main() {\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( diffuseColor * vColor, opacity );\n    #else\n    gl_FragColor = vec4( diffuseColor, opacity );\n    #endif\n}",uniforms:{diffuseColor:new r.Uniform(new r.Color(a.DEFAULT_COLOR)),opacity:new r.Uniform(a.DEFAULT_OPACITY),u_mvp:new r.Uniform(new r.Matrix4),u_eyepos:new r.Uniform(new r.Vector3),u_eyepos_lowpart:new r.Uniform(new r.Vector3)},rendererCapabilities:e.rendererCapabilities}:void 0;Object.assign(t,e),super(t),this.type="HighPrecisionLineMaterial",this.isHighPrecisionLineMaterial=!0,e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity)),this.updateTransparencyFeature()}get color(){return this.uniforms.diffuseColor.value}set color(e){this.uniforms.diffuseColor.value.copy(e)}updateTransparencyFeature(){this.transparent=this.opacity<1}}t.HighPrecisionLineMaterial=a,a.DEFAULT_COLOR=80,a.DEFAULT_OPACITY=1,t.isHighPrecisionLineMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionLineMaterial}},63806:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHighPrecisionPointMaterial=t.HighPrecisionPointMaterial=void 0;const r=i(84428),n=i(32789);class o extends r.PointsMaterial{constructor(e){Object.assign(r.ShaderChunk,n.default),super(e),this.type="HighPrecisionPointMaterial",this.vertexShader="\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\nuniform float size;\n\n// uniforms to implement double-precision\nuniform mat4 u_mvp;             // combined modelView and projection matrix\nuniform vec3 u_eyepos;          // eye position major\nuniform vec3 u_eyepos_lowpart;  // eye position minor ((double) eyepos - (float) eyepos)\n\n// vertex attributes\nattribute vec3 positionLow;     // low part\n\n#include <high_precision_vert_func>\n\nvoid main() {\n    #ifdef USE_COLOR\n    vColor = color.rgb;\n    #endif\n\n    vec3 pos = subtractDblEyePos(position);\n    gl_Position = u_mvp * vec4(pos, 1.0);\n\n    // ignore sizeAttenuation for now!\n    gl_PointSize = size;\n}",this.fragmentShader=r.ShaderChunk.points_frag,this.fog=!1,this.uniforms={diffuseColor:new r.Uniform(new r.Color(o.DEFAULT_COLOR)),opacity:new r.Uniform(o.DEFAULT_OPACITY),size:new r.Uniform(o.DEFAULT_SIZE),scale:new r.Uniform(o.DEFAULT_SCALE),map:new r.Uniform(new r.Texture),uvTransform:new r.Uniform(new r.Matrix3),u_mvp:new r.Uniform(new r.Matrix4),u_eyepos:new r.Uniform(new r.Vector3),u_eyepos_lowpart:new r.Uniform(new r.Vector3)},this.isHighPrecisionPointMaterial=!0,void 0!==e&&(void 0!==e.color&&this.color.set(e.color),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.size&&(this.size=e.size),void 0!==e.scale&&(this.scale=e.scale),void 0!==e.uvTransform&&(this.uvTransform=e.uvTransform),void 0!==e.map&&(this.map=e.map))}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}get uvTransform(){return this.uniforms.uvTransform.value}set uvTransform(e){this.uniforms.uvTransform.value=e}}t.HighPrecisionPointMaterial=o,o.DEFAULT_COLOR=80,o.DEFAULT_OPACITY=1,o.DEFAULT_SIZE=1,o.DEFAULT_SCALE=1,t.isHighPrecisionPointMaterial=function(e){return void 0!==e&&!0===e.isHighPrecisionPointMaterial}},60739:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconMaterial=void 0;const r=i(84428),n=i(87655);class o extends n.RawShaderMaterial{constructor(e){super(e?{name:"IconMaterial",vertexShader:"\nattribute vec4 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n}",fragmentShader:"\nprecision highp float;\nprecision highp int;\n\nuniform sampler2D map;\n\nvarying vec4 vColor;\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 color = texture2D(map, vUv.xy);\n    color *= vColor;\n    if (color.a < 0.05) {\n        discard;\n    }\n    gl_FragColor = color;\n}",uniforms:{map:new r.Uniform(e.map)},depthTest:!1,depthWrite:!1,transparent:!0,vertexColors:!0,premultipliedAlpha:!0,rendererCapabilities:e.rendererCapabilities}:void 0)}get map(){return this.uniforms.map.value}}t.IconMaterial=o},92287:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LuminosityHighPassShader=void 0;const r=i(84428);t.LuminosityHighPassShader={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new r.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform vec3 defaultColor;\n    uniform float defaultOpacity;\n    uniform float luminosityThreshold;\n    uniform float smoothWidth;\n    varying vec2 vUv;\n    void main() {\n        vec4 texel = texture2D( tDiffuse, vUv );\n        vec3 luma = vec3( 0.299, 0.587, 0.114 );\n        float v = dot( texel.xyz, luma );\n        vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n        float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n        gl_FragColor = mix( outputColor, texel, alpha );\n    }"}},68405:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSAAMaterial=void 0;const r=i(84428),n=i(19740);class o extends r.ShaderMaterial{constructor(e){super({uniforms:e,vertexShader:n.CopyShader.vertexShader,fragmentShader:n.CopyShader.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:r.AdditiveBlending,depthTest:!1,depthWrite:!1})}}t.MSAAMaterial=o},41676:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapMeshStandardMaterial=t.MapMeshDepthMaterial=t.MapMeshBasicMaterial=t.ExtrusionFeatureMixin=t.ExtrusionFeature=t.FadingFeatureMixin=t.FadingFeature=t.DisplacementFeatureMixin=t.hasExtrusionFeature=void 0;const r=i(38338),n=i(84428),o=i(59748),a=i(42983),s=i(54589),l=i(59117),c=i(79995),u=new n.Texture;function d(e,t){return e*t.maximum}function h(e,t){void 0===t.defines&&(t.defines={}),e.shaderDefines=t.defines,void 0===e.shaderUniforms&&(e.shaderUniforms={})}function m(e,t){Object.assign(t.uniforms,e.shaderUniforms),e.shaderUniforms=t.uniforms}var p,f,g;t.hasExtrusionFeature=function(e){return"extrusionRatio"in e},function(e){function t(e){return null!==e.displacementMap}e.isEnabled=t,e.updateDisplacementFeature=function(e){r.assert(void 0!==e.shaderDefines),r.assert(void 0!==e.shaderUniforms);const i=t(e),n=c.setShaderDefine(e.shaderDefines,"USE_DISPLACEMENTMAP",i);if(e.needsUpdate=n,i){const t=e.displacementMap;t.needsUpdate=!0,e.shaderUniforms.displacementMap.value=t}else n&&(e.shaderUniforms.displacementMap.value=u)},e.onBeforeCompile=function(e,i){t(e)&&(r.assert(void 0!==e.shaderUniforms),m(e,i),i.vertexShader=i.vertexShader.replace("#include <skinbase_vertex>","#include <skinbase_vertex>\n#ifndef USE_ENVMAP\n    vec3 objectNormal = vec3( normal );\n#endif"),i.vertexShader=c.insertShaderInclude(i.vertexShader,"uv2_pars_vertex","displacementmap_pars_vertex"),i.vertexShader=c.insertShaderInclude(i.vertexShader,"skinning_vertex","displacementmap_vertex",!0))}}(p||(p={}));class y{constructor(){this.m_displacementMap=null}get displacementMap(){return this.m_displacementMap}set displacementMap(e){this.setDisplacementMap(e)}getDisplacementMap(){return this.m_displacementMap}setDisplacementMap(e){e!==this.m_displacementMap&&(this.m_displacementMap=e,p.updateDisplacementFeature(this))}addDisplacementProperties(){Object.defineProperty(this,"displacementMap",{get:()=>this.getDisplacementMap(),set:e=>{this.setDisplacementMap(e)}})}applyDisplacementParameters(e){h(this,this),r.assert(void 0!==this.shaderDefines),r.assert(void 0!==this.shaderUniforms);const t=this.shaderUniforms;t.displacementMap=new n.Uniform(u),t.displacementScale=new n.Uniform(1),t.displacementBias=new n.Uniform(0),void 0!==e&&void 0!==e.displacementMap&&this.setDisplacementMap(e.displacementMap),this.onBeforeCompile=r.chainCallbacks(this.onBeforeCompile,(e=>{p.onBeforeCompile(this,e)})),this.needsUpdate=p.isEnabled(this)}copyDisplacementParameters(e){return this.setDisplacementMap(e.displacementMap),this}}t.DisplacementFeatureMixin=y,function(e){function t(e){return void 0!==e.fadeNear&&void 0!==e.fadeFar&&e.fadeFar>0}e.DEFAULT_FADE_NEAR=-1,e.DEFAULT_FADE_FAR=-1,e.isEnabled=t,e.isDefined=function(e){return void 0!==e.fadeNear&&void 0!==e.fadeFar},e.patchGlobalShaderChunks=function(){void 0===n.ShaderChunk.fading_pars_vertex&&Object.assign(n.ShaderChunk,s.default)},e.updateFadingFeature=function(i){r.assert(void 0!==i.shaderDefines),r.assert(void 0!==i.shaderUniforms);const n=t(i),o=c.setShaderDefine(i.shaderDefines,"FADING_MATERIAL",n);i.needsUpdate=o,r.assert(void 0!==i.shaderUniforms.fadeNear&&void 0!==i.shaderUniforms.fadeFar),n?(i.shaderUniforms.fadeNear.value=i.fadeNear,i.shaderUniforms.fadeFar.value=i.fadeFar,o&&c.enableBlending(i)):o&&(i.shaderUniforms.fadeNear.value=e.DEFAULT_FADE_NEAR,i.shaderUniforms.fadeFar.value=e.DEFAULT_FADE_FAR,c.disableBlending(i))},e.onBeforeCompile=function(e,i){t(e)&&(r.assert(void 0!==e.shaderUniforms),m(e,i),i.vertexShader=c.insertShaderInclude(i.vertexShader,"fog_pars_vertex","fading_pars_vertex"),i.vertexShader=c.insertShaderInclude(i.vertexShader,"fog_vertex","fading_vertex",!0),i.fragmentShader=c.insertShaderInclude(i.fragmentShader,"fog_pars_fragment","fading_pars_fragment"),i.fragmentShader=c.insertShaderInclude(i.fragmentShader,"fog_fragment","fading_fragment",!0))},e.addRenderHelper=function(t,i,n,o,a,s){t.onBeforeRender=r.chainCallbacks(t.onBeforeRender,((t,r,a,l,c,u)=>{const h=c;h.fadeNear=void 0===n||n===e.DEFAULT_FADE_NEAR?e.DEFAULT_FADE_NEAR:d(n,i),h.fadeFar=void 0===o||o===e.DEFAULT_FADE_FAR?e.DEFAULT_FADE_FAR:d(o,i),void 0!==s&&s(t,c)}))}}(f=t.FadingFeature||(t.FadingFeature={}));class v{constructor(){this.m_fadeNear=f.DEFAULT_FADE_NEAR,this.m_fadeFar=f.DEFAULT_FADE_FAR}getFadeNear(){return this.m_fadeNear}setFadeNear(e){e!==this.m_fadeNear&&(this.m_fadeNear=e,f.updateFadingFeature(this))}getFadeFar(){return this.m_fadeFar}setFadeFar(e){e!==this.m_fadeFar&&(this.m_fadeFar=e,f.updateFadingFeature(this))}addFadingProperties(){Object.defineProperty(this,"fadeNear",{get:()=>this.getFadeNear(),set:e=>{this.setFadeNear(e)}}),Object.defineProperty(this,"fadeFar",{get:()=>this.getFadeFar(),set:e=>{this.setFadeFar(e)}})}applyFadingParameters(e){h(this,this),r.assert(void 0!==this.shaderDefines),r.assert(void 0!==this.shaderUniforms),this.shaderUniforms.fadeNear=new n.Uniform(f.DEFAULT_FADE_NEAR),this.shaderUniforms.fadeFar=new n.Uniform(f.DEFAULT_FADE_FAR),void 0!==e&&(void 0!==e.fadeNear&&this.setFadeNear(e.fadeNear),void 0!==e.fadeFar&&this.setFadeFar(e.fadeFar)),this.onBeforeCompile=r.chainCallbacks(this.onBeforeCompile,(e=>{f.onBeforeCompile(this,e)})),this.needsUpdate=f.isEnabled(this)}copyFadingParameters(e){return this.setFadeNear(void 0===e.fadeNear?f.DEFAULT_FADE_NEAR:e.fadeNear),this.setFadeFar(void 0===e.fadeFar?f.DEFAULT_FADE_FAR:e.fadeFar),this}}t.FadingFeatureMixin=v,function(e){function t(e){return void 0!==e.extrusionRatio&&e.extrusionRatio>=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MIN}e.isEnabled=t,e.patchGlobalShaderChunks=function(){void 0===n.ShaderChunk.extrusion_pars_vertex&&Object.assign(n.ShaderChunk,a.default)},e.updateExtrusionFeature=function(e){r.assert(void 0!==e.shaderDefines),r.assert(void 0!==e.shaderUniforms);const i=t(e),n=c.setShaderDefine(e.shaderDefines,"EXTRUSION_MATERIAL",i);e.needsUpdate=n,i?e.shaderUniforms.extrusionRatio.value=e.extrusionRatio:n&&(e.shaderUniforms.extrusionRatio.value=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX)},e.onBeforeCompile=function(e,i){t(e)&&(r.assert(void 0!==e.shaderUniforms),m(e,i),i.vertexShader=c.insertShaderInclude(i.vertexShader,"common","extrusion_pars_vertex"),i.vertexShader=c.insertShaderInclude(i.vertexShader,"begin_vertex","extrusion_vertex",!0),i.fragmentShader=c.insertShaderInclude(i.fragmentShader,"fog_pars_fragment","extrusion_pars_fragment"),i.fragmentShader=i.fragmentShader.replace("#include <normal_fragment_begin>","#include <extrusion_normal_fragment_begin>"),i.fragmentShader=c.insertShaderInclude(i.fragmentShader,"fog_fragment","extrusion_fragment",!0))}}(g=t.ExtrusionFeature||(t.ExtrusionFeature={}));class _{constructor(){this.m_extrusion=o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}getExtrusionRatio(){return this.m_extrusion}setExtrusionRatio(e){e!==this.m_extrusion&&(this.m_extrusion=e,g.updateExtrusionFeature(this))}addExtrusionProperties(){Object.defineProperty(this,"extrusionRatio",{get:()=>this.getExtrusionRatio(),set:e=>{this.setExtrusionRatio(e)}})}applyExtrusionParameters(e){h(this,this),r.assert(void 0!==this.shaderDefines),r.assert(void 0!==this.shaderUniforms),e&&!0===e.zFightingWorkaround&&(this.shaderDefines.ZFIGHTING_WORKAROUND=""),this.shaderUniforms.extrusionRatio=new n.Uniform(o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX),void 0!==e&&void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this.onBeforeCompile=r.chainCallbacks(this.onBeforeCompile,(e=>{g.onBeforeCompile(this,e)})),this.needsUpdate=g.isEnabled(this)}copyExtrusionParameters(e){return void 0!==e.extrusionRatio&&this.setExtrusionRatio(e.extrusionRatio),this}}t.ExtrusionFeatureMixin=_;class b extends n.MeshBasicMaterial{constructor(e){super(e),f.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!0})),this.addDisplacementProperties(),this.applyDisplacementParameters(e)}clone(){return(new b).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this.copyDisplacementParameters(e),this}get fadeNear(){return f.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return f.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}get displacementMap(){return null}set displacementMap(e){}setDisplacementMap(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}addDisplacementProperties(){}applyDisplacementParameters(e){}copyDisplacementParameters(e){}}t.MapMeshBasicMaterial=b;class S extends n.MeshDepthMaterial{constructor(e){super(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!1}))}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}}t.MapMeshDepthMaterial=S;class T extends n.MeshStandardMaterial{constructor(e){super(e),f.patchGlobalShaderChunks(),this.addFadingProperties(),this.applyFadingParameters(e),g.patchGlobalShaderChunks(),this.addExtrusionProperties(),this.applyExtrusionParameters(Object.assign(Object.assign({},e),{zFightingWorkaround:!0})),!0===(null==e?void 0:e.removeDiffuseLight)&&(this.onBeforeCompile=r.chainCallbacks(this.onBeforeCompile,(e=>{e.fragmentShader=n.ShaderChunk.meshphysical_frag.replace("#include <lights_physical_pars_fragment>",l.simpleLightingShadowChunk)})))}clone(){return(new T).copy(this)}copy(e){return super.copy(e),this.copyFadingParameters(e),this.copyExtrusionParameters(e),this}get fadeNear(){return f.DEFAULT_FADE_NEAR}set fadeNear(e){}get fadeFar(){return f.DEFAULT_FADE_FAR}set fadeFar(e){}get extrusionRatio(){return o.ExtrusionFeatureDefs.DEFAULT_RATIO_MAX}set extrusionRatio(e){}get removeDiffuseLight(){return!1}set removeDiffuseLight(e){}addFadingProperties(){}applyFadingParameters(e){}copyFadingParameters(e){}addExtrusionProperties(){}applyExtrusionParameters(e){}copyExtrusionParameters(e){}}t.MapMeshStandardMaterial=T,r.applyMixinsWithoutProperties(b,[v]),r.applyMixinsWithoutProperties(T,[v]),r.applyMixinsWithoutProperties(b,[_]),r.applyMixinsWithoutProperties(T,[_]),r.applyMixinsWithoutProperties(S,[_]),r.applyMixinsWithoutProperties(b,[y])},59748:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ExtrusionFeatureDefs=void 0,(i=t.ExtrusionFeatureDefs||(t.ExtrusionFeatureDefs={})).DEFAULT_RATIO_MIN=0,i.DEFAULT_RATIO_MAX=1,i.MIN_BUILDING_HEIGHT=.1},87655:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RawShaderMaterial=void 0;const r=i(38338),n=i(84428),o=i(79995);class a extends n.RawShaderMaterial{constructor(e){const t=!0===(null==e?void 0:e.rendererCapabilities.isWebGL2),i=e?Object.assign(Object.assign({},e),{glslVersion:t?n.GLSL3:n.GLSL1,vertexShader:t&&e.vertexShader?r.convertVertexShaderToWebGL2(e.vertexShader):e.vertexShader,fragmentShader:t&&e.fragmentShader?r.convertFragmentShaderToWebGL2(e.fragmentShader):e.fragmentShader}):void 0;i&&delete i.rendererCapabilities,super(i),this.invalidateFog(),this.setOpacity(null==i?void 0:i.opacity)}invalidateFog(){void 0!==this.defines&&this.fog!==o.getShaderMaterialDefine(this,"USE_FOG")&&o.setShaderMaterialDefine(this,"USE_FOG",this.fog)}setOpacity(e){var t;void 0!==e&&(this.opacity=e,(null===(t=this.uniforms)||void 0===t?void 0:t.opacity)&&(this.uniforms.opacity.value=e))}}t.RawShaderMaterial=a},25190:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SepiaShader=void 0,t.SepiaShader={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float amount;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D( tDiffuse, vUv );\n            vec3 c = color.rgb;\n            color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );\n            color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );\n            color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );\n            gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );\n        }"}},1709:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={atmosphere_vertex_utils:"\n\n    const float RayleighScaleDepth = 0.25;\n\n    struct AtmosphereColor\n    {\n        vec3 mie;\n        vec3 rayleigh;\n    };\n\n    float scale(float cosAngle)\n    {\n        float x = 1.0 - cosAngle;\n        return RayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n    }\n\n    float getNearSphereIntersect(vec3 v3Pos, vec3 v3Ray, float fCameraHeight2, float fOuterRadius2) {\n        // Solve simple square equation for the x0 (first point of intersection).\n#if defined(IMPROVE_INTERSECT_PRECISION)\n        // To improve precision instead of simple projection: b = 2.0 * dot(vPos, v3Ray),\n        // we change the equation that gives better results especially around the poles.\n        float fB = 2.0 * length(v3Pos) * dot(normalize(v3Pos), v3Ray);\n#else\n        float fB = 2.0 * dot(v3Pos, v3Ray);\n#endif\n        float fC = fCameraHeight2 - fOuterRadius2;\n        // det = b^2 - 4*a*c, where a = 1\n        float fDet = max(0.0, fB * fB - 4.0 * fC);\n        // Intersection points distances are defined as follows:\n        // x0 = (-b - sqrt(det)) / 2*a ^ x1 = (-b + sqrt(det)) / 2*a\n        // we search for x0:\n        return 0.5 * (-fB - sqrt(fDet));\n    }\n\n    float getFarSphereIntersect(vec3 v3Pos, vec3 v3Ray, float fCameraHeight2, float fOuterRadius2) {\n        // Solve simple square equation for the x1 (second point of intersection).\n#if defined(IMPROVE_INTERSECT_PRECISION)\n        float fB = 2.0 * length(v3Pos) * dot(normalize(v3Pos), v3Ray);\n#else\n        float fB = 2.0 * dot(v3Pos, v3Ray);\n#endif\n        float fC = fCameraHeight2 - fOuterRadius2;\n        // det = b^2 - 4*a*c, where a = 1\n        float fDet = max(0.0, fB * fB - 4.0 * fC);\n        // Compute second intersection distance:\n        // x1 = (-b + sqrt(det)) / 2*a\n        return 0.5 * (-fB + sqrt(fDet));\n    }\n    ",atmosphere_fragment_utils:"\n\n    // Branch free RGB to HSV conversion.\n    // Based on article:\n    // http://lolengine.net/blog/2013/01/13/fast-rgb-to-hsv\n    // and optimized OpenGL SL algorithm\n    // http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\n    vec3 rgb2Hsv(vec3 c)\n    {\n        const vec4 RGB_HSV_CONV = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        // Ternary operator may be used explicitly if compiler can use fast conditional move.\n        // vec4 p = c.g < c.b ? vec4(c.bg, RGB_HSV_CONV.wz) : vec4(c.gb, RGB_HSV_CONV.xy);\n        vec4 p = mix(vec4(c.bg, RGB_HSV_CONV.wz), vec4(c.gb, RGB_HSV_CONV.xy), step(c.b, c.g));\n        // vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n        vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n    }\n\n    // Branch free HSV to RGB conversion\n    vec3 hsv2Rgb(vec3 c)\n    {\n        const vec4 HSV_RGB_CONV = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + HSV_RGB_CONV.xyz) * 6.0 - HSV_RGB_CONV.www);\n        return c.z * mix(HSV_RGB_CONV.xxx, clamp(p - HSV_RGB_CONV.xxx, 0.0, 1.0), c.y);\n    }\n\n    vec3 correctExposure(vec3 rgb, float exposure)\n    {\n        const vec3 fullColor = vec3(1.0);\n        return fullColor - exp(-exposure * rgb);\n    }\n\n    vec3 correctColor(vec3 rgb, vec3 hsvShift)\n    {\n        const float e = 0.0000001;\n        // Convert rgb color to hsv\n        vec3 hsv = rgb2Hsv(rgb);\n        // Shift hue value with angle wrapping\n        hsv.x = mod(hsv.x + hsvShift.x, 1.0);\n        // Shift and clamp saturation\n        hsv.y = clamp(hsv.y + hsvShift.y, 0.0, 1.0);\n        // Change value if it is significant (greater then epsilon)\n        hsv.z = hsv.z > e ? clamp(hsv.z + hsvShift.z, 0.0, 1.0) : 0.0;\n        // Convert shifted hsv back to rgb\n        return hsv2Rgb(hsv);\n    }\n    "}},42983:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(59748),n=r.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT*r.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT;t.default={extrusion_pars_vertex:"\n// Add define so we can check for it in the outline effect (see Outline.ts).\n#define HAS_EXTRUSION_PARS_VERTEX\n// Extrusion axis (xyz: vector, w: factor).\nattribute vec4 extrusionAxis;\nuniform float extrusionRatio;\n#ifdef FLAT_SHADED\nvarying vec4 vExtrusionAxis;\n#endif\n#ifdef ZFIGHTING_WORKAROUND\nvarying float vExtrusionRatio;\n#endif\n",extrusion_vertex:`\n#define HAS_EXTRUSION_VERTEX\n#ifdef ZFIGHTING_WORKAROUND\n// Cancel extrusionRatio (meaning, force to 1) if extrusionAxisLen < MIN_BUILDING_HEIGHT.\nconst float MIN_BUILDING_HEIGHT_SQUARED = ${n};\nfloat extrusionAxisLenSquared = dot(extrusionAxis.xyz, extrusionAxis.xyz);\nvExtrusionRatio = (extrusionAxisLenSquared < MIN_BUILDING_HEIGHT_SQUARED) ? 1.0 : extrusionRatio;\n#else\nfloat vExtrusionRatio = extrusionRatio;\n#endif\ntransformed = transformed + extrusionAxis.xyz * (vExtrusionRatio - 1.0);\n#ifdef FLAT_SHADED\nvExtrusionAxis = vec4(normalMatrix * extrusionAxis.xyz, extrusionAxis.w);\n#endif\n`,extrusion_normal_fragment_begin:"\n#ifdef FLAT_SHADED\n    // Flattened this divergent path to prevent undefined behaviour in the following derivatives\n    // functions. For more info:\n    // http://www.aclockworkberry.com/shader-derivative-functions/#Derivatives_and_branches\n\n    // Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n    vec3 fdx = vec3(dFdx(vViewPosition.x), dFdx(vViewPosition.y), dFdx(vViewPosition.z));\n    vec3 fdy = vec3(dFdy(vViewPosition.x), dFdy(vViewPosition.y), dFdy(vViewPosition.z));\n    vec3 normal = cross( fdx, fdy );\n    if (vExtrusionAxis.w > 0.999999) {\n        normal = vExtrusionAxis.xyz;\n    }\n    normal = normalize(normal);\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t\tbitangent = bitangent * (float(gl_FrontFacing) * 2.0 - 1.0);\n\t\t#endif\n\t#endif\n#endif\n// non perturbed normal for clearcoat among others\nvec3 geometryNormal = normal;\n",extrusion_pars_fragment:"\n#ifdef ZFIGHTING_WORKAROUND\nvarying float vExtrusionRatio;\n#else\nuniform float extrusionRatio;\n#endif\nvarying vec4 vExtrusionAxis;\n",extrusion_fragment:"\n#ifndef ZFIGHTING_WORKAROUND\nfloat vExtrusionRatio = extrusionRatio;\n#endif\ngl_FragColor.a *= smoothstep( 0.0, 0.25, vExtrusionRatio );\n"}},54589:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={fading_pars_vertex:"\nvarying float fadingDepth;\n",fading_vertex:"\nfadingDepth = -mvPosition.z;\n",fading_pars_fragment:"\nvarying float fadingDepth;\nuniform float fadeNear;\nuniform float fadeFar;\n",fading_fragment:'\n\n// lerp with "hard" edges\n//float fadingFactor = 1.0 - clamp((fadingDepth - fadeNear) / (fadeFar - fadeNear), 0.0, 1.0);\n\n// smooth transitions\nfloat fadingFactor = smoothstep( fadeNear, fadeFar, fadingDepth );\n\ngl_FragColor.a *= 1.0 - fadingFactor;\n\n// debugging color:\n// gl_FragColor = vec4(1., fadingFactor, fadingFactor, 1.0);\n'}},32789:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LineCapsModes=void 0,function(e){e[e.CAPS_NONE=0]="CAPS_NONE",e[e.CAPS_SQUARE=1]="CAPS_SQUARE",e[e.CAPS_ROUND=2]="CAPS_ROUND",e[e.CAPS_TRIANGLE_IN=3]="CAPS_TRIANGLE_IN",e[e.CAPS_TRIANGLE_OUT=4]="CAPS_TRIANGLE_OUT"}(i=t.LineCapsModes||(t.LineCapsModes={})),t.default={extrude_line_vert_func:"\nvec3 extrudeLine(\n        in vec3 vertexPosition,\n        in float linePosition,\n        in float extrusionWidth,\n        in vec4 bitangent,\n        in vec3 tangent,\n        in float tanHalfAngle,\n        inout vec2 uv\n    ) {\n    vec3 result = vertexPosition;\n    // Retrieve the angle between this segment and the previous one (stored in the bitangent w\n    // component).\n    float angle = bitangent.w;\n    // Extrude according to the angle between segments to properly render narrow joints...\n    if (angle != 0.0) {\n        result += uv.y * extrusionWidth * bitangent.xyz / cos(angle / 2.0);\n        uv.x = linePosition + uv.x * extrusionWidth * uv.y * tanHalfAngle;\n    }\n    // ... or extrude in a simple manner for segments that keep the same direction.\n    else {\n        result += uv.y * extrusionWidth * bitangent.xyz + uv.x * extrusionWidth * tangent;\n        uv.x = linePosition + uv.x * extrusionWidth;\n    }\n    uv.y *= extrusionWidth;\n    return result;\n}\n",round_edges_and_add_caps:`\n#define CAPS_NONE ${i.CAPS_NONE}\n#define CAPS_SQUARE ${i.CAPS_SQUARE}\n#define CAPS_ROUND ${i.CAPS_ROUND}\n#define CAPS_TRIANGLE_IN ${i.CAPS_TRIANGLE_IN}\n#define CAPS_TRIANGLE_OUT ${i.CAPS_TRIANGLE_OUT}\n\nfloat roundEdgesAndAddCaps(in vec4 coords, in vec3 range) {\n    // Compute the line's width to length ratio.\n    float widthRatio = range.y / range.x;\n\n    // Compute the inner segment distance (same for all cap mode).\n    float dist = abs(coords.y);\n    float segmentBeginMask = clamp(ceil(coords.z - coords.x), 0.0, 1.0);\n    float segmentEndMask = clamp(ceil(coords.x - coords.w), 0.0, 1.0);\n    dist = max(dist, segmentBeginMask * length(vec2((coords.x - coords.z) / widthRatio, coords.y)));\n    dist = max(dist, segmentEndMask * length(vec2((coords.x - coords.w) / widthRatio, coords.y)));\n\n    #if CAPS_MODE != CAPS_ROUND\n    // Compute the caps mask.\n    float capRangeMask = clamp(1.0 - ceil(range.z - drawRange.y), 0.0, 1.0);\n    float beginCapMask = clamp(ceil(drawRange.x - coords.x), 0.0, 1.0);\n    float endCapMask = clamp(ceil(coords.x - drawRange.y), 0.0, 1.0);\n    float capMask = capRangeMask * max(beginCapMask, endCapMask);\n\n    // Compute the outer segment distance (specific for each cap mode).\n    float capDist = max(coords.x - drawRange.y, drawRange.x - coords.x) / widthRatio;\n    #if CAPS_MODE == CAPS_NONE\n    dist = mix(dist, max(abs(coords.y), (capDist + 0.1) / 0.1), capMask);\n    #elif CAPS_MODE == CAPS_SQUARE\n    dist = mix(dist, max(abs(coords.y), capDist), capMask);\n    #elif CAPS_MODE == CAPS_TRIANGLE_OUT\n    dist = mix(dist, abs(coords.y) + capDist, capMask);\n    #elif CAPS_MODE == CAPS_TRIANGLE_IN\n    dist = mix(dist, max(abs(coords.y), (capDist - abs(coords.y)) + capDist), capMask);\n    #endif\n    #endif // CAPS_MODE != CAPS_ROUND\n\n    return dist;\n}\n`,tile_clip_func:"\nvoid tileClip(vec2 tilePos, vec2 tileSize) {\n    if (tileSize.x > 0.0 && (tilePos.x < -tileSize.x / 2.0 || tilePos.x > tileSize.x / 2.0))\n        discard;\n    if (tileSize.y > 0.0 && (tilePos.y < -tileSize.y / 2.0 || tilePos.y > tileSize.y / 2.0))\n        discard;\n}\n",high_precision_vert_func:"\nvec3 subtractDblEyePos( const in vec3 pos ) {\n    vec3 t1 = positionLow - u_eyepos_lowpart;\n    vec3 e = t1 - positionLow;\n    vec3 t2 = ((-u_eyepos_lowpart - e) + (positionLow - (t1 - e))) + pos - u_eyepos;\n    vec3 high_delta = t1 + t2;\n    vec3 low_delta = t2 - (high_delta - t1);\n    return (high_delta + low_delta);\n}\n"}},59117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simpleLightingShadowChunk=void 0,t.simpleLightingShadowChunk="\n    struct PhysicalMaterial {\n        vec3\tdiffuseColor;\n        float\tspecularRoughness;\n        vec3\tspecularColor;\n    };\n\n    #define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n    void RE_Direct_Physical( const in IncidentLight directLight,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight ) {\n        // directLight.color is the light color * shadow, internally three.js uses a step function, so\n        // this value is either the light color or black. in order to lighten up the shadows, we\n        // take add 50% of the color to grey (to give us either pure white or grey) and multiply this to\n        // the material's diffuse color.\n        #if defined(USE_SHADOWMAP)\n            reflectedLight.directDiffuse = (0.5 * directLight.color +\n                vec3(0.5,0.5,0.5)) * material.diffuseColor;\n        #else\n            reflectedLight.directDiffuse = material.diffuseColor;\n        #endif\n    }\n\n    void RE_IndirectDiffuse_Physical( const in vec3 irradiance,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight ) {\n            // Disable influence of indirect light (it is handled in the RE_Direct_Physical function)\n    }\n\n    void RE_IndirectSpecular_Physical( const in vec3 radiance,\n        const in vec3 irradiance,\n        const in vec3 clearcoatRadiance,\n        const in GeometricContext geometry,\n        const in PhysicalMaterial material,\n        inout ReflectedLight reflectedLight) {\n            // Disable specular reflection of light.\n    }\n\n    #define RE_Direct               RE_Direct_Physical\n    #define RE_IndirectDiffuse      RE_IndirectDiffuse_Physical\n    #define RE_IndirectSpecular     RE_IndirectSpecular_Physical\n"},18368:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkyAtmosphereMaterial=t.SkyAtmosphereShader=void 0;const r=i(84428),n=i(87655),o=i(1709),a=i(79995);t.SkyAtmosphereShader={uniforms:{u_eyePositionWorld:new r.Uniform(new r.Vector3),u_lightDirectionWorld:new r.Uniform(new r.Vector3(0,1,0)),u_modelViewProjection:new r.Uniform(new r.Matrix4),u_atmosphereEnv:new r.Uniform(new r.Vector3(6378137,6537590.425,0)),u_hsvCorrection:new r.Uniform(new r.Vector3(0,0,0)),topColor:new r.Uniform(new r.Color(30719)),bottomColor:new r.Uniform(new r.Color(16777215)),offset:new r.Uniform(33),exponent:new r.Uniform(.6),fogColor:new r.Uniform(new r.Color(30719)),fogNear:new r.Uniform(new r.Color(30719)),fogFar:new r.Uniform(new r.Color(16777215))},vertexShader:`\n    precision highp float;\n    precision highp int;\n\n    attribute vec4 position;\n\n    uniform mat4 u_modelViewProjection;\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_hsvCorrection;\n\n    const float Pi = 3.141592653589793;\n    const float Kr = 0.0025;\n    const float Kr4PI = Kr * 4.0 * Pi;\n    const float Km = 0.0015;\n    const float Km4PI = Km * 4.0 * Pi;\n    const float ESun = 15.0; // should be 15.0\n    const float KmESun = Km * ESun;\n    const float KrESun = Kr * ESun;\n    const vec3 InvWavelength = vec3(\n        5.60204474633241,  // Red = 1.0 / Math.pow(0.650, 4.0)\n        9.473284437923038, // Green = 1.0 / Math.pow(0.570, 4.0)\n        19.643802610477206); // Blue = 1.0 / Math.pow(0.475, 4.0)\n\n    const int nSamples = 2;\n    const float fSamples = 2.0;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n\n    ${o.default.atmosphere_vertex_utils}\n\n    //\n    // Computes rayleight and mia atmosphere factors for sky.\n    //\n    // Code based on GPU Gems article.\n    //\n    // Author: Sean O'Neil\n    //\n    // Copyright (c) 2004 Sean O'Neil\n    //\n    // https://developer.nvidia.com/gpugems/gpugems2/part-ii-shading-lighting-and-shadows/chapter-16-accurate-atmospheric-scattering\n    //\n    // Further modifications by HERE\n    //\n    AtmosphereColor computeSkyAtmosphere(vec3 v3Pos, vec3 vLightDir)\n    {\n        // Unpack attributes\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        // All that may be const or define(s) at further optimization:\n        float fScale = 1.0 / (fOuterRadius - fInnerRadius);\n        float fScaleOverScaleDepth = (fScale / RayleighScaleDepth);\n        float fCameraHeight2 = fCameraHeight * fCameraHeight;\n        float fOuterRadius2 = fOuterRadius * fOuterRadius;\n\n        // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)\n        vec3 v3Ray = v3Pos - u_eyePositionWorld;\n        float fFar = length(v3Ray);\n        v3Ray /= fFar;\n\n    #ifdef CAMERA_IN_SPACE\n\n        // Calculate the closest intersection of the ray with the outer\n        // atmosphere, this is the first point of the ray passing through the atmosphere dome.\n        float fNear = getNearSphereIntersect(u_eyePositionWorld, v3Ray, fCameraHeight2, fOuterRadius2);\n        // Make far relative to first atmosphere intersection\n        fFar -= fNear;\n\n        // Compute the ray's starting position within the atmosphere, then\n        // calculate its scattering offset\n        vec3 v3Start = u_eyePositionWorld + v3Ray * fNear;\n\n        float fStartAngle = dot(v3Ray, v3Start) / fOuterRadius;\n        float fStartDepth = exp(-1.0 / RayleighScaleDepth );\n        float fStartOffset = fStartDepth * scale(fStartAngle);\n\n    #else // CAMERA_IN_ATMOSPHERE\n\n        // The ray starts already in atmosphere\n        vec3 v3Start = u_eyePositionWorld;\n        float height = length(v3Start);\n        float depth = exp(fScaleOverScaleDepth * (fInnerRadius - fCameraHeight));\n        float fStartAngle = dot(v3Ray, v3Start) / height;\n        float fStartOffset = depth * scale(fStartAngle);\n\n    #endif\n\n        // Initialize the scattering loop variables\n        float fSampleLength = fFar / fSamples;\n        float fScaledLength = fSampleLength * fScale;\n        vec3 v3SampleRay = v3Ray * fSampleLength;\n        vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\n\n        // Now loop through the sample rays\n        vec3 v3BaseColor = vec3(0.0);\n        vec3 v3Attenuate = vec3(0.0);\n        for(int i=0; i < nSamples; i++)\n        {\n            float height = length(v3SamplePoint);\n            float depth = exp(fScaleOverScaleDepth * (fInnerRadius - height));\n            float fLightAngle = dot(vLightDir, v3SamplePoint) / height;\n            float fCameraAngle = dot(v3Ray, v3SamplePoint) / height;\n            float fScatter = (fStartOffset + depth * (scale(fLightAngle) - scale(fCameraAngle)));\n            v3Attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\n            v3BaseColor += v3Attenuate * (depth * fScaledLength);\n            v3SamplePoint += v3SampleRay;\n        }\n\n        // Scale the Mie and Rayleigh colors and set up output of the function\n        AtmosphereColor color;\n        color.mie = v3BaseColor * KmESun;\n        color.rayleigh = v3BaseColor * (InvWavelength * KrESun);\n        return color;\n    }\n\n    void main(void)\n    {\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        AtmosphereColor atmColor = computeSkyAtmosphere(position.xyz, vLightDir);\n        v_mieColor = atmColor.mie;\n        v_rayleighColor = atmColor.rayleigh;\n        v_vertToCamera = u_eyePositionWorld - position.xyz;\n\n        gl_Position = u_modelViewProjection * position;\n    }\n    `,fragmentShader:`\n    // Because of harsh light distribution the exposure correction is always enabled for the sky.\n    #define CORRECT_EXPOSURE 1\n\n    precision highp float;\n    precision highp int;\n\n    #ifdef CORRECT_COLOR\n    uniform vec3 u_hsvCorrection; // Hue, saturation, brightness\n    #endif\n\n    uniform vec3 u_atmosphereEnv; // Atmosphere inner and outer radius, camera height\n    uniform vec3 u_eyePositionWorld;\n    uniform vec3 u_lightDirectionWorld;\n\n    const float g = -0.95;\n    const float g2 = g * g;\n\n    varying vec3 v_rayleighColor;\n    varying vec3 v_mieColor;\n    varying vec3 v_vertToCamera;\n\n    ${o.default.atmosphere_fragment_utils}\n\n    void main(void)\n    {\n        float fInnerRadius = u_atmosphereEnv.x;\n        float fOuterRadius = u_atmosphereEnv.y;\n        float fCameraHeight = u_atmosphereEnv.z;\n\n        #ifdef DYNAMIC_LIGHT\n            vec3 vLightDir = u_lightDirectionWorld;\n            // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n            float fNightAlpha = clamp(dot(normalize(u_eyePositionWorld), vLightDir), 0.0, 1.0);\n        #else\n            vec3 vLightDir = u_eyePositionWorld;\n            float fNightAlpha = 1.0;\n        #endif\n        vLightDir = normalize(vLightDir);\n\n        // NOTE:\n        // For better precision normalization may be added on fragment (for mobile devices)\n        // while in vertex shader may be left un-normalized\n        // dot(vLightDir, normalize(v_vertToCamera)) / length(v_vertToCamera);\n        float fCosAngle = dot(vLightDir, v_vertToCamera) / length(v_vertToCamera);\n        float fRayleighPhase = 0.75 * (1.0 + fCosAngle * fCosAngle);\n        float fMiePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + fCosAngle * fCosAngle) / pow(1.0 + g2 - 2.0 * g * fCosAngle, 1.5);\n\n        vec3 cRgb = fRayleighPhase * v_rayleighColor + fMiePhase * v_mieColor;\n\n        // Sky produces very harsh lighting effect so exposure correction is always enabled.\n    #if !defined(HDR_FRAME_BUFFER) && defined(CORRECT_EXPOSURE)\n        // Exposure factor may be exposed to uniform variable.\n        cRgb = correctExposure(cRgb, 2.0);\n    #endif\n\n    #ifdef CORRECT_COLOR\n        cRgb = correctColor(cRgb, u_hsvCorrection);\n    #endif\n\n        // Alter alpha based on how close the viewer is to the ground (1.0 = on ground, 0.0 = at edge of atmosphere)\n        float fAtmosphereAlpha = clamp((fOuterRadius - fCameraHeight) /\n            (fOuterRadius - fInnerRadius), 0.0, 1.0);\n        fAtmosphereAlpha *= pow(fNightAlpha, 0.5);\n\n        gl_FragColor = vec4(cRgb, mix(cRgb.b, 1.0, fAtmosphereAlpha));\n    }\n    `};class s extends n.RawShaderMaterial{constructor(e){let i;e&&(i={name:"SkyAtmosphereMaterial",vertexShader:t.SkyAtmosphereShader.vertexShader,fragmentShader:t.SkyAtmosphereShader.fragmentShader,uniforms:t.SkyAtmosphereShader.uniforms,transparent:!0,depthTest:!0,depthWrite:!1,side:r.BackSide,blending:r.NormalBlending,fog:!1,rendererCapabilities:e.rendererCapabilities}),super(i)}setDynamicLighting(e){a.setShaderMaterialDefine(this,"DYNAMIC_LIGHT",e)}set outerRadius(e){this.uniforms.u_atmosphereEnv.value.y=e}get outerRadius(){return this.uniforms.u_atmosphereEnv.value.y}set innerRadius(e){this.uniforms.u_atmosphereEnv.value.x=e}get innerRadius(){return this.uniforms.u_atmosphereEnv.value.x}updateUniforms(e,t,i,r){const n=this.getCameraInfo(t,i);if(void 0===e||!e.isMaterial)throw Error("Wrong object used, only Material objects are supported");if(!(e.uniforms&&e.uniforms.u_atmosphereEnv&&e.uniforms.u_hsvCorrection&&e.uniforms.u_eyePositionWorld&&e.uniforms.u_modelViewProjection&&e.uniforms.u_lightDirectionWorld))throw Error("Atmosphere material has missing uniforms");{const t=n.eyePos,i=n.modelViewProjection,o=n.eyeHeight;e.uniforms.u_eyePositionWorld.value.copy(t),e.uniforms.u_modelViewProjection.value.copy(i),e.uniforms.u_atmosphereEnv.value.z=o,e.uniforms.u_lightDirectionWorld.value=r.clone();const s=o>this.outerRadius,l=a.setShaderDefine(e.defines,"CAMERA_IN_SPACE",s),c=a.setShaderDefine(e.defines,"CAMERA_IN_ATMOSPHERE",!s);e.needsUpdate=e.needsUpdate||l||c}}getCameraInfo(e,t,i=!1){if(i){const i=(new r.Matrix4).identity(),n=(new r.Matrix4).copy(e.matrixWorld).invert().transpose(),o=t.projectionMatrix,a=new r.Matrix4;a.multiplyMatrices(n,i),a.multiplyMatrices(o,a);const s=new r.Vector3;e.getWorldPosition(s);const l=new r.Vector3;return t.getWorldPosition(l),{modelViewProjection:a,eyePos:s,eyeHeight:l.distanceTo(s)}}{const i=e.matrixWorld,n=t.matrixWorldInverse,o=t.projectionMatrix,a=new r.Matrix4;a.multiplyMatrices(n,i),a.multiplyMatrices(o,a);const s=new r.Vector3;t.getWorldPosition(s);const l=new r.Vector3;e.getWorldPosition(l);const c=l.distanceTo(s);return s.sub(l),{modelViewProjection:a,eyePos:s,eyeHeight:c}}}}t.SkyAtmosphereMaterial=s},12071:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SolidLineMaterial=t.LineDashesModes=void 0;const r=i(84428),n=i(41676),o=i(87655),a=i(32789),s=i(79995),l={None:a.LineCapsModes.CAPS_NONE,Square:a.LineCapsModes.CAPS_SQUARE,Round:a.LineCapsModes.CAPS_ROUND,TriangleIn:a.LineCapsModes.CAPS_TRIANGLE_IN,TriangleOut:a.LineCapsModes.CAPS_TRIANGLE_OUT},c=Object.keys(l).reduce(((e,t)=>{const i=t;return e[l[i]]=i,e}),{});var u;!function(e){e[e.DASHES_SQUARE=0]="DASHES_SQUARE",e[e.DASHES_ROUND=1]="DASHES_ROUND",e[e.DASHES_DIAMOND=2]="DASHES_DIAMOND"}(u=t.LineDashesModes||(t.LineDashesModes={}));const d={Square:u.DASHES_SQUARE,Round:u.DASHES_ROUND,Diamond:u.DASHES_DIAMOND},h=Object.keys(d).reduce(((e,t)=>{const i=t;return e[d[i]]=i,e}),{}),m=new r.Color,p=`\nprecision highp float;\nprecision highp int;\n\nuniform vec3 diffuseColor;\nuniform vec3 outlineColor;\nuniform float opacity;\nuniform float extrusionWidth;\nuniform float outlineWidth;\nuniform vec2 tileSize;\nuniform vec2 drawRange;\n\n#ifdef USE_DASHED_LINE\nuniform float dashSize;\nuniform float gapSize;\nuniform vec3 dashColor;\n\n#define DASHES_SQUARE ${u.DASHES_SQUARE}\n#define DASHES_ROUND ${u.DASHES_ROUND}\n#define DASHES_DIAMOND ${u.DASHES_DIAMOND}\n#endif\n\n#ifdef USE_TILE_CLIP\nvarying vec3 vPosition;\n#endif\n\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n\n#include <round_edges_and_add_caps>\n#include <tile_clip_func>\n\n#ifdef USE_FADING\n#include <fading_pars_fragment>\n#endif\n\n#include <fog_pars_fragment>\n\nvoid main() {\n    float alpha = opacity;\n    vec3 outputDiffuse = diffuseColor;\n\n    #ifdef USE_TILE_CLIP\n    tileClip(vPosition.xy, tileSize);\n    #endif\n\n    // Calculate distance to center (0.0: lineCenter, 1.0: lineEdge).\n    float distToCenter = roundEdgesAndAddCaps(vCoords, vRange);\n    // Calculate distance to edge (-1.0: lineCenter, 0.0: lineEdge).\n    float distToEdge = distToCenter - (extrusionWidth + outlineWidth) / extrusionWidth;\n\n    // Decrease the line opacity by the distToEdge, making the transition steeper when the slope\n    // of distToChange increases (i.e. the line is further away).\n    float width = fwidth(distToEdge);\n\n    float s = opacity < 0.98\n        ? clamp((distToEdge + width) / (2.0 * width), 0.0, 1.0) // prefer a boxstep\n        : smoothstep(-width, width, distToEdge);\n\n    if (opacity < 0.98 && 1.0 - s < opacity) {\n        // drop the fragment when the line is using opacity.\n        discard;\n    }\n\n    alpha *= 1.0 - s;\n\n    #ifdef USE_DASHED_LINE\n    // Compute the distance to the dash origin (0.0: dashOrigin, 1.0: dashEnd, (d+g)/d: gapEnd).\n    float d = dashSize / vRange.x;\n    float g = gapSize / vRange.x;\n    float distToDashOrigin = mod(vCoords.x, d + g) / d;\n\n    // Compute distance to dash edge (0.5: dashCenter, 0.0: dashEdge) and compute the\n    // dashBlendFactor similarly on how we did it for the line opacity.\n    float distToDashEdge = 0.5 - distance(distToDashOrigin, (d + g) / d * 0.5);\n    #if DASHES_MODE == DASHES_ROUND\n    distToDashEdge = 0.5 - distance(vec2(distToCenter * 0.5, distToDashEdge), vec2(0.0, 0.5));\n    #elif DASHES_MODE == DASHES_DIAMOND\n    distToDashEdge -= distToCenter * 0.5;\n    #endif\n    float dashWidth = fwidth(distToDashEdge);\n    float dashBlendFactor = 1.0 - smoothstep(-dashWidth, dashWidth, distToDashEdge);\n\n    #ifdef USE_DASH_COLOR\n    outputDiffuse = mix(diffuseColor, dashColor, dashBlendFactor);\n    #endif\n    #endif\n\n    #ifdef USE_OUTLINE\n    // Calculate distance to outline (0.0: lineEdge, outlineWidth/lineWidth: outlineEdge) and\n    // compute the outlineBlendFactor (used to mix line and outline colors).\n    float distToOutline = distToCenter - 1.0;\n    float outlineWidth = fwidth(distToOutline);\n    float outlineBlendFactor = smoothstep(-outlineWidth, outlineWidth, distToOutline);\n\n    // Mix the colors using the different computed factors.\n    #if defined(USE_DASHED_LINE) && !defined(USE_DASH_COLOR)\n    float colorBlendFactor = smoothstep(-1.0, 1.0, dashBlendFactor - outlineBlendFactor);\n    outputDiffuse = mix(\n      mix(\n        mix(outlineColor, diffuseColor, colorBlendFactor),\n        outputDiffuse,\n        dashBlendFactor\n      ),\n      outlineColor,\n      outlineBlendFactor\n    );\n    #else\n    outputDiffuse = mix(outputDiffuse, outlineColor, outlineBlendFactor);\n    #endif\n    #endif\n\n    #if defined(USE_DASHED_LINE) && !defined(USE_DASH_COLOR)\n    // Multiply the alpha by the dashBlendFactor.\n    #if defined(USE_OUTLINE)\n    alpha *= clamp(dashBlendFactor + outlineBlendFactor, 0.0, 1.0);\n    #else\n    alpha *= 1.0 - dashBlendFactor;\n    #endif\n    #endif\n\n    #ifdef USE_COLOR\n    gl_FragColor = vec4( outputDiffuse * vColor, alpha );\n    #else\n    gl_FragColor = vec4( outputDiffuse, alpha );\n    #endif\n\n    #include <fog_fragment>\n\n    #ifdef USE_FADING\n    #include <fading_fragment>\n    #endif\n\n\n}`;class f extends o.RawShaderMaterial{constructor(e){var t;Object.assign(r.ShaderChunk,a.default),n.FadingFeature.patchGlobalShaderChunks();const i={CAPS_MODE:a.LineCapsModes.CAPS_ROUND,DASHES_MODE:u.DASHES_SQUARE};let o,l,c=!0,d=1;e&&(c=!0===e.fog,c&&s.setShaderDefine(i,"USE_FOG",!0),d=void 0!==e.opacity?e.opacity:d,o=e.displacementMap,void 0!==o&&s.setShaderDefine(i,"USE_DISPLACEMENTMAP",!0),void 0!==e.outlineWidth&&e.outlineWidth>0&&s.setShaderDefine(i,"USE_OUTLINE",!0),l={name:"SolidLineMaterial",vertexShader:"\n#define SEGMENT_OFFSET 0.1\n\nattribute vec3 extrusionCoord;\nattribute vec3 position;\nattribute vec4 biTangent;\nattribute vec3 tangent;\nattribute vec2 uv;\nattribute vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float extrusionWidth;\nuniform float outlineWidth;\nuniform float offset;\nuniform vec2 drawRange;\n\n#ifdef USE_DISPLACEMENTMAP\nuniform sampler2D displacementMap;\n#endif\n\n#ifdef USE_TILE_CLIP\nvarying vec3 vPosition;\n#endif\nvarying vec3 vRange;\nvarying vec4 vCoords;\n#ifdef USE_COLOR\nattribute vec3 color;\nvarying vec3 vColor;\n#endif\n\n#ifdef USE_FADING\n#include <fading_pars_vertex>\n#endif\n\n#include <fog_pars_vertex>\n\n#include <extrude_line_vert_func>\n\nvoid main() {\n    // Calculate the segment.\n    vec2 segment = abs(extrusionCoord.xy) - SEGMENT_OFFSET;\n    float segmentPos = sign(extrusionCoord.x) / 2.0 + 0.5;\n\n    // Calculate the vertex position inside the line (segment) and extrusion direction and factor.\n    float linePos = mix(segment.x, segment.y, segmentPos);\n    vec2 extrusionDir = sign(extrusionCoord.xy);\n    // Precompute to avoid computing multiple times\n    float tanHalfAngle = tan(biTangent.w / 2.0);\n    float extrusionFactor = extrusionDir.y * tanHalfAngle;\n\n    // Calculate the extruded vertex position (and scale the extrusion direction).\n    vec3 pos = extrudeLine(\n        position, linePos, extrusionWidth + outlineWidth, biTangent, tangent, tanHalfAngle,\n        extrusionDir);\n\n    // Store the normalized extrusion coordinates in vCoords (with their ranges in vRange).\n    vRange = vec3(extrusionCoord.z, extrusionWidth, extrusionFactor);\n    vCoords = vec4(extrusionDir / vRange.xy, segment / vRange.x);\n\n    // Adjust the segment to fit the drawRange.\n    float capDist = (extrusionWidth + outlineWidth) / extrusionCoord.z;\n    if ((vCoords.w + capDist) < drawRange.x || (vCoords.z - capDist) > drawRange.y) {\n        vCoords.zw += 1.0;\n    }\n    if (vCoords.z < drawRange.x) {\n        vCoords.zw += vec2(drawRange.x - vCoords.z, 0.0);\n    }\n    if (vCoords.w > drawRange.y) {\n        vCoords.zw -= vec2(0.0, vCoords.w - drawRange.y);\n    }\n\n    // Transform position.\n    #ifdef USE_DISPLACEMENTMAP\n    pos += normalize( normal ) * texture2D( displacementMap, uv ).x;\n    #endif\n\n    // Shift the line based on the offset, where the bitangent is the cross product of the average\n    // of the two direction vectors (the previous and next segment directions) and the normal of\n    // the line (facing into the sky). The w component is the angle between the two segments.\n    // Note, we need to take the angle into consideration, so we use trigonometry to calculate how\n    // much we need to extend the offset. Note, orthough this looks complicated we are doing this\n    // in the vertex shader, so it should not cause a performance issue.\n    pos += biTangent.xyz * offset * sqrt(1.0 + pow(abs(tanHalfAngle), 2.0));\n\n    vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n\n    // Pass extruded position to fragment shader.\n    #ifdef USE_TILE_CLIP\n    vPosition = pos;\n    #endif\n\n    #ifdef USE_COLOR\n    // Pass vertex color to fragment shader.\n    vColor = color;\n    #endif\n\n    #ifdef USE_FADING\n    #include <fading_vertex>\n    #endif\n\n    #include <fog_vertex>\n}",fragmentShader:p,uniforms:r.UniformsUtils.merge([{diffuseColor:new r.Uniform(new r.Color(f.DEFAULT_COLOR)),dashColor:new r.Uniform(new r.Color(f.DEFAULT_COLOR)),outlineColor:new r.Uniform(new r.Color(f.DEFAULT_COLOR)),extrusionWidth:new r.Uniform(f.DEFAULT_WIDTH),outlineWidth:new r.Uniform(f.DEFAULT_OUTLINE_WIDTH),offset:new r.Uniform(f.DEFAULT_OFFSET),opacity:new r.Uniform(f.DEFAULT_OPACITY),tileSize:new r.Uniform(new r.Vector2),fadeNear:new r.Uniform(n.FadingFeature.DEFAULT_FADE_NEAR),fadeFar:new r.Uniform(n.FadingFeature.DEFAULT_FADE_FAR),displacementMap:new r.Uniform(void 0!==o?o:new r.Texture),drawRange:new r.Uniform(new r.Vector2(f.DEFAULT_DRAW_RANGE_START,f.DEFAULT_DRAW_RANGE_END)),dashSize:new r.Uniform(f.DEFAULT_DASH_SIZE),gapSize:new r.Uniform(f.DEFAULT_GAP_SIZE)},r.UniformsLib.fog]),defines:i,fog:c,opacity:d,rendererCapabilities:e.rendererCapabilities}),super(l),this.fog=c,this.setOpacity(d),this.stencilFunc=r.NotEqualStencilFunc,this.stencilZPass=r.ReplaceStencilOp,this.stencilRef=1,this.stencilWrite=!1,s.enforceBlending(this),this.extensions.derivatives=!0,e&&(void 0!==e.color&&(m.set(e.color),this.color=m),void 0!==e.outlineColor&&(m.set(e.outlineColor),this.outlineColor=m),void 0!==e.lineWidth&&(this.lineWidth=e.lineWidth),void 0!==e.outlineWidth&&(this.outlineWidth=e.outlineWidth),void 0!==e.opacity&&this.setOpacity(e.opacity),void 0!==e.depthTest&&(this.depthTest=e.depthTest),void 0!==e.depthWrite&&(this.depthWrite=e.depthWrite),void 0!==e.fadeNear&&(this.fadeNear=e.fadeNear),void 0!==e.fadeFar&&(this.fadeFar=e.fadeFar),void 0!==e.displacementMap&&(this.displacementMap=e.displacementMap),void 0!==e.caps&&(this.caps=e.caps),void 0!==e.drawRangeStart&&(this.drawRangeStart=e.drawRangeStart),void 0!==e.drawRangeEnd&&(this.drawRangeEnd=e.drawRangeEnd),void 0!==e.dashes&&(this.dashes=e.dashes),void 0!==e.dashColor&&(m.set(e.dashColor),this.dashColor=m),void 0!==e.dashSize&&(this.dashSize=e.dashSize),void 0!==e.gapSize&&(this.gapSize=e.gapSize),void 0!==e.fog&&(this.fog=e.fog,this.invalidateFog()),this.offset=null!==(t=e.offset)&&void 0!==t?t:0)}set offset(e){this.uniforms.offset.value=e}get offset(){return this.uniforms.offset.value}set outline(e){s.setShaderMaterialDefine(this,"USE_OUTLINE",e)}get outline(){return!0===s.getShaderMaterialDefine(this,"USE_OUTLINE")}setOpacity(e){super.setOpacity(e),void 0!==e&&(this.stencilWrite=e<.98)}get color(){return this.uniforms.diffuseColor.value}set color(e){this.uniforms.diffuseColor.value.copy(e)}get outlineColor(){return this.uniforms.outlineColor.value}set outlineColor(e){this.uniforms.outlineColor.value.copy(e)}get dashColor(){return this.uniforms.dashColor.value}set dashColor(e){this.uniforms.dashColor.value.copy(e),s.setShaderMaterialDefine(this,"USE_DASH_COLOR",!0)}get lineWidth(){return 2*this.uniforms.extrusionWidth.value}set lineWidth(e){this.uniforms.extrusionWidth.value=e/2}get outlineWidth(){return this.uniforms.outlineWidth.value}set outlineWidth(e){this.uniforms.outlineWidth.value=e,this.outline=e>0}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){var t,i;this.uniforms.gapSize.value=e,s.setShaderMaterialDefine(this,"USE_DASHED_LINE",e>0),0===(null===(i=null===(t=this.uniforms)||void 0===t?void 0:t.gapSize)||void 0===i?void 0:i.value)&&(this.stencilWrite=this.opacity<.98)}get caps(){let e="Round";const t=s.getShaderMaterialDefine(this,"CAPS_MODE");return"number"==typeof t&&c.hasOwnProperty(t)&&(e=c[t]),e}set caps(e){l.hasOwnProperty(e)&&s.setShaderMaterialDefine(this,"CAPS_MODE",l[e])}get dashes(){let e="Square";const t=s.getShaderMaterialDefine(this,"DASHES_MODE");return"number"==typeof t&&h.hasOwnProperty(t)&&(e=h[t]),e}set dashes(e){d.hasOwnProperty(e)&&s.setShaderMaterialDefine(this,"DASHES_MODE",d[e])}get fadeNear(){return this.uniforms.fadeNear.value}set fadeNear(e){this.uniforms.fadeNear.value=e}get fadeFar(){return this.uniforms.fadeFar.value}set fadeFar(e){this.uniforms.fadeFar.value=e,s.setShaderMaterialDefine(this,"USE_FADING",e>0)}get displacementMap(){return this.uniforms.displacementMap.value}set displacementMap(e){if(this.uniforms.displacementMap.value===e)return;this.uniforms.displacementMap.value=e;const t=null!==e;t&&(this.uniforms.displacementMap.value.needsUpdate=!0),s.setShaderMaterialDefine(this,"USE_DISPLACEMENTMAP",t)}get drawRangeStart(){return this.uniforms.drawRange.value.x}set drawRangeStart(e){this.uniforms.drawRange.value.x=e}get drawRangeEnd(){return this.uniforms.drawRange.value.y}set drawRangeEnd(e){this.uniforms.drawRange.value.y=e}set clipTileSize(e){this.uniforms.tileSize.value.copy(e);const t=e.x>0&&e.y>0;s.setShaderMaterialDefine(this,"USE_TILE_CLIP",t)}get clipTileSize(){return this.uniforms.tileSize.value}copy(e){return super.copy(e),this.invalidateFog(),this.setOpacity(e.opacity),this}}t.SolidLineMaterial=f,f.DEFAULT_COLOR=16711680,f.DEFAULT_WIDTH=1,f.DEFAULT_OUTLINE_WIDTH=0,f.DEFAULT_OPACITY=1,f.DEFAULT_DRAW_RANGE_START=0,f.DEFAULT_DRAW_RANGE_END=1,f.DEFAULT_DASH_SIZE=1,f.DEFAULT_GAP_SIZE=1,f.DEFAULT_OFFSET=0},79995:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShaderDefine=t.setShaderDefine=t.getShaderMaterialDefine=t.setShaderMaterialDefine=t.disableBlending=t.enableBlending=t.enforceBlending=t.insertShaderInclude=t.DEFINE_BOOL_FALSE=t.DEFINE_BOOL_TRUE=void 0;const r=i(38338),n=i(84428);function o(e){!0!==e.transparent&&!0!==e.forcedBlending&&(e.blending=n.CustomBlending,!0===e.premultipliedAlpha?(e.blendSrc=n.OneFactor,e.blendDst=n.OneMinusSrcAlphaFactor,e.blendSrcAlpha=n.OneFactor,e.blendDstAlpha=n.OneMinusSrcAlphaFactor):(e.blendSrc=n.SrcAlphaFactor,e.blendDst=n.OneMinusSrcAlphaFactor,e.blendSrcAlpha=n.OneFactor,e.blendDstAlpha=n.OneMinusSrcAlphaFactor))}function a(e,t,i=!1){return void 0===e.defines?i:l(e.defines,t)}function s(e,i,r){let n=!1;return"number"==typeof r?(n=e[i]!==r,e[i]=r):!0===r?(n=e[i]!==t.DEFINE_BOOL_TRUE,e[i]=t.DEFINE_BOOL_TRUE):!1===r&&void 0!==e[i]&&(delete e[i],n=!0),n}function l(e,i){const r=e[i];return r!==t.DEFINE_BOOL_FALSE&&(r===t.DEFINE_BOOL_TRUE||r)}t.DEFINE_BOOL_TRUE="",t.DEFINE_BOOL_FALSE=void 0,t.insertShaderInclude=function(e,t,i,r){const n=!0===r?"\t":"";return e.replace(`#include <${t}>`,`#include <${t}>\n${n}#include <${i}>`)},t.enforceBlending=function(e){e.transparent||(o(e),e.forcedBlending=!0)},t.enableBlending=o,t.disableBlending=function(e){!0!==e.transparent&&!0!==e.forcedBlending&&(e.blending=n.NormalBlending)},t.setShaderMaterialDefine=function(e,t,i){r.assert(void 0!==e.defines,"Do not use this function in ShaderMaterial derived c-tor.");const n=i!==a(e,t);return!!n&&(s(e.defines,t,i),e.needsUpdate=n,!0)},t.getShaderMaterialDefine=a,t.setShaderDefine=s,t.getShaderDefine=l},23167:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VignetteShader=void 0,t.VignetteShader={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"\n        uniform float offset;\n        uniform float darkness;\n        uniform sampler2D tDiffuse;\n        varying vec2 vUv;\n        void main() {\n            vec4 texel = texture2D( tDiffuse, vUv );\n            vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );\n            gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );\n        }"}},49515:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(2154),t),n(i(2226),t),n(i(51662),t),n(i(27827),t),n(i(84651),t),n(i(92660),t),n(i(52056),t),n(i(67728),t),n(i(15200),t)},84651:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextCanvas=t.DEFAULT_TEXT_CANVAS_LAYER=void 0;const r=i(84428),n=i(27827),o=i(17309),a=i(51662),s=i(31748),l=i(86033),c=i(52056),u=new r.Vector3,d={array:[new r.Box2],offset:0};let h=new Float32Array;t.DEFAULT_TEXT_CANVAS_LAYER=0;class m{constructor(e){this.m_renderer=e.renderer,this.m_fontCatalog=e.fontCatalog,this.minGlyphCount=e.minGlyphCount,this.maxGlyphCount=e.maxGlyphCount,this.name=e.name,void 0===e.material?(this.m_ownsMaterial=!0,this.m_material=c.createSdfTextMaterial({fontCatalog:e.fontCatalog,rendererCapabilities:this.m_renderer.capabilities})):(this.m_ownsMaterial=!1,this.m_material=e.material),void 0===e.backgroundMaterial?(this.m_ownsBgMaterial=!0,this.m_bgMaterial=c.createSdfTextMaterial({fontCatalog:e.fontCatalog,isBackground:!0,rendererCapabilities:this.m_renderer.capabilities})):(this.m_ownsBgMaterial=!1,this.m_bgMaterial=e.backgroundMaterial),this.m_defaultLayer={id:t.DEFAULT_TEXT_CANVAS_LAYER,storage:new o.TextGeometry(new r.Scene,this.m_material,this.m_bgMaterial,this.minGlyphCount,this.maxGlyphCount)},this.m_layers=[this.m_defaultLayer],this.m_currentTextRenderStyle=(new a.TextRenderStyle).copy(m.defaultTextRenderStyle),this.m_currentTextLayoutStyle=(new a.TextLayoutStyle).copy(m.defaultTextLayoutStyle),this.m_lineTypesetter=new s.LineTypesetter,this.m_pathTypesetter=new l.PathTypesetter}get fontCatalog(){return this.m_fontCatalog}set fontCatalog(e){this.m_fontCatalog=e;const t=this.m_material;t.uniforms.sdfTexture.value=this.m_fontCatalog.texture,t.uniforms.sdfParams.value=new r.Vector4(this.m_fontCatalog.textureSize.x,this.m_fontCatalog.textureSize.y,this.m_fontCatalog.size,this.m_fontCatalog.distanceRange),t.defines.MSDF="msdf"===this.m_fontCatalog.type?1:0;const i=this.m_bgMaterial;i.uniforms.sdfTexture.value=this.m_fontCatalog.texture,i.uniforms.sdfParams.value=new r.Vector4(this.m_fontCatalog.textureSize.x,this.m_fontCatalog.textureSize.y,this.m_fontCatalog.size,this.m_fontCatalog.distanceRange),i.defines.MSDF="msdf"===this.m_fontCatalog.type?1:0}get material(){return this.m_material}set material(e){this.m_ownsMaterial&&(this.m_material.dispose(),this.m_ownsMaterial=!1),this.m_material=e;for(const e of this.m_layers)e.storage.mesh.material=this.m_material}get backgroundMaterial(){return this.m_bgMaterial}set backgroundMaterial(e){this.m_ownsBgMaterial&&(this.m_bgMaterial.dispose(),this.m_ownsBgMaterial=!1),this.m_bgMaterial=e;for(const e of this.m_layers)e.storage.backgroundMesh.material=this.m_bgMaterial}get textRenderStyle(){return this.m_currentTextRenderStyle}set textRenderStyle(e){this.m_currentTextRenderStyle.copy(e)}get textLayoutStyle(){return this.m_currentTextLayoutStyle}set textLayoutStyle(e){this.m_currentTextLayoutStyle.copy(e)}clear(){for(const e of this.m_layers)e.storage.clear();this.m_currentTextRenderStyle.copy(m.defaultTextRenderStyle),this.m_currentTextLayoutStyle.copy(m.defaultTextLayoutStyle)}render(e,t,i,r,n){this.m_fontCatalog.update(this.m_renderer);let o=null;void 0!==r&&(o=this.m_renderer.getRenderTarget(),this.m_renderer.setRenderTarget(r)),!0===n&&this.m_renderer.clear(!0);for(let r=0;r<this.m_layers.length;r++){const n=this.m_layers[r];if(n.id>=(null!=t?t:0)){if(!(void 0===i||n.id<i))break;n.storage.update(),this.m_renderer.render(n.storage.scene,e)}}void 0!==r&&this.m_renderer.setRenderTarget(o)}addLayer(e){let t=this.getLayer(e);return void 0===t&&(t={id:e,storage:new o.TextGeometry(new r.Scene,this.m_material,this.m_bgMaterial,this.minGlyphCount,this.maxGlyphCount)},this.m_layers.push(t),this.m_layers.sort(((e,t)=>e.id-t.id))),t}getLayer(e){return this.m_layers.find((t=>t.id===e))}getAllLayers(){return this.m_layers}measureText(e,t,i){let r,n,o,a;if(u.set(0,0,0),void 0!==i){if(r=i.path,n=i.pathOverflow,a=i.outputCharacterBounds,void 0!==i.path){const e=i.path.getPoint(0);if(null===e)return!1;u.set(e.x,e.y,0)}i.letterCaseArray&&(o=i.letterCaseArray)}return this.placeText({input:e,layer:this.m_defaultLayer,textPath:r,textPathOverflow:n,bounds:t,individualBounds:a,letterCaseArray:o})}addText(e,t,i){let r,n,o;u.copy(t);let a=this.m_defaultLayer;if(void 0!==i){if(r=i.path,n=i.pathOverflow,void 0!==i.layer){let e=this.getLayer(i.layer);void 0===e&&(e=this.addLayer(i.layer)),a=e}void 0!==i.path&&u.set(0,0,u.z),i.letterCaseArray&&(o=i.letterCaseArray)}const s=a.storage.drawCount,l=this.placeText({input:e,textPath:r,textPathOverflow:n,layer:a,letterCaseArray:o});return l&&void 0!==i?(!0===i.updatePosition&&t.copy(u),void 0!==i.pickingData&&a.storage.addPickingData(s,a.storage.drawCount,i.pickingData)):l||(a.storage.m_drawCount=s),l}createTextBufferObject(e,t){let i,o;u.set(0,0,0);const s=this.m_currentTextRenderStyle.fontVariant===a.FontVariant.SmallCaps;if("string"!=typeof e)i=e,void 0!==t&&t.letterCaseArray&&(o=t.letterCaseArray);else if(o=[],i=this.m_fontCatalog.getGlyphs(e,this.m_currentTextRenderStyle,s?o:void 0),void 0===i)return;let l,c,d,m,p,f;return void 0!==t&&(l=t.path,c=t.pathOverflow,!0===t.outputBounds&&(d=new r.Box2),!0===t.outputCharacterBounds&&(m=[]),!0===t.storeStyles&&(p=this.m_currentTextRenderStyle.clone(),f=this.m_currentTextLayoutStyle.clone())),this.placeText({input:e,layer:this.m_defaultLayer,computeTextBuffer:!0,textPath:l,textPathOverflow:c,bounds:d,individualBounds:m,letterCaseArray:o}),new n.TextBufferObject(i,new Float32Array(h),d,m,p,f)}addTextBufferObject(e,t){var i;let r,n,o,a,s,l,c,u=this.m_defaultLayer;if(void 0!==t){if(void 0!==t.layer){let e=this.getLayer(t.layer);void 0===e&&(e=this.addLayer(t.layer)),u=e}r=null===(i=t.position)||void 0===i?void 0:i.clone(),n=t.scale,o=t.rotation,a=t.color,s=t.opacity,l=t.backgroundColor,c=t.backgroundOpacity}const d=u.storage.drawCount,h=u.storage.addTextBufferObject(e,r,n,o,a,s,l,c);return h&&void 0!==t?void 0!==t.pickingData&&u.storage.addPickingData(d,u.storage.drawCount,t.pickingData):h||(u.storage.m_drawCount=d),h}pickText(e,t){for(const i of this.m_layers)i.storage.pick(e,t)}getMemoryUsage(e){this.m_fontCatalog.updateMemoryUsage(e);for(const t of this.m_layers)t.storage.updateMemoryUsage(e)}placeText(e){if(0===e.input.length||0===this.m_currentTextLayoutStyle.maxLines)return void 0!==e.bounds&&(e.bounds.min.set(0,0),e.bounds.max.set(0,0)),void 0!==e.individualBounds&&(e.individualBounds.length=0),!0;let t,i;const r=this.m_currentTextRenderStyle.fontVariant===a.FontVariant.SmallCaps;if("string"!=typeof e.input)t=e.input,e.letterCaseArray&&(i=e.letterCaseArray);else if(i=[],t=this.m_fontCatalog.getGlyphs(e.input,this.m_currentTextRenderStyle,r?i:void 0),void 0===t)return!1;let n;void 0!==e.individualBounds&&(d.array=e.individualBounds,d.offset=0,n=d),void 0!==e.bounds&&(e.bounds.min.set(1/0,1/0),e.bounds.max.set(-1/0,-1/0)),!0===e.computeTextBuffer&&(h=new Float32Array(t.length*o.QUAD_VERTEX_MEMORY_FOOTPRINT));const s=void 0!==e.textPath,l={glyphs:t,fontCatalog:this.m_fontCatalog,textRenderStyle:this.m_currentTextRenderStyle,textLayoutStyle:this.m_currentTextLayoutStyle,position:u,geometry:e.layer.storage,smallCapsArray:r?i:void 0,globalBounds:e.bounds,individualBounds:n,vertexBuffer:!0===e.computeTextBuffer?h:void 0};let c=!0;return s?(Object.assign(l,{path:e.textPath,pathOverflow:!0===e.textPathOverflow}),c=this.m_pathTypesetter.arrangeGlyphs(l)):c=this.m_lineTypesetter.arrangeGlyphs(l),void 0!==n&&(n.array.length=n.offset),c}}t.TextCanvas=m,m.defaultTextRenderStyle=new a.TextRenderStyle,m.defaultTextLayoutStyle=new a.TextLayoutStyle},2154:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontCatalog=void 0;const r=i(84428),n=i(15200),o=i(2226),a=i(43552),s=i(51662),l="_BoldAssets/",c="_ItalicAssets/";class u{constructor(e,t,i,r,n,o,s,l,c,u,d){this.url=e,this.name=t,this.type=i,this.size=r,this.maxWidth=n,this.maxHeight=o,this.distanceRange=s,this.fonts=l,this.unicodeBlocks=c,this.maxCodePointCount=u,this.m_replacementGlyph=d,this.showReplacementGlyphs=!1,this.m_glyphTextureCache=new a.GlyphTextureCache(u,this.maxWidth+1,this.maxHeight+1),this.m_loadingJson=new Map,this.m_loadingPages=new Map,this.m_loadingGlyphs=new Map,this.m_loadedJson=new Map,this.m_loadedPages=new Map,this.m_loadedGlyphs=new Map}static async load(e,t){const i=new URL(e,window.location.href),n=await u.loadJSON(i.href),a=new URL(`${n.name}_Assets/Extra/`,i),s=await u.loadJSON(a.href+"Specials.json"),l=await u.loadTexture(a.href+"Specials.png");l.wrapS=r.ClampToEdgeWrapping,l.wrapT=r.ClampToEdgeWrapping,l.minFilter=r.NearestFilter,l.needsUpdate=!0;const c=n.fonts.find((e=>"Extra"===e.name)),d=new o.GlyphData(65533,"Specials",s.chars[0].width,s.chars[0].height,s.chars[0].xadvance,s.chars[0].xoffset,s.chars[0].yoffset,0,0,1,1,l,c,!0);return new u(i.href.substr(0,i.href.lastIndexOf("/")),n.name,n.type,n.size,n.maxWidth,n.maxHeight,n.distanceRange,n.fonts,n.supportedBlocks,t,d)}static async loadTexture(e){return await new Promise((t=>{(new r.TextureLoader).load(e,t)}))}static async loadJSON(e){const t=await fetch(e);if(!t.ok)throw new Error(`${e} Status Text:  ${t.statusText}`);const i=await t.text();return JSON.parse(i)}dispose(){this.fonts.length=0,this.unicodeBlocks.length=0,this.m_glyphTextureCache.dispose(),this.m_loadingJson.clear(),this.m_loadingPages.clear(),this.m_loadingGlyphs.clear(),this.m_loadedJson.clear(),this.m_loadedPages.clear(),this.m_loadedGlyphs.clear()}clear(){this.m_glyphTextureCache.clear(),this.m_loadingJson.clear(),this.m_loadingPages.clear(),this.m_loadingGlyphs.clear(),this.m_loadedJson.clear(),this.m_loadedPages.clear(),this.m_loadedGlyphs.clear()}update(e){this.m_glyphTextureCache.update(e)}get texture(){return this.m_glyphTextureCache.texture}get textureSize(){return this.m_glyphTextureCache.textureSize}get isLoading(){return this.m_loadingJson.size>0||this.m_loadingPages.size>0||this.m_loadingGlyphs.size>0}async loadBlock(e,t,i,r){const n=this.getAssetsPath(i,t),o=`${n}/${e.name.replace(/ /g,"_")}.json`;let a=this.m_loadedJson.get(o);if(void 0===a){let e=this.m_loadingJson.get(o);if(void 0===e)try{e=u.loadJSON(o),this.m_loadingJson.set(o,e),a=await e,this.m_loadingJson.delete(o),this.m_loadedJson.set(o,a)}catch(e){console.error(e),this.m_loadingJson.delete(o)}else a=await e}const s=[];if(!0===r)for(const e of a.pages)s.push(this.loadPage(`${n}/${e}`));return await Promise.all(s),a}removeBlock(e,t,i){const r=this.getAssetsPath(i,t),n=`${r}/${e.name.replace(/ /g,"_")}.json`,o=this.m_loadedJson.get(n);if(void 0!==o){for(const e of o.pages){const t=`${r}/${e}`;this.m_loadingPages.delete(t),this.m_loadedPages.delete(t)}this.m_loadingJson.delete(n),this.m_loadedJson.delete(n)}}async loadCharset(e,t){const i=t.fontName,r=t.fontStyle,n=(t.fontVariant===s.FontVariant.AllCaps||t.fontVariant===s.FontVariant.SmallCaps?e.toUpperCase():e).replace(/[\s\S](?=([\s\S]+))/g,((e,t)=>t.indexOf(e)+1?"":e)),o=[];for(const e of n){const t=e.codePointAt(0),n=this.getFont(t,i),a=`${n.name}_${r}`,s=`${a}_${t}`;let l=this.m_loadedGlyphs.get(a);void 0===l&&(l=new Map,this.m_loadedGlyphs.set(a,l));const c=l.get(t);if(void 0===c){let i=this.m_loadingGlyphs.get(s);if(void 0===i){if(!n.charset.includes(String.fromCodePoint(t))){const i=this.createReplacementGlyph(t,e,n);l.set(t,i),this.m_glyphTextureCache.add(s,i);continue}let o;for(const e of this.unicodeBlocks)if(t>=e.min&&t<=e.max){o=e;break}i=this.loadAssets(t,r,o,n),this.m_loadingGlyphs.set(s,i),i.then((e=>{this.m_loadingGlyphs.delete(s),l.set(t,e),this.m_glyphTextureCache.add(s,e)}))}o.push(i)}else this.m_glyphTextureCache.has(s)||(o.push(Promise.resolve(c)),this.m_glyphTextureCache.add(s,c))}return Promise.all(o)}getGlyph(e,t,i){const r=this.m_loadedGlyphs.get(`${t.name}_${i}`);if(void 0!==r)return r.get(e)}getGlyphs(e,t,i){const r=[],n=t.fontName,o=t.fontStyle,a=t.fontVariant,l=a===s.FontVariant.AllCaps||a===s.FontVariant.SmallCaps;for(const t of e){const e=l?t.toUpperCase():t;for(const a of e){const e=a.codePointAt(0),s=this.getFont(e,n),l=this.getGlyph(e,s,o);if(void 0===l||l.isReplacement&&!this.showReplacementGlyphs)return;r.push(l),void 0!==i&&i.push(a!==t)}}return r}getFont(e,t){let i=this.fonts[0].name;for(const r of this.unicodeBlocks)if(e>=r.min&&e<=r.max){i=void 0!==t&&void 0!==r.fonts.find((e=>e===t))?t:r.fonts[0];break}return this.fonts.find((e=>e.name===i))}updateMemoryUsage(e){let t=0;for(const e of this.unicodeBlocks)t+=2*(e.max-e.min);let i=this.m_glyphTextureCache.textureSize.x*this.m_glyphTextureCache.textureSize.y*4;for(const e in this.m_loadedPages.entries)if(void 0!==this.m_loadedPages.get(e)){const t=this.m_loadedPages.get(e);void 0!==t&&(i+=t.image.width*t.image.height*4)}e.heapSize+=t+i,e.gpuSize+=i}createReplacementGlyph(e,t,i){const r=this.m_replacementGlyph.clone();return r.codePoint=e,r.character=t,r.font=i,r.isReplacement=n.UnicodeUtils.isPrintable(e),r}async loadAssets(e,t,i,r){const n=await this.loadBlock(i,r,t);if(void 0===n)return this.m_replacementGlyph;const a=n.chars.find((t=>t.id===e)),s=`${this.getAssetsPath(t,r)}/${n.pages[a.page]}`,l=await this.loadPage(s);return new o.GlyphData(a.id,i.name,a.width,a.height,a.xadvance,a.xoffset,a.yoffset,a.x/l.image.width,1-(a.y+a.height)/l.image.height,(a.x+a.width)/l.image.width,1-a.y/l.image.height,l,r)}async loadPage(e){let t=this.m_loadedPages.get(e);if(void 0===t){let i=this.m_loadingPages.get(e);void 0===i?(i=u.loadTexture(e),this.m_loadingPages.set(e,i),t=await i,t.wrapS=r.ClampToEdgeWrapping,t.wrapT=r.ClampToEdgeWrapping,t.minFilter=r.NearestFilter,t.needsUpdate=!0,this.m_loadingPages.delete(e)&&this.m_loadedPages.set(e,t),this.m_loadingPages.delete(e)):t=await i}return t}getAssetsPath(e,t){let i="_Assets/";switch(e){case s.FontStyle.Bold:void 0!==t.bold&&(i=l);break;case s.FontStyle.Italic:void 0!==t.italic&&(i=c);break;case s.FontStyle.BoldItalic:void 0!==t.boldItalic?i="_BoldItalicAssets/":void 0!==t.italic?i=c:void 0!==t.bold&&(i=l)}return`${this.url}/${this.name}${i}${t.name}`}}t.FontCatalog=u},2226:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphData=void 0;const r=i(84428),n=i(15200);class o{constructor(e,t,i,o,a,s,l,c,u,d,h,m,p,f=!1){this.codePoint=e,this.block=t,this.width=i,this.height=o,this.advanceX=a,this.offsetX=s,this.offsetY=l,this.texture=m,this.font=p,this.isReplacement=f,this.positions=[],this.sourceTextureCoordinates=[],this.dynamicTextureCoordinates=[],this.copyIndex=0,this.isInCache=!1,this.character=String.fromCodePoint(e),this.direction=n.UnicodeUtils.getDirection(e,t);const g=this.offsetX,y=g+this.width,v=p.metrics.lineHeight-this.offsetY,_=v-this.height;this.positions.push(new r.Vector3(g,_,1),new r.Vector3(y,_,1),new r.Vector3(g,v,1),new r.Vector3(y,v,1)),this.sourceTextureCoordinates.push(new r.Vector2(c,u),new r.Vector2(d,u),new r.Vector2(c,h),new r.Vector2(d,h)),this.dynamicTextureCoordinates.push(new r.Vector2(0,0),new r.Vector2(1,0),new r.Vector2(0,1),new r.Vector2(1,1))}clone(){return new o(this.codePoint,this.block,this.width,this.height,this.advanceX,this.offsetX,this.offsetY,this.sourceTextureCoordinates[0].x,this.sourceTextureCoordinates[0].y,this.sourceTextureCoordinates[3].x,this.sourceTextureCoordinates[3].y,this.texture,this.font,this.isReplacement)}}t.GlyphData=o},43552:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphTextureCache=void 0;const r=i(45772),n=i(84428),o=i(2226),a=i(74095);t.GlyphTextureCache=class{constructor(e,t,i){this.capacity=e,this.entryWidth=t,this.entryHeight=i;const o=Math.floor(Math.sqrt(e));this.m_cacheHeight=o*o<e?o+1:o,this.m_cacheWidth=o*this.m_cacheHeight<e?o+1:o,this.m_textureSize=new n.Vector2(this.m_cacheWidth*t,this.m_cacheHeight*i),(this.m_textureSize.y>4096||this.m_textureSize.x>4096)&&console.warn("GlyphTextureCache texture size ("+this.m_textureSize.x+", "+this.m_textureSize.y+") exceeds WebGL's widely supported MAX_TEXTURE_SIZE (4096).\nThis could result in rendering errors on some devices.\nPlease consider reducing its capacity or input assets size."),this.m_entryCache=new r.LRUCache(e),this.initCacheEntries(),this.m_scene=new n.Scene,this.m_camera=new n.OrthographicCamera(0,this.m_textureSize.x,this.m_textureSize.y,0),this.m_camera.position.z=1,this.m_camera.updateMatrixWorld(!1),this.m_rt=new n.WebGLRenderTarget(this.m_textureSize.x,this.m_textureSize.y,{wrapS:n.ClampToEdgeWrapping,wrapT:n.ClampToEdgeWrapping,depthBuffer:!1,stencilBuffer:!1}),this.m_copyTextureSet=new Set,this.m_copyTransform=new n.Matrix3,this.m_copyPositions=[],this.m_copyPositions.push(new n.Vector2,new n.Vector2,new n.Vector2,new n.Vector2),this.m_copyVertexBuffer=new n.InterleavedBuffer(new Float32Array(20*e),5),this.m_copyVertexBuffer.setUsage(n.DynamicDrawUsage),this.m_copyPositionAttribute=new n.InterleavedBufferAttribute(this.m_copyVertexBuffer,3,0),this.m_copyUVAttribute=new n.InterleavedBufferAttribute(this.m_copyVertexBuffer,2,3),this.m_copyGeometry=new n.BufferGeometry,this.m_copyGeometry.setAttribute("position",this.m_copyPositionAttribute),this.m_copyGeometry.setAttribute("uv",this.m_copyUVAttribute);const a=new n.BufferAttribute(new Uint32Array(6*e),1);a.setUsage(n.DynamicDrawUsage),this.m_copyGeometry.setIndex(a),this.m_copyMesh=new n.Mesh(this.m_copyGeometry),this.m_copyMesh.frustumCulled=!1,this.m_copyGeometryDrawCount=0,this.m_clearPositionAttribute=new n.BufferAttribute(new Float32Array(8*e),2),this.m_clearPositionAttribute.setUsage(n.DynamicDrawUsage),this.m_clearGeometry=new n.BufferGeometry,this.m_clearGeometry.setAttribute("position",this.m_clearPositionAttribute);const s=new n.BufferAttribute(new Uint32Array(6*e),1);s.setUsage(n.DynamicDrawUsage),this.m_clearGeometry.setIndex(s),this.m_clearMesh=new n.Mesh(this.m_clearGeometry),this.m_clearMesh.frustumCulled=!1,this.m_clearGeometryDrawCount=0,this.m_scene.add(this.m_clearMesh,this.m_copyMesh)}dispose(){var e,t;this.m_entryCache.clear(),this.m_scene.remove(this.m_clearMesh,this.m_copyMesh),this.m_rt.dispose(),null===(e=this.m_clearMaterial)||void 0===e||e.dispose(),null===(t=this.m_copyMaterial)||void 0===t||t.dispose(),this.m_copyTextureSet.clear(),this.m_clearGeometry.dispose(),this.m_copyGeometry.dispose()}get texture(){return this.m_rt.texture}get textureSize(){return this.m_textureSize}add(e,t){if(void 0!==this.m_entryCache.get(e))return;const i=this.m_entryCache.oldest;if(null===i)throw new Error("GlyphTextureCache is uninitialized!");this.clearCacheEntry(i.value),this.copyGlyphToCache(e,t,i.value.location)}has(e){return this.m_entryCache.has(e)}get(e){return this.m_entryCache.get(e)}clear(){this.m_copyGeometryDrawCount=0,this.m_clearGeometryDrawCount=0,this.m_entryCache.clear(),this.m_copyTextureSet.clear(),this.initCacheEntries()}update(e){let t=null;const i=this.m_clearGeometryDrawCount>0,r=this.m_copyGeometryDrawCount>0;if((i||r)&&(t=e.getRenderTarget(),e.setRenderTarget(this.m_rt)),i){if(this.m_clearMaterial||(this.m_clearMaterial=new a.GlyphClearMaterial({rendererCapabilities:e.capabilities}),this.m_clearMesh.material=this.m_clearMaterial),null===this.m_clearGeometry.index)throw new Error("GlyphTextureCache clear geometry index is uninitialized!");this.m_clearPositionAttribute.needsUpdate=!0,this.m_clearPositionAttribute.updateRange.offset=0,this.m_clearPositionAttribute.updateRange.count=8*this.m_clearGeometryDrawCount,this.m_clearGeometry.index.needsUpdate=!0,this.m_clearGeometry.index.updateRange.offset=0,this.m_clearGeometry.index.updateRange.count=6*this.m_clearGeometryDrawCount,this.m_clearGeometry.setDrawRange(0,6*this.m_clearGeometryDrawCount),this.m_clearMesh.visible=!0,this.m_copyMesh.visible=!1,e.render(this.m_scene,this.m_camera),this.m_clearGeometryDrawCount=0,this.m_clearMesh.visible=!1}if(r){if(this.m_copyMaterial||(this.m_copyMaterial=new a.GlyphCopyMaterial({rendererCapabilities:e.capabilities}),this.m_copyMesh.material=this.m_copyMaterial),null===this.m_copyGeometry.index)throw new Error("GlyphTextureCache copy geometry index is uninitialized!");this.m_copyVertexBuffer.needsUpdate=!0,this.m_copyVertexBuffer.updateRange.offset=0,this.m_copyVertexBuffer.updateRange.count=20*this.m_copyGeometryDrawCount,this.m_copyGeometry.index.needsUpdate=!0,this.m_copyGeometry.index.updateRange.offset=0,this.m_copyGeometry.index.updateRange.count=6*this.m_copyGeometryDrawCount,this.m_copyGeometry.setDrawRange(0,6*this.m_copyGeometryDrawCount),this.m_copyMesh.visible=!0;const t=Array.from(this.m_copyTextureSet),i=Math.ceil(this.m_copyTextureSet.size/8);for(let r=0;r<i;r++){const i=8*r;this.m_copyMaterial.uniforms.pageOffset.value=i;for(let e=0;e<8;e++){const r=i+e;r<this.m_copyTextureSet.size&&(this.m_copyMaterial.uniforms["page"+e].value=t[r])}e.render(this.m_scene,this.m_camera)}this.m_copyTextureSet.clear(),this.m_copyGeometryDrawCount=0}(i||r)&&e.setRenderTarget(t)}initCacheEntries(){const e=new o.GlyphData(0,"",0,0,0,0,0,0,0,0,0,n.Texture.DEFAULT_IMAGE,{name:"",metrics:{size:0,distanceRange:0,base:0,lineHeight:0,lineGap:0,capHeight:0,xHeight:0},charset:""});for(let t=0;t<this.m_cacheHeight;t++)for(let i=0;i<this.m_cacheWidth;i++){const r={glyphData:e,location:new n.Vector2(i,t)};this.m_entryCache.set(`Dummy_${t*this.m_cacheHeight+i}`,r)}}copyGlyphToCache(e,t,i){this.m_copyTextureSet.add(t.texture);let r=0;for(const e of this.m_copyTextureSet.values()){if(e===t.texture)break;r++}t.copyIndex=r,this.m_copyTransform.set(1,0,i.x*this.entryWidth-t.offsetX,0,1,i.y*this.entryHeight-t.positions[0].y,0,0,0);for(let e=0;e<4;++e)this.m_copyPositions[e].set(t.positions[e].x,t.positions[e].y),this.m_copyPositions[e].applyMatrix3(this.m_copyTransform);if(this.m_copyGeometryDrawCount>=this.capacity)return;const n=4*this.m_copyGeometryDrawCount,o=6*this.m_copyGeometryDrawCount;for(let e=0;e<4;++e)this.m_copyPositionAttribute.setXYZ(n+e,this.m_copyPositions[e].x,this.m_copyPositions[e].y,t.copyIndex),this.m_copyUVAttribute.setXY(n+e,t.sourceTextureCoordinates[e].x,t.sourceTextureCoordinates[e].y);if(null===this.m_copyGeometry.index)throw new Error("GlyphTextureCache copy geometry index is uninitialized!");this.m_copyGeometry.index.setX(o,n),this.m_copyGeometry.index.setX(o+1,n+1),this.m_copyGeometry.index.setX(o+2,n+2),this.m_copyGeometry.index.setX(o+3,n+2),this.m_copyGeometry.index.setX(o+4,n+1),this.m_copyGeometry.index.setX(o+5,n+3),++this.m_copyGeometryDrawCount;const a=this.m_copyPositions[0].x/this.m_textureSize.x,s=this.m_copyPositions[0].y/this.m_textureSize.y,l=this.m_copyPositions[3].x/this.m_textureSize.x,c=this.m_copyPositions[3].y/this.m_textureSize.y;t.dynamicTextureCoordinates[0].set(a,s),t.dynamicTextureCoordinates[1].set(l,s),t.dynamicTextureCoordinates[2].set(a,c),t.dynamicTextureCoordinates[3].set(l,c),t.isInCache=!0,this.m_entryCache.set(e,{glyphData:t,location:i})}clearCacheEntry(e){if(e.glyphData.isInCache=!1,this.m_copyPositions[0].set(e.location.x*this.entryWidth,e.location.y*this.entryHeight),this.m_copyPositions[1].set((e.location.x+1)*this.entryWidth,e.location.y*this.entryHeight),this.m_copyPositions[2].set(e.location.x*this.entryWidth,(e.location.y+1)*this.entryHeight),this.m_copyPositions[3].set((e.location.x+1)*this.entryWidth,(e.location.y+1)*this.entryHeight),this.m_clearGeometryDrawCount>=this.capacity)return;const t=4*this.m_clearGeometryDrawCount,i=6*this.m_clearGeometryDrawCount;for(let e=0;e<4;++e)this.m_clearPositionAttribute.setXY(t+e,this.m_copyPositions[e].x,this.m_copyPositions[e].y);if(null===this.m_clearGeometry.index)throw new Error("GlyphTextureCache clear geometry index is uninitialized!");this.m_clearGeometry.index.setX(i,t),this.m_clearGeometry.index.setX(i+1,t+1),this.m_clearGeometry.index.setX(i+2,t+2),this.m_clearGeometry.index.setX(i+3,t+2),this.m_clearGeometry.index.setX(i+4,t+1),this.m_clearGeometry.index.setX(i+5,t+3),++this.m_clearGeometryDrawCount}}},27827:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextBufferObject=void 0,t.TextBufferObject=class{constructor(e,t,i,r,n,o){this.glyphs=e,this.buffer=t,this.bounds=i,this.characterBounds=r,this.textRenderStyle=n,this.textLayoutStyle=o}}},17309:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextGeometry=t.QUAD_INDEX_MEMORY_FOOTPRINT=t.QUAD_VERTEX_MEMORY_FOOTPRINT=t.INDICES_PER_QUAD=t.VERTICES_PER_QUAD=t.INDEX_BUFFER_STRIDE=t.VERTEX_BUFFER_STRIDE=t.MAX_CAPACITY=void 0;const r=i(84428);t.MAX_CAPACITY=65536,t.VERTEX_BUFFER_STRIDE=16,t.INDEX_BUFFER_STRIDE=1,t.VERTICES_PER_QUAD=4,t.INDICES_PER_QUAD=6,t.QUAD_VERTEX_MEMORY_FOOTPRINT=t.VERTICES_PER_QUAD*t.VERTEX_BUFFER_STRIDE,t.QUAD_INDEX_MEMORY_FOOTPRINT=t.INDICES_PER_QUAD*t.INDEX_BUFFER_STRIDE,t.TextGeometry=class{constructor(e,i,n,o,a){this.scene=e,this.m_pickingDataArray=[],this.capacity=Math.min(a,t.MAX_CAPACITY),this.m_currentCapacity=Math.min(o,a),this.m_drawCount=0,this.m_updateOffset=0,this.m_vertexBuffer=new r.InterleavedBuffer(new Float32Array(this.m_currentCapacity*t.QUAD_VERTEX_MEMORY_FOOTPRINT),t.VERTEX_BUFFER_STRIDE),this.m_vertexBuffer.setUsage(r.DynamicDrawUsage),this.m_positionAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,0),this.m_uvAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,4),this.m_colorAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,8),this.m_bgColorAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,12),this.m_indexBuffer=new r.BufferAttribute(new Uint32Array(this.m_currentCapacity*t.QUAD_INDEX_MEMORY_FOOTPRINT),t.INDEX_BUFFER_STRIDE),this.m_indexBuffer.setUsage(r.DynamicDrawUsage),this.m_geometry=new r.BufferGeometry,this.m_geometry.setAttribute("position",this.m_positionAttribute),this.m_geometry.setAttribute("uv",this.m_uvAttribute),this.m_geometry.setAttribute("color",this.m_colorAttribute),this.m_geometry.setAttribute("bgColor",this.m_bgColorAttribute),this.m_geometry.setIndex(this.m_indexBuffer),this.m_mesh=new r.Mesh(this.m_geometry,i),this.m_bgMesh=new r.Mesh(this.m_geometry,n),this.m_mesh.renderOrder=Number.MAX_SAFE_INTEGER,this.m_bgMesh.renderOrder=Number.MAX_SAFE_INTEGER-1,this.m_mesh.frustumCulled=!1,this.m_bgMesh.frustumCulled=!1,this.scene.add(this.m_bgMesh,this.m_mesh)}get drawCount(){return this.m_drawCount}get mesh(){return this.m_mesh}get backgroundMesh(){return this.m_bgMesh}dispose(){this.scene.remove(this.m_bgMesh,this.m_mesh),this.m_geometry.dispose()}clear(){this.m_drawCount=0,this.m_updateOffset=0,this.m_pickingDataArray.length=0}update(){this.drawCount>this.m_updateOffset&&(this.m_vertexBuffer.needsUpdate=!0,this.m_vertexBuffer.updateRange.offset=this.m_updateOffset*t.QUAD_VERTEX_MEMORY_FOOTPRINT,this.m_vertexBuffer.updateRange.count=(this.m_drawCount-this.m_updateOffset)*t.QUAD_VERTEX_MEMORY_FOOTPRINT,this.m_indexBuffer.needsUpdate=!0,this.m_indexBuffer.updateRange.offset=this.m_updateOffset*t.QUAD_INDEX_MEMORY_FOOTPRINT,this.m_indexBuffer.updateRange.count=(this.m_drawCount-this.m_updateOffset)*t.QUAD_INDEX_MEMORY_FOOTPRINT),this.m_updateOffset=this.m_drawCount,this.m_geometry.setDrawRange(0,this.m_drawCount*t.INDICES_PER_QUAD)}add(e,i,r,n,o,a){if(this.m_drawCount>=this.capacity)return!1;if(this.m_drawCount>=this.m_currentCapacity){const e=Math.min(2*this.m_currentCapacity,this.capacity);this.resizeBuffers(e)}const s=this.m_drawCount*t.VERTICES_PER_QUAD,l=this.m_drawCount*t.INDICES_PER_QUAD;for(let l=0;l<t.VERTICES_PER_QUAD;++l){this.m_positionAttribute.setXYZW(s+l,i[l].x,i[l].y,i[l].z,(o?-1:1)*a.rotation);const t=o?(l+1)%2+2*Math.floor(l/2):l;this.m_uvAttribute.setXYZW(s+l,e.dynamicTextureCoordinates[t].x,e.dynamicTextureCoordinates[t].y,r,n),this.m_colorAttribute.setXYZW(s+l,a.color.r,a.color.g,a.color.b,a.opacity),this.m_bgColorAttribute.setXYZW(s+l,a.backgroundColor.r,a.backgroundColor.g,a.backgroundColor.b,a.backgroundOpacity)}return this.m_indexBuffer.setX(l,s),this.m_indexBuffer.setX(l+1,s+1),this.m_indexBuffer.setX(l+2,s+2),this.m_indexBuffer.setX(l+3,s+2),this.m_indexBuffer.setX(l+4,s+1),this.m_indexBuffer.setX(l+5,s+3),++this.m_drawCount,!0}addToBuffer(e,i,r,n,o,a,s,l){for(let c=0;c<t.VERTICES_PER_QUAD;++c){const u=i+t.VERTEX_BUFFER_STRIDE*c;e[u]=n[c].x,e[u+1]=n[c].y,e[u+2]=n[c].z,e[u+3]=(s?-1:1)*l.rotation;const d=s?(c+1)%2+2*Math.floor(c/2):c;e[u+4]=r.dynamicTextureCoordinates[d].x,e[u+5]=r.dynamicTextureCoordinates[d].y,e[u+6]=o,e[u+7]=a,e[u+8]=l.color.r,e[u+9]=l.color.g,e[u+10]=l.color.b,e[u+11]=l.opacity,e[u+12]=l.backgroundColor.r,e[u+13]=l.backgroundColor.g,e[u+14]=l.backgroundColor.b,e[u+15]=l.backgroundOpacity}}addTextBufferObject(e,i,r,n,o,a,s,l){if(this.m_drawCount+e.glyphs.length>=this.capacity)return!1;if(this.m_drawCount+e.glyphs.length>=this.m_currentCapacity){const e=Math.min(2*this.m_currentCapacity,this.capacity);this.resizeBuffers(e)}const c=null!=r?r:1,u=null!=n?n:0,d=Math.cos(u),h=Math.sin(u),m=void 0!==i?i.x:0,p=void 0!==i?i.y:0,f=e.buffer,g=f[3]<0?-1:1,y=void 0!==o?o.r:f[8],v=void 0!==o?o.g:f[9],_=void 0!==o?o.b:f[10],b=void 0!==a?a:f[11],S=void 0!==s?s.r:f[12],T=void 0!==s?s.g:f[13],E=void 0!==s?s.b:f[14],C=void 0!==l?l:f[15],w=this.m_drawCount*t.VERTICES_PER_QUAD;for(let i=0;i<e.glyphs.length;++i){const r=i*t.QUAD_VERTEX_MEMORY_FOOTPRINT,n=e.glyphs[i];if(!n.isInCache)return!1;const o=f[r+4]>f[r+t.VERTEX_BUFFER_STRIDE+4],a=f[r+6],s=f[r+7];for(let e=0;e<t.VERTICES_PER_QUAD;++e){const l=f[r+e*t.VERTEX_BUFFER_STRIDE],x=f[r+e*t.VERTEX_BUFFER_STRIDE+1];this.m_positionAttribute.setXYZW(w+i*t.VERTICES_PER_QUAD+e,l*c*d+x*c*-h+m,l*c*h+x*c*d+p,f[r+e*t.VERTEX_BUFFER_STRIDE+2]+0,f[r+e*t.VERTEX_BUFFER_STRIDE+3]+g*u);const P=o?(e+1)%2+2*Math.floor(e/2):e;this.m_uvAttribute.setXYZW(w+i*t.VERTICES_PER_QUAD+e,n.dynamicTextureCoordinates[P].x,n.dynamicTextureCoordinates[P].y,a,(s-a)/c+a),this.m_colorAttribute.setXYZW(w+i*t.VERTICES_PER_QUAD+e,y,v,_,b),this.m_bgColorAttribute.setXYZW(w+i*t.VERTICES_PER_QUAD+e,S,T,E,C)}this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD,(this.m_drawCount+i)*t.VERTICES_PER_QUAD),this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD+1,(this.m_drawCount+i)*t.VERTICES_PER_QUAD+1),this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD+2,(this.m_drawCount+i)*t.VERTICES_PER_QUAD+2),this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD+3,(this.m_drawCount+i)*t.VERTICES_PER_QUAD+2),this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD+4,(this.m_drawCount+i)*t.VERTICES_PER_QUAD+1),this.m_indexBuffer.setX((this.m_drawCount+i)*t.INDICES_PER_QUAD+5,(this.m_drawCount+i)*t.VERTICES_PER_QUAD+3)}return this.m_drawCount+=e.glyphs.length,!0}addPickingData(e,t,i){return!(this.m_pickingDataArray.length>=this.m_currentCapacity||(this.m_pickingDataArray.push({start:Math.min(e,this.capacity),end:Math.min(t,this.capacity),data:i}),0))}pick(e,i){for(const r of this.m_pickingDataArray){if(void 0===r)return;for(let n=r.start;n<r.end;++n){const o=n*t.VERTICES_PER_QUAD,a=Math.min(this.m_positionAttribute.getX(o+2),this.m_positionAttribute.getX(o+1));if(e.x<a)continue;const s=Math.max(this.m_positionAttribute.getX(o+2),this.m_positionAttribute.getX(o+1));if(e.x>s)continue;const l=Math.min(this.m_positionAttribute.getY(o+2),this.m_positionAttribute.getY(o+1));if(e.y<l)continue;const c=Math.max(this.m_positionAttribute.getY(o+2),this.m_positionAttribute.getY(o+1));if(!(e.y>c)){i(r.data);break}}}}updateMemoryUsage(e){const t=4*this.m_vertexBuffer.count+4*this.m_indexBuffer.count;e.heapSize+=t,e.gpuSize+=t}resizeBuffers(e){this.m_currentCapacity=e;const i=new Float32Array(e*t.QUAD_VERTEX_MEMORY_FOOTPRINT);i.set(this.m_vertexBuffer.array),this.m_vertexBuffer=new r.InterleavedBuffer(i,t.VERTEX_BUFFER_STRIDE),this.m_vertexBuffer.setUsage(r.DynamicDrawUsage),this.m_positionAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,0),this.m_uvAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,4),this.m_colorAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,8),this.m_bgColorAttribute=new r.InterleavedBufferAttribute(this.m_vertexBuffer,4,12);const n=new Uint32Array(e*t.QUAD_INDEX_MEMORY_FOOTPRINT);n.set(this.m_indexBuffer.array),this.m_indexBuffer=new r.BufferAttribute(n,t.INDEX_BUFFER_STRIDE),this.m_indexBuffer.setUsage(r.DynamicDrawUsage),this.m_geometry.dispose(),this.m_geometry=new r.BufferGeometry,this.m_geometry.setAttribute("position",this.m_positionAttribute),this.m_geometry.setAttribute("uv",this.m_uvAttribute),this.m_geometry.setAttribute("color",this.m_colorAttribute),this.m_geometry.setAttribute("bgColor",this.m_bgColorAttribute),this.m_geometry.setIndex(this.m_indexBuffer),this.m_pickingDataArray.length=this.m_currentCapacity,this.scene.remove(this.m_bgMesh,this.m_mesh),this.m_mesh=new r.Mesh(this.m_geometry,this.m_mesh.material),this.m_bgMesh=new r.Mesh(this.m_geometry,this.m_bgMesh.material),this.m_mesh.renderOrder=Number.MAX_SAFE_INTEGER,this.m_bgMesh.renderOrder=Number.MAX_SAFE_INTEGER-1,this.m_mesh.frustumCulled=!1,this.m_bgMesh.frustumCulled=!1,this.scene.add(this.m_bgMesh,this.m_mesh)}}},74095:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SdfTextMaterial=t.GlyphCopyMaterial=t.GlyphClearMaterial=void 0;const r=i(38338),n=i(84428);Object.assign(n.ShaderChunk,{sdf_attributes:"\n        attribute vec4 position;\n        attribute vec4 uv;\n        attribute vec4 color;\n        attribute vec4 bgColor;\n        ",sdf_varying:"\n        varying vec4 vColor;\n        varying float vWeight;\n        varying vec2 vUv;\n        varying float vRotation;\n        ",sdf_varying_computation:"\n        #if BG_TEXT\n        vColor = bgColor;\n        vWeight = uv.w;\n        #else\n        vColor = color;\n        vWeight = uv.z;\n        #endif\n        vUv = vec2(uv.xy);\n        vRotation = position.w;\n        ",sdf_frag_uniforms:"\n        uniform sampler2D sdfTexture;\n        uniform vec4 sdfParams;\n        ",sdf_sampling_functions:"\n        float median(float r, float g, float b) {\n            return max(min(r, g), min(max(r, g), b));\n        }\n\n        float getDistance(vec2 uvOffset) {\n            vec3 texSample = texture2D(sdfTexture, vUv.xy + uvOffset).rgb;\n            #if MSDF\n            return median(texSample.r, texSample.g, texSample.b);\n            #else\n            return texSample.r;\n            #endif\n        }\n\n        float getOpacity(vec2 uvOffset, float weight) {\n            vec2 uv = vUv + uvOffset;\n            vec2 rotatedUVs = abs(vec2(\n                cos(vRotation) * uv.x - sin(vRotation) * uv.y,\n                sin(vRotation) * uv.x + cos(vRotation) * uv.y));\n\n            float dx = dFdx(rotatedUVs.x) * sdfParams.x;\n            float dy = dFdy(rotatedUVs.y) * sdfParams.y;\n            float toPixels = sdfParams.w * inversesqrt( dx * dx + dy * dy );\n\n            float dist = getDistance(uvOffset) + min(weight, 0.5 - 1.0 / sdfParams.w) - 0.5;\n            return clamp(dist * toPixels + 0.5, 0.0, 1.0);\n        }\n        "});class o extends n.RawShaderMaterial{constructor(e){const t=!0===(null==e?void 0:e.rendererCapabilities.isWebGL2),i=e?Object.assign(Object.assign({},e),{glslVersion:t?n.GLSL3:n.GLSL1,vertexShader:t&&e.vertexShader?r.convertVertexShaderToWebGL2(e.vertexShader):e.vertexShader,fragmentShader:t&&e.fragmentShader?r.convertFragmentShaderToWebGL2(e.fragmentShader):e.fragmentShader}):void 0;i&&delete i.rendererCapabilities,super(i)}}t.GlyphClearMaterial=class extends o{constructor(e){super(e?{name:"GlyphClearMaterial",vertexShader:"\n    attribute vec2 position;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    void main() {\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    }",fragmentShader:"\n    precision highp float;\n    precision highp int;\n\n    void main() {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }",uniforms:{},depthTest:!1,depthWrite:!1,rendererCapabilities:e.rendererCapabilities}:void 0)}},t.GlyphCopyMaterial=class extends o{constructor(e){super(e?{name:"GlyphCopyMaterial",vertexShader:"\n    attribute vec3 position;\n    attribute vec2 uv;\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    varying vec3 vUv;\n\n    void main() {\n        vUv = vec3(uv.xy, position.z);\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 0.0, 1.0);\n    }",fragmentShader:"\n    precision highp float;\n    precision highp int;\n\n    uniform float pageOffset;\n    uniform sampler2D page0;\n    uniform sampler2D page1;\n    uniform sampler2D page2;\n    uniform sampler2D page3;\n    uniform sampler2D page4;\n    uniform sampler2D page5;\n    uniform sampler2D page6;\n    uniform sampler2D page7;\n\n    varying vec3 vUv;\n\n    void main() {\n        vec4 texSample = vec4(0.0);\n        if (vUv.z < pageOffset || vUv.z > (pageOffset + 7.0)) discard;\n        else if (vUv.z < pageOffset + 1.0) texSample = texture2D(page0, vUv.xy);\n        else if (vUv.z < pageOffset + 2.0) texSample = texture2D(page1, vUv.xy);\n        else if (vUv.z < pageOffset + 3.0) texSample = texture2D(page2, vUv.xy);\n        else if (vUv.z < pageOffset + 4.0) texSample = texture2D(page3, vUv.xy);\n        else if (vUv.z < pageOffset + 5.0) texSample = texture2D(page4, vUv.xy);\n        else if (vUv.z < pageOffset + 6.0) texSample = texture2D(page5, vUv.xy);\n        else if (vUv.z < pageOffset + 7.0) texSample = texture2D(page6, vUv.xy);\n        else texSample = texture2D(page7, vUv.xy);\n\n        gl_FragColor = texSample;\n    }",uniforms:{pageOffset:new n.Uniform(0),page0:new n.Uniform(n.Texture.DEFAULT_IMAGE),page1:new n.Uniform(n.Texture.DEFAULT_IMAGE),page2:new n.Uniform(n.Texture.DEFAULT_IMAGE),page3:new n.Uniform(n.Texture.DEFAULT_IMAGE),page4:new n.Uniform(n.Texture.DEFAULT_IMAGE),page5:new n.Uniform(n.Texture.DEFAULT_IMAGE),page6:new n.Uniform(n.Texture.DEFAULT_IMAGE),page7:new n.Uniform(n.Texture.DEFAULT_IMAGE)},depthTest:!1,depthWrite:!1,rendererCapabilities:e.rendererCapabilities}:void 0)}},t.SdfTextMaterial=class extends o{constructor(e){super(e?{name:"SdfTextMaterial",vertexShader:void 0!==e.vertexSource?e.vertexSource:"\n    #include <sdf_attributes>\n    #include <sdf_varying>\n\n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n\n    void main() {\n        #include <sdf_varying_computation>\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n    }",fragmentShader:void 0!==e.fragmentSource?e.fragmentSource:"\n    precision highp float;\n    precision highp int;\n\n    #include <sdf_varying>\n    #include <sdf_frag_uniforms>\n    #include <sdf_sampling_functions>\n\n    void main() {\n        vec4 color = vColor;\n        color.a *= getOpacity(vec2(0.0), vWeight);\n        if (color.a < 0.05) {\n            discard;\n        }\n        gl_FragColor = color;\n    }",uniforms:{sdfTexture:new n.Uniform(e.texture),sdfParams:new n.Uniform(new n.Vector4(e.textureSize.x,e.textureSize.y,e.size,e.distanceRange))},defines:{MSDF:e.isMsdf?1:0,BG_TEXT:e.isBackground?1:0},depthTest:!0,depthWrite:!1,side:n.DoubleSide,transparent:!0,rendererCapabilities:e.rendererCapabilities}:void 0),this.extensions.derivatives=!0}}},51662:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePlacementAndAlignment=t.TextLayoutStyle=t.TextRenderStyle=t.DefaultTextStyle=t.vPlacementFromAlignment=t.hPlacementFromAlignment=t.vAlignFromPlacement=t.hAlignFromPlacement=t.WrappingMode=t.HorizontalPlacement=t.VerticalPlacement=t.HorizontalAlignment=t.VerticalAlignment=t.FontVariant=t.FontStyle=t.FontUnit=void 0;const r=i(84428);var n,o,a,s,l,c,u,d,h;!function(e){e[e.Em=0]="Em",e[e.Pixel=1]="Pixel",e[e.Point=2]="Point",e[e.Percent=3]="Percent"}(n=t.FontUnit||(t.FontUnit={})),function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Italic=2]="Italic",e[e.BoldItalic=3]="BoldItalic"}(o=t.FontStyle||(t.FontStyle={})),function(e){e[e.Regular=0]="Regular",e[e.AllCaps=1]="AllCaps",e[e.SmallCaps=2]="SmallCaps"}(a=t.FontVariant||(t.FontVariant={})),function(e){e[e.Above=0]="Above",e[e.Center=-.5]="Center",e[e.Below=-1]="Below"}(s=t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=-.5]="Center",e[e.Right=-1]="Right"}(l=t.HorizontalAlignment||(t.HorizontalAlignment={})),(h=t.VerticalPlacement||(t.VerticalPlacement={}))[h.Top=0]="Top",h[h.Center=-.5]="Center",h[h.Bottom=-1]="Bottom",(d=t.HorizontalPlacement||(t.HorizontalPlacement={}))[d.Left=-1]="Left",d[d.Center=-.5]="Center",d[d.Right=0]="Right",function(e){e[e.None=0]="None",e[e.Character=1]="Character",e[e.Word=2]="Word"}(c=t.WrappingMode||(t.WrappingMode={})),t.hAlignFromPlacement=function(e){return e},t.vAlignFromPlacement=function(e){return e},t.hPlacementFromAlignment=function(e){return e},t.vPlacementFromAlignment=function(e){return e},function(e){e.DEFAULT_FONT_NAME="",e.DEFAULT_FONT_SIZE={unit:Object.freeze(n.Pixel),size:Object.freeze(16),backgroundSize:Object.freeze(0)},e.DEFAULT_FONT_STYLE=o.Regular,e.DEFAULT_FONT_VARIANT=a.Regular,e.DEFAULT_ROTATION=0,e.DEFAULT_COLOR=new r.Color(0),e.DEFAULT_OPACITY=1,e.DEFAULT_BACKGROUND_COLOR=new r.Color(0),e.DEFAULT_BACKGROUND_OPACITY=0,e.DEFAULT_TRACKING=0,e.DEFAULT_LEADING=0,e.DEFAULT_MAX_LINES=1/0,e.DEFAULT_LINE_WIDTH=1/0,e.DEFAULT_CANVAS_ROTATION=0,e.DEFAULT_LINE_ROTATION=0,e.DEFAULT_WRAPPING_MODE=c.Word,e.DEFAULT_VERTICAL_ALIGNMENT=s.Above,e.DEFAULT_HORIZONTAL_ALIGNMENT=l.Left,e.DEFAULT_PLACEMENTS=[]}(u=t.DefaultTextStyle||(t.DefaultTextStyle={}));class m{constructor(e={}){this.m_params={fontName:void 0!==e.fontName?e.fontName:u.DEFAULT_FONT_NAME,fontSize:void 0!==e.fontSize?Object.assign({},e.fontSize):{unit:u.DEFAULT_FONT_SIZE.unit,size:u.DEFAULT_FONT_SIZE.size,backgroundSize:u.DEFAULT_FONT_SIZE.backgroundSize},fontStyle:void 0!==e.fontStyle?e.fontStyle:u.DEFAULT_FONT_STYLE,fontVariant:void 0!==e.fontVariant?e.fontVariant:u.DEFAULT_FONT_VARIANT,rotation:void 0!==e.rotation?e.rotation:u.DEFAULT_ROTATION,color:void 0!==e.color?e.color.clone():u.DEFAULT_COLOR.clone(),opacity:void 0!==e.opacity?e.opacity:u.DEFAULT_OPACITY,backgroundColor:void 0!==e.backgroundColor?e.backgroundColor.clone():u.DEFAULT_BACKGROUND_COLOR.clone(),backgroundOpacity:void 0!==e.backgroundOpacity?e.backgroundOpacity:u.DEFAULT_BACKGROUND_OPACITY}}get params(){return this.m_params}set params(e){this.m_params=Object.assign(Object.assign({},this.m_params),e)}get fontName(){return this.m_params.fontName}set fontName(e){this.m_params.fontName=e}get fontSize(){return this.m_params.fontSize}set fontSize(e){this.m_params.fontSize=Object.assign({},e)}get fontStyle(){return this.m_params.fontStyle}set fontStyle(e){this.m_params.fontStyle=e}get fontVariant(){return this.m_params.fontVariant}set fontVariant(e){this.m_params.fontVariant=e}get rotation(){return this.m_params.rotation}set rotation(e){this.m_params.rotation=e}get color(){return this.m_params.color}set color(e){this.m_params.color.copy(e)}get backgroundColor(){return this.m_params.backgroundColor}set backgroundColor(e){this.m_params.backgroundColor.copy(e)}get opacity(){return this.m_params.opacity}set opacity(e){this.m_params.opacity=e}get backgroundOpacity(){return this.m_params.backgroundOpacity}set backgroundOpacity(e){this.m_params.backgroundOpacity=e}clone(e={}){return new m(Object.assign(Object.assign({},this.m_params),e))}copy(e){return this.m_params.fontName=e.fontName,this.m_params.fontSize=Object.assign({},e.fontSize),this.m_params.fontStyle=e.fontStyle,this.m_params.fontVariant=e.fontVariant,this.m_params.rotation=e.rotation,this.m_params.color.copy(e.color),this.m_params.backgroundColor.copy(e.backgroundColor),this.m_params.opacity=e.opacity,this.m_params.backgroundOpacity=e.backgroundOpacity,this}}t.TextRenderStyle=m;class p{constructor(e={}){const{horizontalAlignment:t,verticalAlignment:i,placements:r}=f(e.horizontalAlignment,e.verticalAlignment,e.placements);this.m_params={tracking:void 0!==e.tracking?e.tracking:u.DEFAULT_TRACKING,leading:void 0!==e.leading?e.leading:u.DEFAULT_LEADING,maxLines:void 0!==e.maxLines?e.maxLines:u.DEFAULT_MAX_LINES,lineWidth:void 0!==e.lineWidth?e.lineWidth:u.DEFAULT_LINE_WIDTH,canvasRotation:void 0!==e.canvasRotation?e.canvasRotation:u.DEFAULT_CANVAS_ROTATION,lineRotation:void 0!==e.lineRotation?e.lineRotation:u.DEFAULT_LINE_ROTATION,wrappingMode:void 0!==e.wrappingMode?e.wrappingMode:u.DEFAULT_WRAPPING_MODE,verticalAlignment:i,horizontalAlignment:t,placements:r}}get params(){return this.m_params}set params(e){this.m_params=Object.assign(Object.assign({},this.m_params),e)}get tracking(){return this.m_params.tracking}set tracking(e){this.m_params.tracking=e}get leading(){return this.m_params.leading}set leading(e){this.m_params.leading=e}get maxLines(){return this.m_params.maxLines}set maxLines(e){this.m_params.maxLines=e}get lineWidth(){return this.m_params.lineWidth}set lineWidth(e){this.m_params.lineWidth=e}get canvasRotation(){return this.m_params.canvasRotation}set canvasRotation(e){this.m_params.canvasRotation=e}get lineRotation(){return this.m_params.lineRotation}set lineRotation(e){this.m_params.lineRotation=e}get wrappingMode(){return this.m_params.wrappingMode}set wrappingMode(e){this.m_params.wrappingMode=e}get verticalAlignment(){return this.m_params.verticalAlignment}set verticalAlignment(e){this.m_params.verticalAlignment=e}get horizontalAlignment(){return this.m_params.horizontalAlignment}set horizontalAlignment(e){this.m_params.horizontalAlignment=e}get placements(){return this.m_params.placements}set placements(e){const{horizontalAlignment:t,verticalAlignment:i,placements:r}=f(this.horizontalAlignment,this.verticalAlignment,e);this.m_params.horizontalAlignment=t,this.m_params.verticalAlignment=i,this.m_params.placements=r}clone(e={}){return new p(Object.assign(Object.assign({},this.m_params),e))}copy(e){return this.params=Object.assign({},e.params),this}}function f(e,t,i){var r;const n=null!==(r=null==i?void 0:i.map((e=>Object.assign({},e))))&&void 0!==r?r:u.DEFAULT_PLACEMENTS.map((e=>Object.assign({},e)));return{horizontalAlignment:n.length>0?n[0].h:null!=e?e:u.DEFAULT_HORIZONTAL_ALIGNMENT,verticalAlignment:n.length>0?n[0].v:null!=t?t:u.DEFAULT_VERTICAL_ALIGNMENT,placements:n}}t.TextLayoutStyle=p,t.resolvePlacementAndAlignment=f},31748:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineTypesetter=void 0;const r=i(84428),n=i(17309),o=i(51662),a=i(67728),s=i(15200);t.LineTypesetter=class{constructor(){this.m_tempTransform=new r.Matrix3,this.m_tempCorners=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3],this.m_tempLineDirection=s.UnicodeUtils.Direction.LTR,this.m_tempRunDirection=s.UnicodeUtils.Direction.LTR,this.m_tempPixelSize=1,this.m_tempPixelBgSize=1,this.m_tempScale=1,this.m_tempSmallCaps=!1}arrangeGlyphs(e){this.m_currentParams=e,this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,0),this.m_tempRunDirection=this.m_tempLineDirection,this.m_tempPixelSize=a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.size,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_tempScale=this.m_tempPixelSize/this.m_currentParams.fontCatalog.size,this.m_tempPixelBgSize=Math.min(a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.backgroundSize,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_currentParams.fontCatalog.distanceRange*this.m_tempScale),this.m_tempSmallCaps=void 0!==this.m_currentParams.smallCapsArray,this.m_currentParams.position.y+=this.m_currentParams.textLayoutStyle.verticalAlignment*this.m_currentParams.glyphs[0].font.metrics.capHeight*this.m_tempScale;const t=void 0!==this.m_currentParams.globalBounds&&void 0===this.m_currentParams.vertexBuffer,i=this.m_currentParams.position.x,r=this.m_currentParams.glyphs[0].font.metrics.lineHeight+this.m_currentParams.textLayoutStyle.leading;let n=0,l=0,c=0,u=0,d=0,h=0,m=0,p=0,f=!1;for(let e=0;e<this.m_currentParams.glyphs.length&&!(p>this.m_currentParams.textLayoutStyle.maxLines-1);++e){const g=this.m_currentParams.glyphs[e];if(!g.isInCache&&!t)return!1;const y=s.UnicodeUtils.isNewLine(g.codePoint),v=s.UnicodeUtils.isWhiteSpace(g.codePoint);if(f||g.direction!==-this.m_tempLineDirection||(f=!0),s.UnicodeUtils.isPrintable(g.codePoint)&&(d+=(g.advanceX+this.m_currentParams.textLayoutStyle.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(this.m_currentParams.glyphs,this.m_currentParams.smallCapsArray,e,this.m_currentParams.textRenderStyle.fontVariant):1)),e===n&&(u=d,h=d,m=d),y||this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Character&&d>this.m_currentParams.textLayoutStyle.lineWidth||this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&d>this.m_currentParams.textLayoutStyle.lineWidth&&m!==u){if(this.m_currentParams.textLayoutStyle.wrappingMode!==o.WrappingMode.None){let t=l,i=h;this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&m!==u&&(t=c,i=m),d=i,e=Math.min(y?n===e?t:e:t,this.m_currentParams.glyphs.length-1)}const t=this.m_tempLineDirection===s.UnicodeUtils.Direction.RTL&&f?1+this.m_currentParams.textLayoutStyle.horizontalAlignment:this.m_currentParams.textLayoutStyle.horizontalAlignment;if(this.m_currentParams.position.x=this.m_currentParams.position.x+d*t,!this.placeLine(n,e,this.m_tempLineDirection,f))return!1;for(this.m_currentParams.position.y-=r*this.m_tempScale,this.m_currentParams.position.x=i;e!==n&&e+1<this.m_currentParams.glyphs.length&&s.UnicodeUtils.isWhiteSpace(this.m_currentParams.glyphs[e+1].codePoint);)++e;if(n=e+1,n===this.m_currentParams.glyphs.length)break;y&&(this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,n),this.m_tempRunDirection=this.m_tempLineDirection),u=0,d=0,l=n,h=0,c=n,m=0,f=!1,p++}else this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.None||v||(l=e,h=d,this.m_currentParams.textLayoutStyle.wrappingMode===o.WrappingMode.Word&&e+1<this.m_currentParams.glyphs.length&&(s.UnicodeUtils.isWhiteSpace(this.m_currentParams.glyphs[e+1].codePoint)||s.UnicodeUtils.isNewLine(this.m_currentParams.glyphs[e+1].codePoint))&&(c=e,m=d))}if(p<=this.m_currentParams.textLayoutStyle.maxLines-1&&n<=this.m_currentParams.glyphs.length-1){const e=this.m_tempLineDirection===s.UnicodeUtils.Direction.RTL&&f?1+this.m_currentParams.textLayoutStyle.horizontalAlignment:this.m_currentParams.textLayoutStyle.horizontalAlignment;if(this.m_currentParams.position.setX(this.m_currentParams.position.x+d*e),!this.placeLine(n,this.m_currentParams.glyphs.length-1,this.m_tempLineDirection,f))return!1}return!0}placeLine(e,t,i,r){if(!r)return this.placeRun(e,t,i);const n=this.m_currentParams.glyphs,o=this.m_currentParams.smallCapsArray,l=this.m_currentParams.textRenderStyle,c=this.m_currentParams.textLayoutStyle,u=this.m_currentParams.position,d=i===s.UnicodeUtils.Direction.RTL,h=u.x;let m=0,p=e;for(let r=e;r<=t;++r){const e=n[r];if(e.direction===-this.m_tempRunDirection){if(d&&(u.x=h+m),!this.placeRun(p,r-1,this.m_tempRunDirection))return!1;d||(u.x=h+m),p=r,this.m_tempRunDirection*=-1}else if(e.direction===s.UnicodeUtils.Direction.Neutral&&this.m_tempRunDirection===-i){let e=r;for(;e+1<n.length&&1!==Math.abs(n[e].direction);)++e;if(n[e].direction!==this.m_tempRunDirection){if(d&&(u.x=h+m),!this.placeRun(p,r-1,this.m_tempRunDirection))return!1;d||(u.x=h+m),p=r,this.m_tempRunDirection*=-1}}m+=(e.advanceX+c.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(n,o,r,l.fontVariant):1)*i}if(p<=t){if(d&&(u.x=h+m),!this.placeRun(p,t,this.m_tempRunDirection))return!1;d||(u.x=h+m)}return!0}placeRun(e,t,i){const r=this.m_currentParams.glyphs,l=this.m_currentParams.smallCapsArray,c=this.m_currentParams.fontCatalog,u=this.m_currentParams.textRenderStyle,d=this.m_currentParams.textLayoutStyle,h=this.m_currentParams.position,m=this.m_currentParams.geometry,p=this.m_currentParams.globalBounds,f=this.m_currentParams.individualBounds,g=this.m_currentParams.vertexBuffer,y=i===s.UnicodeUtils.Direction.LTR?e:t,v=i===s.UnicodeUtils.Direction.LTR?t:e;for(let _=y;i===s.UnicodeUtils.Direction.RTL?_>=v:_<=v;_+=i){const y=r[_];if(!s.UnicodeUtils.isPrintable(y.codePoint))continue;if(e!==t&&0!==_&&i===s.UnicodeUtils.Direction.RTL&&y.direction===s.UnicodeUtils.Direction.Weak){let t=_,i=r[t-1];for(;t!==e&&(i.direction===s.UnicodeUtils.Direction.Weak||i.direction===s.UnicodeUtils.Direction.Neutral&&!s.UnicodeUtils.isWhiteSpace(i.codePoint));)--t,i=r[t-1];this.placeRun(Math.max(t,e),_,s.UnicodeUtils.Direction.LTR),_=t;continue}const v=y.font,b=v.metrics,S=u.fontStyle,T=S===o.FontStyle.Bold&&void 0===v.bold||S===o.FontStyle.BoldItalic&&void 0===v.bold&&void 0===v.boldItalic,E=S===o.FontStyle.Italic&&void 0===v.italic||S===o.FontStyle.BoldItalic&&void 0===v.italic&&void 0===v.boldItalic,C=!!this.m_tempSmallCaps&&l[_]&&u.fontVariant===o.FontVariant.SmallCaps,w=C?b.xHeight/b.capHeight:1,x=this.m_tempScale*w,P=((T?.02:0)+(C?.01:0))*(c.size/c.distanceRange),O=.5*this.m_tempPixelBgSize/(c.distanceRange*Math.max(x,1)),A=s.UnicodeUtils.isRtlMirrored(y.codePoint)&&i===s.UnicodeUtils.Direction.RTL,D=b.lineHeight-b.base-.5*b.distanceRange;a.TypesettingUtils.computeGlyphTransform(this.m_tempTransform,h,x,d.canvasRotation,u.rotation);for(let e=0;e<4;++e){const t=y.positions[e],i=E&&e>1?a.TypesettingUtils.OBLIQUE_OFFSET*b.size:0;this.m_tempCorners[e].set(t.x+i,t.y-D,t.z),this.m_tempCorners[e].applyMatrix3(this.m_tempTransform)}if(void 0===p&&void 0===g){if(!m.add(y,this.m_tempCorners,P,P+O,A,u))return!1}else void 0!==p&&a.TypesettingUtils.updateBounds(this.m_tempCorners,p,f),void 0!==g&&m.addToBuffer(g,_*n.QUAD_VERTEX_MEMORY_FOOTPRINT,y,this.m_tempCorners,P,P+O,A,u);h.set(h.x+(y.advanceX+d.tracking)*x*Math.cos(d.lineRotation),h.y+(y.advanceX+d.tracking)*x*Math.sin(d.lineRotation),h.z)}return!0}}},86033:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathTypesetter=void 0;const r=i(84428),n=i(17309),o=i(51662),a=i(67728),s=i(15200);t.PathTypesetter=class{constructor(){this.m_tempTransform=new r.Matrix3,this.m_tempCorners=[new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3],this.m_tempLineDirection=s.UnicodeUtils.Direction.LTR,this.m_tempRunDirection=s.UnicodeUtils.Direction.LTR,this.m_tempPixelSize=1,this.m_tempPixelBgSize=1,this.m_tempScale=1,this.m_tempSmallCaps=!1,this.m_tempPathPosition=new r.Vector3,this.m_tempPathLength=0,this.m_tempPathOffset=0}arrangeGlyphs(e){this.m_currentParams=e,this.m_tempLineDirection=a.TypesettingUtils.getDirection(this.m_currentParams.glyphs,0),this.m_tempRunDirection=this.m_tempLineDirection,this.m_tempPixelSize=a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.size,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_tempScale=this.m_tempPixelSize/this.m_currentParams.fontCatalog.size,this.m_tempPixelBgSize=Math.min(a.TypesettingUtils.getPixelSize(this.m_currentParams.textRenderStyle.fontSize.backgroundSize,this.m_currentParams.textRenderStyle.fontSize.unit,this.m_currentParams.fontCatalog.size),this.m_currentParams.fontCatalog.distanceRange*this.m_tempScale),this.m_tempSmallCaps=void 0!==this.m_currentParams.smallCapsArray,this.m_tempPathLength=this.m_currentParams.path.getLength(),this.m_tempPathOffset=0;const t=void 0!==this.m_currentParams.globalBounds&&void 0===this.m_currentParams.vertexBuffer;let i=!1,r=0;for(let e=0;e<this.m_currentParams.glyphs.length;++e){const n=this.m_currentParams.glyphs[e];if(!n.isInCache&&!t)return!1;s.UnicodeUtils.isPrintable(n.codePoint)&&(i||n.direction!==-this.m_tempLineDirection||(i=!0),r+=(n.advanceX+this.m_currentParams.textLayoutStyle.tracking)*this.m_tempScale*(this.m_tempSmallCaps?a.TypesettingUtils.getSmallCapsScale(this.m_currentParams.glyphs,this.m_currentParams.smallCapsArray,e,this.m_currentParams.textRenderStyle.fontVariant):1))}return this.m_tempPathOffset=Math.min(Math.max(-this.m_currentParams.textLayoutStyle.horizontalAlignment+this.m_currentParams.textLayoutStyle.horizontalAlignment*r/this.m_tempPathLength,0),1),this.placeLine(this.m_tempLineDirection,i)}placeLine(e,t){if(!t)return this.placeRun(0,this.m_currentParams.glyphs.length-1,e);const i=this.m_currentParams.glyphs;let r=0;for(let t=r;t<i.length;++t){const n=i[t];if(n.direction===-this.m_tempRunDirection){if(!this.placeRun(r,t-1,this.m_tempRunDirection))return!1;r=t,this.m_tempRunDirection*=-1}else if(n.direction===s.UnicodeUtils.Direction.Neutral&&this.m_tempRunDirection===-e){let e=t;for(;e+1<i.length&&1!==Math.abs(i[e].direction);)++e;if(i[e].direction!==this.m_tempRunDirection){if(!this.placeRun(r,t-1,this.m_tempRunDirection))return!1;r=t,this.m_tempRunDirection*=-1}}}return!(r<i.length&&!this.placeRun(r,i.length-1,this.m_tempRunDirection))}placeRun(e,t,i){const l=this.m_currentParams.glyphs,c=this.m_currentParams.smallCapsArray,u=this.m_currentParams.fontCatalog,d=this.m_currentParams.textRenderStyle,h=this.m_currentParams.textLayoutStyle,m=this.m_currentParams.position,p=this.m_currentParams.geometry,f=this.m_currentParams.globalBounds,g=this.m_currentParams.individualBounds,y=this.m_currentParams.vertexBuffer,v=this.m_currentParams.path,_=d.rotation,b=h.verticalAlignment*l[0].font.metrics.capHeight*this.m_tempScale,S=i===s.UnicodeUtils.Direction.LTR?e:t,T=i===s.UnicodeUtils.Direction.LTR?t:e;for(let E=S;i===s.UnicodeUtils.Direction.RTL?E>=T:E<=T;E+=i){const S=l[E];if(!s.UnicodeUtils.isPrintable(S.codePoint))continue;if(e!==t&&0!==E&&i===s.UnicodeUtils.Direction.RTL&&S.direction===s.UnicodeUtils.Direction.Weak){let t=E,i=l[t-1];for(;t!==e&&(i.direction===s.UnicodeUtils.Direction.Weak||i.direction===s.UnicodeUtils.Direction.Neutral&&!s.UnicodeUtils.isWhiteSpace(i.codePoint));)--t,i=l[t-1];this.placeRun(Math.max(t,e),E,s.UnicodeUtils.Direction.LTR),E=t;continue}const T=S.font,C=T.metrics,w=d.fontStyle,x=w===o.FontStyle.Bold&&void 0===T.bold||w===o.FontStyle.BoldItalic&&void 0===T.bold&&void 0===T.boldItalic,P=w===o.FontStyle.Italic&&void 0===T.italic||w===o.FontStyle.BoldItalic&&void 0===T.italic&&void 0===T.boldItalic,O=!!this.m_tempSmallCaps&&c[E]&&d.fontVariant===o.FontVariant.SmallCaps,A=O?C.xHeight/C.capHeight:1,D=this.m_tempScale*A,R=((x?.02:0)+(O?.01:0))*(u.size/u.distanceRange),I=.5*this.m_tempPixelBgSize/(u.distanceRange*Math.max(D,1)),M=s.UnicodeUtils.isRtlMirrored(S.codePoint)&&i===s.UnicodeUtils.Direction.RTL,L=C.lineHeight-C.base-.5*C.distanceRange,k=v.getPoint(this.m_tempPathOffset);if(null===k)return this.m_currentParams.pathOverflow;const N=v.getTangent(this.m_tempPathOffset),U=new r.Vector2(-N.y,N.x).multiplyScalar(b),j=Math.atan2(N.y,N.x);this.m_tempPathPosition.set(U.x+k.x,U.y+k.y,m.z),d.rotation=_+j,a.TypesettingUtils.computeGlyphTransform(this.m_tempTransform,this.m_tempPathPosition,D,0,d.rotation);for(let e=0;e<4;++e){const t=S.positions[e],i=P&&e>1?a.TypesettingUtils.OBLIQUE_OFFSET*C.size:0;this.m_tempCorners[e].set(t.x+i,t.y-L,t.z),this.m_tempCorners[e].applyMatrix3(this.m_tempTransform),this.m_tempCorners[e].x-=m.x,this.m_tempCorners[e].y-=m.y}if(void 0===f&&void 0===y){if(!p.add(S,this.m_tempCorners,R,R+I,M,d))return!1}else void 0!==f&&a.TypesettingUtils.updateBounds(this.m_tempCorners,f,g),void 0!==y&&p.addToBuffer(y,E*n.QUAD_VERTEX_MEMORY_FOOTPRINT,S,this.m_tempCorners,R,R+I,M,d);d.rotation=_,this.m_tempPathOffset+=(S.advanceX+h.tracking)*D/this.m_tempPathLength}return!0}}},92660:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ContextualArabicConverter=void 0,function(e){e[e.Initial=0]="Initial",e[e.Medial=1]="Medial",e[e.Final=2]="Final"}(i||(i={})),function(e){e[e.Isolated=0]="Isolated",e[e.Connected=1]="Connected"}(r||(r={}));class n{constructor(){this.m_singleCharactersMap=new Map,this.m_combinedCharactersMap=new Map,this.m_singleCharactersMap.set(1569,[void 0,void 0,void 0]),this.m_singleCharactersMap.set(1570,[void 0,void 0,65154]),this.m_singleCharactersMap.set(1571,[void 0,void 0,65156]),this.m_singleCharactersMap.set(1572,[void 0,void 0,65158]),this.m_singleCharactersMap.set(1573,[void 0,void 0,65160]),this.m_singleCharactersMap.set(1574,[65163,65164,65162]),this.m_singleCharactersMap.set(1575,[void 0,void 0,65166]),this.m_singleCharactersMap.set(1576,[65169,65170,65168]),this.m_singleCharactersMap.set(1577,[void 0,void 0,65172]),this.m_singleCharactersMap.set(1578,[65175,65176,65174]),this.m_singleCharactersMap.set(1579,[65179,65180,65178]),this.m_singleCharactersMap.set(1580,[65183,65184,65182]),this.m_singleCharactersMap.set(1581,[65187,65188,65186]),this.m_singleCharactersMap.set(1582,[65191,65192,65190]),this.m_singleCharactersMap.set(1583,[void 0,void 0,65194]),this.m_singleCharactersMap.set(1584,[void 0,void 0,65196]),this.m_singleCharactersMap.set(1585,[void 0,void 0,65198]),this.m_singleCharactersMap.set(1586,[void 0,void 0,65200]),this.m_singleCharactersMap.set(1587,[65203,65204,65202]),this.m_singleCharactersMap.set(1588,[65207,65208,65206]),this.m_singleCharactersMap.set(1589,[65211,65212,65210]),this.m_singleCharactersMap.set(1590,[65215,65216,65214]),this.m_singleCharactersMap.set(1591,[65219,65220,65218]),this.m_singleCharactersMap.set(1592,[65223,65224,65222]),this.m_singleCharactersMap.set(1593,[65227,65228,65226]),this.m_singleCharactersMap.set(1594,[65231,65232,65230]),this.m_singleCharactersMap.set(1600,[1600,1600,1600]),this.m_singleCharactersMap.set(1601,[65235,65236,65234]),this.m_singleCharactersMap.set(1602,[65239,65240,65238]),this.m_singleCharactersMap.set(1603,[65243,65244,65242]),this.m_singleCharactersMap.set(1604,[65247,65248,65246]),this.m_singleCharactersMap.set(1605,[65251,65252,65250]),this.m_singleCharactersMap.set(1606,[65255,65256,65254]),this.m_singleCharactersMap.set(1607,[65259,65260,65258]),this.m_singleCharactersMap.set(1608,[void 0,void 0,65262]),this.m_singleCharactersMap.set(1609,[void 0,void 0,65264]),this.m_singleCharactersMap.set(1610,[65267,65268,65266]),this.m_singleCharactersMap.set(1662,[64344,64345,64343]),this.m_singleCharactersMap.set(1740,[64510,64511,64509]),this.m_singleCharactersMap.set(1670,[64380,64381,64379]),this.m_singleCharactersMap.set(1705,[64400,64401,64399]),this.m_singleCharactersMap.set(1711,[64404,64405,64403]),this.m_singleCharactersMap.set(1688,[void 0,void 0,64395]),this.m_combinedCharactersMap.set(1604,new Map),this.m_combinedCharactersMap.get(1604).set(1570,[65269,65270]),this.m_combinedCharactersMap.get(1604).set(1571,[65271,65272]),this.m_combinedCharactersMap.get(1604).set(1573,[65273,65274]),this.m_combinedCharactersMap.get(1604).set(1575,[65275,65276]),this.m_neutralCharacters=[1552,1554,1555,1556,1557,1611,1612,1613,1614,1615,1616,1617,1618,1619,1620,1621,1622,1623,1624,1648,1750,1751,1752,1753,1754,1755,1756,1759,1760,1761,1762,1763,1764,1767,1768,1770,1771,1772,1773]}static get instance(){return void 0===this.m_instance&&(this.m_instance=new n),this.m_instance}convert(e){let t="";for(let n=0;n<e.length;++n){const o=e.charCodeAt(n);if(this.isArabicCharacter(o)){let a=n-1;for(;a>=0&&this.isNeutral(e.charCodeAt(a));--a);let s=a>=0?e.charCodeAt(a):void 0;if(void 0!==s){const e=this.getCharacterMap(s);(void 0===e||void 0===e[i.Initial]&&void 0===e[i.Medial])&&(s=void 0)}let l=n+1;for(;l<e.length&&this.isNeutral(e.charCodeAt(l));++l);let c=l<e.length?e.charCodeAt(l):void 0;if(void 0!==c){const e=this.getCharacterMap(c);(void 0===e||void 0===e[i.Medial]&&void 0===e[i.Final])&&(c=void 0)}if(1604===o&&void 0!==c&&(1570===c||1571===c||1573===c||1575===c)){const e=this.getCombinedCharacterMap(o,c);t+=void 0!==s?String.fromCharCode(e[r.Connected]):String.fromCharCode(e[r.Isolated]),++n;continue}const u=this.getCharacterMap(o);void 0!==s&&void 0!==c&&void 0!==u[i.Medial]?t+=String.fromCharCode(u[i.Medial]):void 0!==s&&void 0!==u[i.Final]?t+=String.fromCharCode(u[i.Final]):void 0!==c&&void 0!==u[i.Initial]?t+=String.fromCharCode(u[i.Initial]):t+=String.fromCharCode(o)}else t+=String.fromCharCode(o)}return t}isArabicCharacter(e){return this.m_singleCharactersMap.has(e)}getCharacterMap(e){return this.m_singleCharactersMap.get(e)}getCombinedCharacterMap(e,t){const i=this.m_combinedCharactersMap.get(e);if(void 0!==i)return i.get(t)}isNeutral(e){for(const t of this.m_neutralCharacters)if(t===e)return!0;return!1}}t.ContextualArabicConverter=n},52056:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSdfTextMaterial=void 0;const r=i(74095);t.createSdfTextMaterial=function(e){return new r.SdfTextMaterial({texture:e.fontCatalog.texture,textureSize:e.fontCatalog.textureSize,size:e.fontCatalog.size,distanceRange:e.fontCatalog.distanceRange,isMsdf:"msdf"===e.fontCatalog.type,isBackground:!0===e.isBackground,vertexSource:e.vertexSource,fragmentSource:e.fragmentSource,rendererCapabilities:e.rendererCapabilities})}},67728:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypesettingUtils=void 0;const r=i(84428),n=i(51662),o=i(15200);var a;(a=t.TypesettingUtils||(t.TypesettingUtils={})).EM_TO_PX=16,a.PT_TO_PX=1.25,a.OBLIQUE_ANGLE=.174533,a.OBLIQUE_OFFSET=Math.tan(a.OBLIQUE_ANGLE),a.getPixelSize=function(e,t,i){let r=e;switch(t){case n.FontUnit.Em:r*=a.EM_TO_PX;break;case n.FontUnit.Point:r*=a.PT_TO_PX;break;case n.FontUnit.Percent:r*=.01*i}return r},a.getSmallCapsScale=function(e,t,i,r){return t[i]&&r===n.FontVariant.SmallCaps?e[i].font.metrics.xHeight/e[i].font.metrics.capHeight:1},a.getDirection=function(e,t){let i=o.UnicodeUtils.Direction.LTR,r=t;for(;e[r].direction!==o.UnicodeUtils.Direction.LTR&&e[r].direction!==o.UnicodeUtils.Direction.RTL&&r<e.length-1;)++r;return 1===Math.abs(e[r].direction)&&(i=e[r].direction),i},a.computeGlyphTransform=function(e,t,i,r,n){const o=Math.cos(r),a=Math.sin(r),s=Math.cos(n),l=Math.sin(n);e.set(i*s,i*-l,o*t.x-a*t.y,i*l,i*s,a*t.x+o*t.y,0,0,1)},a.updateBounds=function(e,t,i){const n=Math.min(e[0].x,e[1].x,e[2].x,e[3].x),o=Math.max(e[0].x,e[1].x,e[2].x,e[3].x),a=Math.min(e[0].y,e[1].y,e[2].y,e[3].y),s=Math.max(e[0].y,e[1].y,e[2].y,e[3].y);void 0!==i&&(void 0!==i.array[i.offset]?(i.array[i.offset].min.set(n,a),i.array[i.offset].max.set(o,s)):i.array.push(new r.Box2(new r.Vector2(n,a),new r.Vector2(o,s))),++i.offset),t.min.set(Math.min(t.min.x,n),Math.min(t.min.y,a)),t.max.set(Math.max(t.max.x,o),Math.max(t.max.y,s))}},15200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeUtils=void 0,function(e){let t;e.whiteSpaceRanges=[[9,9],[32,32],[5760,5760],[8192,8198],[8200,8202],[8287,12288],[6158,6158],[8203,8205]],e.isWhiteSpace=function(t){for(const i of e.whiteSpaceRanges)if(t>=i[0]&&t<=i[1])return!0;return!1},e.newLineRanges=[[10,13],[133,133],[8232,8233]],e.isNewLine=function(t){for(const i of e.newLineRanges)if(t>=i[0]&&t<=i[1])return!0;return!1},e.nonPrintableRanges=[[0,31],[127,159]],e.isPrintable=function(t){for(const i of e.nonPrintableRanges)if(t>=i[0]&&t<=i[1])return!1;return!0},function(e){e[e.Neutral=0]="Neutral",e[e.Weak=.5]="Weak",e[e.LTR=1]="LTR",e[e.RTL=-1]="RTL"}(t=e.Direction||(e.Direction={})),e.rtlBlocks=["Hebrew","Alphabetic Presentation Forms","Arabic","Arabic Supplement","Arabic Extended-A","Arabic Presentation Forms-A","Arabic Presentation Forms-B","Arabic Mathematical Alphabetic Symbols","Indic Siyaq Numbers","Rumi Numeral Symbols","Syriac","Syriac Supplement","Samaritan","Mandaic","Thaana","Mende Kikakui","NKo","Adlam","Hanifi Rohingya"],e.neutralBidirectionalRanges=[[32,47],[58,64],[91,96],[123,126]],e.weakBidirectionalRanges=[[48,57],[1632,1641],[1776,1785]],e.getDirection=function(i,r){for(const r of e.weakBidirectionalRanges)if(i>=r[0]&&i<=r[1])return t.Weak;for(const r of e.neutralBidirectionalRanges)if(i>=r[0]&&i<=r[1])return t.Neutral;return void 0!==e.rtlBlocks.find((e=>e===r))?t.RTL:t.LTR},e.rtlMirroredCodePoints=[40,41,60,62,91,93,123,125],e.isRtlMirrored=function(t){return void 0!==e.rtlMirroredCodePoints.find((e=>e===t))}}(t.UnicodeUtils||(t.UnicodeUtils={}))},59571:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(87769),t)},92725:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DeferredPromise=void 0,t.DeferredPromise=class{constructor(e){this.executor=e,this.promise=new Promise(((e,t)=>{this.resolveFunc=e,this.rejectFunc=t}))}exec(){this.executor().then((e=>this.resolveFunc(e))).catch((e=>this.rejectFunc(e)))}}},87769:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferManager=void 0,i(76254);const r=i(92725);class n{constructor(e=fetch,t=5){this.fetchFunction=e,this.maxRetries=t,this.activeDownloadCount=0,this.downloadQueue=new Array,this.activeDownloads=new Map}static instance(){return n.defaultInstance}static async fetchRepeatedly(e,t,i,r,o){try{if(!(t<i))throw new Error("Max number of retries reached");{const n=await e(r,o);if(200===n.status||204===n.status)return n;if(n.status>=400&&n.status<500){t=i;const e=await n.text();throw new Error(e)}}}catch(e){if(e.hasOwnProperty("isCancelled")||"AbortError"===e.name||t>=i)throw e}return await n.waitFor(n.retryTimeout*t).then((()=>n.fetchRepeatedly(e,t+1,i,r,o)))}static waitFor(e){return new Promise((t=>setTimeout(t,e)))}downloadJson(e,t){return this.downloadAs((e=>e.json()),e,t)}downloadArrayBuffer(e,t){return this.download(e,t).then((e=>e.arrayBuffer()))}download(e,t){if(this.activeDownloadCount>=n.maxParallelDownloads){const i=new r.DeferredPromise((()=>this.doDownload(e,t)));return this.downloadQueue.push(i),i.promise}return this.doDownload(e,t)}async doDownload(e,t){try{++this.activeDownloadCount;const i=await n.fetchRepeatedly(this.fetchFunction,0,this.maxRetries,e,t);return this.onDownloadDone(),i}catch(e){throw this.onDownloadDone(),e}}onDownloadDone(){--this.activeDownloadCount,this.execDeferredDownload()}execDeferredDownload(){const e=this.downloadQueue.pop();void 0!==e&&e.exec()}downloadAs(e,t,i){const r=t,n=this.activeDownloads.get(r);if(void 0!==n)return Promise.resolve(n);const o=this.download(t,i).then((t=>{if(this.activeDownloads.delete(r),t.ok)return e(t);throw new Error(JSON.stringify(t))})).catch((e=>{throw this.activeDownloads.delete(r),e}));return this.activeDownloads.set(r,o),o}}t.TransferManager=n,n.retryTimeout=500,n.maxParallelDownloads=16,n.defaultInstance=new n},85258:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(49098),t),n(i(44843),t),n(i(43546),t),n(i(43340),t),n(i(18646),t),n(i(1069),t),n(i(94840),t),n(i(36086),t),n(i(50713),t),n(i(29152),t),n(i(66587),t),n(i(95640),t),n(i(26337),t),n(i(63866),t),n(i(31763),t),n(i(82466),t),n(i(64151),t),n(i(63144),t),n(i(45062),t)},38338:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(85258),t),n(i(48069),t)},63144:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},36086:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},50713:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextLogger=void 0,t.ContextLogger=class{constructor(e,t){this.m_logger=e,this.headerMessage=t,this.context=[],this.m_headerLogged=!1,this.warn=this.createLogMethod("warn"),this.info=this.createLogMethod("info"),this.error=this.createLogMethod("error")}pushAttr(e){this.context.push(`${this.context.length>0?".":""}${e}`)}pushIndex(e){this.context.push(`[${e}]`)}pop(){this.context.pop()}createLogMethod(e){return(t,...i)=>{this.m_headerLogged||(this.m_logger.info(this.headerMessage),this.m_headerLogged=!0),this.m_logger[e](`${this.context.join("")}: ${t}`,...i)}}}},49098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMUtils=void 0,function(e){function t(e){return e.substring(0,2)}e.getBrowserLanguages=function(){if(void 0!==navigator.languages&&navigator.languages.length>0){const e=[];for(const i of navigator.languages)e.push(t(i));return e}if(void 0!==navigator.language)return[t(navigator.language)]}}(t.DOMUtils||(t.DOMUtils={}))},82466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chainCallbacks=void 0,t.chainCallbacks=function(e,t){return function(...i){return e&&e.apply(this,i),t.apply(this,i)}}},45062:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFragmentShaderToWebGL2=t.convertVertexShaderToWebGL2=void 0,t.convertVertexShaderToWebGL2=function(e){return["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+e},t.convertFragmentShaderToWebGL2=function(e){return["#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+e}},44843:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupedPriorityList=t.PriorityListGroup=void 0;class i{constructor(e,t=new Array){this.priority=e,this.elements=t}clone(){return new i(this.priority,this.elements.slice())}remove(e){const t=this.elements.indexOf(e);return-1!==t&&(this.elements.splice(t,1),!0)}}t.PriorityListGroup=i;class r{constructor(){this.groups=new Map}add(e){this.getGroup(e.priority).elements.push(e)}remove(e){const t=this.findGroup(e.priority);return!(void 0===t||!t.remove(e)||(0===t.elements.length&&this.groups.delete(t.priority),0))}clear(){this.groups.clear()}merge(e){for(const t of e.groups){const e=this.findGroup(t[1].priority);void 0!==e?e.elements=e.elements.concat(t[1].elements):this.groups.set(Math.floor(t[1].priority),t[1].clone())}return this}clone(){const e=new r;for(const[t,i]of this.groups)e.groups.set(t,i.clone());return e}forEach(e){for(const t of this.groups)t[1].elements.forEach(e)}count(){let e=0;for(const t of this.groups)e+=t[1].elements.length;return e}findGroup(e){const t=Math.floor(e);return this.groups.get(t)}getGroup(e){let t=this.findGroup(e);if(void 0===t){const r=Math.floor(e);t=new i(r),this.groups.set(t.priority,t)}return t}}t.GroupedPriorityList=r},6422:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleChannel=void 0,t.ConsoleChannel=class{error(e,...t){console.error(e,...t)}debug(e,...t){console.debug(e,...t)}info(e,...t){console.info(e,...t)}log(e,...t){console.log(e,...t)}trace(e,...t){console.trace(e,...t)}warn(e,...t){console.warn(e,...t)}}},33131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},65596:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerOptions=t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.Trace=0]="Trace",i[i.Debug=1]="Debug",i[i.Log=2]="Log",i[i.Info=3]="Info",i[i.Warn=4]="Warn",i[i.Error=5]="Error",i[i.None=6]="None",t.LoggerOptions=class{}},64762:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;const r=i(65596);t.Logger=class{constructor(e,t,i){this.name=e,this.m_channel=t,this.enabled=!0,this.level=r.LogLevel.Trace,void 0!==i&&this.update(i)}error(e,...t){this.enabled&&this.level<=r.LogLevel.Error&&this.m_channel.error(this.prefix,e,...t)}debug(e,...t){this.enabled&&this.level<=r.LogLevel.Debug&&this.m_channel.debug(this.prefix,e,...t)}info(e,...t){this.enabled&&this.level<=r.LogLevel.Info&&this.m_channel.info(this.prefix,e,...t)}log(e,...t){this.enabled&&this.level<=r.LogLevel.Log&&this.m_channel.log(this.prefix,e,...t)}trace(e,...t){this.enabled&&this.level<=r.LogLevel.Trace&&this.m_channel.trace(this.prefix,e,...t)}warn(e,...t){this.enabled&&this.level<=r.LogLevel.Warn&&this.m_channel.warn(this.prefix,e,...t)}update(e){this.enabled=void 0===e.enabled?this.enabled:e.enabled,this.level=void 0===e.level?this.level:e.level}get prefix(){return this.name+":"}}},83975:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerManager=void 0;const r=i(4067);t.LoggerManager=class{static get instance(){return this.m_instance||(this.m_instance=new r.LoggerManagerImpl)}}},4067:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerManagerImpl=void 0;const r=i(6422),n=i(64762),o=i(82500);t.LoggerManagerImpl=class{constructor(){this.m_loggers=[],this.channel="undefined"==typeof self||void 0!==self.document?new r.ConsoleChannel:new o.WorkerChannel}getLoggerNames(){return this.m_loggers.map((e=>e.name))}getLogger(e){return this.m_loggers.find((t=>t.name===e))}create(e,t={}){void 0!==this.m_levelSetForAll&&(void 0===t.level||t.level<this.m_levelSetForAll)&&(t.level=this.m_levelSetForAll);const i=new n.Logger(e,this.channel,t);return this.m_loggers.push(i),i}dispose(e){const t=this.m_loggers.indexOf(e);if(t<0)throw new Error(`Cannot unregister "${e}" : no such logger registered.`);this.m_loggers.splice(t,1)}updateAll(e){for(const t of this.m_loggers)t.update(e)}update(e,t){for(const i of this.m_loggers)i.name===e&&i.update(t)}enableAll(e){for(const t of this.m_loggers)t.enabled=e}enable(e,t){this.update(e,{enabled:t})}setLogLevelForAll(e){this.m_levelSetForAll=e;for(const t of this.m_loggers)t.level=e}setLogLevel(e,t){this.update(e,{level:t})}setChannel(e){this.channel=e}}},80569:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiChannel=void 0,t.MultiChannel=class{constructor(...e){this.channels=[],this.channels=e}error(e,...t){for(const i of this.channels)i.error(e,...t)}debug(e,...t){for(const i of this.channels)i.debug(e,...t)}info(e,...t){for(const i of this.channels)i.info(e,...t)}log(e,...t){for(const i of this.channels)i.log(e,...t)}trace(e,...t){for(const i of this.channels)i.trace(e,...t)}warn(e,...t){for(const i of this.channels)i.warn(e,...t)}}},82500:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerChannel=t.WORKERCHANNEL_MSG_TYPE=void 0;const r=i(65596);t.WORKERCHANNEL_MSG_TYPE="worker-channel-message",t.WorkerChannel=class{error(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Error};self.postMessage(n)}debug(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Debug};self.postMessage(n)}info(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Info};self.postMessage(n)}log(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Log};self.postMessage(n)}trace(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Trace};self.postMessage(n)}warn(e,...i){const n={message:[e,...i],type:t.WORKERCHANNEL_MSG_TYPE,level:r.LogLevel.Warn};self.postMessage(n)}}},43546:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(6422),t),n(i(33131),t),n(i(65596),t),n(i(64762),t),n(i(83975),t),n(i(80569),t),n(i(82500),t)},43340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math2D=void 0,function(e){function t(e,t,i,r){return(e-i)*(e-i)+(t-r)*(t-r)}e.Box=class{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.w=i,this.h=r}set(e,t,i,r){this.x=e,this.y=t,this.w=i,this.h=r}copy(e){this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h}contains(e,t){return this.x<=e&&this.x+this.w>=e&&this.y<=t&&this.y+this.h>=t}containsBox(e){const t=e.x+e.w,i=e.y+e.h;return this.contains(e.x,e.y)&&this.contains(t,e.y)&&this.contains(e.x,i)&&this.contains(t,i)}intersects(e){return this.x<=e.x+e.w&&this.x+this.w>=e.x&&this.y<=e.y+e.h&&this.y+this.h>=e.y}},e.distSquared=t,e.computeSquaredLineLength=function(e){let t=0;const i=e.length-4;for(let r=0;r<i;r+=3){const i=e[r+3]-e[r],n=e[r+4]-e[r+1];t+=i*i+n*n}return t},e.distToSegmentSquared=function(e,i,r,n,o,a){const s=t(r,n,o,a);if(0===s)return t(e,i,r,n);let l=((e-r)*(o-r)+(i-n)*(a-n))/s;return l=Math.max(0,Math.min(1,l)),t(e,i,r+l*(o-r),n+l*(a-n))},e.intersectLineAndCircle=function(e,t,i,r,n,o=0,a=0){const s=i-e,l=r-t,c=s*s+l*l,u=e*r-i*t-l*o+s*a,d=n*n*c-u*u;if(d<-1e-10)return;const h=u*l,m=-u*s;if(d<1e-10)return{x1:o+h/c,y1:a+m/c};const p=Math.sqrt(d),f=(l<0?-1:1)*s*p,g=Math.abs(l)*p;return{x1:o+(h+f)/c,y1:a+(m+g)/c,x2:o+(h-f)/c,y2:a+(m-g)/c}},e.intersectLines=function(e,t,i,r,n,o,a,s,l={x:0,y:0}){const c=(e-i)*(o-s)-(t-r)*(n-a);if(0===c)return;const u=((e*r-t*i)*(n-a)-(e-i)*(n*s-o*a))/c,d=((e*r-t*i)*(o-s)-(t-r)*(n*s-o*a))/c;return l.x=u,l.y=d,l}}(t.Math2D||(t.Math2D={}))},18646:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0,function(e){function t(e,t,i){return e<t?t:e>i?i:e}e.clamp=t,e.smoothStep=function(e,i,r){return(r=t((r-e)/(i-e),0,1))*r*(3-2*r)},e.smootherStep=function(e,i,r){return(r=t((r-e)/(i-e),0,1))*r*r*(r*(6*r-15)+10)},e.map=function(e,t,i,r,n){return(e-t)*(n-r)/(i-t)+r},e.min2=function(e,t){let i;return void 0!==e&&(i=e),void 0!==t&&(i=void 0===i?t:Math.min(i,t)),i},e.max2=function(e,t){let i;return void 0!==e&&(i=e),void 0!==t&&(i=void 0===i?t:Math.max(i,t)),i},e.isClamped=function(e,t,i){return!(void 0!==t&&e<t||void 0!==i&&e>i)},e.easeInOutCubic=function(e,t,i){return e+(t-e)*(i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1)}}(t.MathUtils||(t.MathUtils={}))},1069:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyMixinsWithoutProperties=t.applyMixins=void 0,t.applyMixins=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((i=>{e.prototype[i]=t.prototype[i]}))}))},t.applyMixinsWithoutProperties=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((i=>{const r=Object.getOwnPropertyDescriptor(t.prototype,i);void 0!==r&&void 0===r.get&&"constructor"!==i&&(e.prototype[i]=t.prototype[i])}))}))}},66587:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pick=t.cloneDeep=void 0,t.cloneDeep=function(e){const t=new Map,i=function e(i){if(null===i)return null;if("object"==typeof i){const r=t.get(i);if(void 0!==r)return r;if(Array.isArray(i)){const r=[];t.set(i,r),r.length=i.length;for(let t=0;t<r.length;++t)r[t]=e(i[t]);return r}if(i instanceof Date){const e=new Date(i.getTime());return t.set(i,e),e}if(i instanceof RegExp){const e=new RegExp(i.source,i.flags);return t.set(i,e),e}if(i.constructor!==Object)throw new Error("cloneDeep doesn't support objects with custom prototypes");{const r={};t.set(i,r);for(const t in i)i.hasOwnProperty(t)&&(r[t]=e(i[t]));return r}}return i}(e);return t.clear(),i},t.pick=function(e,t){const i={};for(const r of t)e.hasOwnProperty(r)&&(i[r]=e[r]);return i}},95640:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOptionValue=void 0,t.getOptionValue=function(...e){for(const t of e)if(null!=t)return t}},29152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceTimer=void 0;class i{static now(){return i.nowFunc()}static getNowFunc(){return"undefined"!=typeof performance&&void 0!==performance.now?()=>performance.now():()=>(new Date).getTime()}}t.PerformanceTimer=i,i.instance=new i,i.nowFunc=i.getNowFunc()},64151:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sampleBilinear=void 0,t.sampleBilinear=function(e,t,i,r,n){const o=t-1,a=i-1,s=r*o,l=Math.floor(s),c=n*a,u=Math.floor(c),d=u*t+l,h=l<o?d+1:d,m=u<a?d+t:d,p=l<o?m+1:m,f=e[d],g=e[h],y=e[m],v=e[p],_=Number.isInteger(s)?0:s-l,b=1-_,S=Number.isInteger(c)?0:c-u,T=1-S;return f*b*T+g*_*T+y*b*S+v*_*S}},26337:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskQueue=void 0,t.TaskQueue=class{constructor(e){var t;this.m_options=e,this.m_taskLists=new Map,null===(t=this.m_options.groups)||void 0===t||t.forEach((e=>{this.m_taskLists.set(e,[])})),this.m_options.prioSortFn&&(this.sort=this.m_options.prioSortFn)}update(e){if(void 0===e)this.m_taskLists.forEach((e=>{this.updateTaskList(e)}));else{const t=this.getTaskList(e);t&&this.updateTaskList(t)}}add(e){var t;if(this.m_taskLists.has(e.group)){const i=this.m_taskLists.get(e.group);if(!(null==i?void 0:i.includes(e)))return null===(t=this.m_taskLists.get(e.group))||void 0===t||t.push(e),!0}return!1}remove(e){var t,i;if(this.m_taskLists.has(e.group)){const r=null===(t=this.m_taskLists.get(e.group))||void 0===t?void 0:t.indexOf(e);if(-1!==r)return null===(i=this.m_taskLists.get(e.group))||void 0===i||i.splice(r,1),!0}return!1}numItemsLeft(e){var t,i;let r=0;return void 0===e?this.m_taskLists.forEach((e=>{r+=e.length})):r+=null!==(i=null===(t=this.getTaskList(e))||void 0===t?void 0:t.length)&&void 0!==i?i:0,r}processNext(e,t,i=1){if(!this.getTaskList(e)||this.numItemsLeft(e)<=0)return!1;for(let r=0;r<i&&this.numItemsLeft(e)>0;r++){const i=this.pull(e,!0);void 0!==i&&(!t||(null==t?void 0:t(i))?i.execute():this.add(i))}return!0}clear(){this.m_taskLists.clear()}pull(e,t=!1){var i,r;let n;return this.getTaskList(e)&&(n=null===(i=this.getTaskList(e))||void 0===i?void 0:i.pop(),t&&n&&(null===(r=n.isExpired)||void 0===r?void 0:r.call(n)))?this.pull(e,t):n}sort(e,t){return t.getPriority()-e.getPriority()}getTaskList(e){return this.m_taskLists.get(e)}updateTaskList(e){var t;for(let i=0;i<e.length;i++){const r=e[i];(null===(t=null==r?void 0:r.isExpired)||void 0===t?void 0:t.call(r))&&(e.splice(i,1),i--)}e.sort(this.sort)}}},63866:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.composeUriResolvers=t.RelativeUriResolver=t.PrefixMapUriResolver=void 0;const r=i(31763);t.PrefixMapUriResolver=class{constructor(e){this.definitions=e}resolveUri(e){return Object.keys(this.definitions).reduce(((e,t)=>t.endsWith("/")&&e.startsWith(t)?this.definitions[t]+e.substr(t.length):e===t?this.definitions[t]:e),e)}},t.RelativeUriResolver=class{constructor(e){this.parentUri=e}resolveUri(e){return r.resolveReferenceUri(this.parentUri,e)}},t.composeUriResolvers=function(...e){return{resolveUri:t=>e.reduce(((e,t)=>void 0!==t?t.resolveUri(e):e),t)}}},48069:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAppBaseUrl=void 0;const r=i(31763);t.getAppBaseUrl=function(){return"undefined"==typeof window?`file://${process.cwd()}/`:r.baseUrl(window.location.href)}},31763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlHostAndProtocol=t.getUrlOrigin=t.baseUrl=t.resolveReferenceUri=void 0,t.resolveReferenceUri=function(e,t){return i.test(t)?t:t.startsWith("/")?n(e)+t:(t.startsWith("./")&&(t=t.substr(2)),r(e)+t)};const i=new RegExp("^(((?:[a-z]+:)?//)|(file:/)|(data:))","i");function r(e){if(void 0===e)return"./";let t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),t=e.indexOf("?"),-1!==t&&(e=e.slice(0,t)),t=e.lastIndexOf("/"),-1===t?"./":e.substring(0,t+1)}function n(e){if(void 0===e)return"";const t=o(e);return"file:"===t.protocol?"file://":t.host&&t.protocol?t.protocol+"//"+t.host:t.host?"//"+t.host:t.protocol?t.protocol+"//":""}function o(e){const t=new RegExp(/^(?:([a-z]+:))?\/\/([^\/]*)/,"i"),i=e.match(t);if(!i)throw new Error(`getUrlHostAndProtocol: unable to parse URL '${e}'`);return{protocol:i[1],host:i[2]}}t.baseUrl=r,t.getUrlOrigin=n,t.getUrlHostAndProtocol=o},94840:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertExists=t.assert=void 0,t.assert=function(e,t){},t.assertExists=function(e,t){return e}},91758:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(52063),t),n(i(26183),t),n(i(16038),t),n(i(39015),t)},39015:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},94409:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DecodeInfo=void 0;const r=i(32941),n=i(84428);t.DecodeInfo=class{constructor(e,t,i=0){this.targetProjection=e,this.tileKey=t,this.storageLevelOffset=i,this.projectedBoundingBox=new r.OrientedBox3,this.tileBounds=new n.Box3,this.tileSize=new n.Vector3,this.center=new n.Vector3,this.geoBox=this.tilingScheme.getGeoBox(t),this.targetProjection.projectBox(this.geoBox,this.projectedBoundingBox),this.projectedBoundingBox.getCenter(this.center),this.tilingScheme.getWorldBox(t,this.tileBounds),this.tileBounds.getSize(this.tileSize),this.tileSizeOnScreen=256*Math.pow(2,-this.storageLevelOffset),this.columnCount=r.webMercatorTilingScheme.subdivisionScheme.getLevelDimensionX(this.tileKey.level),this.rowCount=r.webMercatorTilingScheme.subdivisionScheme.getLevelDimensionY(this.tileKey.level)}get tilingScheme(){return r.webMercatorTilingScheme}get sourceProjection(){return this.tilingScheme.projection}}},26183:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonTilerService=void 0;const r=i(19955),n=i(16038);t.GeoJsonTilerService=class{static start(){r.WorkerServiceManager.getInstance().register({serviceType:n.GEOJSON_TILER_SERVICE_TYPE,factory:e=>r.TilerService.start(e)})}}},35236:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvGenericFeatureModifier=t.ComposedDataFilter=t.OmvGenericFeatureFilter=t.OmvFeatureFilterDescriptionBuilder=void 0;const r=i(96500),n=i(16038);t.OmvFeatureFilterDescriptionBuilder=class{constructor(e){this.m_processLayersDefault=!0,this.m_processPointsDefault=!0,this.m_processLinesDefault=!0,this.m_processPolygonsDefault=!0,this.m_layersToProcess=new Array,this.m_layersToIgnore=new Array,this.m_pointsToProcess=new Array,this.m_ignoredPoints=new Array,this.m_linesToProcess=new Array,this.m_linesToIgnore=new Array,this.m_polygonsToProcess=new Array,this.m_polygonsToIgnore=new Array,this.m_kindsToProcess=[],this.m_kindsToIgnore=[],e&&(this.m_processLayersDefault=void 0===e.processLayersDefault||e.processLayersDefault,this.m_processPointsDefault=void 0===e.processPointsDefault||e.processPointsDefault,this.m_processLinesDefault=void 0===e.processLinesDefault||e.processLinesDefault,this.m_processPolygonsDefault=void 0===e.processPolygonsDefault||e.processPolygonsDefault)}processLayer(e,t=n.OmvFilterString.StringMatch.Match,i=0,r=1/0){this.m_layersToProcess.push({name:{value:e,match:t},minLevel:i,maxLevel:r})}ignoreLayer(e,t=n.OmvFilterString.StringMatch.Match,i=0,r=1/0){this.m_layersToIgnore.push({name:{value:e,match:t},minLevel:i,maxLevel:r})}processPoint(e){this.addItem(this.m_pointsToProcess,e)}processPoints(e){this.addItems(this.m_pointsToProcess,e)}ignorePoint(e){this.addItem(this.m_ignoredPoints,e)}ignorePoints(e){this.addItems(this.m_ignoredPoints,e)}processLine(e){this.addItem(this.m_linesToProcess,e)}processLines(e){this.addItems(this.m_linesToProcess,e)}ignoreLine(e){this.addItem(this.m_linesToIgnore,e)}ignoreLines(e){this.addItems(this.m_linesToIgnore,e)}processPolygon(e){this.addItem(this.m_polygonsToProcess,e)}processPolygons(e){this.addItems(this.m_polygonsToProcess,e)}ignorePolygon(e){this.addItem(this.m_polygonsToIgnore,e)}ignorePolygons(e){this.addItems(this.m_polygonsToIgnore,e)}processKinds(e){this.m_kindsToProcess=this.m_kindsToProcess.concat(e)}ignoreKinds(e){this.m_kindsToIgnore=this.m_kindsToIgnore.concat(e)}createDescription(){return{processLayersDefault:this.m_processLayersDefault,processPointsDefault:this.m_processPointsDefault,processLinesDefault:this.m_processLinesDefault,processPolygonsDefault:this.m_processPolygonsDefault,layersToProcess:this.m_layersToProcess,layersToIgnore:this.m_layersToIgnore,pointsToProcess:this.m_pointsToProcess,pointsToIgnore:this.m_ignoredPoints,linesToProcess:this.m_linesToProcess,linesToIgnore:this.m_linesToIgnore,polygonsToProcess:this.m_polygonsToProcess,polygonsToIgnore:this.m_polygonsToIgnore,kindsToProcess:this.m_kindsToProcess,kindsToIgnore:this.m_kindsToIgnore}}addItem(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const i={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomType?Array.isArray(t.geomType)?t.geomType:[t.geomType]:void 0,classes:[{value:t.featureClass,match:void 0===t.matchClass?n.OmvFilterString.StringMatch.Match:t.matchClass}],minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(i)}addItems(e,t){(void 0===t.minLevel||isNaN(t.minLevel))&&(t.minLevel=0),(void 0===t.maxLevel||isNaN(t.maxLevel))&&(t.maxLevel=1/0);const i={layerName:{value:t.layer,match:void 0===t.matchLayer?n.OmvFilterString.StringMatch.Match:t.matchLayer},geometryTypes:void 0!==t.geomTypes?Array.isArray(t.geomTypes)?t.geomTypes:[t.geomTypes]:void 0,classes:t.featureClasses,minLevel:t.minLevel,maxLevel:t.maxLevel,featureAttribute:t.featureAttribute};e.push(i)}};class o{constructor(e){this.description=e,this.description.kindsToProcess.length>0&&(this.enabledKinds=new r.GeometryKindSet(this.description.kindsToProcess)),this.description.kindsToIgnore.length>0&&(this.disabledKinds=new r.GeometryKindSet(this.description.kindsToIgnore))}static matchLayer(e,t,i){for(const r of t)if(!(i<r.minLevel||i>r.maxLevel)&&n.OmvFilterString.matchString(e,r.name))return!0;return!1}wantsLayer(e,t){return!!o.matchLayer(e,this.description.layersToProcess,t)||!o.matchLayer(e,this.description.layersToIgnore,t)&&this.description.processLayersDefault}wantsPointFeature(e,t,i){return this.wantsFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,i,this.description.processPointsDefault)}wantsLineFeature(e,t,i){return this.wantsFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,i,this.description.processLinesDefault)}wantsPolygonFeature(e,t,i){return this.wantsFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,i,this.description.processPolygonsDefault)}wantsKind(e){return void 0===e||!(void 0!==this.disabledKinds&&this.disabledKinds.hasOrIntersects(e))||void 0!==this.enabledKinds&&this.enabledKinds.hasOrIntersects(e)}get hasKindFilter(){return void 0!==this.enabledKinds||void 0!==this.disabledKinds}wantsFeature(e,t,i,r,o,a){for(const t of e)if(!(o<t.minLevel||o>t.maxLevel)&&n.OmvFilterString.matchString(i,t.layerName)&&void 0!==t.geometryTypes&&t.geometryTypes.includes(r))return!0;for(const e of t)if(n.OmvFilterString.matchString(i,e.layerName)&&void 0!==e.geometryTypes&&e.geometryTypes.includes(r))return!1;return a}}t.OmvGenericFeatureFilter=o,t.ComposedDataFilter=class{constructor(e){this.filters=e}get hasKindFilter(){return this.filters.reduce(((e,t)=>e||t.hasKindFilter),!0)}wantsLayer(e,t){return this.filters.reduce(((i,r)=>i&&r.wantsLayer(e,t)),!0)}wantsPointFeature(e,t,i){return this.filters.reduce(((r,n)=>r&&n.wantsPointFeature(e,t,i)),!0)}wantsLineFeature(e,t,i){return this.filters.reduce(((r,n)=>r&&n.wantsLineFeature(e,t,i)),!0)}wantsPolygonFeature(e,t,i){return this.filters.reduce(((r,n)=>r&&n.wantsPolygonFeature(e,t,i)),!0)}wantsKind(e){return this.filters.reduce(((t,i)=>t&&i.wantsKind(e)),!0)}};class a{constructor(e){this.description=e}static matchItems(e,t,i){for(const r of i)if(void 0!==r.classes){if(!n.OmvFilterString.matchString(e,r.layerName))continue;for(const e of r.classes)if(n.OmvFilterString.matchString(t,e))return!0}return!1}static matchAttribute(e,t,i){for(const r of i)if(void 0!==r.featureAttribute&&n.OmvFilterString.matchString(e,r.layerName)&&t.lookup(r.featureAttribute.key)===r.featureAttribute.value)return!0;return!1}doProcessPointFeature(e,t){return this.doProcessFeature(this.description.pointsToProcess,this.description.pointsToIgnore,e,t,this.description.processPointsDefault)}doProcessLineFeature(e,t){return this.doProcessFeature(this.description.linesToProcess,this.description.linesToIgnore,e,t,this.description.processLinesDefault)}doProcessPolygonFeature(e,t){return this.doProcessFeature(this.description.polygonsToProcess,this.description.polygonsToIgnore,e,t,this.description.processPolygonsDefault)}doProcessFeature(e,t,i,r,n){if(void 0===i||0===e.length&&0===t.length)return n;let o;const s=r.lookup("class");return null!=s&&(o=s.toString()),!(!o||!a.matchItems(i,o,e))||(!o||!a.matchItems(i,o,t))&&(!!a.matchAttribute(i,r,e)||!a.matchAttribute(i,r,t)&&n)}}t.OmvGenericFeatureModifier=a},16038:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.GEOJSON_TILER_SERVICE_TYPE=t.VECTOR_TILE_DECODER_SERVICE_TYPE=t.OmvGeometryType=t.OmvFilterString=t.FeatureModifierId=void 0,(r=t.FeatureModifierId||(t.FeatureModifierId={}))[r.default=0]="default",function(e){let t;!function(e){e[e.Any=0]="Any",e[e.Match=1]="Match",e[e.StartsWith=2]="StartsWith",e[e.Contains=3]="Contains",e[e.EndsWith=4]="EndsWith"}(t=e.StringMatch||(e.StringMatch={})),e.matchString=function(t,i){switch(i.match){case e.StringMatch.Any:return!0;case e.StringMatch.Match:return t===i.value;case e.StringMatch.StartsWith:return i.value.startsWith(t);case e.StringMatch.EndsWith:return i.value.endsWith(t);default:return t.includes(i.value)}}}(t.OmvFilterString||(t.OmvFilterString={})),(i=t.OmvGeometryType||(t.OmvGeometryType={}))[i.UNKNOWN=0]="UNKNOWN",i[i.POINT=1]="POINT",i[i.LINESTRING=2]="LINESTRING",i[i.POLYGON=3]="POLYGON",t.VECTOR_TILE_DECODER_SERVICE_TYPE="vector-tile-decoder",t.GEOJSON_TILER_SERVICE_TYPE="geojson-tiler"},75940:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvPoliticalViewFeatureModifier=void 0;const r=i(38338).LoggerManager.instance.create("OmvPoliticalViewFeatureModifier");t.OmvPoliticalViewFeatureModifier=class{constructor(e){this.m_countryCode=e}doProcessPointFeature(e,t,i){return!0}doProcessLineFeature(e,t,i){return this.rewriteEnvironment(e,t),!0}doProcessPolygonFeature(e,t,i){return!0}rewriteEnvironment(e,t){this.isPoliticalViewLayer(e)&&this.updateEnvironment(t,this.m_countryCode,"kind")}updateEnvironment(e,t,i){const r=this.getAlternativePov(e,t,i);void 0!==r&&(e.entries[i]=r)}getAlternativePov(e,t,i){r.log("Get alternate POV: ",JSON.stringify(e));const n=t,o=e.lookup(`${i}:${n}`);return r.log("Lookup POV: ",`${i}:${n}`,o),"string"==typeof o&&o.length>0?(r.log("Found POV: ",`${i}:${n}`,o),o):void 0}isPoliticalViewLayer(e){return"boundaries"===e}}},79115:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webMercatorTile2TargetTile=t.webMercatorTile2TargetWorld=t.world2tile=t.tile2world=t.createWorldTileTransformationCookie=t.tile2lat=t.lat2tile=t.isArrayBufferLike=void 0;const r=i(32941),n=i(84428);function o(e,t){return Math.round((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}function a(e,t){const{north:i,west:r}=t.geoBox,n=Math.log2(e),a=Math.pow(2,t.tileKey.level+n);return{extents:e,scale:a,top:o(i,t.tileKey.level+n),left:Math.round((r+180)/360*a)}}function s(e,t,i,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=a(e,t));const{top:s,left:l,scale:c}=t.worldTileProjectionCookie,u=r.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.x=(l+i.x)/c*u,o.y=(s+(n?-i.y:i.y))/c*u,o.z=r.isVector3Like(i)?i.z:0,o}function l(e,t,i,o,a,l=!1){s(e,t,i,l,o),t.targetProjection.reprojectPoint(r.webMercatorProjection,o,o),i instanceof n.Vector3&&a&&(o.z*=t.targetProjection.getScaleFactor(o))}t.isArrayBufferLike=function(e){return"undefined"!=typeof SharedArrayBuffer?e instanceof ArrayBuffer||e instanceof SharedArrayBuffer:e instanceof ArrayBuffer},t.lat2tile=o,t.tile2lat=function(e,t){const i=Math.PI-2*Math.PI*e/Math.pow(2,t);return 180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))},t.createWorldTileTransformationCookie=a,t.tile2world=s,t.world2tile=function(e,t,i,n=!1,o){void 0!==t.worldTileProjectionCookie&&t.worldTileProjectionCookie.extents===e||(t.worldTileProjectionCookie=a(e,t));const{top:s,left:l,scale:c}=t.worldTileProjectionCookie,u=r.EarthConstants.EQUATORIAL_CIRCUMFERENCE;return o.x=Math.round(i.x/u*c-l),o.y=Math.round((n?-1:1)*(i.y/u*c-s)),r.isVector3Like(o)&&(o.z=i.z),o},t.webMercatorTile2TargetWorld=l,t.webMercatorTile2TargetTile=function(e,t,i,r,n,o=!1){l(e,t,i,r,n,o),r.sub(t.center)}},69443:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;const r=i(84428);t.Ring=class{constructor(e,t,i=4096,n=!1){if(this.points=e,this.textureCoords=t,this.extents=i,this.hasClipInfo=n,void 0!==t&&t.length!==e.length)throw new Error("the array of texture coordinates must have the same number of elements of the array of points");this.vertexStride=2,void 0!==t&&(this.vertexStride=this.vertexStride+2),this.area=r.ShapeUtils.area(this.points),this.winding=this.area<0}toArray(e=[],t=0){var i;return this.points.forEach(((i,r)=>i.toArray(e,t+this.vertexStride*r))),null===(i=this.textureCoords)||void 0===i||i.forEach(((i,r)=>i.toArray(e,t+this.vertexStride*r+2))),e}isProperEdge(e){const t=this.extents,i=(e+1)%this.points.length,r=this.points[e],n=this.points[i];if(this.hasClipInfo){if(r.x!==n.x&&r.y!==n.y)return!0;if(r.x%this.extents!=0&&r.y%this.extents!=0)return!0;if(n.x%this.extents!=0&&n.y%this.extents!=0)return!0;const e=!0===r.isClipped,t=!0===n.isClipped;return!e&&!t}return!(r.x<=0&&n.x<=0||r.x>=t&&n.x>=t||r.y<=0&&n.y<=0||r.y>=t&&n.y>=t)}}},96094:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSetDataFilter=void 0,t.StyleSetDataFilter=class{constructor(e){this.styleSetEvaluator=e,this.hasKindFilter=!1}wantsLayer(e,t){return this.styleSetEvaluator.wantsLayer(e)}wantsPointFeature(e){return this.styleSetEvaluator.wantsFeature(e,"point")}wantsLineFeature(e){return this.styleSetEvaluator.wantsFeature(e,"line")}wantsPolygonFeature(e){return this.styleSetEvaluator.wantsFeature(e,"polygon")}wantsKind(){return!0}}},36733:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTileDataEmitter=void 0;const r=i(96500),n=i(33189),o=i(46115),a=i(81028),s=i(56772),l=i(32941),c=i(50440),u=i(19136),d=i(59748),h=i(38338),m=i(9187),p=i(84428),f=i(79115),g=i(69443),y=h.LoggerManager.instance.create("OmvDecodedTileEmitter"),v=new p.Vector3,_=new p.Vector3,b=new p.Vector3,S=new p.Vector3,T=new p.Vector2,E=new p.Vector2,C=new p.Vector3,w=new p.Vector3,x=new p.Vector3,P=new p.Vector2,O=new p.Vector2,A=new p.Vector2,D=new p.Vector3,R=new p.Vector3,I=new p.Vector3,M=new p.Vector3,L=new p.Vector3,k=new p.Line3,N=Math.PI/8;function U(e,t,i="index"){const r=t>65535?"uint32":"uint16";return{itemCount:1,name:i,buffer:("uint32"===r?new Uint32Array(e):new Uint16Array(e)).buffer,type:r}}class j{constructor(e){this.type=e,this.positions=[],this.normals=[],this.textureCoordinates=[],this.colors=[],this.extrusionAxis=[],this.indices=[],this.edgeIndices=[],this.groups=[],this.texts=[],this.pathLengths=[],this.stringCatalog=[],this.imageTextures=[],this.featureStarts=[],this.edgeFeatureStarts=[],this.objInfos=[],this.offsetDirections=[]}addText(e){let t=this.stringCatalog.indexOf(e);return t<0&&(t=this.stringCatalog.length,this.stringCatalog.push(e)),t}}var F;!function(e){e[e.Simple=0]="Simple",e[e.Complex=1]="Complex"}(F||(F={}));const V=new p.Color;t.VectorTileDataEmitter=class{constructor(e,t,i={}){var r,n,o;this.m_decodeInfo=e,this.m_styleSetEvaluator=t,this.m_options=i,this.m_meshBuffers=new Map,this.m_geometries=[],this.m_textGeometries=[],this.m_textPathGeometries=[],this.m_pathGeometries=[],this.m_poiGeometries=[],this.m_simpleLines=[],this.m_solidLines=[],this.m_sources=[],this.m_maxGeometryHeight=0,this.m_minGeometryHeight=0,this.m_options.gatherFeatureAttributes=null!==(r=i.gatherFeatureAttributes)&&void 0!==r&&r,this.m_options.skipShortLabels=null===(n=i.skipShortLabels)||void 0===n||n,this.m_options.enableElevationOverlay=null!==(o=i.enableElevationOverlay)&&void 0!==o&&o}get projection(){return this.m_decodeInfo.targetProjection}get center(){return this.m_decodeInfo.center}processPointFeature(e,t,i,o,a){var s;const c=o.env;this.processFeatureCommon(c);const{tileKey:u,columnCount:d,rowCount:h}=this.m_decodeInfo,m=u.column+1<d?t-1:t,p=u.row+1<h?t-1:t,g=i.filter((e=>e.x>=0&&e.x<=m&&e.y>=0&&e.y<=p));if(0!==g.length)for(const e of a){if(void 0===e)continue;const i=e._index,a=this.findOrCreateMeshBuffers(i,r.GeometryType.Point);if(void 0===a)continue;const{positions:u,texts:d,imageTextures:h,objInfos:m,offsetDirections:p}=a,y=r.isTextTechnique(e)||r.isPoiTechnique(e);let v;const _=r.isPoiTechnique(e);if(_){const t=e;if(v=n.evaluateTechniqueAttr(o,t.imageTexture),void 0!==t.poiName)v=n.evaluateTechniqueAttr(o,t.poiName);else if("string"==typeof t.poiNameField)v=c.lookup(t.poiNameField);else if("string"==typeof t.imageTextureField){const e=c.lookup(t.imageTextureField);v=r.composeTechniqueTextureName(e,t)}}const b=r.scaleHeight(o,e,this.m_decodeInfo.tileKey.level),S=r.getFeatureId(c.entries);for(const i of g){if(y){const t=e,i=r.getFeatureText(o,t,this.m_options.languages);void 0!==i&&i.length>0?d.push(a.addText(i)):d.push(-1)}y?f.webMercatorTile2TargetWorld(t,this.m_decodeInfo,i,C,b):f.webMercatorTile2TargetTile(t,this.m_decodeInfo,i,C,b);const n=this.projection.type===l.ProjectionType.Planar?C.z:i.z;n>this.m_maxGeometryHeight?this.m_maxGeometryHeight=n:n<this.m_minGeometryHeight&&(this.m_minGeometryHeight=n),u.push(C.x,C.y,C.z),m.push(this.m_options.gatherFeatureAttributes?c.entries:S),p.push(null!==(s=c.lookup("offset_direction"))&&void 0!==s?s:0),_&&(void 0===v?h.push(-1):h.push(a.addText(v)))}}}processLineFeature(e,t,i,o,a){const s=o.env;this.processFeatureCommon(s);const l=[],c=[],d=[],m=[],g=this.m_decodeInfo.projectedBoundingBox;let v;const _=2*g.extents.x,b=2*g.extents.y,S=Math.max(_,b);let T,E;const P=void 0!==i[0].untiledPositions,O=!1;let A=!1,D=!1;for(const e of a)if(void 0!==e){if(T){const t=this.getTextureCoordinateType(e);h.assert(void 0===t||E===t)}else T=this.getComputeTexCoordsFunc(e),E=this.getTextureCoordinateType(e);A=A||r.isSpecialDashesLineTechnique(e),D=D||!A}for(const e of i){const i=[];let r=0;if(P&&(this.m_decodeInfo.targetProjection.projectPoint(e.untiledPositions[0],w),e.untiledPositions.forEach((e=>{this.m_decodeInfo.targetProjection.projectPoint(e,C),r+=C.distanceTo(w),w.copy(C),this.m_decodeInfo.targetProjection.projectPoint(e.normalized(),C),i.push(C.x,C.y,C.z,r)}))),A){v=[];let n=0;const o=e.positions.length;if(o>1){let a=0;for(let s=0;s<o-1;s++){const o=[],l=[],u=[],h=[],p=e.positions[s],g=e.positions[s+1];if(f.webMercatorTile2TargetWorld(t,this.m_decodeInfo,p,C,O),l.push(C.x,C.y,C.z),f.webMercatorTile2TargetWorld(t,this.m_decodeInfo,g,x,O),l.push(x.x,x.y,x.z),T&&(T(p,t).toArray(u,u.length),T(g,t).toArray(u,u.length)),P){let e=this.findRelativePositionInLine(C,i)/r;h.push(e),e=this.findRelativePositionInLine(x,i)/r,h.push(e)}else{h.push(a);const e=C.distanceTo(x);n+=e,a+=e,h.push(a)}C.sub(this.m_decodeInfo.center),o.push(C.x,C.y,C.z),x.sub(this.m_decodeInfo.center),o.push(x.x,x.y,x.z),v.push(o),c.push(l),d.push(u),m.push(h)}}if(!P&&n>0)for(const e of m)e.forEach(((t,i)=>{e[i]=t/n}))}if(D){const n=[],o=[],a=[],s=[];e.positions.forEach((e=>{if(f.webMercatorTile2TargetWorld(t,this.m_decodeInfo,e,C,O),o.push(C.x,C.y,C.z),T&&T(e,t).toArray(a,a.length),P){const e=this.findRelativePositionInLine(C,i)/r;s.push(e)}C.sub(this.m_decodeInfo.center),n.push(C.x,C.y,C.z)})),l.push(n),c.push(o),d.push(a),m.push(s)}}const R=this.m_decodeInfo.tileKey.level>=11;for(const e of a){if(void 0===e)continue;const t=e._index,i=e.name;if(r.isLineTechnique(e)||r.isSolidLineTechnique(e)){const i=r.isLineTechnique(e)?this.m_simpleLines:this.m_solidLines,n=r.isLineTechnique(e)?F.Simple:F.Complex;A&&(h.assert(void 0!==v,"OmvDecodedTileEmitter#processLineFeature: Internal error - No localLineSegments"),this.applyLineTechnique(i,e,t,n,s.entries,v,o,this.getTextureCoordinateType(e)?d:void 0,m)),l.length>0&&this.applyLineTechnique(i,e,t,n,s.entries,l,o,this.getTextureCoordinateType(e)?d:void 0,P?m:void 0)}else if(r.isTextTechnique(e)||r.isPoiTechnique(e)||r.isLineMarkerTechnique(e)){const i=e,a=r.getFeatureText(o,i,this.m_options.languages);if(void 0===a||0===a.length)continue;let l=[];if(this.m_options.skipShortLabels){const e=S/this.m_decodeInfo.tileSizeOnScreen,t=5*a.length*e*.5,i=t*t;l=this.splitJaggyLines(c,i,N)}else l=c;if(0===l.length)continue;if(r.isTextTechnique(e)){if(void 0===a)continue;for(const e of l){const i=h.Math2D.computeSquaredLineLength(e);this.m_textPathGeometries.push({technique:t,path:e,pathLengthSqr:i,text:String(a),objInfos:this.m_options.gatherFeatureAttributes?s.entries:r.getFeatureId(s.entries)})}}else{const i=e;let c=n.evaluateTechniqueAttr(o,i.imageTexture);"string"==typeof i.imageTextureField&&(c=s.lookup(i.imageTextureField),"string"==typeof i.imageTexturePrefix&&(c=i.imageTexturePrefix+c),"string"==typeof i.imageTexturePostfix&&(c+=i.imageTexturePostfix));for(const e of l)this.m_poiGeometries.push({technique:t,positions:{name:"position",type:"float",buffer:new Float64Array(e).buffer,itemCount:3},texts:[0],stringCatalog:[a,c],imageTextures:[1],objInfos:this.m_options.gatherFeatureAttributes?[s.entries]:[r.getFeatureId(s.entries)]})}}else if(r.isLabelRejectionLineTechnique(e))for(const e of c){const t=[];for(let i=0;i<e.length;i+=3)t.push((new p.Vector3).fromArray(e,i));this.m_pathGeometries.push({path:t})}else if(r.isExtrudedLineTechnique(e)){const i=this.findOrCreateMeshBuffers(t,r.GeometryType.ExtrudedLine);if(void 0===i)continue;const{positions:a,indices:c,groups:d,featureStarts:h,objInfos:m}=i,p=c.length,f=n.evaluateTechniqueAttr(o,e.lineWidth);if(void 0===f)continue;const g=n.evaluateTechniqueAttr(o,e.caps,"Circle"),y=R&&"Circle"===g;l.forEach((e=>{u.triangulateLine(e,f,a,c,y),h.push(p),m.push(this.m_options.gatherFeatureAttributes?s.entries:r.getFeatureId(s.entries))}));const v=c.length-p;d.push({start:p,count:v,technique:t})}else y.warn(`OmvDecodedTileEmitter#processLineFeature: Invalid line technique\n                     ${i} for layer: ${s.entries.$layer} `)}}processPolygonFeature(e,t,i,n,a){const s=n.env;this.processFeatureCommon(s);const c=!1;a.forEach((e=>{if(void 0===e)return;const a=e._index;if(void 0===a)throw new Error("OmvDecodedTileEmitter#processPolygonFeature: Internal error - No technique index");let u;const d=s.lookup("bbox");if(Array.isArray(d)){const[e,t,i,r]=d,n=new l.GeoBox(new l.GeoCoordinates(t,e),new l.GeoCoordinates(r,i));u=new p.Box3,l.webMercatorProjection.projectBox(n,u)}const h=[],m=r.isExtrudedPolygonTechnique(e),y=r.isFillTechnique(e),v=r.isStandardTechnique(e),_=m||y||v||r.isShaderTechnique(e)&&"mesh"===e.primitive,b=this.getComputeTexCoordsFunc(e,u),S=_&&!m;for(const e of i){const i=[];for(let r=0;r<e.rings.length;r++){const n=0===r;let a=e.rings[r];S&&a.some((e=>e.x<0||e.x>t||e.y<0||e.y>t))&&(a=o.clipPolygon(a,t));const s=p.ShapeUtils.area(a);if(n&&0===s)break;if(0!==s){let e;void 0!==b&&(e=a.map((e=>b(e,t)))),i.push(new g.Ring(a,e,t,S))}}i.length>0&&h.push(i)}const E=r.isSolidLineTechnique(e)||r.isLineTechnique(e);if(_)this.applyPolygonTechnique(h,e,a,n,t);else if(E){const i="line"===e.name?this.m_simpleLines:this.m_solidLines,o="line"===e.name?F.Simple:F.Complex,l=r.isSpecialDashesLineTechnique(e);h.forEach((r=>{const u=[],d=l?[]:void 0;r.forEach((e=>{const i=e.points.length;let r=[],n=0,o=0,a=l?[]:void 0;for(let s=0;s<i;++s){l&&r.length>0&&(r=[],a=[]);const h=(s+1)%i,m=e.points[s],p=e.points[h],g=e.isProperEdge(s);if(g||0===r.length){if(g&&0===r.length&&(f.webMercatorTile2TargetTile(t,this.m_decodeInfo,T.copy(m),C,c),r.push(C.x,C.y,C.z),l)){f.webMercatorTile2TargetTile(t,this.m_decodeInfo,T.copy(p),x,c),r.push(x.x,x.y,x.z),a.push(o);const e=C.distanceTo(x);n+=e,o+=e,a.push(o)}}else u.push(r),r=[];g&&!l&&(f.webMercatorTile2TargetTile(t,this.m_decodeInfo,T.copy(p),C,c),r.push(C.x,C.y,C.z)),l&&r.length>0&&n>0&&(a.forEach(((e,t)=>{a[t]=e/n})),u.push(r),d.push(a))}!l&&r.length>0&&u.push(r)})),0!==u.length&&this.applyLineTechnique(i,e,a,o,s.entries,u,n,void 0,d)}))}}))}getDecodedTile(){this.createGeometries(),this.processSimpleLines(this.m_simpleLines),this.processLines(this.m_solidLines);const e={techniques:this.m_styleSetEvaluator.decodedTechniques,geometries:this.m_geometries,decodeTime:void 0};return this.m_textGeometries.length>0&&(e.textGeometries=this.m_textGeometries),this.m_poiGeometries.length>0&&(e.poiGeometries=this.m_poiGeometries),this.m_textPathGeometries.length>0&&(e.textPathGeometries=this.m_textPathGeometries),this.m_pathGeometries.length>0&&(e.pathGeometries=this.m_pathGeometries),0!==this.m_sources.length&&(e.copyrightHolderIds=this.m_sources),e.maxGeometryHeight=this.m_maxGeometryHeight,e.minGeometryHeight=this.m_minGeometryHeight,e}splitJaggyLines(e,t,i){const r=[],n=(e,t,i)=>{let r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;for(let s=t;s<i;s+=3){const t=e[s],i=e[s+1];t<r&&(r=t),t>n&&(n=t),i<o&&(o=i),i>a&&(a=i)}return(n-r)*(n-r)+(a-o)*(a-o)},o=e.slice();for(;o.length>0;){const e=o.pop();if(void 0===e||e.length<6)continue;let a=-1;for(let t=0;t<e.length-3;t+=3){P.set(e[t],e[t+1]),O.set(e[t+3],e[t+4]);const r=O.sub(P).normalize();if(t>0){const e=Math.atan2(A.x*r.y-r.x*A.y,r.dot(A));if(Math.abs(e)>i){a=t;break}}A.set(r.x,r.y)}if(a>0){const i=n(e,0,a+3),s=n(e,a,e.length);i>t&&r.push(e.slice(0,a+3)),s>t&&o.push(e.slice(a))}else n(e,0,e.length)>t&&r.push(e)}return r}getTextureCoordinateType(e){return(r.isFillTechnique(e)||r.isSolidLineTechnique(e)||r.isExtrudedPolygonTechnique(e))&&this.m_options.enableElevationOverlay?r.TextureCoordinateType.TileSpace:r.textureCoordinateType(e)}getComputeTexCoordsFunc(e,t){switch(this.getTextureCoordinateType(e)){case r.TextureCoordinateType.TileSpace:return(e,t)=>{const i=e.clone().divideScalar(t);return i.y=1-i.y,i};case r.TextureCoordinateType.EquirectangularSpace:return(e,t)=>{const i=f.tile2world(t,this.m_decodeInfo,e,!1,w),r=l.normalizedEquirectangularProjection.reprojectPoint(l.webMercatorProjection,i);return new p.Vector2(r.x,r.y)};case r.TextureCoordinateType.FeatureSpace:if(!t)return;return(e,i)=>{const r=f.tile2world(i,this.m_decodeInfo,e,!1,w),n=new p.Vector2(r.x,r.y);return t&&(n.x-=t.min.x,n.y-=t.min.y,n.x/=t.max.x-t.min.x,n.y/=t.max.y-t.min.y),n.y=1-n.y,n};default:return}}applyLineTechnique(e,t,i,n=F.Complex,o,a,s,l,u){let d;const h=e.find((e=>e.technique===i)),m=void 0!==l;if(void 0===h){d=new c.LineGroup(m,void 0,n===F.Simple);const t={type:n===F.Complex?r.GeometryType.SolidLine:r.GeometryType.Line,technique:i,lines:d};this.m_options.gatherFeatureAttributes&&(t.objInfos=[o],t.featureStarts=[0]),e.push(t)}else d=h.lines,this.m_options.gatherFeatureAttributes&&h.objInfos&&h.featureStarts&&(h.objInfos.push(o),h.featureStarts.push(d.indices.length));let p=0;a.forEach((e=>{d.add(this.m_decodeInfo.center,e,this.projection,u?u[p]:void 0,l?l[p]:void 0),p++}))}applyPolygonTechnique(e,t,i,o,c){var u,g;if(0===e.length)return;const x=r.isExtrudedPolygonTechnique(t),P=x?r.GeometryType.ExtrudedPolygon:r.GeometryType.Polygon,O=this.findOrCreateMeshBuffers(i,P);if(void 0===O)return;const A=t,D=t,R=!0===A.boundaryWalls,I=r.isFillTechnique(t),M=this.getTextureCoordinateType(t);let L=n.evaluateTechniqueAttr(o,A.height),k=n.evaluateTechniqueAttr(o,A.floorHeight);if(void 0===L){const e=o.env.lookup("height"),t=n.evaluateTechniqueAttr(o,A.defaultHeight);L=void 0!==e?e:void 0!==t?t:0}if(void 0===k){const e=o.env.lookup("min_height");k=void 0===e||I?0:e}L=Math.max(k+d.ExtrusionFeatureDefs.MIN_BUILDING_HEIGHT,L);const N=this.m_decodeInfo.tileKey.level,j=x&&r.scaleHeight(o,A,N);this.m_decodeInfo.tileBounds.getCenter(v);const{positions:F,normals:B,textureCoordinates:G,colors:z,extrusionAxis:H,indices:q,edgeIndices:W,groups:K}=O,$=this.m_decodeInfo.targetProjection.type===l.ProjectionType.Spherical,Y=x?null!==(u=A.lineWidth)&&void 0!==u?u:0:I&&null!==(g=D.lineWidth)&&void 0!==g?g:0,Q="number"!=typeof Y||Y>0;let J;if(r.isExtrudedPolygonTechnique(t)&&h.getOptionValue(t.vertexColors,!1)){let e=n.evaluateTechniqueAttr(o,t.color);if(void 0===e){const t=o.env.lookup("color");this.isColorStringValid(t)&&(e=String(t))}void 0===e&&(e=n.evaluateTechniqueAttr(o,t.defaultColor,0)),void 0===e&&(e=0),V.set(e),J=V}for(const t of e){const e=q.length,r=W.length,n=[],u=F.length/3,d=t[0],h=d.vertexStride,g=h+2;for(let e=0;e<d.points.length;++e){const t=d.points[e];n.push(t.x,-t.y),void 0!==d.textureCoords&&n.push(d.textureCoords[e].x,d.textureCoords[e].y);const i=(e+1)%d.points.length,r=d.isProperEdge(e);n.push(r?i:-1,R||r?i:-1)}const v=[];let P=1;for(;P<t.length;){const e=n.length/g;v.push(e);const i=t[P++];for(let t=0;t<i.points.length;++t){const r=(t+1)%i.points.length,o=i.points[t];n.push(o.x,-o.y),void 0!==i.textureCoords&&n.push(i.textureCoords[t].x,i.textureCoords[t].y);const a=i.isProperEdge(t);n.push(a?e+r:-1,R||a?e+r:-1)}}try{const e=m.default(n,v,g),t=n.length/g;if($){const t=new p.BufferGeometry,i=[],r=[],o=[],u=[];for(let e=0;e<n.length;e+=g){const t=f.tile2world(c,this.m_decodeInfo,T.set(n[e],n[e+1]),!0,w);i.push(t.x,t.y,0),void 0!==M&&r.push(n[e+2],n[e+3]),o.push(n[e+h]),u.push(n[e+h+1])}const d=new p.BufferAttribute(new Float32Array(i),3);let m;t.setAttribute("position",d),void 0!==M&&(m=new p.BufferAttribute(new Float32Array(r),2),t.setAttribute("uv",m));const y=new p.BufferAttribute(new Float32Array(o),1);t.setAttribute("edge",y);const v=new p.BufferAttribute(new Float32Array(u),1);t.setAttribute("wall",y);const _=U(e,d.count-1),b="uint32"===_.type?new p.Uint32BufferAttribute(_.buffer,1):new p.Uint16BufferAttribute(_.buffer,1);t.setIndex(b);const S=this.m_decodeInfo.tileKey.level;if(S>=3&&S<9){const e=Math.pow(2,9-S),{geoBox:i}=this.m_decodeInfo;new a.EdgeLengthGeometrySubdivisionModifier(e,i,a.SubdivisionMode.NoDiagonals,l.webMercatorProjection).modify(t)}new s.SphericalGeometrySubdivisionModifier(p.MathUtils.degToRad(10),l.webMercatorProjection).modify(t),n.length=0,e.length=0;for(let e=0;e<d.array.length;e+=3){const t=f.world2tile(c,this.m_decodeInfo,C.set(d.array[e],d.array[e+1],0),!0,E);n.push(t.x,t.y),void 0!==M&&(n.push(m.array[e/3*2]),n.push(m.array[e/3*2+1])),n.push(y.array[e/3]),n.push(v.array[e/3])}const x=t.getIndex();null!==x&&e.push(...x.array)}_.set(0,0,1);for(let e=0;e<n.length;e+=g){f.webMercatorTile2TargetWorld(c,this.m_decodeInfo,T.set(n[e],n[e+1]),C,!1,!0);const t=j?this.m_decodeInfo.targetProjection.getScaleFactor(C):1;this.m_maxGeometryHeight=Math.max(this.m_maxGeometryHeight,t*L),this.m_minGeometryHeight=Math.min(this.m_minGeometryHeight,t*L),$&&_.set(C.x,C.y,C.z).normalize(),C.sub(this.center),b.copy(_).multiplyScalar(k*t),F.push(C.x+b.x,C.y+b.y,C.z+b.z),void 0!==M&&G.push(n[e+2],n[e+3]),this.m_options.enableElevationOverlay&&B.push(..._.toArray()),x&&(S.copy(_).multiplyScalar(L*t),F.push(C.x+S.x,C.y+S.y,C.z+S.z),H.push(0,0,0,0,S.x-b.x,S.y-b.y,S.z-b.z,1),void 0!==M&&G.push(n[e+2],n[e+3]),this.m_options.enableElevationOverlay&&B.push(..._.toArray()),void 0!==J&&z.push(J.r,J.g,J.b,J.r,J.g,J.b))}for(let t=0;t<e.length;t+=3)if(x){const i=u+2*e[t+0]+1,r=u+2*e[t+1]+1,n=u+2*e[t+2]+1;q.push(i,r,n)}else{const i=u+e[t+0],r=u+e[t+1],n=u+e[t+2];q.push(i,r,n)}Q&&this.addEdges(u,t,g,h,F,n,W,x,A.footprint,A.maxSlope),x&&this.addWalls(u,t,g,h,n,q)}catch(e){y.error("cannot triangulate geometry",e)}this.m_options.gatherFeatureAttributes&&(O.objInfos.push(o.env.entries),O.featureStarts.push(e),O.edgeFeatureStarts.push(r));const D=q.length-e;D>0&&K.push({start:e,count:D,technique:i})}}createGeometries(){this.m_meshBuffers.forEach(((e,t)=>{if(0===e.positions.length)return;if(!this.m_styleSetEvaluator.techniques||this.m_styleSetEvaluator.techniques.length<=t)throw new Error("Invalid technique index");const i=this.m_styleSetEvaluator.techniques[t];if(void 0===i)return;if(e.texts.length>0){const n={positions:{name:"position",type:"float",buffer:new Float64Array(e.positions).buffer,itemCount:3},texts:e.texts,technique:t,stringCatalog:e.stringCatalog,objInfos:e.objInfos};if(r.isTextTechnique(i))this.m_textGeometries.push(n);else{h.assert(r.isPoiTechnique(i));const t=n;t.imageTextures=e.imageTextures,t.offsetDirections=e.offsetDirections,this.m_poiGeometries.push(t)}return}const n=new Float32Array(e.positions);0===e.groups.length&&e.groups.push({start:0,count:n.length/3,technique:t});const o=[{name:"position",buffer:n.buffer,itemCount:3,type:"float"}],a={type:e.type,vertexAttributes:o,groups:e.groups};if(e.normals.length>0){const t=new Float32Array(e.normals);h.assert(t.length===n.length,"length of normals buffer is different than the length of the position buffer"),o.push({name:"normal",buffer:t.buffer,itemCount:3,type:"float"})}if(e.colors.length>0){const t=new Float32Array(e.colors);h.assert(t.length===n.length,"length of colors buffer is different than the length of the position buffer"),o.push({name:"color",buffer:t.buffer,itemCount:3,type:"float"})}const s=e.positions.length/3;if(e.textureCoordinates.length>0){const t=e.textureCoordinates.length/2;h.assert(t===s,"length of textureCoordinates buffer is different than the length of theposition buffer");const i=new Float32Array(e.textureCoordinates);o.push({name:"uv",buffer:i.buffer,itemCount:2,type:"float"})}if(e.extrusionAxis.length>0){const t=new Float32Array(e.extrusionAxis);h.assert(t.length/4==n.length/3,"length of extrusionAxis buffer is different than the length of the position buffer"),o.push({name:"extrusionAxis",buffer:t.buffer,itemCount:4,type:"float"})}e.indices.length>0&&(a.index=U(e.indices,s-1)),e.edgeIndices.length>0&&(a.edgeIndex=U(e.edgeIndices,s-1,"edgeIndex")),a.featureStarts=e.featureStarts,a.edgeFeatureStarts=e.edgeFeatureStarts,a.objInfos=e.objInfos,this.m_geometries.push(a)}))}processLines(e){e.forEach((e=>{const{vertices:t,indices:i}=e.lines,n=e.technique,o=new Float32Array(t).buffer,a=U(i,t.length/e.lines.stride-1),s={type:"float",stride:e.lines.stride,buffer:o,attributes:e.lines.vertexAttributes},l={type:r.GeometryType.SolidLine,index:a,interleavedVertexAttributes:[s],groups:[{start:0,count:i.length,technique:n}],vertexAttributes:[],featureStarts:e.featureStarts,objInfos:e.objInfos};this.m_geometries.push(l)}))}processSimpleLines(e){e.forEach((e=>{const{vertices:t,indices:i}=e.lines,n=e.technique,o={buffer:new Float32Array(t).buffer,itemCount:3,type:"float",name:"position"},a={type:r.GeometryType.Line,index:U(i,t.length/o.itemCount-1),vertexAttributes:[o],groups:[{start:0,count:i.length,technique:n}],featureStarts:e.featureStarts,objInfos:e.objInfos};this.m_geometries.push(a)}))}findOrCreateMeshBuffers(e,t){let i=this.m_meshBuffers.get(e);return void 0!==i?i.type!==t?void y.error(`MeshBuffer has been created with wrong type "${r.GeometryType[t]}"\n                instead of "${r.GeometryType[i.type]}"`):i:(i=new j(t),this.m_meshBuffers.set(e,i),i)}processFeatureCommon(e){const t=e.lookup("source");"string"==typeof t&&""!==t&&(this.m_sources.includes(t)||this.m_sources.push(t))}isColorStringValid(e){return"string"==typeof e&&e.length>0}addEdges(e,t,i,r,n,o,a,s,l,c){const u=new p.Vector3,d=new p.Vector3;let h,m,f=0,g=0;for(;f<t;){for(;f!==h;){void 0===h&&(h=f),f<t&&(g=Math.max(g,f));const p=o[f*i+r];if(p<0)break;if(s)if(!0===l&&a.push(e+2*f,e+2*p),a.push(e+2*f+1,e+2*p+1),void 0!==c){if(void 0!==m){const t=3*(e+2*m),i=3*(e+2*f),r=3*(e+2*p);u.set(n[i]-n[t],n[i+1]-n[t+1],n[i+2]-n[t+2]).normalize(),d.set(n[r]-n[i],n[r+1]-n[i+1],n[r+2]-n[i+2]).normalize(),u.dot(d)<=c&&a.push(e+2*f,e+2*f+1)}}else a.push(e+2*f,e+2*f+1);else a.push(e+f,e+p);m=f,f=p}f=g+1,h=void 0,m=void 0}}addWalls(e,t,i,r,n,o){let a,s=0,l=0;for(;s<t;){for(;s!==a;){void 0===a&&(a=s),s<t&&(l=Math.max(l,s));const c=n[s*i+r+1];if(c<0)break;o.push(e+2*s,e+2*s+1,e+2*c+1,e+2*c+1,e+2*c,e+2*s),s=c}s=l+1,a=void 0}}findRelativePositionInLine(e,t){let i=1/0,r=0;for(let n=0;n<t.length;n+=4){k.set(D.set(t[n],t[n+1],t[n+2]),R.set(t[n+4],t[n+5],t[n+6])),k.closestPointToPoint(e,!0,I);const o=I.distanceTo(e);o<i&&(M.copy(I),L.copy(D),i=o,r=t[n+3])}return r+M.distanceTo(L)}}},52063:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VectorTileDecoderService=t.VectorTileDecoder=t.VectorTileDataProcessor=void 0;const r=i(96500),n=i(17550),o=i(19955),a=i(38338),s=i(59249),l=i(125),c=i(52221),u=i(94409),d=i(16038),h=i(36733),m=a.LoggerManager.instance.create("VectorTileDecoder",{enabled:!1});class p{constructor(e,t,i,r,n={},o){var a,s;this.m_tileKey=e,this.m_projection=t,this.m_styleSetEvaluator=i,this.m_dataAdapter=r,this.m_options=n,this.m_dataFilter=o,n.storageLevelOffset=null!==(a=n.storageLevelOffset)&&void 0!==a?a:0,n.showMissingTechniques=null!==(s=n.showMissingTechniques)&&void 0!==s&&s}getDecodedTile(e){this.m_styleSetEvaluator.resetTechniques();const t=new u.DecodeInfo(this.m_projection,this.m_tileKey,this.m_options.storageLevelOffset);return this.m_decodedTileEmitter=new h.VectorTileDataEmitter(t,this.m_styleSetEvaluator,this.m_options),this.m_dataAdapter.process(e,t,this),this.m_decodedTileEmitter.getDecodedTile()}processPointFeature(e,t,i,n,o){a.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,i,"point",n,o,this.m_decodedTileEmitter.processPointFeature,r.GeometryKind.Label)}processLineFeature(e,t,i,n,o){a.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,i,"line",n,o,this.m_decodedTileEmitter.processLineFeature,r.GeometryKind.Line)}processPolygonFeature(e,t,i,n,o){a.assert(void 0!==this.m_decodedTileEmitter),this.processFeature(e,t,i,"polygon",n,o,this.m_decodedTileEmitter.processPolygonFeature,r.GeometryKind.Area)}processFeature(e,t,i,r,n,o,a,s){const l=this.createMapEnv(n,o,e,r),c=this.applyKindFilter(this.m_styleSetEvaluator.getMatchingTechniques(l,e,r),s);if(0===c.length)return void(this.m_options.showMissingTechniques&&m.log("VectorTileDataProcessor#processFeature: no techniques for object:",JSON.stringify(l.unmap())));const u={env:l,cachedExprResults:new Map};this.m_decodedTileEmitter&&a.apply(this.m_decodedTileEmitter,[e,t,i,u,c])}createMapEnv(e,t,i,r){const o=this.m_tileKey.level;return new n.MapEnv(Object.assign({$layer:i,$id:null!=t?t:null,$level:o,$zoom:Math.max(0,o-this.m_options.storageLevelOffset),$geometryType:r},e))}applyKindFilter(e,t){return void 0!==this.m_dataFilter&&this.m_dataFilter.hasKindFilter&&(e=e.filter((e=>{const i=void 0===e.kind?t:e.kind;return this.m_dataFilter.wantsKind(i)}))),e}}t.VectorTileDataProcessor=p;class f extends o.ThemedTileDecoder{constructor(){super(),this.m_roundUpCoordinatesIfNeeded=!1,this.m_options={map:{},changed:!1},this.m_defaultDataAdapters=[],this.m_defaultDataAdapters.push(new c.OmvDataAdapter,new l.GeoJsonVtDataAdapter,new s.GeoJsonDataAdapter)}connect(){return Promise.resolve()}decodeThemedTile(e,t,i,r){const n=a.PerformanceTimer.now();if(!this.m_dataAdapter&&(this.m_dataAdapter=this.getDataAdapter(e),!this.m_dataAdapter))return Promise.reject(new Error("Unsupported data format."));const o=this.m_dataAdapter;if(a.assert(o.canProcess(e)),this.m_options.changed){if(o instanceof c.OmvDataAdapter){const e=this.m_options.map;o.configure(e,i),this.m_featureFilter=o.dataFilter}this.m_options.changed=!1}const s=new p(t,r,i,o,this.m_options.map,this.m_featureFilter).getDecodedTile(e);return s.decodeTime=a.PerformanceTimer.now()-n,Promise.resolve(s)}configure(e,t){super.configure(e,t),this.m_options.map=Object.assign(Object.assign(Object.assign({},this.m_options.map),e),t),this.m_options.changed=!0}getDataAdapter(e){for(const t of this.m_defaultDataAdapters)if(t.canProcess(e))return t}}t.VectorTileDecoder=f,t.VectorTileDecoderService=class{static start(){o.WorkerServiceManager.getInstance().register({serviceType:d.VECTOR_TILE_DECODER_SERVICE_TYPE,factory:e=>o.TileDecoderService.start(e,new f)})}}},125:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonVtDataAdapter=void 0;const r=i(32941),n=i(84428),o=i(79115),a=4096;var s;!function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"}(s||(s={}));const l=new n.Vector3;t.GeoJsonVtDataAdapter=class{canProcess(e){if(o.isArrayBufferLike(e))return!1;const t=e;return void 0!==t.features&&void 0!==t.source&&void 0!==t.x&&void 0!==t.y&&void 0!==t.z}process(e,t,i){for(const c of e.features)switch(c.type){case s.Point:for(const t of c.geometry){const r=t[0],o=t[1],s=new n.Vector3(r,o,0);i.processPointFeature(e.layer,a,[s],c.tags,c.id)}break;case s.LineString:{const s=c.geometry;let u;const d=[];s.forEach((e=>{const t=null==u?void 0:u.positions[u.positions.length-1],[i,r]=e[0];if((null==t?void 0:t.x)===i&&(null==t?void 0:t.y)===r)for(let t=1;t<e.length;++t){const[i,r]=e[t];null==u||u.positions.push(new n.Vector2(i,r))}else{const t=e.map((([e,t])=>new n.Vector2(e,t)));d.push({positions:t}),u=d[d.length-1]}})),d.forEach((e=>{e.untiledPositions=e.positions.map((e=>(o.tile2world(a,t,e,!1,l),r.webMercatorProjection.unprojectPoint(l))))})),i.processLineFeature(e.layer,a,d,c.tags,c.id);break}case s.Polygon:{const t=[];let r;for(const e of c.geometry){const i=[];for(const[t,r]of e){const e=new n.Vector2(t,r);i.push(e)}n.ShapeUtils.area(i)>0&&(r={rings:[]},t.push(r)),null==r||r.rings.push(i)}i.processPolygonFeature(e.layer,a,t,c.tags,c.id);break}case s.Unknown:}}}},59249:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonDataAdapter=void 0;const r=i(37725),n=i(32941),o=i(84428),a=i(79115),s=4096,l=new o.Vector3;function c(e,t,i){return n.webMercatorProjection.projectPoint(n.GeoCoordinates.fromGeoPoint(e),l),a.world2tile(s,t,l,!1,i)}function u(e,t){return{untiledPositions:e.map((e=>n.GeoCoordinates.fromGeoPoint(e))),positions:e.map((e=>c(e,t,new o.Vector2)))}}function d(e,t){return"LineString"===e.type?[u(e.coordinates,t)]:e.coordinates.map((e=>u(e,t)))}function h(e,t){return{rings:e.map(((e,i)=>{const r=0===i,{positions:n}=u(e,t),a=o.ShapeUtils.area(n)>0;return(r&&!a||!r&&a)&&n.reverse(),n}))}}function m(e,t){return"Polygon"===e.type?[h(e.coordinates,t)]:e.coordinates.map((e=>h(e,t)))}function p(e,t){return"Point"===e.type?[c(e.coordinates,t,new o.Vector3)]:e.coordinates.map((e=>c(e,t,new o.Vector3)))}t.GeoJsonDataAdapter=class{canProcess(e){return e&&"FeatureCollection"===e.type&&Array.isArray(e.features)}process(e,t,i,n="geojson"){if(Array.isArray(e.features)&&0!==e.features.length)for(const o of e.features)switch(o.geometry.type){case"LineString":case"MultiLineString":{let e=d(o.geometry,t);const a=[],l=100;e.forEach((e=>{r.clipLineString(e.positions,-l,-l,s+l,s+l).forEach((e=>{a.push({positions:e})}))})),e=a,e.length>0&&i.processLineFeature(n,s,a,o.properties,o.id);break}case"Polygon":case"MultiPolygon":{const e=m(o.geometry,t);i.processPolygonFeature(n,s,e,o.properties,o.id);break}case"Point":case"MultiPoint":{const e=p(o.geometry,t);i.processPointFeature(n,s,e,o.properties,o.id);break}}}}},51400:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryCommands=t.FeatureAttributes=t.visitOmvLayer=t.visitOmv=t.isClosePathCommand=t.isLineToCommand=t.isMoveToCommand=t.CommandKind=void 0;const r=i(84428),n=i(31940);var o;function a(e,t){if((!t.visitLayer||t.visitLayer(e))&&e.features)for(const i of e.features)switch(i.type){case n.com.mapbox.pb.Tile.GeomType.UNKNOWN:break;case n.com.mapbox.pb.Tile.GeomType.POINT:t.visitPointFeature&&t.visitPointFeature(i);break;case n.com.mapbox.pb.Tile.GeomType.LINESTRING:t.visitLineFeature&&t.visitLineFeature(i);break;case n.com.mapbox.pb.Tile.GeomType.POLYGON:t.visitPolygonFeature&&t.visitPolygonFeature(i)}t.endVisitLayer&&t.endVisitLayer(e)}!function(e){e[e.MoveTo=1]="MoveTo",e[e.LineTo=2]="LineTo",e[e.ClosePath=7]="ClosePath"}(o=t.CommandKind||(t.CommandKind={})),t.isMoveToCommand=function(e){return e.kind===o.MoveTo},t.isLineToCommand=function(e){return e.kind===o.LineTo},t.isClosePathCommand=function(e){return e.kind===o.ClosePath},t.visitOmv=function(e,t){if(e.layers)for(const i of e.layers)t.visitLayer&&!t.visitLayer(i)||a(i,t),t.endVisitLayer&&t.endVisitLayer(i)},t.visitOmvLayer=a,t.FeatureAttributes=class{accept(e,t,i){const{keys:r,values:n}=e,o=t.tags;if(o&&r&&n)for(let e=0;e<o.length;e+=2){const t=r[o[e]],a=n[o[e+1]];if(!i.visitAttribute(t,a))break}}},t.GeometryCommands=class{accept(e,t){if(!e)return;const i=e.length;let n=0,a=0;const s=[],l=[],c=[];for(let u=0;u<i;){const i=7&e[u],d=e[u]>>3;if(++u,i===o.MoveTo||i===o.LineTo)for(let o=0;o<d;++o){const o=e[u++],d=e[u++];n+=o>>1^-(1&o),a+=d>>1^-(1&d),"Polygon"===t.type&&(s.push(n),l.push(a));const h=new r.Vector2(n,a);c.push({kind:i,position:h})}else{for(const e of c)t.visitCommand(e);t.visitCommand({kind:i}),s.length=0,l.length=0,c.length=0}}if(c.length>0)for(const e of c)t.visitCommand(e)}}},52221:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OmvDataAdapter=t.asGeometryType=void 0;const r=i(17550),n=i(38338),o=i(43720),a=i(84428),s=i(35236),l=i(16038),c=i(75940),u=i(79115),d=i(96094),h=i(51400),m=i(31940),p=["stringValue","floatValue","doubleValue","intValue","uintValue","sintValue","boolValue"],f=n.LoggerManager.instance.create("OmvDataAdapter",{enabled:!1});function g(e,t,i){if(void 0!==t.id&&null!==t.id)return t.id;if(e.hasOwnProperty("id")){const t=e.id;if("number"==typeof t)return t;if(t)return void 0!==i&&t.greaterThan(Number.MAX_SAFE_INTEGER)&&i.error("Invalid ID: Larger than largest available Number in feature: ",e),t.toNumber()}}function y(e){if(void 0===e)return l.OmvGeometryType.UNKNOWN;switch(e.type){case m.com.mapbox.pb.Tile.GeomType.UNKNOWN:return l.OmvGeometryType.UNKNOWN;case m.com.mapbox.pb.Tile.GeomType.POINT:return l.OmvGeometryType.POINT;case m.com.mapbox.pb.Tile.GeomType.LINESTRING:return l.OmvGeometryType.LINESTRING;case m.com.mapbox.pb.Tile.GeomType.POLYGON:return l.OmvGeometryType.POLYGON;default:return l.OmvGeometryType.UNKNOWN}}function v(e,t){e.forEach((e=>{e.x===t-1&&(e.x=t)}))}function _(e,t){switch(t){case l.FeatureModifierId.default:return new s.OmvGenericFeatureModifier(e);default:return n.assert(!1),new s.OmvGenericFeatureModifier(e)}}t.asGeometryType=y,t.OmvDataAdapter=class{constructor(){this.m_geometryCommands=new h.GeometryCommands,this.m_roundUpCoordinatesIfNeeded=!1}get dataFilter(){return this.m_dataFilter}configure(e,t){var i;if(void 0!==e.filterDescription){if(null!==e.filterDescription){const t=e.filterDescription,i=e.featureModifiers;this.m_dataFilter=new s.OmvGenericFeatureFilter(t);const r=[];void 0!==i?i.forEach((e=>{r.push(_(t,e))})):r.push(_(t,l.FeatureModifierId.default)),this.m_featureModifiers=r}else this.m_dataFilter=void 0,this.m_featureModifiers=void 0;const i=new d.StyleSetDataFilter(t);this.m_dataFilter=this.m_dataFilter?new s.ComposedDataFilter([i,this.m_dataFilter]):i}if(void 0!==e.politicalView){const t=e.politicalView;let i=this.m_featureModifiers;if(i&&(i=i.filter((e=>!(e instanceof c.OmvPoliticalViewFeatureModifier)))),0!==t.length){n.assert(2===t.length,"The political view must be specified as two letters ISO 3166-1 standard!");const e=new c.OmvPoliticalViewFeatureModifier(t);i?i.push(e):i=[e]}this.m_featureModifiers=i&&i.length>0?i:void 0}this.m_roundUpCoordinatesIfNeeded=null!==(i=e.roundUpCoordinatesIfNeeded)&&void 0!==i&&i}canProcess(e){return u.isArrayBufferLike(e)}process(e,t,i){const{tileKey:r}=t,n=new Uint8Array(e),o=m.com.mapbox.pb.Tile.decode(n);this.m_tileKey=r,this.m_processor=i,h.visitOmv(o,this)}visitLayer(e){this.m_layer=e;const t=this.m_tileKey.level,i=e.name;return!(void 0!==this.m_dataFilter&&!this.m_dataFilter.wantsLayer(i,t))}visitPointFeature(e){var t,i,r;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessPointFeature,o=this.filterAndModifyFeature(e,null===(i=this.m_dataFilter)||void 0===i?void 0:i.wantsPointFeature,n);if(!o)return;const s=this.m_layer.name,l=null!==(r=this.m_layer.extent)&&void 0!==r?r:4096,c=[];this.m_geometryCommands.accept(e.geometry,{type:"Point",visitCommand:e=>{h.isMoveToCommand(e)&&c.push(new a.Vector3(e.position.x,e.position.y,0))}}),0!==c.length&&this.m_processor.processPointFeature(s,l,c,o,g(e,o,f))}visitLineFeature(e){var t,i,r;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessLineFeature,o=this.filterAndModifyFeature(e,null===(i=this.m_dataFilter)||void 0===i?void 0:i.wantsLineFeature,n);if(!o)return;const a=this.m_layer.name,s=null!==(r=this.m_layer.extent)&&void 0!==r?r:4096,l=[];let c;this.m_geometryCommands.accept(e.geometry,{type:"Line",visitCommand:e=>{h.isMoveToCommand(e)?(c=[e.position],l.push({positions:c})):h.isLineToCommand(e)&&c.push(e.position)}}),0!==l.length&&(this.mustRoundUpCoordinates&&function(e,t){e.forEach((e=>v(e.positions,t)))}(l,s),this.m_processor.processLineFeature(a,s,l,o,g(e,o,f)))}visitPolygonFeature(e){var t,i,r;if(void 0===e.geometry)return;const n=null===(t=this.m_featureModifiers)||void 0===t?void 0:t[0].doProcessPolygonFeature,o=this.filterAndModifyFeature(e,null===(i=this.m_dataFilter)||void 0===i?void 0:i.wantsPolygonFeature,n);if(!o)return;const s=this.m_layer.name,l=null!==(r=this.m_layer.extent)&&void 0!==r?r:4096,c=[];let u,d,m;this.m_geometryCommands.accept(e.geometry,{type:"Polygon",visitCommand:e=>{if(h.isMoveToCommand(e))d=[e.position];else if(h.isLineToCommand(e))d.push(e.position);else if(h.isClosePathCommand(e)&&void 0!==d&&d.length>0){const e=Math.sign(a.ShapeUtils.area(d));void 0===m&&(m=e),e===m&&(u={rings:[]},c.push(u)),d.push(d[0].clone()),null==u||u.rings.push(d)}}}),0!==c.length&&(this.mustRoundUpCoordinates&&function(e,t){e.forEach((e=>e.rings.forEach((e=>v(e,t)))))}(c,l),function(e){const t=e[0];if(void 0!==t&&0!==t.rings.length&&!(a.ShapeUtils.area(t.rings[0])>0))for(const t of e)for(const e of t.rings)e.reverse()}(c),this.m_processor.processPolygonFeature(s,l,c,o,g(e,o,f)))}filterAndModifyFeature(e,t,i){var a;const s=this.m_tileKey.level,l=this.m_layer.name,c=y(e);if(this.m_dataFilter&&!1===t.apply(this.m_dataFilter,[l,c,s]))return;const u=function(e,t){const i=new h.FeatureAttributes,r={};return i.accept(e,t,{visitAttribute:(e,t)=>(r[e]=function(e){const t=Object.prototype.hasOwnProperty;for(const i of p)if(t.call(e,i)){const t=e[i];if(void 0===t)throw new Error("unpexted undefined value");return o.isLong(t)?t.toNumber():t}throw new Error("not happening")}(t),!0)}),r}(this.m_layer,e),d=new r.MapEnv(u);return void 0===(null===(a=this.m_featureModifiers)||void 0===a?void 0:a.find((e=>(n.assert(void 0!==i),!i.apply(e,[l,d,this.m_tileKey.level])))))?u:void 0}get mustRoundUpCoordinates(){return this.m_roundUpCoordinatesIfNeeded&&this.m_tileKey.level<5&&this.m_tileKey.column===this.m_tileKey.columnCount()-1}}},31940:(e,t,i)=>{"use strict";var r,n,o,a=i(62100),s=a.Reader,l=a.util,c=a.roots.default||(a.roots.default={});c.com=((o={}).mapbox=((n={}).pb=((r={}).Tile=function(){function e(e){if(this.layers=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}var t,i;return e.prototype.layers=l.emptyArray,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new c.com.mapbox.pb.Tile;e.pos<i;){var n=e.uint32();switch(n>>>3){case 3:r.layers&&r.layers.length||(r.layers=[]),r.layers.push(c.com.mapbox.pb.Tile.Layer.decode(e,e.uint32()));break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof c.com.mapbox.pb.Tile)return e;var t=new c.com.mapbox.pb.Tile;if(e.layers){if(!Array.isArray(e.layers))throw TypeError(".com.mapbox.pb.Tile.layers: array expected");t.layers=[];for(var i=0;i<e.layers.length;++i){if("object"!=typeof e.layers[i])throw TypeError(".com.mapbox.pb.Tile.layers: object expected");t.layers[i]=c.com.mapbox.pb.Tile.Layer.fromObject(e.layers[i])}}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.layers=[]),e.layers&&e.layers.length){i.layers=[];for(var r=0;r<e.layers.length;++r)i.layers[r]=c.com.mapbox.pb.Tile.Layer.toObject(e.layers[r],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e.GeomType=(t={},(i=Object.create(t))[t[0]="UNKNOWN"]=0,i[t[1]="POINT"]=1,i[t[2]="LINESTRING"]=2,i[t[3]="POLYGON"]=3,i),e.Value=function(){function e(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.stringValue="",e.prototype.floatValue=0,e.prototype.doubleValue=0,e.prototype.intValue=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.uintValue=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.sintValue=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.boolValue=!1,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new c.com.mapbox.pb.Tile.Value;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.stringValue=e.string();break;case 2:r.floatValue=e.float();break;case 3:r.doubleValue=e.double();break;case 4:r.intValue=e.int64();break;case 5:r.uintValue=e.uint64();break;case 6:r.sintValue=e.sint64();break;case 7:r.boolValue=e.bool();break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof c.com.mapbox.pb.Tile.Value)return e;var t=new c.com.mapbox.pb.Tile.Value;return null!=e.stringValue&&(t.stringValue=String(e.stringValue)),null!=e.floatValue&&(t.floatValue=Number(e.floatValue)),null!=e.doubleValue&&(t.doubleValue=Number(e.doubleValue)),null!=e.intValue&&(l.Long?(t.intValue=l.Long.fromValue(e.intValue)).unsigned=!1:"string"==typeof e.intValue?t.intValue=parseInt(e.intValue,10):"number"==typeof e.intValue?t.intValue=e.intValue:"object"==typeof e.intValue&&(t.intValue=new l.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber())),null!=e.uintValue&&(l.Long?(t.uintValue=l.Long.fromValue(e.uintValue)).unsigned=!0:"string"==typeof e.uintValue?t.uintValue=parseInt(e.uintValue,10):"number"==typeof e.uintValue?t.uintValue=e.uintValue:"object"==typeof e.uintValue&&(t.uintValue=new l.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0))),null!=e.sintValue&&(l.Long?(t.sintValue=l.Long.fromValue(e.sintValue)).unsigned=!1:"string"==typeof e.sintValue?t.sintValue=parseInt(e.sintValue,10):"number"==typeof e.sintValue?t.sintValue=e.sintValue:"object"==typeof e.sintValue&&(t.sintValue=new l.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber())),null!=e.boolValue&&(t.boolValue=Boolean(e.boolValue)),t},e.toObject=function(e,t){t||(t={});var i={};if(t.defaults){if(i.stringValue="",i.floatValue=0,i.doubleValue=0,l.Long){var r=new l.Long(0,0,!1);i.intValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.intValue=t.longs===String?"0":0;l.Long?(r=new l.Long(0,0,!0),i.uintValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.uintValue=t.longs===String?"0":0,l.Long?(r=new l.Long(0,0,!1),i.sintValue=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):i.sintValue=t.longs===String?"0":0,i.boolValue=!1}return null!=e.stringValue&&e.hasOwnProperty("stringValue")&&(i.stringValue=e.stringValue),null!=e.floatValue&&e.hasOwnProperty("floatValue")&&(i.floatValue=t.json&&!isFinite(e.floatValue)?String(e.floatValue):e.floatValue),null!=e.doubleValue&&e.hasOwnProperty("doubleValue")&&(i.doubleValue=t.json&&!isFinite(e.doubleValue)?String(e.doubleValue):e.doubleValue),null!=e.intValue&&e.hasOwnProperty("intValue")&&("number"==typeof e.intValue?i.intValue=t.longs===String?String(e.intValue):e.intValue:i.intValue=t.longs===String?l.Long.prototype.toString.call(e.intValue):t.longs===Number?new l.LongBits(e.intValue.low>>>0,e.intValue.high>>>0).toNumber():e.intValue),null!=e.uintValue&&e.hasOwnProperty("uintValue")&&("number"==typeof e.uintValue?i.uintValue=t.longs===String?String(e.uintValue):e.uintValue:i.uintValue=t.longs===String?l.Long.prototype.toString.call(e.uintValue):t.longs===Number?new l.LongBits(e.uintValue.low>>>0,e.uintValue.high>>>0).toNumber(!0):e.uintValue),null!=e.sintValue&&e.hasOwnProperty("sintValue")&&("number"==typeof e.sintValue?i.sintValue=t.longs===String?String(e.sintValue):e.sintValue:i.sintValue=t.longs===String?l.Long.prototype.toString.call(e.sintValue):t.longs===Number?new l.LongBits(e.sintValue.low>>>0,e.sintValue.high>>>0).toNumber():e.sintValue),null!=e.boolValue&&e.hasOwnProperty("boolValue")&&(i.boolValue=e.boolValue),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e.Feature=function(){function e(e){if(this.tags=[],this.geometry=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.id=l.Long?l.Long.fromBits(0,0,!0):0,e.prototype.tags=l.emptyArray,e.prototype.type=0,e.prototype.geometry=l.emptyArray,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new c.com.mapbox.pb.Tile.Feature;e.pos<i;){var n=e.uint32();switch(n>>>3){case 1:r.id=e.uint64();break;case 2:if(r.tags&&r.tags.length||(r.tags=[]),2==(7&n))for(var o=e.uint32()+e.pos;e.pos<o;)r.tags.push(e.uint32());else r.tags.push(e.uint32());break;case 3:r.type=e.int32();break;case 4:if(r.geometry&&r.geometry.length||(r.geometry=[]),2==(7&n))for(o=e.uint32()+e.pos;e.pos<o;)r.geometry.push(e.uint32());else r.geometry.push(e.uint32());break;default:e.skipType(7&n)}}return r},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof c.com.mapbox.pb.Tile.Feature)return e;var t=new c.com.mapbox.pb.Tile.Feature;if(null!=e.id&&(l.Long?(t.id=l.Long.fromValue(e.id)).unsigned=!0:"string"==typeof e.id?t.id=parseInt(e.id,10):"number"==typeof e.id?t.id=e.id:"object"==typeof e.id&&(t.id=new l.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0))),e.tags){if(!Array.isArray(e.tags))throw TypeError(".com.mapbox.pb.Tile.Feature.tags: array expected");t.tags=[];for(var i=0;i<e.tags.length;++i)t.tags[i]=e.tags[i]>>>0}switch(e.type){case"UNKNOWN":case 0:t.type=0;break;case"POINT":case 1:t.type=1;break;case"LINESTRING":case 2:t.type=2;break;case"POLYGON":case 3:t.type=3}if(e.geometry){if(!Array.isArray(e.geometry))throw TypeError(".com.mapbox.pb.Tile.Feature.geometry: array expected");for(t.geometry=[],i=0;i<e.geometry.length;++i)t.geometry[i]=e.geometry[i]>>>0}return t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.tags=[],i.geometry=[]),t.defaults){if(l.Long){var r=new l.Long(0,0,!0);i.id=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else i.id=t.longs===String?"0":0;i.type=t.enums===String?"UNKNOWN":0}if(null!=e.id&&e.hasOwnProperty("id")&&("number"==typeof e.id?i.id=t.longs===String?String(e.id):e.id:i.id=t.longs===String?l.Long.prototype.toString.call(e.id):t.longs===Number?new l.LongBits(e.id.low>>>0,e.id.high>>>0).toNumber(!0):e.id),e.tags&&e.tags.length){i.tags=[];for(var n=0;n<e.tags.length;++n)i.tags[n]=e.tags[n]}if(null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?c.com.mapbox.pb.Tile.GeomType[e.type]:e.type),e.geometry&&e.geometry.length)for(i.geometry=[],n=0;n<e.geometry.length;++n)i.geometry[n]=e.geometry[n];return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e.Layer=function(){function e(e){if(this.features=[],this.keys=[],this.values=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.version=1,e.prototype.name="",e.prototype.features=l.emptyArray,e.prototype.keys=l.emptyArray,e.prototype.values=l.emptyArray,e.prototype.extent=4096,e.decode=function(e,t){e instanceof s||(e=s.create(e));for(var i=void 0===t?e.len:e.pos+t,r=new c.com.mapbox.pb.Tile.Layer;e.pos<i;){var n=e.uint32();switch(n>>>3){case 15:r.version=e.uint32();break;case 1:r.name=e.string();break;case 2:r.features&&r.features.length||(r.features=[]),r.features.push(c.com.mapbox.pb.Tile.Feature.decode(e,e.uint32()));break;case 3:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;case 4:r.values&&r.values.length||(r.values=[]),r.values.push(c.com.mapbox.pb.Tile.Value.decode(e,e.uint32()));break;case 5:r.extent=e.uint32();break;default:e.skipType(7&n)}}if(!r.hasOwnProperty("version"))throw l.ProtocolError("missing required 'version'",{instance:r});if(!r.hasOwnProperty("name"))throw l.ProtocolError("missing required 'name'",{instance:r});return r},e.decodeDelimited=function(e){return e instanceof s||(e=new s(e)),this.decode(e,e.uint32())},e.fromObject=function(e){if(e instanceof c.com.mapbox.pb.Tile.Layer)return e;var t=new c.com.mapbox.pb.Tile.Layer;if(null!=e.version&&(t.version=e.version>>>0),null!=e.name&&(t.name=String(e.name)),e.features){if(!Array.isArray(e.features))throw TypeError(".com.mapbox.pb.Tile.Layer.features: array expected");t.features=[];for(var i=0;i<e.features.length;++i){if("object"!=typeof e.features[i])throw TypeError(".com.mapbox.pb.Tile.Layer.features: object expected");t.features[i]=c.com.mapbox.pb.Tile.Feature.fromObject(e.features[i])}}if(e.keys){if(!Array.isArray(e.keys))throw TypeError(".com.mapbox.pb.Tile.Layer.keys: array expected");for(t.keys=[],i=0;i<e.keys.length;++i)t.keys[i]=String(e.keys[i])}if(e.values){if(!Array.isArray(e.values))throw TypeError(".com.mapbox.pb.Tile.Layer.values: array expected");for(t.values=[],i=0;i<e.values.length;++i){if("object"!=typeof e.values[i])throw TypeError(".com.mapbox.pb.Tile.Layer.values: object expected");t.values[i]=c.com.mapbox.pb.Tile.Value.fromObject(e.values[i])}}return null!=e.extent&&(t.extent=e.extent>>>0),t},e.toObject=function(e,t){t||(t={});var i={};if((t.arrays||t.defaults)&&(i.features=[],i.keys=[],i.values=[]),t.defaults&&(i.name="",i.extent=4096,i.version=1),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),e.features&&e.features.length){i.features=[];for(var r=0;r<e.features.length;++r)i.features[r]=c.com.mapbox.pb.Tile.Feature.toObject(e.features[r],t)}if(e.keys&&e.keys.length)for(i.keys=[],r=0;r<e.keys.length;++r)i.keys[r]=e.keys[r];if(e.values&&e.values.length)for(i.values=[],r=0;r<e.values.length;++r)i.values[r]=c.com.mapbox.pb.Tile.Value.toObject(e.values[r],t);return null!=e.extent&&e.hasOwnProperty("extent")&&(i.extent=e.extent),null!=e.version&&e.hasOwnProperty("version")&&(i.version=e.version),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},e}(),e}(),r),n),o),e.exports=c},90546:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(90766),t),n(i(82840),t)},82840:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIB_VERSION=void 0,t.LIB_VERSION="1.12.0"},96953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ApiCacheRepository=void 0,t.ApiCacheRepository=class{constructor(e,t){this.cache=e,this.hrn=t?t.toString():"platform-api"}put(e,t,i,r){const n=this.createKey(this.hrn,e,t,r);return this.cache.put(n,i)}get(e,t,i){const r=this.createKey(this.hrn,e,t,i);return this.cache.get(r)}createKey(e,t,i,r){return`${e}::${t}::${i}::${r}`}}},13099:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyValueCache=void 0;const r=i(90546);t.KeyValueCache=class{constructor(){this.cache=new r.LRUCache(2097152,r.getDataSize)}put(e,t){try{return this.cache.set(e,t),!0}catch(e){return!1}}get(e){return this.cache.get(e)}remove(e){return this.cache.delete(e)}clear(){this.cache.clear()}setCapacity(e){this.cache.setCapacity(1024*e*1024)}getCapacity(){return this.cache.getCapacity()}getSize(){return this.cache.getSize()}}},44977:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.Entry=void 0;class i{constructor(e,t,i,r,n){this.key=e,this.value=t,this.size=i,this.newer=r,this.older=n}}t.Entry=i,t.LRUCache=class{constructor(e,t=(()=>1)){this.maxCapacity=e,this.sizeFunction=t,this.cacheSize=0,this.map=new Map,this.newestEntry=null,this.oldestEntry=null}getSize(){return this.cacheSize}getCapacity(){return this.maxCapacity}getNewest(){return this.newestEntry}getOldest(){return this.oldestEntry}setCapacity(e){this.maxCapacity=e,this.evict()}set(e,t){const r=this.sizeFunction(t);let n=this.map.get(e);if(void 0!==n)this.cacheSize=this.cacheSize-n.size+r,n.value=t,n.size=r,this.promoteEntry(n),this.evict();else{if(r>this.maxCapacity)throw new Error(`Error. Value size (${r}) is to big for cache it (${this.maxCapacity}).`);if(n=new i(e,t,r,null,null),0===this.map.size)this.newestEntry=this.oldestEntry=n;else if(null!==this.newestEntry){const e=this.newestEntry;n.older=this.newestEntry,e.newer=n,this.newestEntry=n}this.map.set(e,n),this.cacheSize+=r,this.evict()}}has(e){return this.map.has(e)}get(e){const t=this.map.get(e);if(void 0!==t)return this.promoteEntry(t),t.value}clear(){this.newestEntry=this.oldestEntry=null,this.cacheSize=0,this.map.clear()}delete(e){const t=this.map.get(e);return void 0!==t&&(this.deleteEntry(t),this.map.delete(e))}evict(){for(;null!==this.oldestEntry&&this.cacheSize>this.maxCapacity;)if(void 0===this.evictOldest())return}evictOldest(){if(null!==this.oldestEntry){const e=this.oldestEntry;return this.oldestEntry=e.newer,null!==e.newer&&(e.newer.older=null),this.map.delete(e.key),this.cacheSize-=e.size,e}}promoteEntry(e){e!==this.newestEntry&&(e.newer&&(e.newer.older=e.older),e.older&&(e.older.newer=e.newer),e===this.oldestEntry&&(this.oldestEntry=e.newer),e.newer=null,e.older=this.newestEntry,null!==this.newestEntry)&&(this.newestEntry.newer=e,this.newestEntry=e)}deleteEntry(e){e===this.newestEntry?this.newestEntry=e.older:e.newer&&(e.newer.older=e.older),e===this.oldestEntry?this.oldestEntry=e.newer:e.older&&(e.older.newer=e.newer),this.cacheSize-=e.size}}},42395:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(44977),t),n(i(96953),t),n(i(13099),t)},68955:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OlpClientSettings=void 0;const r=i(90546);t.OlpClientSettings=class{constructor(e){this.getValidToken=e.getToken,this.env=e.environment,this.dm=e.dm||new r.DataStoreDownloadManager,this.keyValueCache=new r.KeyValueCache}get downloadManager(){return this.dm}get token(){return this.getValidToken}get environment(){return this.env}get cache(){return this.keyValueCache}}},28406:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(68955),t)},90766:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(42395),t),n(i(42494),t),n(i(28406),t)},44662:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataStoreDownloadManager=void 0;const n=i(90546);class o{constructor(e){this.executor=e,this.promise=new Promise(((e,t)=>{this.resolveFunc=e,this.rejectFunc=t}))}exec(){this.executor().then(this.resolveFunc).catch(this.rejectFunc)}}class a{constructor(e=fetch,t=5){this.fetchFunction=e,this.maxRetries=t,this.activeDownloadCount=0,this.downloadQueue=new Array}static fetchRepeatedly(e,t,i,o,s){return r(this,void 0,void 0,(function*(){try{const r=yield e(n.addSentWithParam(o),s);if(!this.requestShouldRetryOnError(r.status)||t>=i){if(r.status<=299||r.status===n.STATUS_CODES.FOUND)return Promise.resolve(r);{let e;r.text&&(e=yield r.text());let t=r.statusText;return e&&(t+=" | Info: "+e),Promise.reject(new n.HttpError(r.status,t))}}}catch(e){if(e.hasOwnProperty("isCancelled")||e.hasOwnProperty("name")&&"AbortError"===e.name||t>i)return Promise.reject(e)}return a.waitFor(a.retryTimeout*t).then((()=>a.fetchRepeatedly(e,t+1,i,o,s)))}))}static requestShouldRetryOnError(e){return e>=n.STATUS_CODES.INTERNAL_SERVER_ERROR&&e<=n.STATUS_CODES.NETWORK_CONNECT_TIMEOUT||e===n.STATUS_CODES.TO_MANY_REQUESTS}static waitFor(e){return r(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}download(e,t){return r(this,void 0,void 0,(function*(){if(this.activeDownloadCount>=a.maxParallelDownloads){const i=new o((()=>this.doDownload(e,t)));return this.downloadQueue.push(i),i.promise}return this.doDownload(e,t)}))}doDownload(e,t){return r(this,void 0,void 0,(function*(){return++this.activeDownloadCount,a.fetchRepeatedly(this.fetchFunction,0,this.maxRetries,e,t).then((e=>(this.onDownloadDone(),e))).catch((e=>r(this,void 0,void 0,(function*(){return this.onDownloadDone(),Promise.reject(e)}))))}))}onDownloadDone(){--this.activeDownloadCount,this.execDeferredDownload()}execDeferredDownload(){const e=this.downloadQueue.pop();void 0!==e&&e.exec()}}t.DataStoreDownloadManager=a,a.retryTimeout=500,a.maxParallelDownloads=16},40041:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataStoreRequestBuilder=void 0;const n=i(90546),o=i(65727);class a extends o.RequestBuilder{constructor(e,t,i,r){super(t),this.downloadManager=e,this.getBearerToken=i,this.abortSignal=r}download(e,t){return r(this,void 0,void 0,(function*(){let i=yield this.addBearerToken(t);return i=this.addUserAgent(i),this.abortSignal&&(i=Object.assign(Object.assign({},i),this.addAbortSignal(t))),this.downloadManager.download(e,i).then((e=>e.json())).catch((e=>Promise.reject(e)))}))}downloadBlob(e,t){return r(this,void 0,void 0,(function*(){let i=yield this.addBearerToken(t);return i=this.addUserAgent(i),this.abortSignal&&(i=Object.assign(Object.assign({},i),this.addAbortSignal(t))),this.downloadManager.download(e,i).catch((e=>Promise.reject(e)))}))}addBearerToken(e){return r(this,void 0,void 0,(function*(){return function(e,t){return r(this,void 0,void 0,(function*(){const i=yield e();if(void 0===t)(t={}).headers=new Headers,t.headers.append("Authorization","Bearer "+i);else{const e=new Headers(t.headers);e.append("Authorization","Bearer "+i),t.headers=e}return Promise.resolve(t)}))}(this.getBearerToken,e)}))}addUserAgent(e){return function(e){if(n.LIB_VERSION,void 0===e)(e={}).headers=new Headers;else{const t=new Headers(e.headers);e.headers=t}return e}(e)}addAbortSignal(e){const t=e||{};return t.signal=this.abortSignal,t}}t.DataStoreRequestBuilder=a},33720:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},24184:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FetchOptions=void 0,(i=t.FetchOptions||(t.FetchOptions={}))[i.OnlineIfNotFound=0]="OnlineIfNotFound",i[i.OnlineOnly=1]="OnlineOnly",i[i.CacheOnly=2]="CacheOnly"},91440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HRN=void 0;class i{constructor(e){this.data=e}static fromString(e){if(e.startsWith("http:")||e.startsWith("https:"))return new i({partition:"catalog-url",service:"datastore",region:"",account:"",resource:encodeURIComponent(e)});const t=e.split(":");if(t.length<this.ENTRIES_COUNT||"hrn"!==t[0])throw new Error("Invalid HRN");return new i({partition:t[this.PARTITION_POS],service:t[this.SERVICE_POS],region:t[this.REGION_POS],account:t[this.ACCOUNT_POS],resource:t.slice(this.RESOURCE_POS).join(":")})}toString(){return"hrn:"+this.data.partition+":"+this.data.service+":"+(void 0===this.data.region?"":this.data.region)+":"+(void 0===this.data.account?"":this.data.account)+":"+this.data.resource}}t.HRN=i,i.PARTITION_POS=1,i.SERVICE_POS=2,i.REGION_POS=3,i.ACCOUNT_POS=4,i.RESOURCE_POS=5,i.ENTRIES_COUNT=i.RESOURCE_POS+1},65463:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpError=void 0;class i extends Error{constructor(e,t){super(t),this.status=e,this.name="HttpError"}static isHttpError(e){return"HttpError"===e.name}}t.HttpError=i},48151:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestFactory=void 0;const n=i(90546),o=i(65727);class a{static create(e,t,i,o,s){return r(this,void 0,void 0,(function*(){return a.getBaseUrl(e,t,i,o).then((t=>r(this,void 0,void 0,(function*(){return t?Promise.resolve(new n.DataStoreRequestBuilder(i.downloadManager,t,i.token,s)):Promise.reject(new Error(`Error getting base url to the service: ${e}`))}))))}))}static getBaseUrl(e,t,i,a){return r(this,void 0,void 0,(function*(){const s=new n.ApiCacheRepository(i.cache,a),l=s.get(e,t,"api"),c=s.get(e,t,"age"),u=(new Date).getTime();if(l&&c&&u<parseInt(c,10))return Promise.resolve(l);const d=n.getEnvLookUpUrl(i.environment),h=new n.DataStoreRequestBuilder(i.downloadManager,d,i.token);return(a?o.LookupApi.getResourceAPIList(h,{hrn:a.toString()}):o.LookupApi.getPlatformAPIList(h)).then((i=>r(this,void 0,void 0,(function*(){let r;if(i.headers){const e=i.headers.get("cache-control");if(e){const t=e.match(/max-age=(\d+)/);r=t?parseInt(t[1],10):0}}const o=yield i.json();if(!Array.isArray(o))throw new n.HttpError(o.status||204,o.title||"No content");o.forEach((e=>{if("v1"===e.version&&(s.put(e.api,e.version,e.baseURL,"api"),r)){const t=(new Date).getTime()+1e3*r;s.put(e.api,e.version,t.toString(),"age")}}));const l=o.findIndex((i=>i.api===e&&i.version===t));if(-1===l)throw new n.HttpError(404,`No BaseUrl found for ${e}, ${t} ${a?a.toString():""}`);return o[l].baseURL})))).catch((e=>Promise.reject(e)))}))}}t.RequestFactory=a},92219:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileKey=void 0;class i{constructor(e,t,i){this.row=e,this.column=t,this.level=i}static fromRowColumnLevel(e,t,r){return new i(e,t,r)}static fromQuadKey(e){const t=e.length;let r=0,n=0;for(let i=0;i<e.length;++i){const o=1<<i,a=parseInt(e.charAt(t-i-1),10);1&a&&(n|=o),2&a&&(r|=o)}return i.fromRowColumnLevel(r,n,t)}static fromMortonCode(e){let t=0,r=0,n=0,o=e;for(;o>1;){const e=1<<t;1&o&&(n|=e),2&o&&(r|=e),t++,o=(o-(3&o))/4}const a=i.fromRowColumnLevel(r,n,t);return a.m_mortonCode=e,a}static fromHereTile(e){const t=i.fromMortonCode(parseInt(e,10));return t.m_hereTile=e,t}static columnsAtLevel(e){return Math.pow(2,e)}static rowsAtLevel(e){return Math.pow(2,e)}static atCoords(e,t,r,n,o){return i.fromRowColumnLevel(Math.floor(r/(o/i.rowsAtLevel(e))),Math.floor(t/(n/i.columnsAtLevel(e))),e)}static parentMortonCode(e){return Math.floor(e/4)}static isValid(e){if(e.level<0||e.level>26)return!1;const t=Math.pow(2,e.level),i=e.row>=0&&e.row<t,r=e.column>=0&&e.column<t;return i&&r}parent(){if(0===this.level)throw new Error("Cannot get the parent of the root tile key");return i.fromRowColumnLevel(this.row>>>1,this.column>>>1,this.level-1)}changedLevelBy(e){const t=Math.max(0,this.level+e);let r=this.row,n=this.column;return e>=0?(r<<=e,n<<=e):(r>>>=-e,n>>>=-e),i.fromRowColumnLevel(r,n,t)}changedLevelTo(e){return this.changedLevelBy(e-this.level)}mortonCode(){if(void 0===this.m_mortonCode){let e=this.column,t=this.row,i=r[this.level<<1];for(let n=0;n<this.level;++n)1&e&&(i+=r[2*n]),1&t&&(i+=r[2*n+1]),e>>>=1,t>>>=1;this.m_mortonCode=i}return this.m_mortonCode}toHereTile(){return void 0===this.m_hereTile&&(this.m_hereTile=this.mortonCode().toString()),this.m_hereTile}toQuadKey(){if(0===this.level)return"-";let e="";for(let t=this.level;t>0;--t){const i=1<<t-1,r=0!=(this.column&i),n=0!=(this.row&i);e+=r&&n?"3":n?"2":r?"1":"0"}return e}equals(e){return this.row===e.row&&this.column===e.column&&this.level===e.level}addedSubKey(e){const t=i.fromQuadKey(0===e.length?"-":e),r=this.changedLevelBy(t.level);return i.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}addedSubHereTile(e){const t=i.fromHereTile(e),r=this.changedLevelBy(t.level);return i.fromRowColumnLevel(r.row+t.row,r.column+t.column,r.level)}getSubHereTile(e){const t=1<<2*e;return(this.mortonCode()&t-1|t).toString()}rowCount(){return i.rowsAtLevel(this.level)}columnCount(){return i.columnsAtLevel(this.level)}}t.TileKey=i;const r=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,0x800000000000,281474976710656,562949953421312,0x4000000000000,0x8000000000000,4503599627370496]},68810:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uuid=void 0;class i{static create(){return[i.generate(2),i.generate(1),i.generate(1),i.generate(1),i.generate(3)].join("-")}static generate(e){let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}}t.Uuid=i},52569:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDataSize=void 0,t.getDataSize=function(e){let t=0;return function e(i){if(null!=i)switch(typeof i){case"number":t+=8;break;case"string":t+=2*i.length;break;case"boolean":t+=4;break;case"object":const r=Object.prototype.toString.call(i);if("[object Object]"===r||"[object Array]"===r)for(const t in i)i.hasOwnProperty(t)&&e(i[t]);else t+=2*i.toString().length}return t}(e)}},14112:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnvLookUpUrl=void 0,t.getEnvLookUpUrl=function(e){if(t=e,new RegExp('(?:(?:(?:[a-z]+:)?//)|www\\.)(?:localhost|(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#][^\\s"]*)?').test(t.trim()))return e;var t;switch(e){case"here-dev":return"https://api-lookup.data.api.platform.sit.here.com/lookup/v1";case"here-cn":return"https://api-lookup.data.api.platform.hereolp.cn/lookup/v1";case"here-cn-dev":return"https://api-lookup.data.api.platform.in.hereolp.cn/lookup/v1";case"local":return"http://localhost:31005/lookup/v1";default:return"https://api-lookup.data.api.platform.here.com/lookup/v1"}}},42494:function(e,t,i){"use strict";var r,n=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_CODES=void 0,(r=t.STATUS_CODES||(t.STATUS_CODES={}))[r.OK=200]="OK",r[r.CREATED=201]="CREATED",r[r.NO_CONTENT=204]="NO_CONTENT",r[r.FOUND=302]="FOUND",r[r.BAD_REQUEST=400]="BAD_REQUEST",r[r.NOT_FOUND=404]="NOT_FOUND",r[r.TO_MANY_REQUESTS=429]="TO_MANY_REQUESTS",r[r.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",r[r.SERVICE_UNAVAIBLE=503]="SERVICE_UNAVAIBLE",r[r.NETWORK_CONNECT_TIMEOUT=599]="NETWORK_CONNECT_TIMEOUT",o(i(44662),t),o(i(40041),t),o(i(33720),t),o(i(48151),t),o(i(14112),t),o(i(91440),t),o(i(52569),t),o(i(65463),t),o(i(24184),t),o(i(92219),t),o(i(68810),t),o(i(29674),t)},29674:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSentWithParam=t.SENT_WITH_PARAM=void 0;const r=i(82840);t.SENT_WITH_PARAM=`sentWith=OLP-TS-SDK-${r.LIB_VERSION}`,t.addSentWithParam=function(e){return 1===e.split("?").length?`${e}?${t.SENT_WITH_PARAM}`:`${e}&${t.SENT_WITH_PARAM}`}},65727:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveApi=t.ObjectStoreApi=t.PublishApi=t.StreamApi=t.IndexApi=t.VolatileBlobApi=t.BlobApi=t.CoverageApi=t.QueryApi=t.ArtifactApi=t.ConfigApi=t.MetadataApi=t.LookupApi=t.AuthorizationAPI=void 0,n(i(50746),t);const o=i(88534);t.ArtifactApi=o;const a=i(68787);t.AuthorizationAPI=a;const s=i(44750);t.BlobApi=s;const l=i(19032);t.ConfigApi=l;const c=i(41231);t.CoverageApi=c;const u=i(37167);t.IndexApi=u;const d=i(41349);t.LookupApi=d;const h=i(84398);t.MetadataApi=h;const m=i(87273);t.PublishApi=m;const p=i(60994);t.QueryApi=p;const f=i(82258);t.StreamApi=f;const g=i(72326);t.VolatileBlobApi=g;const y=i(65193);t.ObjectStoreApi=y;const v=i(95110);t.InteractiveApi=v},50746:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestBuilder=t.UrlBuilder=void 0;class r{constructor(e,t=!1){this.url=e,this.hasQuery=t}static stringifyQuery(e){let t="";for(const i in e)if(e.hasOwnProperty(i)){const n=e[i];void 0!==n&&(t=r.appendQueryString(t,"",i,n))}return t}static toString(e){return"string"==typeof e?e:e.toString()}static appendQueryString(e,t,i,r,n="="){if(e+=t,e+=encodeURIComponent(i)+n,"number"==typeof r)e+=r.toString();else if("boolean"==typeof r)e+=`${r}`;else if("string"==typeof r)e+=encodeURIComponent(r);else if(Array.isArray(r)){const t=[];r.forEach((e=>{t.push(encodeURIComponent(e))})),e+=t.join(",")}return e}appendQuery(e,t,i="="){if(void 0!==t){if(t instanceof Object&&!(t instanceof Array)){let e="";for(const i in t)e+=r.appendQueryString("",this.hasQuery?"&":"?",i,t[i]);this.url+=e}else this.url=r.appendQueryString(this.url,this.hasQuery?"&":"?",e,t,i);this.hasQuery=!0}}}t.UrlBuilder=r,t.RequestBuilder=class{constructor(e){this.baseUrl=e}request(e,t){return i(this,void 0,void 0,(function*(){return this.download(e.url,t)}))}requestBlob(e,t){return i(this,void 0,void 0,(function*(){return this.downloadBlob(e.url,t)}))}}},88534:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateSchemaPermissionUsingPOST=t.listUsingGET=t.getSchemaUsingGET=t.getDocumentUsingGET=t.deleteSchemaUsingDELETE=t.registerArtifactUsingPUT=t.putArtifactFileUsingPUT=t.getArtifactUsingGET=t.getArtifactFileUsingGET=t.deleteFileUsingDELETE=t.deleteArtifactUsingDELETE=void 0;const n=i(50746);t.deleteArtifactUsingDELETE=function(e,t){return r(this,void 0,void 0,(function*(){const i="/artifact/{artifactHrn}".replace("{artifactHrn}",n.UrlBuilder.toString(t.artifactHrn)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"DELETE",headers:{}})}))},t.deleteFileUsingDELETE=function(e,t){return r(this,void 0,void 0,(function*(){const i="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",n.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",n.UrlBuilder.toString(t.fileName)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"DELETE",headers:{}})}))},t.getArtifactFileUsingGET=function(e,t){return r(this,void 0,void 0,(function*(){const i="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",n.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",n.UrlBuilder.toString(t.fileName)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getArtifactUsingGET=function(e,t){return r(this,void 0,void 0,(function*(){const i="/{artifactHrn}".replace("{artifactHrn}",n.UrlBuilder.toString(t.artifactHrn)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"GET",headers:{}})}))},t.putArtifactFileUsingPUT=function(e,t){return r(this,void 0,void 0,(function*(){const i="/artifact/{artifactHrn}/{fileName}".replace("{artifactHrn}",n.UrlBuilder.toString(t.artifactHrn)).replace("{fileName}",n.UrlBuilder.toString(t.fileName)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.file&&(a.body=JSON.stringify(t.file)),e.request(r,a)}))},t.registerArtifactUsingPUT=function(e,t){return r(this,void 0,void 0,(function*(){const i="/artifact/register/{groupId}/{artifactId}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)).replace("{artifactId}",n.UrlBuilder.toString(t.artifactId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.registerRequest&&(a.body=JSON.stringify(t.registerRequest)),e.request(r,a)}))},t.deleteSchemaUsingDELETE=function(e,t){return r(this,void 0,void 0,(function*(){const i="/schema/{schemaHrn}".replace("{schemaHrn}",n.UrlBuilder.toString(t.schemaHrn)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"DELETE",headers:{}})}))},t.getDocumentUsingGET=function(e,t){return r(this,void 0,void 0,(function*(){const i="/schema/{schemaHrn}/doc/{file}".replace("{schemaHrn}",n.UrlBuilder.toString(t.schemaHrn)).replace("{file}",n.UrlBuilder.toString(t.file)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getSchemaUsingGET=function(e,t){return r(this,void 0,void 0,(function*(){const i="/schema/{schemaHrn}".replace("{schemaHrn}",n.UrlBuilder.toString(t.schemaHrn)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.listUsingGET=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/schema");i.appendQuery("sort",t.sort),i.appendQuery("order",t.order),i.appendQuery("from",t.from),i.appendQuery("limit",t.limit);return e.request(i,{method:"GET",headers:{}})}))},t.updateSchemaPermissionUsingPOST=function(e,t){return r(this,void 0,void 0,(function*(){const i="/schema/{schemaHrn}/permission".replace("{schemaHrn}",n.UrlBuilder.toString(t.schemaHrn)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.updatePermissionRequest&&(a.body=JSON.stringify(t.updatePermissionRequest)),e.request(r,a)}))}},68787:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getResourceTypeActionList=t.getResourceActionsForProject=t.updateProjectPolicy=t.setAttachedProjectPoliciesToMember=t.getProjectPolicyList=t.getProjectPolicy=t.getAttachedProjectPolicyForMember=t.getAttachedProjectPoliciesForMember=t.getAllProjectMembersWithAttachedPolicy=t.detachProjectPolicyFromMember=t.deleteProjectPolicy=t.createProjectPolicy=t.attachProjectPolicyToMember=t.updateResourceLinkability=t.removeResourceLinkability=t.makeResourceLinkable=t.listRealmResources=t.getResources=t.getResourceProjects=t.getResourceLinkability=t.getResource=t.getListOfWaysResourceIsLinkable=t.patchProject=t.listProjectResources=t.listProjectMembers=t.leaveProject=t.getProjectResource=t.getProjectMember=t.getProjectList=t.getProject=t.getAllProjectList=t.deleteProjectResourceReference=t.deleteProjectMember=t.deleteProject=t.createProject=t.checkProjectExistance=t.addProjectResourceRelation=t.addProjectMember=t.updateGroup=t.removeGroupMember=t.leaveGroup=t.getMyGroups=t.getGroups=t.getGroupRoles=t.getGroupMembers=t.getGroupMember=t.getGroup=t.deleteGroup=t.createGroup=t.addGroupMember=t.getRoles=t.getRolePermissions=t.getRolePermission=t.getRoleEntity=t.getRoleEntities=t.getRole=t.getMyRoles=t.deleteRoleEntity=t.addRoleEntity=t.removeGrant=t.listGrants=t.getGrants=t.getGrant=t.addGrant=t.searchRealmMemberInvites=t.resendRealmMemberInvite=t.createRealmMemberInvite=t.cancelRealmMemberInvite=t.getRealmMembers=t.getRealmMember=t.getEntityManagedGroups=t.getEntityGroupMembership=void 0;const n=i(50746);t.getEntityGroupMembership=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/members/{member}/groups".replace("{realm}",n.UrlBuilder.toString(t.realm)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.getEntityManagedGroups=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/members/{member}/managedGroups".replace("{realm}",n.UrlBuilder.toString(t.realm)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.getRealmMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/members/{member}".replace("{realm}",n.UrlBuilder.toString(t.realm)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getRealmMembers=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/members".replace("{realm}",n.UrlBuilder.toString(t.realm)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count),r.appendQuery("entityType",t.entityType),r.appendQuery("q",t.q),r.appendQuery("state",t.state);return e.request(r,{method:"GET",headers:{}})}))},t.cancelRealmMemberInvite=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/invites/{invite}".replace("{realm}",n.UrlBuilder.toString(t.realm)).replace("{invite}",n.UrlBuilder.toString(t.invite)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.createRealmMemberInvite=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/invites".replace("{realm}",n.UrlBuilder.toString(t.realm)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.resendRealmMemberInvite=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/invites/{invite}".replace("{realm}",n.UrlBuilder.toString(t.realm)).replace("{invite}",n.UrlBuilder.toString(t.invite)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"POST",headers:{}})}))},t.searchRealmMemberInvites=function(e,t){return r(this,void 0,void 0,(function*(){const i="/realms/{realm}/invites".replace("{realm}",n.UrlBuilder.toString(t.realm)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("group",t.group),r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count),r.appendQuery("q",t.q);return e.request(r,{method:"GET",headers:{}})}))},t.addGrant=function(e,t){return r(this,void 0,void 0,(function*(){const i="/grants/resources/{resourceHrn}/entities/{entityId}/actions/{actionId}".replace("{resourceHrn}",n.UrlBuilder.toString(t.resourceHrn)).replace("{entityId}",n.UrlBuilder.toString(t.entityId)).replace("{actionId}",n.UrlBuilder.toString(t.actionId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("entityType",t.entityType);return e.request(r,{method:"POST",headers:{}})}))},t.getGrant=function(e,t){return r(this,void 0,void 0,(function*(){const i="/grants/resources/{resourceHrn}/entities/{entityId}/actions/{actionId}".replace("{resourceHrn}",n.UrlBuilder.toString(t.resourceHrn)).replace("{entityId}",n.UrlBuilder.toString(t.entityId)).replace("{actionId}",n.UrlBuilder.toString(t.actionId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("entityType",t.entityType);return e.request(r,{method:"GET",headers:{}})}))},t.getGrants=function(e,t){return r(this,void 0,void 0,(function*(){const i="/grants/resources/{resourceHrn}/entities/{entityId}".replace("{resourceHrn}",n.UrlBuilder.toString(t.resourceHrn)).replace("{entityId}",n.UrlBuilder.toString(t.entityId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("entityType",t.entityType);return e.request(r,{method:"GET",headers:{}})}))},t.listGrants=function(e,t){return r(this,void 0,void 0,(function*(){const i="/grants/resources/{resourceHrn}/entities".replace("{resourceHrn}",n.UrlBuilder.toString(t.resourceHrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("entityType",t.entityType),r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.removeGrant=function(e,t){return r(this,void 0,void 0,(function*(){const i="/grants/resources/{resourceHrn}/entities/{entityId}/actions/{actionId}".replace("{resourceHrn}",n.UrlBuilder.toString(t.resourceHrn)).replace("{entityId}",n.UrlBuilder.toString(t.entityId)).replace("{actionId}",n.UrlBuilder.toString(t.actionId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("entityType",t.entityType);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.addRoleEntity=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/entities/{entity}".replace("{role}",n.UrlBuilder.toString(t.role)).replace("{entity}",n.UrlBuilder.toString(t.entity)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"POST",headers:{}})}))},t.deleteRoleEntity=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/entities/{entity}".replace("{role}",n.UrlBuilder.toString(t.role)).replace("{entity}",n.UrlBuilder.toString(t.entity)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.getMyRoles=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/roles/me");t&&(i.appendQuery("pageToken",t.pageToken),i.appendQuery("count",t.count));return e.request(i,{method:"GET",headers:{}})}))},t.getRole=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}".replace("{role}",n.UrlBuilder.toString(t.role)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getRoleEntities=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/entities".replace("{role}",n.UrlBuilder.toString(t.role)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.getRoleEntity=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/entities/{entity}".replace("{role}",n.UrlBuilder.toString(t.role)).replace("{entity}",n.UrlBuilder.toString(t.entity)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getRolePermission=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/permissions/{permission}".replace("{role}",n.UrlBuilder.toString(t.role)).replace("{permission}",n.UrlBuilder.toString(t.permission)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getRolePermissions=function(e,t){return r(this,void 0,void 0,(function*(){const i="/roles/{role}/permissions".replace("{role}",n.UrlBuilder.toString(t.role)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.getRoles=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/roles");t&&(i.appendQuery("pageToken",t.pageToken),i.appendQuery("count",t.count),i.appendQuery("roleName",t.roleName),i.appendQuery("resource",t.resource));return e.request(i,{method:"GET",headers:{}})}))},t.addGroupMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/members/{member}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"POST",headers:{}})}))},t.createGroup=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/groups"),r={},o={method:"POST",headers:r};return r["Content-Type"]="application/json",void 0!==t.body&&(o.body=JSON.stringify(t.body)),e.request(i,o)}))},t.deleteGroup=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.getGroup=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getGroupMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/members/{member}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getGroupMembers=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/members".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count),r.appendQuery("entityType",t.entityType);return e.request(r,{method:"GET",headers:{}})}))},t.getGroupRoles=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/roles".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("pageToken",t.pageToken),r.appendQuery("count",t.count);return e.request(r,{method:"GET",headers:{}})}))},t.getGroups=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/groups");t&&(i.appendQuery("pageToken",t.pageToken),i.appendQuery("count",t.count),i.appendQuery("q",t.q));return e.request(i,{method:"GET",headers:{}})}))},t.getMyGroups=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/groups/me");t&&(i.appendQuery("pageToken",t.pageToken),i.appendQuery("count",t.count));return e.request(i,{method:"GET",headers:{}})}))},t.leaveGroup=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/members/me".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.removeGroupMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}/members/{member}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.updateGroup=function(e,t){return r(this,void 0,void 0,(function*(){const i="/groups/{groupId}".replace("{groupId}",n.UrlBuilder.toString(t.groupId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.addProjectMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.addProjectResourceRelation=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/resources/{resource}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("relation",t.relation),r.appendQuery("type",t.type);const o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.checkProjectExistance=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"HEAD",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.createProject=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/projects"),r={},o={method:"POST",headers:r};return r["Content-Type"]="application/json",void 0!==t.body&&(o.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(r["X-Correlation-ID"]=t.xCorrelationID),e.request(i,o)}))},t.deleteProject=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"DELETE",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.deleteProjectMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"DELETE",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.deleteProjectResourceReference=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/resources/{resource}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("relation",t.relation);const o={},a={method:"DELETE",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.getAllProjectList=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/projects");i.appendQuery("limit",t.limit),i.appendQuery("pageToken",t.pageToken);const r={},o={method:"GET",headers:r};return void 0!==t.xCorrelationID&&(r["X-Correlation-ID"]=t.xCorrelationID),e.request(i,o)}))},t.getProject=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getProjectList=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/projects/me");i.appendQuery("limit",t.limit),i.appendQuery("pageToken",t.pageToken),i.appendQuery("canManage",`${t.canManage}`),i.appendQuery("isMember",`${t.isMember}`);const r={},o={method:"GET",headers:r};return void 0!==t.xCorrelationID&&(r["X-Correlation-ID"]=t.xCorrelationID),e.request(i,o)}))},t.getProjectMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getProjectResource=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/resources/{resource}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("relation",t.relation);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.leaveProject=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/me".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"DELETE",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.listProjectMembers=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("onlyIncludeIdentities",`${t.onlyIncludeIdentities}`),r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.listProjectResources=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/resources".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("type",t.type),r.appendQuery("relation",t.relation),r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.patchProject=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PATCH",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getListOfWaysResourceIsLinkable=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/linkable".replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getResource=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}".replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("referenceable",`${t.referenceable}`);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getResourceLinkability=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/linkable/{availableToHrn}".replace("{resource}",n.UrlBuilder.toString(t.resource)).replace("{availableToHrn}",n.UrlBuilder.toString(t.availableToHrn)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getResourceProjects=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/projects".replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken),r.appendQuery("relation",t.relation);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getResources=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/resources");i.appendQuery("limit",t.limit),i.appendQuery("pageToken",t.pageToken),i.appendQuery("type",t.type),i.appendQuery("access",t.access),i.appendQuery("referenceable",`${t.referenceable}`),i.appendQuery("linkable",`${t.linkable}`);const r={},o={method:"GET",headers:r};return void 0!==t.xCorrelationID&&(r["X-Correlation-ID"]=t.xCorrelationID),e.request(i,o)}))},t.listRealmResources=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/realm/resources");i.appendQuery("limit",t.limit),i.appendQuery("pageToken",t.pageToken),i.appendQuery("type",t.type);const r={},o={method:"GET",headers:r};return void 0!==t.xCorrelationID&&(r["X-Correlation-ID"]=t.xCorrelationID),e.request(i,o)}))},t.makeResourceLinkable=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/linkable".replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.removeResourceLinkability=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/linkable/{availableToHrn}".replace("{resource}",n.UrlBuilder.toString(t.resource)).replace("{availableToHrn}",n.UrlBuilder.toString(t.availableToHrn)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"DELETE",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.requestBlob(r,a)}))},t.updateResourceLinkability=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{resource}/linkable/{availableToHrn}".replace("{resource}",n.UrlBuilder.toString(t.resource)).replace("{availableToHrn}",n.UrlBuilder.toString(t.availableToHrn)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.attachProjectPolicyToMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"POST",headers:{}})}))},t.createProjectPolicy=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.deleteProjectPolicy=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.detachProjectPolicyFromMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.getAllProjectMembersWithAttachedPolicy=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies/{policy}/members".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getAttachedProjectPoliciesForMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}/policies".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getAttachedProjectPolicyForMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getProjectPolicy=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getProjectPolicyList=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies".replace("{project}",n.UrlBuilder.toString(t.project)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("projectPolicyType",t.projectPolicyType),r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.setAttachedProjectPoliciesToMember=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/members/{member}/policies".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{member}",n.UrlBuilder.toString(t.member)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.updateProjectPolicy=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/policies/{policy}".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{policy}",n.UrlBuilder.toString(t.policy)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.getResourceActionsForProject=function(e,t){return r(this,void 0,void 0,(function*(){const i="/projects/{project}/resources/{resource}/actions".replace("{project}",n.UrlBuilder.toString(t.project)).replace("{resource}",n.UrlBuilder.toString(t.resource)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("type",t.type);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))},t.getResourceTypeActionList=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resourceTypes/{resourceType}/actions".replace("{resourceType}",n.UrlBuilder.toString(t.resourceType)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("type",t.type);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationID&&(o["X-Correlation-ID"]=t.xCorrelationID),e.request(r,a)}))}},44750:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.doUploadPart=t.doCompleteMultipartUpload=t.startMultipartUpload=t.putData=t.getMultipartUploadStatus=t.getBlob=t.deleteBlob=t.checkBlobExistsStatus=t.cancelMultipartUpload=void 0;const n=i(50746);t.cancelMultipartUpload=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",n.UrlBuilder.toString(t.multiPartToken)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"DELETE",headers:{}})}))},t.checkBlobExistsStatus=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.requestBlob(r,{method:"HEAD",headers:{}})}))},t.deleteBlob=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"DELETE",headers:{}})}))},t.getBlob=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"GET",headers:o};return void 0!==t.range&&(o.Range=t.range),e.requestBlob(r,a)}))},t.getMultipartUploadStatus=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}/multiparts/{multiPartToken}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)).replace("{multiPartToken}",n.UrlBuilder.toString(t.multiPartToken)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.putData=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=t.body),void 0!==t.contentType&&(o["Content-Type"]=t.contentType),void 0!==t.contentLength&&(o["Content-Length"]=t.contentLength),void 0!==t.contentEncoding&&(o["Content-Encoding"]=t.contentEncoding),e.requestBlob(r,a)}))},t.startMultipartUpload=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}/multiparts".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.doCompleteMultipartUpload=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(t.url);i.appendQuery("billingTag",t.billingTag);const r={},o={method:"PUT",headers:r};return r["Content-Type"]="application/json",void 0!==t.parts&&(o.body=JSON.stringify(t.parts)),e.requestBlob(i,o)}))},t.doUploadPart=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(t.url);i.appendQuery("partNumber",t.partNumber),i.appendQuery("billingTag",t.billingTag);const r={},o={method:"POST",headers:r};return r["Content-Type"]="application/json",void 0!==t.body&&(o.body=t.body),void 0!==t.contentType&&(r["Content-Type"]=t.contentType),void 0!==t.contentLength&&(r["Content-Length"]=t.contentLength),e.requestBlob(i,o)}))}},65193:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.uploadPartByKey=t.startMultipartUploadByKey=t.putBlobByKey=t.listKeys=t.getMultipartUploadStatusByKey=t.getBlobByKey=t.deleteBlobByKey=t.completeMultipartUploadByKey=t.checkKeyExists=t.cancelMultipartUploadByKey=void 0;const n=i(50746);t.cancelMultipartUploadByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keysMultipart/{multipartToken}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{multipartToken}",n.UrlBuilder.toString(t.multipartToken)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.checkKeyExists=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys/{key}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{key}",n.UrlBuilder.toString(t.key)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"HEAD",headers:{}})}))},t.completeMultipartUploadByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keysMultipart/{multipartToken}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{multipartToken}",n.UrlBuilder.toString(t.multipartToken)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.requestBlob(r,a)}))},t.deleteBlobByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys/{key}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{key}",n.UrlBuilder.toString(t.key)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.getBlobByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys/{key}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{key}",n.UrlBuilder.toString(t.key)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"GET",headers:o};return void 0!==t.range&&(o.Range=t.range),e.requestBlob(r,a)}))},t.getMultipartUploadStatusByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keysMultipart/{multipartToken}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{multipartToken}",n.UrlBuilder.toString(t.multipartToken)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.listKeys=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("parent",t.parent),r.appendQuery("pageToken",t.pageToken),r.appendQuery("limit",t.limit),r.appendQuery("deep",t.deep);return e.request(r,{method:"GET",headers:{}})}))},t.putBlobByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys/{key}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{key}",n.UrlBuilder.toString(t.key)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("source",t.source);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),void 0!==t.contentLength&&(o["Content-Length"]=`${t.contentLength}`),e.requestBlob(r,a)}))},t.startMultipartUploadByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keys/{key}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{key}",n.UrlBuilder.toString(t.key)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.uploadPartByKey=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/keysMultipart/{multipartToken}/parts".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{multipartToken}",n.UrlBuilder.toString(t.multipartToken)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("partNumber",t.partNumber),r.appendQuery("source",t.source);const o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",a.body=t.body,void 0!==t.contentLength&&(o["Content-Length"]=`${t.contentLength}`),void 0!==t.contentType&&(o["Content-Type"]=t.contentType),void 0!==t.range&&(o.Range=t.range),e.request(r,a)}))}},19032:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.updateCatalog=t.patchLayer=t.patchCatalog=t.getCatalogs=t.getCatalogStatus=t.getCatalog=t.disableAutomaticVersionDeletion=t.deleteLayer=t.deleteCatalog=t.createCatalog=t.catalogExists=void 0;const n=i(50746);t.catalogExists=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.requestBlob(r,{method:"HEAD",headers:{}})}))},t.createCatalog=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/catalogs");i.appendQuery("billingTag",t.billingTag);const r={},o={method:"POST",headers:r};return r["Content-Type"]="application/json",void 0!==t.body&&(o.body=JSON.stringify(t.body)),e.request(i,o)}))},t.deleteCatalog=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"DELETE",headers:{}})}))},t.deleteLayer=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}/layers/{layerId}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)).replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"DELETE",headers:{}})}))},t.disableAutomaticVersionDeletion=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}/automaticVersionDeletion".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"DELETE",headers:{}})}))},t.getCatalog=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.getCatalogStatus=function(e,t){return r(this,void 0,void 0,(function*(){const i="/status/{token}".replace("{token}",n.UrlBuilder.toString(t.token)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.getCatalogs=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/catalogs");i.appendQuery("billingTag",t.billingTag),i.appendQuery("verbose",t.verbose),i.appendQuery("q",t.q),i.appendQuery("organisation",t.organisation),i.appendQuery("organisationType",t.organisationType),i.appendQuery("layerType",t.layerType),i.appendQuery("region",t.region),i.appendQuery("schemaHrn",t.schemaHrn),i.appendQuery("resourceType",t.resourceType),i.appendQuery("coverage",t.coverage),i.appendQuery("access",t.access),i.appendQuery("marketplaceReady",t.marketplaceReady),i.appendQuery("limit",t.limit),i.appendQuery("sortBy",t.sortBy),i.appendQuery("sortOrder",t.sortOrder),i.appendQuery("linkable",t.linkable);return e.request(i,{method:"GET",headers:{}})}))},t.patchCatalog=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PATCH",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.patchLayer=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}/layers/{layerId}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)).replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PATCH",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.updateCatalog=function(e,t){return r(this,void 0,void 0,(function*(){const i="/catalogs/{catalogHrn}".replace("{catalogHrn}",n.UrlBuilder.toString(t.catalogHrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))}},41231:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getDataCoverageTimeMap=t.getDataCoverageTile=t.getDataCoverageSummary=t.getDataCoverageSizeMap=t.getDataCoverageAdminAreas=void 0;const n=i(50746);t.getDataCoverageAdminAreas=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/adminareas".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("datalevel",t.datalevel);return e.request(r,{method:"GET",headers:{}})}))},t.getDataCoverageSizeMap=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/heatmap/size".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("datalevel",t.datalevel);return e.requestBlob(r,{method:"GET",headers:{}})}))},t.getDataCoverageSummary=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/summary".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getDataCoverageTile=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/tilemap".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("datalevel",t.datalevel);return e.requestBlob(r,{method:"GET",headers:{}})}))},t.getDataCoverageTimeMap=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/heatmap/age".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("datalevel",t.datalevel),r.appendQuery("catalogHRN",t.catalogHRN);return e.requestBlob(r,{method:"GET",headers:{}})}))}},37167:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.performUpdate=t.performQuery=t.insertIndexes=void 0;const n=i(50746);t.insertIndexes=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerID}".replace("{layerID}",n.UrlBuilder.toString(t.layerID)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.indexes&&(a.body=JSON.stringify(t.indexes)),e.request(r,a)}))},t.performQuery=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerID}".replace("{layerID}",n.UrlBuilder.toString(t.layerID)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("huge",t.huge?"true":"false"),r.appendQuery("query",t.query);return e.request(r,{method:"GET",headers:{}})}))},t.performUpdate=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerID}".replace("{layerID}",n.UrlBuilder.toString(t.layerID)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.request&&(a.body=JSON.stringify(t.request)),e.request(r,a)}))}},95110:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.putFeatures=t.putFeature=t.postFeatures=t.patchFeature=t.deleteFeatures=t.deleteFeature=t.searchFeatures=t.iterateFeatures=t.getStatistics=t.getFeaturesByTile=t.getFeaturesBySpatialPost=t.getFeaturesBySpatial=t.getFeaturesByBBox=t.getFeatures=t.getFeature=t.getHealth=t.getApiVersion=void 0;const n=i(50746);t.getApiVersion=function(e){return r(this,void 0,void 0,(function*(){const t=new n.UrlBuilder(e.baseUrl+"/version");return e.request(t,{method:"GET",headers:{}})}))},t.getHealth=function(e){return r(this,void 0,void 0,(function*(){const t=new n.UrlBuilder(e.baseUrl+"/health");return e.request(t,{method:"GET",headers:{}})}))},t.getFeature=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features/{featureId}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{featureId}",n.UrlBuilder.toString(t.featureId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("selection",t.selection),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.getFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("id",t.id),r.appendQuery("selection",t.selection),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.getFeaturesByBBox=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/bbox".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("bbox",t.bbox),r.appendQuery("clip",t.clip),r.appendQuery("limit",t.limit);const o=t.params;if(o instanceof Array?o.forEach((e=>{r.appendQuery(e.key,e.value,e.operator)})):r.appendQuery("params",t.params),r.appendQuery("selection",t.selection),r.appendQuery("skipCache",t.skipCache),r.appendQuery("clustering",t.clustering),t.clusteringParams)for(const e in t.clusteringParams)r.appendQuery(`clustering.${e}`,t.clusteringParams[e]);r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.getFeaturesBySpatial=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/spatial".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("lat",t.lat),r.appendQuery("lng",t.lng),r.appendQuery("refCatalogHrn",t.refCatalogHrn),r.appendQuery("refLayerId",t.refLayerId),r.appendQuery("refFeatureId",t.refFeatureId),r.appendQuery("radius",t.radius),r.appendQuery("limit",t.limit);const o=t.params;o instanceof Array?o.forEach((e=>{r.appendQuery(e.key,e.value,e.operator)})):r.appendQuery("params",t.params),r.appendQuery("selection",t.selection),r.appendQuery("skipCache",t.skipCache),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.getFeaturesBySpatialPost=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/spatial".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("radius",t.radius),r.appendQuery("limit",t.limit);const o=t.params;o instanceof Array?o.forEach((e=>{r.appendQuery(e.key,e.value,e.operator)})):r.appendQuery("params",t.params),r.appendQuery("selection",t.selection),r.appendQuery("skipCache",t.skipCache),r.appendQuery("force2D",t.force2D);const a={},s={method:"POST",headers:a};return a["Content-Type"]="application/json",void 0!==t.body&&(s.body=JSON.stringify(t.body)),e.request(r,s)}))},t.getFeaturesByTile=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/tile/{tileType}/{tileId}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{tileType}",n.UrlBuilder.toString(t.tileType)).replace("{tileId}",n.UrlBuilder.toString(t.tileId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("clip",t.clip);const o=t.params;if(o instanceof Array?o.forEach((e=>{r.appendQuery(e.key,e.value,e.operator)})):r.appendQuery("params",t.params),r.appendQuery("selection",t.selection),r.appendQuery("skipCache",t.skipCache),r.appendQuery("clustering",t.clustering),t.clusteringParams)for(const e in t.clusteringParams)r.appendQuery(`clustering.${e}`,t.clusteringParams[e]);r.appendQuery("margin",t.margin),r.appendQuery("limit",t.limit),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.getStatistics=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/statistics".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("skipCache",t.skipCache);return e.request(r,{method:"GET",headers:{}})}))},t.iterateFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/iterate".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit),r.appendQuery("pageToken",t.pageToken),r.appendQuery("part",t.part),r.appendQuery("selection",t.selection),r.appendQuery("sort",t.sort),r.appendQuery("skipCache",t.skipCache),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.searchFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/search".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("limit",t.limit);const o=t.params;o instanceof Array?o.forEach((e=>{r.appendQuery(e.key,e.value,e.operator)})):r.appendQuery("params",t.params),r.appendQuery("selection",t.selection),r.appendQuery("skipCache",t.skipCache),r.appendQuery("force2D",t.force2D);return e.request(r,{method:"GET",headers:{}})}))},t.deleteFeature=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features/{featureId}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{featureId}",n.UrlBuilder.toString(t.featureId)),r=new n.UrlBuilder(e.baseUrl+i);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.deleteFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("id",t.id);return e.requestBlob(r,{method:"DELETE",headers:{}})}))},t.patchFeature=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features/{featureId}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{featureId}",n.UrlBuilder.toString(t.featureId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PATCH",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.postFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.putFeature=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features/{featureId}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{featureId}",n.UrlBuilder.toString(t.featureId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))},t.putFeatures=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/features".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i),o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))}},41349:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getResourceAPIList=t.resourceAPI=t.getPlatformAPIList=t.platformAPI=void 0;const n=i(50746);t.platformAPI=function(e,t){return r(this,void 0,void 0,(function*(){const i="/platform/apis/{api}/{version}".replace("{api}",n.UrlBuilder.toString(t.api)).replace("{version}",n.UrlBuilder.toString(t.version)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.getPlatformAPIList=function(e){return r(this,void 0,void 0,(function*(){const t=new n.UrlBuilder(e.baseUrl+"/platform/apis");return e.requestBlob(t,{method:"GET",headers:{}})}))},t.resourceAPI=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{hrn}/apis/{api}/{version}".replace("{hrn}",n.UrlBuilder.toString(t.hrn)).replace("{api}",n.UrlBuilder.toString(t.api)).replace("{version}",n.UrlBuilder.toString(t.version)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("region",t.region);return e.request(r,{method:"GET",headers:{}})}))},t.getResourceAPIList=function(e,t){return r(this,void 0,void 0,(function*(){const i="/resources/{hrn}/apis".replace("{hrn}",n.UrlBuilder.toString(t.hrn)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("region",t.region);return e.requestBlob(r,{method:"GET",headers:{}})}))}},84398:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.minimumVersion=t.listVersions=t.latestVersion=t.getPartitions=t.getLayerVersions=t.getChanges=void 0;const n=i(50746);t.getChanges=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/changes".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("startVersion",t.startVersion),r.appendQuery("endVersion",t.endVersion),r.appendQuery("sinceTime",t.sinceTime),r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("billingTag",t.billingTag);const o={},a={method:"GET",headers:o};return void 0!==t.range&&(o.Range=t.range),e.request(r,a)}))},t.getLayerVersions=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/layerVersions");i.appendQuery("version",t.version),i.appendQuery("billingTag",t.billingTag);return e.request(i,{method:"GET",headers:{}})}))},t.getPartitions=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/partitions".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("version",t.version),r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("billingTag",t.billingTag);const o={},a={method:"GET",headers:o};return void 0!==t.range&&(o.Range=t.range),e.request(r,a)}))},t.latestVersion=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/versions/latest");i.appendQuery("startVersion",t.startVersion),i.appendQuery("billingTag",t.billingTag);return e.request(i,{method:"GET",headers:{}})}))},t.listVersions=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/versions");i.appendQuery("startVersion",t.startVersion),i.appendQuery("endVersion",t.endVersion),i.appendQuery("billingTag",t.billingTag);return e.request(i,{method:"GET",headers:{}})}))},t.minimumVersion=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/versions/minimum");i.appendQuery("billingTag",t.billingTag);return e.request(i,{method:"GET",headers:{}})}))}},87273:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.uploadPartitions=t.submitPublication=t.initPublication=t.getPublication=t.cancelPublication=void 0;const n=i(50746);t.cancelPublication=function(e,t){return r(this,void 0,void 0,(function*(){const i="/publications/{publicationId}".replace("{publicationId}",n.UrlBuilder.toString(t.publicationId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"DELETE",headers:{}})}))},t.getPublication=function(e,t){return r(this,void 0,void 0,(function*(){const i="/publications/{publicationId}".replace("{publicationId}",n.UrlBuilder.toString(t.publicationId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.initPublication=function(e,t){return r(this,void 0,void 0,(function*(){const i=new n.UrlBuilder(e.baseUrl+"/publications");i.appendQuery("billingTag",t.billingTag);const r={},o={method:"POST",headers:r};return r["Content-Type"]="application/json",void 0!==t.body&&(o.body=JSON.stringify(t.body)),e.request(i,o)}))},t.submitPublication=function(e,t){return r(this,void 0,void 0,(function*(){const i="/publications/{publicationId}".replace("{publicationId}",n.UrlBuilder.toString(t.publicationId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.requestBlob(r,{method:"PUT",headers:{}})}))},t.uploadPartitions=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/publications/{publicationId}/partitions".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{publicationId}",n.UrlBuilder.toString(t.publicationId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.requestBlob(r,a)}))}},60994:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.quadTreeIndexVolatile=t.quadTreeIndex=t.getPartitionsById=t.getChangesById=void 0;const n=i(50746);t.getChangesById=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/changes".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("startVersion",t.startVersion),r.appendQuery("endVersion",t.endVersion),r.appendQuery("sinceTime",t.sinceTime),r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("partition",t.partition),r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.getPartitionsById=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/partitions".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);t.partition.forEach((e=>{r.appendQuery("partition",e)})),r.appendQuery("version",t.version),r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.quadTreeIndex=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/versions/{version}/quadkeys/{quadKey}/depths/{depth}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{version}",n.UrlBuilder.toString(t.version)).replace("{quadKey}",n.UrlBuilder.toString(t.quadKey)).replace("{depth}",n.UrlBuilder.toString(t.depth)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))},t.quadTreeIndexVolatile=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/quadkeys/{quadKey}/depths/{depth}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{quadKey}",n.UrlBuilder.toString(t.quadKey)).replace("{depth}",n.UrlBuilder.toString(t.depth)),r=new n.UrlBuilder(e.baseUrl+i);t.additionalFields&&r.appendQuery("additionalFields",t.additionalFields),r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"GET",headers:{}})}))}},82258:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.subscribe=t.seekToOffset=t.endpointByConsumer=t.endpoint=t.deleteSubscription=t.consumeData=t.doCommitOffsets=void 0;const n=i(50746);t.doCommitOffsets=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/offsets".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("subscriptionId",t.subscriptionId),r.appendQuery("mode",t.mode);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.commitOffsets&&(a.body=JSON.stringify(t.commitOffsets)),void 0!==t.xCorrelationId&&(o["X-Correlation-Id"]=t.xCorrelationId),e.requestBlob(r,a)}))},t.consumeData=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/partitions".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("subscriptionId",t.subscriptionId),r.appendQuery("mode",t.mode);const o={},a={method:"GET",headers:o};return void 0!==t.xCorrelationId&&(o["X-Correlation-Id"]=t.xCorrelationId),e.requestBlob(r,a)}))},t.deleteSubscription=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/subscribe".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("subscriptionId",t.subscriptionId),r.appendQuery("mode",t.mode);const o={},a={method:"DELETE",headers:o};return void 0!==t.xCorrelationId&&(o["X-Correlation-Id"]=t.xCorrelationId),e.requestBlob(r,a)}))},t.endpoint=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/endpoint".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.endpointByConsumer=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/{type}/endpoint".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{type}",n.UrlBuilder.toString(t.type)),r=new n.UrlBuilder(e.baseUrl+i);return e.request(r,{method:"GET",headers:{}})}))},t.seekToOffset=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/seek".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("subscriptionId",t.subscriptionId),r.appendQuery("mode",t.mode);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.seekOffsets&&(a.body=JSON.stringify(t.seekOffsets)),void 0!==t.xCorrelationId&&(o["X-Correlation-Id"]=t.xCorrelationId),e.requestBlob(r,a)}))},t.subscribe=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/subscribe".replace("{layerId}",n.UrlBuilder.toString(t.layerId)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("mode",t.mode),r.appendQuery("subscriptionId",t.subscriptionId),r.appendQuery("consumerId",t.consumerId);const o={},a={method:"POST",headers:o};return o["Content-Type"]="application/json",void 0!==t.subscriptionProperties&&(a.body=JSON.stringify({kafkaConsumerProperties:t.subscriptionProperties})),e.requestBlob(r,a)}))}},72326:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.putVolatileBlob=t.getVolatileBlob=t.deleteVolatileBlob=t.checkHandleExists=void 0;const n=i(50746);t.checkHandleExists=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"HEAD",headers:{}})}))},t.deleteVolatileBlob=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.request(r,{method:"DELETE",headers:{}})}))},t.getVolatileBlob=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);return e.requestBlob(r,{method:"GET",headers:{}})}))},t.putVolatileBlob=function(e,t){return r(this,void 0,void 0,(function*(){const i="/layers/{layerId}/data/{dataHandle}".replace("{layerId}",n.UrlBuilder.toString(t.layerId)).replace("{dataHandle}",n.UrlBuilder.toString(t.dataHandle)),r=new n.UrlBuilder(e.baseUrl+i);r.appendQuery("billingTag",t.billingTag);const o={},a={method:"PUT",headers:o};return o["Content-Type"]="application/json",void 0!==t.body&&(a.body=JSON.stringify(t.body)),e.request(r,a)}))}},15762:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(96853),t)},58998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataCacheRepository=void 0,t.MetadataCacheRepository=class{constructor(e){this.cache=e}put(e,t,i,r,n){let o;if(e.getPartitionIds()){for(const e of r)o=this.createKey({hrn:t,layerId:i,version:n,partitionId:e.partition}),this.cache.put(o,JSON.stringify(e));return!0}return o=this.createKey({hrn:t,layerId:i,version:n}),this.cache.put(o,JSON.stringify(r))}get(e,t,i,r){const n=e.getPartitionIds();let o;if(n){const a=[];for(const e of n){o=this.createKey({hrn:t,layerId:i,version:r,partitionId:e});const n=this.cache.get(o);n&&a.push(JSON.parse(n))}if(n.length!==a.length||this.checkAdditionalFieldsAvailable(a,e.getAdditionalFields()))return;return a}o=this.createKey({hrn:t,layerId:i,version:r});const a=this.cache.get(o);return a?JSON.parse(a):void 0}createKey(e){return`${e.hrn}::${e.layerId}::`+(e.version?`${e.version}::`:"")+(e.partitionId?`${e.partitionId}::partition`:"partitions")}checkAdditionalFieldsAvailable(e,t){if(void 0===t)return!1;for(const i of e)for(const e of t)if(!i.hasOwnProperty(e))return!0;return!1}}},46490:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTreeIndexCacheRepository=void 0,t.QuadTreeIndexCacheRepository=class{constructor(e){this.cache=e}put(e){return this.cache.put(this.createKey(e),JSON.stringify(e.tree))}get(e){const t=this.createKey(e),i=this.cache.get(t);return i?JSON.parse(i):void 0}createKey(e){const t=void 0!==e.version?`::${e.version}`:"";return`${e.hrn}::${e.layerId}::${e.root.toHereTile()}${t}::${e.depth}::quadtree`}}},38257:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(58998),t),n(i(46490),t)},74162:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ArtifactClient=void 0;const n=i(90546),o=i(65727);t.ArtifactClient=class{constructor(e){this.settings=e,this.apiVersion="v1"}getSchemaDetails(e){return r(this,void 0,void 0,(function*(){const t=e.getSchema();if(!t)return Promise.reject(new Error("Please provide the schema HRN by schemaDetailsRequest.withSchema()"));const i=t.toString(),r=yield n.RequestFactory.create("artifact",this.apiVersion,this.settings).catch((e=>Promise.reject(e)));return o.ArtifactApi.getSchemaUsingGET(r,{schemaHrn:i}).catch((e=>Promise.reject(e)))}))}getSchema(e){return r(this,void 0,void 0,(function*(){const t=e.getVariant();if(!t)return Promise.reject(new Error("Please provide the schema variant by schemaRequest.withVariant()"));const i=yield n.RequestFactory.create("artifact",this.apiVersion,this.settings).catch((e=>Promise.reject(e)));return(yield o.ArtifactApi.getArtifactUsingGET(i,{artifactHrn:t.url}).catch((e=>r(this,void 0,void 0,(function*(){const t=e.statusText||{400:"Bad request",401:"You are not authorized to view the schema",403:"Accessing the schema is forbidden",404:"The schema was not found",500:"Internal server error"}[e.status];return Promise.reject(new Error(`Artifact Service error: HTTP ${e.status}: ${t}`))}))))).arrayBuffer()}))}}},49517:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogClient=void 0;const n=i(90546),o=i(65727),a=i(15762);t.CatalogClient=class{constructor(e,t){this.settings=t,this.apiVersion="v1",this.hrn=e.toString()}getCatalog(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.getRequestBuilder("config",void 0,t);return o.ConfigApi.getCatalog(i,{catalogHrn:this.hrn,billingTag:e.getBillingTag()}).catch((e=>Promise.reject(e)))}))}getEarliestVersion(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e))),r=yield o.MetadataApi.minimumVersion(i,{billingTag:e.getBillingTag()}).catch((e=>Promise.reject(e)));return Promise.resolve(r.version)}))}getLayerVersions(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e)));let s=e.getVersion();if(void 0===s){const t=e.getBillingTag(),i=new a.CatalogVersionRequest;t&&i.withBillingTag(t),s=yield this.getLatestVersion(i).catch((e=>Promise.reject(e)))}if(void 0===s)return Promise.reject(new Error("Please set version with LayerVersionsRequest.withVersion() method."));const l=yield o.MetadataApi.getLayerVersions(i,{version:s,billingTag:e.getBillingTag()}).catch((e=>r(this,void 0,void 0,(function*(){return Promise.reject(new Error(e))}))));return Promise.resolve(l.layerVersions)}))}getLatestVersion(e,t){return r(this,void 0,void 0,(function*(){let i=e.getStartVersion();void 0===i&&(i=-1);const r=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e))),a=yield o.MetadataApi.latestVersion(r,{startVersion:i,billingTag:e.getBillingTag()}).catch((e=>Promise.reject(e)));return Promise.resolve(a.version)}))}getVersions(e,t){return r(this,void 0,void 0,(function*(){let i=e.getStartVersion();void 0===i&&(i=-1);let r=e.getEndVersion();void 0===r&&(r=yield this.getLatestVersion(e));const a=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e)));return o.MetadataApi.listVersions(a,{startVersion:i,endVersion:r,billingTag:e.getBillingTag()})}))}getRequestBuilder(e,t,i){return r(this,void 0,void 0,(function*(){return n.RequestFactory.create(e,this.apiVersion,this.settings,t,i).catch((t=>Promise.reject(`Error retrieving from cache builder for resource "${this.hrn}" and api: "${e}.\n${t}"`)))}))}}},60414:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogRequest=void 0;const r=i(15762);t.CatalogRequest=class{withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},4812:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogVersionRequest=void 0;const r=i(15762);t.CatalogVersionRequest=class{getStartVersion(){return this.startVersion}getEndVersion(){return this.endVersion}withStartVersion(e){return this.startVersion=e,this}withEndVersion(e){return this.endVersion=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},46196:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogsRequest=void 0;const r=i(15762);t.CatalogsRequest=class{getSchema(){return this.schemaHrn}withSchema(e){return this.schemaHrn=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},54168:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigClient=void 0;const n=i(90546),o=i(65727);t.ConfigClient=class{constructor(e){this.settings=e,this.apiVersion="v1"}getCatalogs(e){return r(this,void 0,void 0,(function*(){const t=yield n.RequestFactory.create("config",this.apiVersion,this.settings).catch((e=>Promise.reject(e))),i={};return e&&(i.billingTag=e.getBillingTag(),e.getSchema()&&(i.verbose="true",i.schemaHrn=e.getSchema())),o.ConfigApi.getCatalogs(t,i)}))}}},14573:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataRequest=void 0;const r=i(90546),n=i(15762);t.DataRequest=class{constructor(){this.fetchOption=r.FetchOptions.OnlineIfNotFound}getDataHandle(){return this.dataHandle}withDataHandle(e){return this.dataHandle=e,this}getPartitionId(){return this.partitionId}withPartitionId(e){return this.partitionId=e,this}withBillingTag(e){return this.billingTag=n.validateBillingTag(e),this}getBillingTag(){return this.billingTag}withFetchOption(e){return this.fetchOption=e,this}getFetchOption(){return this.fetchOption}}},98098:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IndexLayerClient=void 0;const n=i(90546),o=i(65727);t.IndexLayerClient=class{constructor(e){this.apiVersion="v1",this.hrn=e.catalogHrn.toString(),this.layerId=e.layerId,this.settings=e.settings}getPartitions(e,t){return r(this,void 0,void 0,(function*(){const i=e.getQueryString();if(!i)return Promise.reject(new Error("Please provide correct query"));const r=yield this.getRequestBuilder("index",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e))),a=yield o.IndexApi.performQuery(r,{layerID:this.layerId,query:i,huge:e.getHugeResponse()}).catch((e=>Promise.reject(e)));return a.data?Promise.resolve(a.data):Promise.reject(a.error)}))}getData(e,t){return r(this,void 0,void 0,(function*(){if(!e.id)return Promise.reject(new Error("No data handle for this partition"));const i=yield this.getRequestBuilder("blob",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e)));return o.BlobApi.getBlob(i,{dataHandle:e.id,layerId:this.layerId})}))}getRequestBuilder(e,t,i){return r(this,void 0,void 0,(function*(){return n.RequestFactory.create(e,this.apiVersion,this.settings,t,i).catch((e=>Promise.reject(e)))}))}}},32209:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndexQueryRequest=void 0,t.IndexQueryRequest=class{withQueryString(e){return this.queryString=e,this}withHugeResponse(e){return this.isHugeResponse=e,this}getQueryString(){return this.queryString}getHugeResponse(){return this.isHugeResponse}}},76382:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LayerVersionsRequest=void 0;const r=i(15762);t.LayerVersionsRequest=class{getVersion(){return this.version}withVersion(e){return this.version=e,this}getBillingTag(){return this.billingTag}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}}},34914:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartitionsRequest=void 0;const r=i(90546),n=i(15762);t.PartitionsRequest=class{constructor(){this.fetchOption=r.FetchOptions.OnlineIfNotFound}withBillingTag(e){return this.billingTag=n.validateBillingTag(e),this}getBillingTag(){return this.billingTag}withPartitionIds(e){return this.partitionIds=n.validatePartitionsIdsList(e),this}getPartitionIds(){return this.partitionIds}withAdditionalFields(e){if(e.length)return this.additionalFields=e,this;throw new Error("Error. Parameter 'additionalFields' could not contain empty array. Add value or do not use this method.")}getAdditionalFields(){return this.additionalFields}withFetchOption(e){return this.fetchOption=e,this}getFetchOption(){return this.fetchOption}}},82556:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PollRequest=void 0,t.PollRequest=class{getMode(){return this.mode}withMode(e){return this.mode=e,this}getSubscriptionId(){return this.subscriptionId}withSubscriptionId(e){return this.subscriptionId=e,this}}},3821:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadKeyPartitionsRequest=void 0;const r=i(15762);t.QuadKeyPartitionsRequest=class{withQuadKey(e){return this.quadKey=e,this}withDepth(e){return this.depth=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}withAdditionalFields(e){return this.additionalFields=e,this}getQuadKey(){return this.quadKey}getDepth(){return this.depth||0}getBillingTag(){return this.billingTag}getAdditionalFields(){return this.additionalFields}}},62610:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadTreeIndexRequest=void 0;const r=i(15762);t.QuadTreeIndexRequest=class{constructor(e,t,i="versioned"){this.catalogHrn=e,this.layerId=t,this.layerType=i}withVersion(e){return this.version=e,this}withQuadKey(e){return this.quadKey=e,this}withDepth(e){return this.depth=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}withAdditionalFields(e){return this.additionalFields=e,this}getVersion(){return this.version}getQuadKey(){return this.quadKey}getDepth(){return this.depth||0}getLayerType(){return this.layerType}getCatalogHrn(){return this.catalogHrn}getLayerId(){return this.layerId}getBillingTag(){return this.billingTag}getAdditionalFields(){return this.additionalFields}}},30454:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.QueryClient=void 0;const n=i(90546),o=i(65727),a=i(15762);t.QueryClient=class{constructor(e){this.settings=e,this.apiVersion="v1"}fetchQuadTreeIndex(e,t){return r(this,void 0,void 0,(function*(){const i=e.getQuadKey(),r=e.getLayerId();if(!i||!n.TileKey.isValid(i))return Promise.reject("Please provide correct QuadKey");if(!r)return Promise.reject("Please provide correct Id of the Layer");let a=e.getVersion();if("versioned"===e.getLayerType()&&void 0===a&&(a=yield this.getCatalogLatestVersion(e.getCatalogHrn(),t,e.getBillingTag()).catch((e=>Promise.reject(`Error getting the last catalog version: ${e}`)))),"versioned"===e.getLayerType()&&void 0===a)return Promise.reject("Please provide correct catalog version");const s=yield n.RequestFactory.create("query",this.apiVersion,this.settings,e.getCatalogHrn(),t).catch((e=>Promise.reject(`Erorr creating request object for query service: ${e}`)));let l,c={version:0,layerId:r,depth:e.getDepth(),quadKey:n.TileKey.fromRowColumnLevel(i.row,i.column,i.level).mortonCode().toString(),billingTag:e.getBillingTag(),additionalFields:e.getAdditionalFields()};return"volatile"===e.getLayerType()?l=o.QueryApi.quadTreeIndexVolatile:(l=o.QueryApi.quadTreeIndex,c=Object.assign(Object.assign({},c),{version:a})),l(s,c)}))}getPartitionsById(e,t,i,s,l){return r(this,void 0,void 0,(function*(){const r=e.getPartitionIds();if(!r)return Promise.reject("Please provide correct partitionIds list");const c=new a.MetadataCacheRepository(this.settings.cache);if(e.getFetchOption()!==n.FetchOptions.OnlineOnly){const r=c.get(e,i.toString(),t,l);if(r)return Promise.resolve({partitions:r})}const u=yield n.RequestFactory.create("query",this.apiVersion,this.settings,i,s).catch((e=>Promise.reject(`Erorr creating request object for query service: ${e}`))),d=yield o.QueryApi.getPartitionsById(u,{layerId:t,partition:r,additionalFields:e.getAdditionalFields(),version:void 0!==l?`${l}`:void 0}).catch((e=>Promise.reject(e)));if(e.getFetchOption()!==n.FetchOptions.OnlineOnly&&d&&d.partitions&&d.partitions.length){const r=d.partitions.map((e=>({checksum:e.checksum,compressedDataSize:e.compressedDataSize,dataHandle:e.dataHandle||"",dataSize:e.dataSize,partition:e.partition,version:e.version})));c.put(e,i.toString(),t,r,l)}return Promise.resolve(d)}))}getCatalogLatestVersion(e,t,i){return r(this,void 0,void 0,(function*(){const r=yield n.RequestFactory.create("metadata",this.apiVersion,this.settings,e,t).catch((e=>Promise.reject(`Erorr creating request object for metadata service: ${e}`))),a=yield o.MetadataApi.latestVersion(r,{startVersion:-1,billingTag:i}).catch((e=>Promise.reject(e)));return Promise.resolve(a.version)}))}}},86290:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaDetailsRequest=void 0;const r=i(15762);t.SchemaDetailsRequest=class{getSchema(){return this.schemaHrn}withSchema(e){return this.schemaHrn=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},82381:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaRequest=void 0;const r=i(15762);t.SchemaRequest=class{getVariant(){return this.variant}withVariant(e){return this.variant=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},29851:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeekRequest=void 0,t.SeekRequest=class{getMode(){return this.mode}withMode(e){return this.mode=e,this}getSubscriptionId(){return this.subscriptionId}withSubscriptionId(e){return this.subscriptionId=e,this}withSeekOffsets(e){return this.offsets=e,this}getSeekOffsets(){return this.offsets}}},22328:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StatisticsClient=void 0;const n=i(90546),o=i(65727),a=i(15762);t.StatisticsClient=class{constructor(e){this.settings=e,this.apiVersion="v1"}getSummary(e){return r(this,void 0,void 0,(function*(){const t=e.getLayerId(),i=e.getCatalogHrn();if(void 0===i)return Promise.reject(new Error("No catalogHrn provided"));if(void 0===t)return Promise.reject(new Error("No layerId provided"));const r=yield this.getRequestBuilder(i).catch((e=>Promise.reject(e)));return o.CoverageApi.getDataCoverageSummary(r,{layerId:t})}))}getStatistics(e){return r(this,void 0,void 0,(function*(){const t=e.getLayerId(),i=e.getCatalogHrn(),r=e.getTypemap(),n=e.getDataLevel();if(void 0===i)return Promise.reject(new Error("No catalogHrn provided"));if(void 0===t)return Promise.reject(new Error("No layerId provided"));if(void 0===r)return Promise.reject(new Error("No typemap provided"));const s=yield this.getRequestBuilder(i).catch((e=>Promise.reject(e)));let l;switch(r){case a.CoverageDataType.BITMAP:l=o.CoverageApi.getDataCoverageTile;break;case a.CoverageDataType.SIZEMAP:l=o.CoverageApi.getDataCoverageSizeMap;break;case a.CoverageDataType.TIMEMAP:l=o.CoverageApi.getDataCoverageTimeMap;break;default:return Promise.reject(new Error(`Incorrect typemap provided: ${r}`))}return l(s,{layerId:t,datalevel:n,catalogHRN:i})}))}getRequestBuilder(e){return r(this,void 0,void 0,(function*(){return n.RequestFactory.create("statistics",this.apiVersion,this.settings,n.HRN.fromString(e))}))}}},72891:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatisticsRequest=t.CoverageDataType=void 0;const r=i(15762);var n;(n=t.CoverageDataType||(t.CoverageDataType={})).BITMAP="tilemap",n.SIZEMAP="heatmap/size",n.TIMEMAP="heatmap/age",t.StatisticsRequest=class{getCatalogHrn(){return this.catalogHrn}getLayerId(){return this.layerId}getTypemap(){return this.typemap}getDataLevel(){return this.dataLevel}withCatalogHrn(e){return this.catalogHrn=e.toString(),this}withLayerId(e){return this.layerId=e,this}withTypemap(e){return this.typemap=e,this}withDataLevel(e){return this.dataLevel=Number(e),this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},2900:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamLayerClient=void 0;const n=i(90546),o=i(65727);t.StreamLayerClient=class{constructor(e){this.apiVersion="v2",this.catalogHrn=e.catalogHrn,this.layerId=e.layerId,this.settings=e.settings}subscribe(e,t){return r(this,void 0,void 0,(function*(){const i=yield n.RequestFactory.create("stream",this.apiVersion,this.settings,this.catalogHrn,t).catch((e=>Promise.reject(e))),a={layerId:this.layerId,mode:e.getMode(),consumerId:e.getConsumerId(),subscriptionId:e.getSubscriptionId(),subscriptionProperties:e.getSubscriptionProperties()},s=yield o.StreamApi.subscribe(i,a).then((e=>r(this,void 0,void 0,(function*(){const t=e.headers.get("X-Correlation-Id")||void 0,i=yield e.json();return Promise.resolve(Object.assign({xCorrelationId:t},i))})))).catch((e=>Promise.reject(e)));return this.xCorrelationId=s.xCorrelationId,this.subscribtionNodeBaseUrl=s.nodeBaseURL,Promise.resolve(s.subscriptionId)}))}poll(e,t){return r(this,void 0,void 0,(function*(){if("parallel"===e.getMode()&&!e.getSubscriptionId())return Promise.reject(new Error("Error: for 'parallel' mode 'subscriptionId' is required."));if(!this.subscribtionNodeBaseUrl)return Promise.reject(new Error(`No valid nodeBaseurl provided for the subscribtion id=${e.getSubscriptionId()}, please check your subscribtion`));const i=new n.DataStoreRequestBuilder(this.settings.downloadManager,this.subscribtionNodeBaseUrl,this.settings.token,t),a={layerId:this.layerId,mode:e.getMode(),subscriptionId:e.getSubscriptionId(),xCorrelationId:this.xCorrelationId},s=yield o.StreamApi.consumeData(i,a).then((e=>r(this,void 0,void 0,(function*(){const t=yield e.json();return Promise.resolve({xCorrelationId:e.headers.get("X-Correlation-Id")||void 0,data:t&&t.messages?t.messages:[]})})))).catch((e=>Promise.reject(e)));if(this.xCorrelationId=s.xCorrelationId,s.data.length>0){const t=s.data.map((e=>e.offset)).reduce(((e,t)=>(e[t.partition]=e[t.partition]>t.offset?e[t.partition]:t.offset,e)),{});yield o.StreamApi.doCommitOffsets(i,{commitOffsets:{offsets:Object.keys(t).map((e=>({partition:+e,offset:t[e]})))},subscriptionId:e.getSubscriptionId(),mode:e.getMode(),layerId:this.layerId,xCorrelationId:this.xCorrelationId}).catch((e=>r(this,void 0,void 0,(function*(){console.log(`Commit offsets unsuccessful, error=${e.message}`)}))))}return Promise.resolve(s.data)}))}unsubscribe(e,t){return r(this,void 0,void 0,(function*(){if("parallel"===e.getMode()&&!e.getSubscriptionId())return Promise.reject(new Error("Error: for 'parallel' mode 'subscriptionId' is required."));if(!this.subscribtionNodeBaseUrl)return Promise.reject(new Error(`Subscribtion error. No valid nodeBaseurl provided for the subscribtion id=${e.getSubscriptionId()}, please check your subscribtion`));const i=new n.DataStoreRequestBuilder(this.settings.downloadManager,this.subscribtionNodeBaseUrl,this.settings.token,t);return o.StreamApi.deleteSubscription(i,{layerId:this.layerId,mode:e.getMode(),subscriptionId:e.getSubscriptionId(),xCorrelationId:this.xCorrelationId})}))}getData(e,t){return r(this,void 0,void 0,(function*(){if(!e.metaData||!e.metaData.dataHandle)return Promise.reject(new Error("No data handle for this partition"));const i=yield n.RequestFactory.create("blob","v1",this.settings,this.catalogHrn,t).catch((e=>Promise.reject(e)));return o.BlobApi.getBlob(i,{dataHandle:e.metaData.dataHandle,layerId:this.layerId})}))}seek(e,t){return r(this,void 0,void 0,(function*(){const i=e.getSeekOffsets();if(!i||!i.offsets||!i.offsets.length)return Promise.reject(new Error("Error: offsets are required."));if("parallel"===e.getMode()&&!e.getSubscriptionId())return Promise.reject(new Error("Error: for 'parallel' mode 'subscriptionId' is required."));if(!this.subscribtionNodeBaseUrl)return Promise.reject(new Error(`Subscribtion error. No valid nodeBaseurl provided for the subscribtion id=${e.getSubscriptionId()}, please check your subscribtion`));const a=new n.DataStoreRequestBuilder(this.settings.downloadManager,this.subscribtionNodeBaseUrl,this.settings.token,t);return o.StreamApi.seekToOffset(a,{layerId:this.layerId,seekOffsets:i,mode:e.getMode(),subscriptionId:e.getSubscriptionId(),xCorrelationId:this.xCorrelationId}).then((e=>r(this,void 0,void 0,(function*(){return this.xCorrelationId=e.headers.get("X-Correlation-Id")||this.xCorrelationId,e})))).catch((e=>Promise.reject(e)))}))}}},52599:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscribeRequest=void 0,t.SubscribeRequest=class{getMode(){return this.mode}withMode(e){return this.mode=e,this}getSubscriptionId(){return this.subscriptionId}withSubscriptionId(e){return this.subscriptionId=e,this}getConsumerId(){return this.consumerId}withConsumerId(e){return this.consumerId=e,this}getSubscriptionProperties(){return this.subscriptionProperties}withSubscriptionProperties(e){return this.subscriptionProperties=e,this}}},76709:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SummaryRequest=void 0;const r=i(15762);t.SummaryRequest=class{getCatalogHrn(){return this.catalogHrn}getLayerId(){return this.layerId}withCatalogHrn(e){return this.catalogHrn=e.toString(),this}withLayerId(e){return this.layerId=e,this}withBillingTag(e){return this.billingTag=r.validateBillingTag(e),this}getBillingTag(){return this.billingTag}}},81097:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileRequest=void 0;const r=i(90546),n=i(15762);t.TileRequest=class{constructor(){this.fetchOption=r.FetchOptions.OnlineIfNotFound}withTileKey(e){return this.quadKey=e,this}withBillingTag(e){return this.billingTag=n.validateBillingTag(e),this}getTileKey(){return this.quadKey}getBillingTag(){return this.billingTag}withFetchOption(e){return this.fetchOption=e,this}getFetchOption(){return this.fetchOption}}},73132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsubscribeRequest=void 0,t.UnsubscribeRequest=class{getMode(){return this.mode}withMode(e){return this.mode=e,this}getSubscriptionId(){return this.subscriptionId}withSubscriptionId(e){return this.subscriptionId=e,this}}},73850:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.VersionedLayerClient=void 0;const n=i(90546),o=i(65727),a=i(15762);t.VersionedLayerClient=class{constructor(e){this.apiVersion="v1",this.hrn=e.catalogHrn.toString(),this.layerId=e.layerId,this.settings=e.settings,void 0!==e.version&&e.version>=0&&(this.version=e.version)}getAggregatedData(e,t){return r(this,void 0,void 0,(function*(){let i=this.version;void 0===i&&(i=yield this.getLatestVersion(e.getBillingTag()));const r={catalogHrn:n.HRN.fromString(this.hrn),layerId:this.layerId,layerType:"versioned",settings:this.settings,catalogVersion:i};return a.getTile(e,r,t)}))}getData(e,t){return r(this,void 0,void 0,(function*(){const i=e.getDataHandle();if(i)return this.downloadPartition(i,t,e.getBillingTag());const r=e.getPartitionId();if(void 0===this.version&&(this.version=yield this.getLatestVersion(e.getBillingTag()).catch((e=>Promise.reject(e)))),void 0===this.version)return Promise.reject(new Error("Unable to retrieve latest version. Please provide version to the DataRequest or lock version in the constructor"));if(r){const i=yield this.getDataHandleByPartitionId(r,e.getFetchOption(),e.getBillingTag()).catch((e=>Promise.reject(e)));return this.downloadPartition(i,t,e.getBillingTag())}return Promise.reject(new Error("No data provided. Add dataHandle, partitionId or quadKey to the DataRequest object"))}))}getPartitions(e,t){return r(this,void 0,void 0,(function*(){if(void 0===this.version&&(this.version=yield this.getLatestVersion(e.getBillingTag()).catch((e=>Promise.reject(e)))),void 0===this.version)return Promise.reject(new Error("Unable to retrieve latest version. Please provide version to the Request or lock version in the constructor"));if(e instanceof a.QuadKeyPartitionsRequest){const i=e.getQuadKey();if(!i)return Promise.reject(new Error("Please provide correct QuadKey"));const r=new a.QueryClient(this.settings),o=new a.QuadTreeIndexRequest(n.HRN.fromString(this.hrn),this.layerId,"versioned").withQuadKey(i).withVersion(this.version).withDepth(e.getDepth()).withAdditionalFields(e.getAdditionalFields());return r.fetchQuadTreeIndex(o,t)}if(e.getPartitionIds())return new a.QueryClient(this.settings).getPartitionsById(e,this.layerId,n.HRN.fromString(this.hrn),t,this.version);const i=new a.MetadataCacheRepository(this.settings.cache);if(e.getFetchOption()!==n.FetchOptions.OnlineOnly){const t=i.get(e,this.hrn.toString(),this.layerId,this.version);if(t){const i=e.getAdditionalFields();let r;if(i&&(r=i.filter((e=>t.every((t=>void 0!==t[e]))))),!i||!r||i.length===r.length)return Promise.resolve({partitions:t})}}const r=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e))),s=yield o.MetadataApi.getPartitions(r,{version:this.version,layerId:this.layerId,additionalFields:e.getAdditionalFields(),billingTag:e.getBillingTag()}).catch((e=>Promise.reject(e)));return e.getFetchOption()!==n.FetchOptions.OnlineOnly&&s.partitions.length&&i.put(e,this.hrn.toString(),this.layerId,s.partitions,this.version),Promise.resolve(s)}))}getDataHandleByPartitionId(e,t,i){return r(this,void 0,void 0,(function*(){const r=new a.QueryClient(this.settings),o=(new a.PartitionsRequest).withPartitionIds([e]).withFetchOption(t);i&&o.withBillingTag(i);const s=yield r.getPartitionsById(o,this.layerId,n.HRN.fromString(this.hrn),void 0,this.version);return s.partitions&&s.partitions[0]&&s.partitions[0].dataHandle?s.partitions[0].dataHandle:Promise.reject(new n.HttpError(n.STATUS_CODES.NOT_FOUND,`No partition dataHandle for partition ${e}. HRN: ${this.hrn}`))}))}getLatestVersion(e){return r(this,void 0,void 0,(function*(){const t=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn)).catch((e=>Promise.reject(e))),i=yield o.MetadataApi.latestVersion(t,{startVersion:-1,billingTag:e}).catch((e=>Promise.reject(e)));return Promise.resolve(i.version)}))}downloadPartition(e,t,i){return r(this,void 0,void 0,(function*(){const r=yield this.getRequestBuilder("blob",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e)));return o.BlobApi.getBlob(r,{dataHandle:e,layerId:this.layerId,billingTag:i})}))}getRequestBuilder(e,t,i){return r(this,void 0,void 0,(function*(){return n.RequestFactory.create(e,this.apiVersion,this.settings,t,i)}))}}},59155:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.VolatileLayerClient=void 0;const n=i(90546),o=i(65727),a=i(15762);t.VolatileLayerClient=class{constructor(e){this.apiVersion="v1",this.hrn=e.catalogHrn.toString(),this.layerId=e.layerId,this.settings=e.settings}getAggregatedData(e,t){return r(this,void 0,void 0,(function*(){const i={catalogHrn:n.HRN.fromString(this.hrn),layerId:this.layerId,layerType:"volatile",settings:this.settings};return a.getTile(e,i,t)}))}getData(e,t){return r(this,void 0,void 0,(function*(){const i=e.getDataHandle(),r=e.getPartitionId();if(void 0!==i||void 0!==r){if(i)return this.downloadPartition(i,t,e.getBillingTag());if(r){const i=yield this.getDataHandleByPartitionId(r,e.getFetchOption(),e.getBillingTag()).catch((e=>Promise.reject(e)));return this.downloadPartition(i,t,e.getBillingTag())}}return Promise.reject(new Error("No data provided. Add dataHandle, partitionId or quadKey to the DataRequest object"))}))}getPartitions(e,t){return r(this,void 0,void 0,(function*(){if(e instanceof a.QuadKeyPartitionsRequest){const i=e.getQuadKey();if(!i)return Promise.reject(new Error("Please provide correct QuadKey"));const r=new a.QueryClient(this.settings),o=new a.QuadTreeIndexRequest(n.HRN.fromString(this.hrn),this.layerId,"volatile").withQuadKey(i).withDepth(e.getDepth()).withAdditionalFields(e.getAdditionalFields());return r.fetchQuadTreeIndex(o,t)}if(e.getPartitionIds())return new a.QueryClient(this.settings).getPartitionsById(e,this.layerId,n.HRN.fromString(this.hrn),t);const i=new a.MetadataCacheRepository(this.settings.cache);if(e.getFetchOption()!==n.FetchOptions.OnlineOnly){const t=i.get(e,this.hrn.toString(),this.layerId);if(t){const i=e.getAdditionalFields();let r;if(i&&(r=i.filter((e=>t.every((t=>void 0!==t[e]))))),!i||!r||i.length===r.length)return Promise.resolve({partitions:t})}}const r=yield this.getRequestBuilder("metadata",n.HRN.fromString(this.hrn)).catch((e=>Promise.reject(e))),s=yield o.MetadataApi.getPartitions(r,{layerId:this.layerId,additionalFields:e.getAdditionalFields(),billingTag:e.getBillingTag()}).catch((e=>Promise.reject(e)));return e.getFetchOption()!==n.FetchOptions.OnlineOnly&&s.partitions.length&&i.put(e,this.hrn.toString(),this.layerId,s.partitions),Promise.resolve(s)}))}downloadPartition(e,t,i){return r(this,void 0,void 0,(function*(){const r=yield this.getRequestBuilder("volatile-blob",n.HRN.fromString(this.hrn),t).catch((e=>Promise.reject(e)));return o.VolatileBlobApi.getVolatileBlob(r,{dataHandle:e,layerId:this.layerId,billingTag:i})}))}getRequestBuilder(e,t,i){return r(this,void 0,void 0,(function*(){return n.RequestFactory.create(e,this.apiVersion,this.settings,t,i)}))}getDataHandleByPartitionId(e,t,i){return r(this,void 0,void 0,(function*(){const r=new a.QueryClient(this.settings),o=(new a.PartitionsRequest).withPartitionIds([e]).withFetchOption(t);i&&o.withBillingTag(i);const s=yield r.getPartitionsById(o,this.layerId,n.HRN.fromString(this.hrn));return s.partitions&&s.partitions[0]&&s.partitions[0].dataHandle?s.partitions[0].dataHandle:Promise.reject(new n.HttpError(n.STATUS_CODES.NOT_FOUND,`No partition dataHandle for partition ${e}. HRN: ${this.hrn}`))}))}}},16830:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(49517),t),n(i(60414),t),n(i(14573),t),n(i(22328),t),n(i(72891),t),n(i(76709),t),n(i(73850),t),n(i(59155),t),n(i(54168),t),n(i(46196),t),n(i(86290),t),n(i(74162),t),n(i(34914),t),n(i(30454),t),n(i(62610),t),n(i(3821),t),n(i(82381),t),n(i(4812),t),n(i(76382),t),n(i(98098),t),n(i(32209),t),n(i(2900),t),n(i(52599),t),n(i(82556),t),n(i(73132),t),n(i(29851),t),n(i(81097),t)},96853:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(9552),t),n(i(16830),t),n(i(38257),t)},69316:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchQuadTreeIndex=t.getTile=void 0;const n=i(90546),o=i(65727),a=i(15762);function s(e){return r(this,void 0,void 0,(function*(){const t=new a.QuadTreeIndexCacheRepository(e.settings.cache),i=new a.QueryClient(e.settings),r=new a.QuadTreeIndexRequest(e.catalogHrn,e.layerId,e.layerType).withQuadKey(e.tileKey).withDepth(e.depth);"versioned"===e.layerType&&r.withVersion(e.catalogVersion);const o=yield i.fetchQuadTreeIndex(r,e.abortSignal).catch((e=>Promise.reject(e)));return e.fetchOptions!==n.FetchOptions.OnlineOnly&&o.subQuads&&t.put({hrn:e.catalogHrn.toString(),layerId:e.layerId,depth:e.depth,root:e.tileKey,tree:o,version:e.catalogVersion}),Promise.resolve(o)}))}t.getTile=function(e,t,i){return r(this,void 0,void 0,(function*(){let r;const l=e.getTileKey();if(!l)return Promise.reject(new Error("Please provide correct QuadKey"));"versioned"===t.layerType&&(r=t.catalogVersion);const c="versioned"===t.layerType?"blob":"volatile-blob",u=yield n.RequestFactory.create(c,"v1",t.settings,t.catalogHrn,i).catch((e=>Promise.reject(e))),d=n.TileKey.fromRowColumnLevel(l.row,l.column,l.level);let h=null;if(e.getFetchOption()!==n.FetchOptions.OnlineOnly){const e=new a.QuadTreeIndexCacheRepository(t.settings.cache);for(let i=1;i<=4;i++){const n=d.changedLevelBy(-i),o=e.get({hrn:t.catalogHrn.toString(),layerId:t.layerId,depth:4,root:n,version:r});o&&(h=o)}}const m=d.changedLevelBy(-4);if(h||(h=yield s(Object.assign(Object.assign({},t),{catalogVersion:r,depth:4,fetchOptions:e.getFetchOption(),tileKey:m,abortSignal:i,billingTag:e.getBillingTag()})).catch((e=>Promise.reject(e)))),!h.subQuads||!h.subQuads.length)return Promise.resolve(new Response("No Content",{status:204,statusText:"No Content"}));const p=h.subQuads;let f=d,g=4;for(let i=f.level;i>=m.level;--i){const i=p.find((e=>e.subQuadKey===f.getSubHereTile(g)));if(i)return o.BlobApi.getBlob(u,{dataHandle:i.dataHandle,layerId:t.layerId,billingTag:e.getBillingTag()});try{f=f.parent(),g=m.level-f.level}catch(e){continue}}return Promise.reject(new Error(`Error getting blob for Tile: ${JSON.stringify(l)}`))}))},t.fetchQuadTreeIndex=s},9552:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(87195),t),n(i(61886),t),n(i(69316),t)},87195:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateBillingTag=void 0,t.validateBillingTag=function(e){if(!/^[A-Za-z0-9_-]{4,16}$/.test(e))throw new Error("The billing tag must be between 4 - 16 characters, contain only alpha/numeric ASCII characters [A-Za-z0-9]");return e}},61886:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePartitionsIdsList=void 0,t.validatePartitionsIdsList=function(e){const t=e.length;if(t<1||t>100)throw new Error("The partition ids quantity must be between 1 - 100");return e}},34537:e=>{"use strict";e.exports=function(e,t){for(var i=new Array(arguments.length-1),r=0,n=2,o=!0;n<arguments.length;)i[r++]=arguments[n++];return new Promise((function(n,a){i[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];n.apply(null,t)}};try{e.apply(t||null,i)}catch(e){o&&(o=!1,a(e))}}))}},97419:(e,t)=>{"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var r=new Array(64),n=new Array(123),o=0;o<64;)n[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function(e,t,i){for(var n,o=null,a=[],s=0,l=0;t<i;){var c=e[t++];switch(l){case 0:a[s++]=r[c>>2],n=(3&c)<<4,l=1;break;case 1:a[s++]=r[n|c>>4],n=(15&c)<<2,l=2;break;case 2:a[s++]=r[n|c>>6],a[s++]=r[63&c],l=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return l&&(a[s++]=r[n],a[s++]=61,1===l&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";i.decode=function(e,t,i){for(var r,o=i,s=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&s>1)break;if(void 0===(c=n[c]))throw Error(a);switch(s){case 0:r=c,s=1;break;case 1:t[i++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[i++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[i++]=(3&r)<<6|c,s=0}}if(1===s)throw Error(a);return i-o},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},75124:e=>{"use strict";function t(e,i){"string"==typeof e&&(i=e,e=void 0);var r=[];function n(e){if("string"!=typeof e){var i=o();if(t.verbose&&console.log("codegen: "+i),i="return "+i,e){for(var a=Object.keys(e),s=new Array(a.length+1),l=new Array(a.length),c=0;c<a.length;)s[c]=a[c],l[c]=e[a[c++]];return s[c]=i,Function.apply(null,s).apply(null,l)}return Function(i)()}for(var u=new Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var i=u[d++];switch(t){case"d":case"f":return String(Number(i));case"i":return String(Math.floor(i));case"j":return JSON.stringify(i);case"s":return String(i)}return"%"})),d!==u.length)throw Error("parameter count mismatch");return r.push(e),n}function o(t){return"function "+(t||i||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return n.toString=o,n}e.exports=t,t.verbose=!1},19211:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],r=0;r<i.length;)i[r].fn===t?i.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],r=1;r<arguments.length;)i.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,i)}return this}},49054:(e,t,i)=>{"use strict";e.exports=o;var r=i(34537),n=i(67199)("fs");function o(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),i?!t.xhr&&n&&n.readFile?n.readFile(e,(function(r,n){return r&&"undefined"!=typeof XMLHttpRequest?o.xhr(e,t,i):r?i(r):i(null,t.binary?n:n.toString("utf8"))})):o.xhr(e,t,i):r(o,this,e,t)}o.xhr=function(e,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return i(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var n=0;n<r.responseText.length;++n)e.push(255&r.responseText.charCodeAt(n))}return i(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return i(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},10945:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),r=128===i[3];function n(e,r,n){t[0]=e,r[n]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=i[3]}function o(e,r,n){t[0]=e,r[n]=i[3],r[n+1]=i[2],r[n+2]=i[1],r[n+3]=i[0]}function a(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],t[0]}function s(e,r){return i[3]=e[r],i[2]=e[r+1],i[1]=e[r+2],i[0]=e[r+3],t[0]}e.writeFloatLE=r?n:o,e.writeFloatBE=r?o:n,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,i,r){var n=t<0?1:0;if(n&&(t=-t),0===t)e(1/t>0?0:2147483648,i,r);else if(isNaN(t))e(2143289344,i,r);else if(t>34028234663852886e22)e((n<<31|2139095040)>>>0,i,r);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,i,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((n<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,i,r)}}function a(e,t,i){var r=e(t,i),n=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:n*(1/0):0===o?1401298464324817e-60*n*a:n*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,r),e.readFloatLE=a.bind(null,n),e.readFloatBE=a.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),r=128===i[7];function n(e,r,n){t[0]=e,r[n]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=i[3],r[n+4]=i[4],r[n+5]=i[5],r[n+6]=i[6],r[n+7]=i[7]}function o(e,r,n){t[0]=e,r[n]=i[7],r[n+1]=i[6],r[n+2]=i[5],r[n+3]=i[4],r[n+4]=i[3],r[n+5]=i[2],r[n+6]=i[1],r[n+7]=i[0]}function a(e,r){return i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],i[4]=e[r+4],i[5]=e[r+5],i[6]=e[r+6],i[7]=e[r+7],t[0]}function s(e,r){return i[7]=e[r],i[6]=e[r+1],i[5]=e[r+2],i[4]=e[r+3],i[3]=e[r+4],i[2]=e[r+5],i[1]=e[r+6],i[0]=e[r+7],t[0]}e.writeDoubleLE=r?n:o,e.writeDoubleBE=r?o:n,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,i,r,n,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,n,o+t),e(1/r>0?0:2147483648,n,o+i);else if(isNaN(r))e(0,n,o+t),e(2146959360,n,o+i);else if(r>17976931348623157e292)e(0,n,o+t),e((a<<31|2146435072)>>>0,n,o+i);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,n,o+t),e((a<<31|s/4294967296)>>>0,n,o+i);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(s=r*Math.pow(2,-l))>>>0,n,o+t),e((a<<31|l+1023<<20|1048576*s&1048575)>>>0,n,o+i)}}}function a(e,t,i,r,n){var o=e(r,n+t),a=e(r,n+i),s=2*(a>>31)+1,l=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047===l?c?NaN:s*(1/0):0===l?5e-324*s*c:s*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=a.bind(null,n,0,4),e.readDoubleBE=a.bind(null,o,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function r(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function n(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},67199:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},18626:(e,t)=>{"use strict";var i=t,r=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},n=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),i=r(e),n="";i&&(n=t.shift()+"/");for(var o=0;o<t.length;)".."===t[o]?o>0&&".."!==t[o-1]?t.splice(--o,2):i?t.splice(o,1):++o:"."===t[o]?t.splice(o,1):++o;return n+t.join("/")};i.resolve=function(e,t,i){return i||(t=n(t)),r(t)?t:(i||(e=n(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?n(e+"/"+t):t)}},76662:e=>{"use strict";e.exports=function(e,t,i){var r=i||8192,n=r>>>1,o=null,a=r;return function(i){if(i<1||i>n)return e(i);a+i>r&&(o=e(r),a=0);var s=t.call(o,a,a+=i);return 7&a&&(a=1+(7|a)),s}}},94997:(e,t)=>{"use strict";var i=t;i.length=function(e){for(var t=0,i=0,r=0;r<e.length;++r)(i=e.charCodeAt(r))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var r,n=null,o=[],a=0;t<i;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,o)),a=0);return n?(a&&n.push(String.fromCharCode.apply(String,o.slice(0,a))),n.join("")):String.fromCharCode.apply(String,o.slice(0,a))},i.write=function(e,t,i){for(var r,n,o=i,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[i++]=r:r<2048?(t[i++]=r>>6|192,t[i++]=63&r|128):55296==(64512&r)&&56320==(64512&(n=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&n),++a,t[i++]=r>>18|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128,t[i++]=63&r|128):(t[i++]=r>>12|224,t[i++]=r>>6&63|128,t[i++]=63&r|128);return i-o}},65096:(e,t,i)=>{"use strict";var r=i(47153),n=i(83610),o=i(47531),a=i(74022),s=i(35035),l=i(1516),c=i(47753),u=i(3978),d=i(42889);e.exports=y,y.prototype.validate=function(e,t){var i;if("string"==typeof e){if(!(i=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var r=this._addSchema(e);i=r.validate||this._compile(r)}var n=i(t);return!0!==i.$async&&(this.errors=i.errors),n},y.prototype.compile=function(e,t){var i=this._addSchema(e,void 0,t);return i.validate||this._compile(i)},y.prototype.addSchema=function(e,t,i,r){if(Array.isArray(e)){for(var o=0;o<e.length;o++)this.addSchema(e[o],void 0,i,r);return this}var a=this._getId(e);if(void 0!==a&&"string"!=typeof a)throw new Error("schema id must be string");return E(this,t=n.normalizeId(t||a)),this._schemas[t]=this._addSchema(e,i,r,!0),this},y.prototype.addMetaSchema=function(e,t,i){return this.addSchema(e,t,i,!0),this},y.prototype.validateSchema=function(e,t){var i=e.$schema;if(void 0!==i&&"string"!=typeof i)throw new Error("$schema must be a string");if(!(i=i||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(p)?p:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this.validate(i,e);if(!r&&t){var n="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(n);this.logger.error(n)}return r},y.prototype.getSchema=function(e){var t=v(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var i=n.schema.call(e,{schema:{}},t);if(i){var o=i.schema,s=i.root,l=i.baseId,c=r.call(e,o,s,void 0,l);return e._fragments[t]=new a({ref:t,fragment:!0,schema:o,root:s,baseId:l,validate:c}),c}}(this,e)}},y.prototype.removeSchema=function(e){if(e instanceof RegExp)return _(this,this._schemas,e),_(this,this._refs,e),this;switch(typeof e){case"undefined":return _(this,this._schemas),_(this,this._refs),this._cache.clear(),this;case"string":var t=v(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var i=this._opts.serialize,r=i?i(e):e;this._cache.del(r);var o=this._getId(e);o&&(o=n.normalizeId(o),delete this._schemas[o],delete this._refs[o])}return this},y.prototype.addFormat=function(e,t){return"string"==typeof t&&(t=new RegExp(t)),this._formats[e]=t,this},y.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var i=void 0===(t=t||{}).separator?", ":t.separator,r=void 0===t.dataVar?"data":t.dataVar,n="",o=0;o<e.length;o++){var a=e[o];a&&(n+=r+a.dataPath+" "+a.message+i)}return n.slice(0,-i.length)},y.prototype._addSchema=function(e,t,i,r){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var o=this._opts.serialize,s=o?o(e):e,l=this._cache.get(s);if(l)return l;r=r||!1!==this._opts.addUsedSchema;var c=n.normalizeId(this._getId(e));c&&r&&E(this,c);var u,d=!1!==this._opts.validateSchema&&!t;d&&!(u=c&&c==n.normalizeId(e.$schema))&&this.validateSchema(e,!0);var h=n.ids.call(this,e),m=new a({id:c,schema:e,localRefs:h,cacheKey:s,meta:i});return"#"!=c[0]&&r&&(this._refs[c]=m),this._cache.put(s,m),d&&u&&this.validateSchema(e,!0),m},y.prototype._compile=function(e,t){if(e.compiling)return e.validate=o,o.schema=e.schema,o.errors=null,o.root=t||o,!0===e.schema.$async&&(o.$async=!0),o;var i,n;e.compiling=!0,e.meta&&(i=this._opts,this._opts=this._metaOpts);try{n=r.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=i)}return e.validate=n,e.refs=n.refs,e.refVal=n.refVal,e.root=n.root,n;function o(){var t=e.validate,i=t.apply(this,arguments);return o.errors=t.errors,i}},y.prototype.compileAsync=i(42931);var h=i(14895);y.prototype.addKeyword=h.add,y.prototype.getKeyword=h.get,y.prototype.removeKeyword=h.remove,y.prototype.validateKeyword=h.validate;var m=i(87802);y.ValidationError=m.Validation,y.MissingRefError=m.MissingRef,y.$dataMetaSchema=u;var p="http://json-schema.org/draft-07/schema",f=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],g=["/properties"];function y(e){if(!(this instanceof y))return new y(e);e=this._opts=d.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:C,warn:C,error:C};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(e.format),this._cache=e.cache||new o,this._loadingSchemas={},this._compilations=[],this.RULES=c(),this._getId=function(e){switch(e.schemaId){case"auto":return T;case"id":return b;default:return S}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=s),this._metaOpts=function(e){for(var t=d.copy(e._opts),i=0;i<f.length;i++)delete t[f[i]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var i=e._opts.formats[t];e.addFormat(t,i)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var i=e._opts.keywords[t];e.addKeyword(t,i)}}(this),function(e){var t;if(e._opts.$data&&(t=i(894),e.addMetaSchema(t,t.$id,!0)),!1!==e._opts.meta){var r=i(6680);e._opts.$data&&(r=u(r,g)),e.addMetaSchema(r,p,!0),e._refs["http://json-schema.org/schema"]=p}}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(t)if(Array.isArray(t))e.addSchema(t);else for(var i in t)e.addSchema(t[i],i)}(this)}function v(e,t){return t=n.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function _(e,t,i){for(var r in t){var n=t[r];n.meta||i&&!i.test(r)||(e._cache.del(n.cacheKey),delete t[r])}}function b(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function S(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function T(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function E(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function C(){}},47531:e=>{"use strict";var t=e.exports=function(){this._cache={}};t.prototype.put=function(e,t){this._cache[e]=t},t.prototype.get=function(e){return this._cache[e]},t.prototype.del=function(e){delete this._cache[e]},t.prototype.clear=function(){this._cache={}}},42931:(e,t,i)=>{"use strict";var r=i(87802).MissingRef;e.exports=function e(t,i,n){var o=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof i&&(n=i,i=void 0);var a=s(t).then((function(){var e=o._addSchema(t,void 0,i);return e.validate||l(e)}));return n&&a.then((function(e){n(null,e)}),n),a;function s(t){var i=t.$schema;return i&&!o.getSchema(i)?e.call(o,{$ref:i},!0):Promise.resolve()}function l(e){try{return o._compile(e)}catch(t){if(t instanceof r)return function(t){var r=t.missingSchema;if(c(r))throw new Error("Schema "+r+" is loaded but "+t.missingRef+" cannot be resolved");var n=o._loadingSchemas[r];return n||(n=o._loadingSchemas[r]=o._opts.loadSchema(r)).then(a,a),n.then((function(e){if(!c(r))return s(e).then((function(){c(r)||o.addSchema(e,r,void 0,i)}))})).then((function(){return l(e)}));function a(){delete o._loadingSchemas[r]}function c(e){return o._refs[e]||o._schemas[e]}}(t);throw t}}}},87802:(e,t,i)=>{"use strict";var r=i(83610);function n(e,t,i){this.message=i||n.message(e,t),this.missingRef=r.url(e,t),this.missingSchema=r.normalizeId(r.fullPath(this.missingRef))}function o(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:o((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:o(n)},n.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},1516:(e,t,i)=>{"use strict";var r=i(42889),n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,s=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,u=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,m=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,p=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function f(e){return e="full"==e?"full":"fast",r.copy(f[e])}function g(e){var t=e.match(n);if(!t)return!1;var i=+t[1],r=+t[2],a=+t[3];return r>=1&&r<=12&&a>=1&&a<=(2==r&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(i)?29:o[r])}function y(e,t){var i=e.match(a);if(!i)return!1;var r=i[1],n=i[2],o=i[3],s=i[5];return(r<=23&&n<=59&&o<=59||23==r&&59==n&&60==o)&&(!t||s)}e.exports=f,f.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:S,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":m,"relative-json-pointer":p},f.full={date:g,time:y,"date-time":function(e){var t=e.split(v);return 2==t.length&&g(t[0])&&y(t[1],!0)},uri:function(e){return _.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:s,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:S,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":m,"relative-json-pointer":p};var v=/t|\s/i,_=/\/|:/,b=/[^\\]\\Z/;function S(e){if(b.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},47153:(e,t,i)=>{"use strict";var r=i(83610),n=i(42889),o=i(87802),a=i(35035),s=i(19508),l=n.ucs2length,c=i(64063),u=o.Validation;function d(e,t,i){var r=m.call(this,e,t,i);return r>=0?{index:r,compiling:!0}:(r=this._compilations.length,this._compilations[r]={schema:e,root:t,baseId:i},{index:r,compiling:!1})}function h(e,t,i){var r=m.call(this,e,t,i);r>=0&&this._compilations.splice(r,1)}function m(e,t,i){for(var r=0;r<this._compilations.length;r++){var n=this._compilations[r];if(n.schema==e&&n.root==t&&n.baseId==i)return r}return-1}function p(e,t){return"var pattern"+e+" = new RegExp("+n.toQuotedString(t[e])+");"}function f(e){return"var default"+e+" = defaults["+e+"];"}function g(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function y(e){return"var customRule"+e+" = customRules["+e+"];"}function v(e,t){if(!e.length)return"";for(var i="",r=0;r<e.length;r++)i+=t(r,e);return i}e.exports=function e(t,i,m,_){var b=this,S=this._opts,T=[void 0],E={},C=[],w={},x=[],P={},O=[];i=i||{schema:t,refVal:T,refs:E};var A=d.call(this,t,i,_),D=this._compilations[A.index];if(A.compiling)return D.callValidate=function e(){var t=D.validate,i=t.apply(this,arguments);return e.errors=t.errors,i};var R=this._formats,I=this.RULES;try{var M=k(t,i,m,_);D.validate=M;var L=D.callValidate;return L&&(L.schema=M.schema,L.errors=null,L.refs=M.refs,L.refVal=M.refVal,L.root=M.root,L.$async=M.$async,S.sourceCode&&(L.source=M.source)),M}finally{h.call(this,t,i,_)}function k(t,a,d,h){var m=!a||a&&a.schema==t;if(a.schema!=i.schema)return e.call(b,t,a,d,h);var _,w=!0===t.$async,P=s({isTop:!0,schema:t,isRoot:m,baseId:h,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:o.MissingRef,RULES:I,validate:s,util:n,resolve:r,resolveRef:N,usePattern:F,useDefault:V,useCustomRule:B,opts:S,formats:R,logger:b.logger,self:b});P=v(T,g)+v(C,p)+v(x,f)+v(O,y)+P,S.processCode&&(P=S.processCode(P,t));try{_=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",P)(b,I,R,i,T,x,O,c,l,u),T[0]=_}catch(e){throw b.logger.error("Error compiling schema, function code:",P),e}return _.schema=t,_.errors=null,_.refs=E,_.refVal=T,_.root=m?_:a,w&&(_.$async=!0),!0===S.sourceCode&&(_.source={code:P,patterns:C,defaults:x}),_}function N(t,n,o){n=r.url(t,n);var a,s,l=E[n];if(void 0!==l)return j(a=T[l],s="refVal["+l+"]");if(!o&&i.refs){var c=i.refs[n];if(void 0!==c)return j(a=i.refVal[c],s=U(n,a))}s=U(n);var u=r.call(b,k,i,n);if(void 0===u){var d=m&&m[n];d&&(u=r.inlineRef(d,S.inlineRefs)?d:e.call(b,d,i,m,t))}if(void 0!==u)return function(e,t){var i=E[e];T[i]=t}(n,u),j(u,s);!function(e){delete E[e]}(n)}function U(e,t){var i=T.length;return T[i]=t,E[e]=i,"refVal"+i}function j(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function F(e){var t=w[e];return void 0===t&&(t=w[e]=C.length,C[t]=e),"pattern"+t}function V(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return n.toQuotedString(e);case"object":if(null===e)return"null";var t=a(e),i=P[t];return void 0===i&&(i=P[t]=x.length,x[i]=e),"default"+i}}function B(e,t,i,r){if(!1!==b._opts.validateSchema){var n=e.definition.dependencies;if(n&&!n.every((function(e){return Object.prototype.hasOwnProperty.call(i,e)})))throw new Error("parent schema must have all required keywords: "+n.join(","));var o=e.definition.validateSchema;if(o&&!o(t)){var a="keyword schema is invalid: "+b.errorsText(o.errors);if("log"!=b._opts.validateSchema)throw new Error(a);b.logger.error(a)}}var s,l=e.definition.compile,c=e.definition.inline,u=e.definition.macro;if(l)s=l.call(b,t,i,r);else if(u)s=u.call(b,t,i,r),!1!==S.validateSchema&&b.validateSchema(s,!0);else if(c)s=c.call(b,r,e.keyword,t,i);else if(!(s=e.definition.validate))return;if(void 0===s)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var d=O.length;return O[d]=s,{code:"customRule"+d,validate:s}}}},83610:(e,t,i)=>{"use strict";var r=i(60540),n=i(64063),o=i(42889),a=i(74022),s=i(49461);function l(e,t,i){var r=this._refs[i];if("string"==typeof r){if(!this._refs[r])return l.call(this,e,t,r);r=this._refs[r]}if((r=r||this._schemas[i])instanceof a)return p(r.schema,this._opts.inlineRefs)?r.schema:r.validate||this._compile(r);var n,o,s,u=c.call(this,t,i);return u&&(n=u.schema,t=u.root,s=u.baseId),n instanceof a?o=n.validate||e.call(this,n.schema,t,void 0,s):void 0!==n&&(o=p(n,this._opts.inlineRefs)?n:e.call(this,n,t,void 0,s)),o}function c(e,t){var i=r.parse(t),n=v(i),o=y(this._getId(e.schema));if(0===Object.keys(e.schema).length||n!==o){var s=b(n),l=this._refs[s];if("string"==typeof l)return u.call(this,e,l,i);if(l instanceof a)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[s])instanceof a))return;if(l.validate||this._compile(l),s==b(t))return{schema:l,root:e,baseId:o};e=l}if(!e.schema)return;o=y(this._getId(e.schema))}return h.call(this,i,o,e.schema,e)}function u(e,t,i){var r=c.call(this,e,t);if(r){var n=r.schema,o=r.baseId;e=r.root;var a=this._getId(n);return a&&(o=S(o,a)),h.call(this,i,o,n,e)}}e.exports=l,l.normalizeId=b,l.fullPath=y,l.url=S,l.ids=function(e){var t=b(this._getId(e)),i={"":t},a={"":y(t,!1)},l={},c=this;return s(e,{allKeys:!0},(function(e,t,s,u,d,h,m){if(""!==t){var p=c._getId(e),f=i[u],g=a[u]+"/"+d;if(void 0!==m&&(g+="/"+("number"==typeof m?m:o.escapeFragment(m))),"string"==typeof p){p=f=b(f?r.resolve(f,p):p);var y=c._refs[p];if("string"==typeof y&&(y=c._refs[y]),y&&y.schema){if(!n(e,y.schema))throw new Error('id "'+p+'" resolves to more than one schema')}else if(p!=b(g))if("#"==p[0]){if(l[p]&&!n(e,l[p]))throw new Error('id "'+p+'" resolves to more than one schema');l[p]=e}else c._refs[p]=g}i[t]=f,a[t]=g}})),l},l.inlineRef=p,l.schema=c;var d=o.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function h(e,t,i,r){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var n=e.fragment.split("/"),a=1;a<n.length;a++){var s=n[a];if(s){if(void 0===(i=i[s=o.unescapeFragment(s)]))break;var l;if(!d[s]&&((l=this._getId(i))&&(t=S(t,l)),i.$ref)){var u=S(t,i.$ref),h=c.call(this,r,u);h&&(i=h.schema,r=h.root,t=h.baseId)}}}return void 0!==i&&i!==r.schema?{schema:i,root:r,baseId:t}:void 0}}var m=o.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(e,t){return!1!==t&&(void 0===t||!0===t?f(e):t?g(e)<=t:void 0)}function f(e){var t;if(Array.isArray(e)){for(var i=0;i<e.length;i++)if("object"==typeof(t=e[i])&&!f(t))return!1}else for(var r in e){if("$ref"==r)return!1;if("object"==typeof(t=e[r])&&!f(t))return!1}return!0}function g(e){var t,i=0;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&(i+=g(t)),i==1/0)return 1/0}else for(var n in e){if("$ref"==n)return 1/0;if(m[n])i++;else if("object"==typeof(t=e[n])&&(i+=g(t)+1),i==1/0)return 1/0}return i}function y(e,t){return!1!==t&&(e=b(e)),v(r.parse(e))}function v(e){return r.serialize(e).split("#")[0]+"#"}var _=/#\/?$/;function b(e){return e?e.replace(_,""):""}function S(e,t){return t=b(t),r.resolve(e,t)}},47753:(e,t,i)=>{"use strict";var r=i(66674),n=i(42889).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=n(t),e.types=n(["number","integer","string","array","object","boolean","null"]),e.forEach((function(i){i.rules=i.rules.map((function(i){var n;if("object"==typeof i){var o=Object.keys(i)[0];n=i[o],i=o,n.forEach((function(i){t.push(i),e.all[i]=!0}))}return t.push(i),e.all[i]={keyword:i,code:r[i],implements:n}})),e.all.$comment={keyword:"$comment",code:r.$comment},i.type&&(e.types[i.type]=i)})),e.keywords=n(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},74022:(e,t,i)=>{"use strict";var r=i(42889);e.exports=function(e){r.copy(e,this)}},4442:e=>{"use strict";e.exports=function(e){for(var t,i=0,r=e.length,n=0;n<r;)i++,(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<r&&56320==(64512&(t=e.charCodeAt(n)))&&n++;return i}},42889:(e,t,i)=>{"use strict";function r(e,t,i,r){var n=r?" !== ":" === ",o=r?" || ":" && ",a=r?"!":"",s=r?"":"!";switch(e){case"null":return t+n+"null";case"array":return a+"Array.isArray("+t+")";case"object":return"("+a+t+o+"typeof "+t+n+'"object"'+o+s+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+n+'"number"'+o+s+"("+t+" % 1)"+o+t+n+t+(i?o+a+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+n+'"'+e+'"'+(i?o+a+"isFinite("+t+")":"")+")";default:return"typeof "+t+n+'"'+e+'"'}}e.exports={copy:function(e,t){for(var i in t=t||{},e)t[i]=e[i];return t},checkDataType:r,checkDataTypes:function(e,t,i){switch(e.length){case 1:return r(e[0],t,i,!0);default:var n="",a=o(e);for(var s in a.array&&a.object&&(n=a.null?"(":"(!"+t+" || ",n+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer,a)n+=(n?" && ":"")+r(s,t,i,!0);return n}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var i=[],r=0;r<t.length;r++){var o=t[r];(n[o]||"array"===e&&"array"===o)&&(i[i.length]=o)}if(i.length)return i}else{if(n[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:o,getProperty:l,escapeQuotes:c,equal:i(64063),ucs2length:i(4442),varOccurences:function(e,t){t+="[^0-9]";var i=e.match(new RegExp(t,"g"));return i?i.length:0},varReplace:function(e,t,i){return t+="([^0-9])",i=i.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),i+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var i in e)if(t[i])return!0},schemaHasRulesExcept:function(e,t,i){if("boolean"==typeof e)return!e&&"not"!=i;for(var r in e)if(r!=i&&t[r])return!0},schemaUnknownRules:function(e,t){if("boolean"!=typeof e)for(var i in e)if(!t[i])return i},toQuotedString:u,getPathExpr:function(e,t,i,r){return m(e,i?"'/' + "+t+(r?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):r?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,i){return m(e,u(i?"/"+p(t):l(t)))},getData:function(e,t,i){var r,n,o,a;if(""===e)return"rootData";if("/"==e[0]){if(!d.test(e))throw new Error("Invalid JSON-pointer: "+e);n=e,o="rootData"}else{if(!(a=e.match(h)))throw new Error("Invalid JSON-pointer: "+e);if(r=+a[1],"#"==(n=a[2])){if(r>=t)throw new Error("Cannot access property/index "+r+" levels up, current level is "+t);return i[t-r]}if(r>t)throw new Error("Cannot access data "+r+" levels up, current level is "+t);if(o="data"+(t-r||""),!n)return o}for(var s=o,c=n.split("/"),u=0;u<c.length;u++){var m=c[u];m&&(s+=" && "+(o+=l(f(m))))}return s},unescapeFragment:function(e){return f(decodeURIComponent(e))},unescapeJsonPointer:f,escapeFragment:function(e){return encodeURIComponent(p(e))},escapeJsonPointer:p};var n=o(["string","number","integer","boolean","null"]);function o(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=!0;return t}var a=/^[a-z$_][a-z$_0-9]*$/i,s=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":a.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(s,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function u(e){return"'"+c(e)+"'"}var d=/^\/(?:[^~]|~0|~1)*$/,h=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function m(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function p(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},3978:e=>{"use strict";var t=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,i){for(var r=0;r<i.length;r++){e=JSON.parse(JSON.stringify(e));var n,o=i[r].split("/"),a=e;for(n=1;n<o.length;n++)a=a[o[n]];for(n=0;n<t.length;n++){var s=t[n],l=a[s];l&&(a[s]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e}},61128:(e,t,i)=>{"use strict";var r=i(6680);e.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:r.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:r.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},18210:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s;var m="maximum"==t,p=m?"exclusiveMaximum":"exclusiveMinimum",f=e.schema[p],g=e.opts.$data&&f&&f.$data,y=m?"<":">",v=m?">":"<",_=void 0;if(!h&&"number"!=typeof s&&void 0!==s)throw new Error(t+" must be number");if(!g&&void 0!==f&&"number"!=typeof f&&"boolean"!=typeof f)throw new Error(p+" must be number or boolean");if(g){var b,S=e.util.getData(f.$data,a,e.dataPathArr),T="exclusive"+o,E="exclType"+o,C="exclIsNumber"+o,w="' + "+(P="op"+o)+" + '";n+=" var schemaExcl"+o+" = "+S+"; ",n+=" var "+T+"; var "+E+" = typeof "+(S="schemaExcl"+o)+"; if ("+E+" != 'boolean' && "+E+" != 'undefined' && "+E+" != 'number') { ",_=p,(b=b||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: '"+p+" should be boolean' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var x=n;n=b.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" "+E+" == 'number' ? ( ("+T+" = "+r+" === undefined || "+S+" "+y+"= "+r+") ? "+d+" "+v+"= "+S+" : "+d+" "+v+" "+r+" ) : ( ("+T+" = "+S+" === true) ? "+d+" "+v+"= "+r+" : "+d+" "+v+" "+r+" ) || "+d+" !== "+d+") { var op"+o+" = "+T+" ? '"+y+"' : '"+y+"='; ",void 0===s&&(_=p,c=e.errSchemaPath+"/"+p,r=S,h=g)}else if(w=y,(C="number"==typeof f)&&h){var P="'"+w+"'";n+=" if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" ( "+r+" === undefined || "+f+" "+y+"= "+r+" ? "+d+" "+v+"= "+f+" : "+d+" "+v+" "+r+" ) || "+d+" !== "+d+") { "}else C&&void 0===s?(T=!0,_=p,c=e.errSchemaPath+"/"+p,r=f,v+="="):(C&&(r=Math[m?"min":"max"](f,s)),f===(!C||r)?(T=!0,_=p,c=e.errSchemaPath+"/"+p,v+="="):(T=!1,w+="=")),P="'"+w+"'",n+=" if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" "+d+" "+v+" "+r+" || "+d+" !== "+d+") { ";return _=_||t,(b=b||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(_||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+P+", limit: "+r+", exclusive: "+T+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be "+w+" ",n+=h?"' + "+r:r+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",x=n,n=b.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { "),n}},33038:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");n+="if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" "+d+".length "+("maxItems"==t?">":"<")+" "+r+") { ";var m=t,p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(m||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxItems"==t?"more":"fewer",n+=" than ",n+=h?"' + "+r+" + '":""+s,n+=" items' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=p.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},80425:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");var m="maxLength"==t?">":"<";n+="if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),!1===e.opts.unicode?n+=" "+d+".length ":n+=" ucs2length("+d+") ",n+=" "+m+" "+r+") { ";var p=t,f=f||[];f.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(p||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be ",n+="maxLength"==t?"longer":"shorter",n+=" than ",n+=h?"' + "+r+" + '":""+s,n+=" characters' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var g=n;return n=f.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},78204:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");n+="if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),n+=" Object.keys("+d+").length "+("maxProperties"==t?">":"<")+" "+r+") { ";var m=t,p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(m||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have ",n+="maxProperties"==t?"more":"fewer",n+=" than ",n+=h?"' + "+r+" + '":""+s,n+=" properties' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var f=n;return n=p.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},42988:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.schema[t],o=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var u="valid"+l.level,d=l.baseId,h=!0,m=n;if(m)for(var p,f=-1,g=m.length-1;f<g;)p=m[f+=1],(e.opts.strictKeywords?"object"==typeof p&&Object.keys(p).length>0||!1===p:e.util.schemaHasRules(p,e.RULES.all))&&(h=!1,l.schema=p,l.schemaPath=o+"["+f+"]",l.errSchemaPath=a+"/"+f,r+="  "+e.validate(l)+" ",l.baseId=d,s&&(r+=" if ("+u+") { ",c+="}"));return s&&(r+=h?" if (true) { ":" "+c.slice(0,-1)+" "),r}},39996:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level;if(a.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)}))){var g=m.baseId;r+=" var "+h+" = errors; var "+d+" = false;  ";var y=e.compositeRule;e.compositeRule=m.compositeRule=!0;var v=a;if(v)for(var _,b=-1,S=v.length-1;b<S;)_=v[b+=1],m.schema=_,m.schemaPath=s+"["+b+"]",m.errSchemaPath=l+"/"+b,r+="  "+e.validate(m)+" ",m.baseId=g,r+=" "+d+" = "+d+" || "+f+"; if (!"+d+") { ",p+="}";e.compositeRule=m.compositeRule=y,r+=" "+p+" if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else c&&(r+=" if (true) { ");return r}},57812:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.schema[t],o=e.errSchemaPath+"/"+t,a=(e.opts.allErrors,e.util.toQuotedString(n));return!0===e.opts.$comment?r+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(r+=" self._opts.$comment("+a+", "+e.util.toQuotedString(o)+", validate.root.schema);"),r}},25306:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; "),h||(r+=" var schema"+n+" = validate.schema"+s+";"),r+="var "+d+" = equal("+u+", schema"+n+"); if (!"+d+") {   ";var m=m||[];m.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+n+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var p=r;return r=m.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+p+"]); ":r+=" validate.errors = ["+p+"]; return false; ":r+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},2840:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e);m.level++;var p="valid"+m.level,f="i"+n,g=m.dataLevel=e.dataLevel+1,y="data"+g,v=e.baseId,_=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all);if(r+="var "+h+" = errors;var "+d+";",_){var b=e.compositeRule;e.compositeRule=m.compositeRule=!0,m.schema=a,m.schemaPath=s,m.errSchemaPath=l,r+=" var "+p+" = false; for (var "+f+" = 0; "+f+" < "+u+".length; "+f+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);var S=u+"["+f+"]";m.dataPathArr[g]=f;var T=e.validate(m);m.baseId=v,e.util.varOccurences(T,y)<2?r+=" "+e.util.varReplace(T,y,S)+" ":r+=" var "+y+" = "+S+"; "+T+" ",r+=" if ("+p+") break; }  ",e.compositeRule=m.compositeRule=b,r+="  if (!"+p+") {"}else r+=" if ("+u+".length == 0) {";var E=E||[];E.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var C=r;return r=E.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",_&&(r+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}},14165:e=>{"use strict";e.exports=function(e,t,i){var r,n,o=" ",a=e.level,s=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,h="data"+(s||""),m="valid"+a,p="errs__"+a,f=e.opts.$data&&l&&l.$data;f?(o+=" var schema"+a+" = "+e.util.getData(l.$data,s,e.dataPathArr)+"; ",n="schema"+a):n=l;var g,y,v,_,b,S=this,T="definition"+a,E=S.definition,C="";if(f&&E.$data){b="keywordValidate"+a;var w=E.validateSchema;o+=" var "+T+" = RULES.custom['"+t+"'].definition; var "+b+" = "+T+".validate;"}else{if(!(_=e.useCustomRule(S,l,e.schema,e)))return;n="validate.schema"+c,b=_.code,g=E.compile,y=E.inline,v=E.macro}var x=b+".errors",P="i"+a,O="ruleErr"+a,A=E.async;if(A&&!e.async)throw new Error("async keyword in sync schema");if(y||v||(o+=x+" = null;"),o+="var "+p+" = errors;var "+m+";",f&&E.$data&&(C+="}",o+=" if ("+n+" === undefined) { "+m+" = true; } else { ",w&&(C+="}",o+=" "+m+" = "+T+".validateSchema("+n+"); if ("+m+") { ")),y)E.statements?o+=" "+_.validate+" ":o+=" "+m+" = "+_.validate+"; ";else if(v){var D=e.util.copy(e);C="",D.level++;var R="valid"+D.level;D.schema=_.validate,D.schemaPath="";var I=e.compositeRule;e.compositeRule=D.compositeRule=!0;var M=e.validate(D).replace(/validate\.schema/g,b);e.compositeRule=D.compositeRule=I,o+=" "+M}else{(U=U||[]).push(o),o="",o+="  "+b+".call( ",e.opts.passContext?o+="this":o+="self",g||!1===E.schema?o+=" , "+h+" ":o+=" , "+n+" , "+h+" , validate.schema"+e.schemaPath+" ",o+=" , (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var L=s?"data"+(s-1||""):"parentData",k=s?e.dataPathArr[s]:"parentDataProperty",N=o+=" , "+L+" , "+k+" , rootData )  ";o=U.pop(),!1===E.errors?(o+=" "+m+" = ",A&&(o+="await "),o+=N+"; "):o+=A?" var "+(x="customErrors"+a)+" = null; try { "+m+" = await "+N+"; } catch (e) { "+m+" = false; if (e instanceof ValidationError) "+x+" = e.errors; else throw e; } ":" "+x+" = null; "+m+" = "+N+"; "}if(E.modifying&&(o+=" if ("+L+") "+h+" = "+L+"["+k+"];"),o+=""+C,E.valid)d&&(o+=" if (true) { ");else{var U;o+=" if ( ",void 0===E.valid?(o+=" !",o+=v?""+R:""+m):o+=" "+!E.valid+" ",o+=") { ",r=S.keyword,(U=U||[]).push(o),o="",(U=U||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+S.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+S.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ";var j=o;o=U.pop(),!e.compositeRule&&d?e.async?o+=" throw new ValidationError(["+j+"]); ":o+=" validate.errors = ["+j+"]; return false; ":o+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var F=o;o=U.pop(),y?E.errors?"full"!=E.errors&&(o+="  for (var "+P+"="+p+"; "+P+"<errors; "+P+"++) { var "+O+" = vErrors["+P+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+O+".schemaPath === undefined) { "+O+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } "):!1===E.errors?o+=" "+F+" ":(o+=" if ("+p+" == errors) { "+F+" } else {  for (var "+P+"="+p+"; "+P+"<errors; "+P+"++) { var "+O+" = vErrors["+P+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+O+".schemaPath === undefined) { "+O+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } } "):v?(o+="   var err =   ",!1!==e.createErrors?(o+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+S.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+S.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ",o+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?o+=" throw new ValidationError(vErrors); ":o+=" validate.errors = vErrors; return false; ")):!1===E.errors?o+=" "+F+" ":(o+=" if (Array.isArray("+x+")) { if (vErrors === null) vErrors = "+x+"; else vErrors = vErrors.concat("+x+"); errors = vErrors.length;  for (var "+P+"="+p+"; "+P+"<errors; "+P+"++) { var "+O+" = vErrors["+P+"]; if ("+O+".dataPath === undefined) "+O+".dataPath = (dataPath || '') + "+e.errorPath+";  "+O+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(o+=" "+O+".schema = "+n+"; "+O+".data = "+h+"; "),o+=" } } else { "+F+" } "),o+=" } ",d&&(o+=" else { ")}return o}},66659:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e),m="";h.level++;var p="valid"+h.level,f={},g={},y=e.opts.ownProperties;for(S in a)if("__proto__"!=S){var v=a[S],_=Array.isArray(v)?g:f;_[S]=v}r+="var "+d+" = errors;";var b=e.errorPath;for(var S in r+="var missing"+n+";",g)if((_=g[S]).length){if(r+=" if ( "+u+e.util.getProperty(S)+" !== undefined ",y&&(r+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),c){r+=" && ( ";var T=_;if(T)for(var E=-1,C=T.length-1;E<C;)D=T[E+=1],E&&(r+=" || "),r+=" ( ( "+(L=u+(M=e.util.getProperty(D)))+" === undefined ",y&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(D)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?D:M)+") ) ";r+=")) {  ";var w="missing"+n,x="' + "+w+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,w,!0):b+" + "+w);var P=P||[];P.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==_.length?r+="property "+e.util.escapeQuotes(_[0]):r+="properties "+e.util.escapeQuotes(_.join(", ")),r+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var O=r;r=P.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+O+"]); ":r+=" validate.errors = ["+O+"]; return false; ":r+=" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var A=_;if(A)for(var D,R=-1,I=A.length-1;R<I;){D=A[R+=1];var M=e.util.getProperty(D),L=(x=e.util.escapeQuotes(D),u+M);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,D,e.opts.jsonPointers)),r+=" if ( "+L+" === undefined ",y&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(D)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==_.length?r+="property "+e.util.escapeQuotes(_[0]):r+="properties "+e.util.escapeQuotes(_.join(", ")),r+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&(m+="}",r+=" else { ")}e.errorPath=b;var k=h.baseId;for(var S in f)v=f[S],(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0||!1===v:e.util.schemaHasRules(v,e.RULES.all))&&(r+=" "+p+" = true; if ( "+u+e.util.getProperty(S)+" !== undefined ",y&&(r+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),r+=") { ",h.schema=v,h.schemaPath=s+e.util.getProperty(S),h.errSchemaPath=l+"/"+e.util.escapeFragment(S),r+="  "+e.validate(h)+" ",h.baseId=k,r+=" }  ",c&&(r+=" if ("+p+") { ",m+="}"));return c&&(r+="   "+m+" if ("+d+" == errors) {"),r}},31740:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var m="i"+n,p="schema"+n;h||(r+=" var "+p+" = validate.schema"+s+";"),r+="var "+d+";",h&&(r+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),r+=d+" = false;for (var "+m+"=0; "+m+"<"+p+".length; "+m+"++) if (equal("+u+", "+p+"["+m+"])) { "+d+" = true; break; }",h&&(r+="  }  "),r+=" if (!"+d+") {   ";var f=f||[];f.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+n+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var g=r;return r=f.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},39014:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||"");if(!1===e.opts.format)return c&&(r+=" if (true) { "),r;var d,h=e.opts.$data&&a&&a.$data;h?(r+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",d="schema"+n):d=a;var m=e.opts.unknownFormats,p=Array.isArray(m);if(h)r+=" var "+(f="format"+n)+" = formats["+d+"]; var "+(g="isObject"+n)+" = typeof "+f+" == 'object' && !("+f+" instanceof RegExp) && "+f+".validate; var "+(y="formatType"+n)+" = "+g+" && "+f+".type || 'string'; if ("+g+") { ",e.async&&(r+=" var async"+n+" = "+f+".async; "),r+=" "+f+" = "+f+".validate; } if (  ",h&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" (","ignore"!=m&&(r+=" ("+d+" && !"+f+" ",p&&(r+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),r+=") || "),r+=" ("+f+" && "+y+" == '"+i+"' && !(typeof "+f+" == 'function' ? ",e.async?r+=" (async"+n+" ? await "+f+"("+u+") : "+f+"("+u+")) ":r+=" "+f+"("+u+") ",r+=" : "+f+".test("+u+"))))) {";else{var f;if(!(f=e.formats[a])){if("ignore"==m)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(r+=" if (true) { "),r;if(p&&m.indexOf(a)>=0)return c&&(r+=" if (true) { "),r;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var g,y=(g="object"==typeof f&&!(f instanceof RegExp)&&f.validate)&&f.type||"string";if(g){var v=!0===f.async;f=f.validate}if(y!=i)return c&&(r+=" if (true) { "),r;if(v){if(!e.async)throw new Error("async format in sync schema");r+=" if (!(await "+(_="formats"+e.util.getProperty(a)+".validate")+"("+u+"))) { "}else{r+=" if (! ";var _="formats"+e.util.getProperty(a);g&&(_+=".validate"),r+="function"==typeof f?" "+_+"("+u+") ":" "+_+".test("+u+") ",r+=") { "}}var b=b||[];b.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",r+=h?""+d:""+e.util.toQuotedString(a),r+="  } ",!1!==e.opts.messages&&(r+=" , message: 'should match format \"",r+=h?"' + "+d+" + '":""+e.util.escapeQuotes(a),r+="\"' "),e.opts.verbose&&(r+=" , schema:  ",r+=h?"validate.schema"+s:""+e.util.toQuotedString(a),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var S=r;return r=b.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},17231:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e);m.level++;var p="valid"+m.level,f=e.schema.then,g=e.schema.else,y=void 0!==f&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0||!1===f:e.util.schemaHasRules(f,e.RULES.all)),v=void 0!==g&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0||!1===g:e.util.schemaHasRules(g,e.RULES.all)),_=m.baseId;if(y||v){var b;m.createErrors=!1,m.schema=a,m.schemaPath=s,m.errSchemaPath=l,r+=" var "+h+" = errors; var "+d+" = true;  ";var S=e.compositeRule;e.compositeRule=m.compositeRule=!0,r+="  "+e.validate(m)+" ",m.baseId=_,m.createErrors=!0,r+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=m.compositeRule=S,y?(r+=" if ("+p+") {  ",m.schema=e.schema.then,m.schemaPath=e.schemaPath+".then",m.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(m)+" ",m.baseId=_,r+=" "+d+" = "+p+"; ",y&&v?r+=" var "+(b="ifClause"+n)+" = 'then'; ":b="'then'",r+=" } ",v&&(r+=" else { ")):r+=" if (!"+p+") { ",v&&(m.schema=e.schema.else,m.schemaPath=e.schemaPath+".else",m.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(m)+" ",m.baseId=_,r+=" "+d+" = "+p+"; ",y&&v?r+=" var "+(b="ifClause"+n)+" = 'else'; ":b="'else'",r+=" } "),r+=" if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",c&&(r+=" else { ")}else c&&(r+=" if (true) { ");return r}},66674:(e,t,i)=>{"use strict";e.exports={$ref:i(62392),allOf:i(42988),anyOf:i(39996),$comment:i(57812),const:i(25306),contains:i(2840),dependencies:i(66659),enum:i(31740),format:i(39014),if:i(17231),items:i(37482),maximum:i(18210),minimum:i(18210),maxItems:i(33038),minItems:i(33038),maxLength:i(80425),minLength:i(80425),maxProperties:i(78204),minProperties:i(78204),multipleOf:i(43673),not:i(28528),oneOf:i(59709),pattern:i(49614),properties:i(81175),propertyNames:i(58441),required:i(71287),uniqueItems:i(3603),validate:i(19508)}},37482:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level,g="i"+n,y=m.dataLevel=e.dataLevel+1,v="data"+y,_=e.baseId;if(r+="var "+h+" = errors;var "+d+";",Array.isArray(a)){var b=e.schema.additionalItems;if(!1===b){r+=" "+d+" = "+u+".length <= "+a.length+"; ";var S=l;l=e.errSchemaPath+"/additionalItems",r+="  if (!"+d+") {   ";var T=T||[];T.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var E=r;r=T.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",l=S,c&&(p+="}",r+=" else { ")}var C=a;if(C)for(var w,x=-1,P=C.length-1;x<P;)if(w=C[x+=1],e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0||!1===w:e.util.schemaHasRules(w,e.RULES.all)){r+=" "+f+" = true; if ("+u+".length > "+x+") { ";var O=u+"["+x+"]";m.schema=w,m.schemaPath=s+"["+x+"]",m.errSchemaPath=l+"/"+x,m.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0),m.dataPathArr[y]=x;var A=e.validate(m);m.baseId=_,e.util.varOccurences(A,v)<2?r+=" "+e.util.varReplace(A,v,O)+" ":r+=" var "+v+" = "+O+"; "+A+" ",r+=" }  ",c&&(r+=" if ("+f+") { ",p+="}")}"object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))&&(m.schema=b,m.schemaPath=e.schemaPath+".additionalItems",m.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+f+" = true; if ("+u+".length > "+a.length+") {  for (var "+g+" = "+a.length+"; "+g+" < "+u+".length; "+g+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0),O=u+"["+g+"]",m.dataPathArr[y]=g,A=e.validate(m),m.baseId=_,e.util.varOccurences(A,v)<2?r+=" "+e.util.varReplace(A,v,O)+" ":r+=" var "+v+" = "+O+"; "+A+" ",c&&(r+=" if (!"+f+") break; "),r+=" } }  ",c&&(r+=" if ("+f+") { ",p+="}"))}else(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all))&&(m.schema=a,m.schemaPath=s,m.errSchemaPath=l,r+="  for (var "+g+" = 0; "+g+" < "+u+".length; "+g+"++) { ",m.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0),O=u+"["+g+"]",m.dataPathArr[y]=g,A=e.validate(m),m.baseId=_,e.util.varOccurences(A,v)<2?r+=" "+e.util.varReplace(A,v,O)+" ":r+=" var "+v+" = "+O+"; "+A+" ",c&&(r+=" if (!"+f+") break; "),r+=" }");return c&&(r+=" "+p+" if ("+h+" == errors) {"),r}},43673:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");n+="var division"+o+";if (",h&&(n+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),n+=" (division"+o+" = "+d+" / "+r+", ",e.opts.multipleOfPrecision?n+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+e.opts.multipleOfPrecision+" ":n+=" division"+o+" !== parseInt(division"+o+") ",n+=" ) ",h&&(n+="  )  "),n+=" ) {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be multiple of ",n+=h?"' + "+r:r+"'"),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var p=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},28528:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=l,r+=" var "+d+" = errors;  ";var p,f=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(p=h.opts.allErrors,h.opts.allErrors=!1),r+=" "+e.validate(h)+" ",h.createErrors=!0,p&&(h.opts.allErrors=p),e.compositeRule=h.compositeRule=f,r+=" if ("+m+") {   ";var g=g||[];g.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var y=r;r=g.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},59709:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h="errs__"+n,m=e.util.copy(e),p="";m.level++;var f="valid"+m.level,g=m.baseId,y="prevValid"+n,v="passingSchemas"+n;r+="var "+h+" = errors , "+y+" = false , "+d+" = false , "+v+" = null; ";var _=e.compositeRule;e.compositeRule=m.compositeRule=!0;var b=a;if(b)for(var S,T=-1,E=b.length-1;T<E;)S=b[T+=1],(e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0||!1===S:e.util.schemaHasRules(S,e.RULES.all))?(m.schema=S,m.schemaPath=s+"["+T+"]",m.errSchemaPath=l+"/"+T,r+="  "+e.validate(m)+" ",m.baseId=g):r+=" var "+f+" = true; ",T&&(r+=" if ("+f+" && "+y+") { "+d+" = false; "+v+" = ["+v+", "+T+"]; } else { ",p+="}"),r+=" if ("+f+") { "+d+" = "+y+" = true; "+v+" = "+T+"; }";return e.compositeRule=m.compositeRule=_,r+=p+"if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+v+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}},49614:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,n+="if ( ",h&&(n+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),n+=" !"+(h?"(new RegExp("+r+"))":e.usePattern(s))+".test("+d+") ) {   ";var m=m||[];m.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",n+=h?""+r:""+e.util.toQuotedString(s),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match pattern \"",n+=h?"' + "+r+" + '":""+e.util.escapeQuotes(s),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+l:""+e.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var p=n;return n=m.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+p+"]); ":n+=" validate.errors = ["+p+"]; return false; ":n+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+="} ",u&&(n+=" else { "),n}},81175:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e),m="";h.level++;var p="valid"+h.level,f="key"+n,g="idx"+n,y=h.dataLevel=e.dataLevel+1,v="data"+y,_="dataProperties"+n,b=Object.keys(a||{}).filter(M),S=e.schema.patternProperties||{},T=Object.keys(S).filter(M),E=e.schema.additionalProperties,C=b.length||T.length,w=!1===E,x="object"==typeof E&&Object.keys(E).length,P=e.opts.removeAdditional,O=w||x||P,A=e.opts.ownProperties,D=e.baseId,R=e.schema.required;if(R&&(!e.opts.$data||!R.$data)&&R.length<e.opts.loopRequired)var I=e.util.toHash(R);function M(e){return"__proto__"!==e}if(r+="var "+d+" = errors;var "+p+" = true;",A&&(r+=" var "+_+" = undefined;"),O){if(r+=A?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+g+"=0; "+g+"<"+_+".length; "+g+"++) { var "+f+" = "+_+"["+g+"]; ":" for (var "+f+" in "+u+") { ",C){if(r+=" var isAdditional"+n+" = !(false ",b.length)if(b.length>8)r+=" || validate.schema"+s+".hasOwnProperty("+f+") ";else{var L=b;if(L)for(var k=-1,N=L.length-1;k<N;)Y=L[k+=1],r+=" || "+f+" == "+e.util.toQuotedString(Y)+" "}if(T.length){var U=T;if(U)for(var j=-1,F=U.length-1;j<F;)oe=U[j+=1],r+=" || "+e.usePattern(oe)+".test("+f+") "}r+=" ); if (isAdditional"+n+") { "}if("all"==P)r+=" delete "+u+"["+f+"]; ";else{var V=e.errorPath,B="' + "+f+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers)),w)if(P)r+=" delete "+u+"["+f+"]; ";else{r+=" "+p+" = false; ";var G=l;l=e.errSchemaPath+"/additionalProperties",(ie=ie||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+B+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var z=r;r=ie.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+z+"]); ":r+=" validate.errors = ["+z+"]; return false; ":r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=G,c&&(r+=" break; ")}else if(x)if("failing"==P){r+=" var "+d+" = errors;  ";var H=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers);var q=u+"["+f+"]";h.dataPathArr[y]=f;var W=e.validate(h);h.baseId=D,e.util.varOccurences(W,v)<2?r+=" "+e.util.varReplace(W,v,q)+" ":r+=" var "+v+" = "+q+"; "+W+" ",r+=" if (!"+p+") { errors = "+d+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+u+"["+f+"]; }  ",e.compositeRule=h.compositeRule=H}else h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers),q=u+"["+f+"]",h.dataPathArr[y]=f,W=e.validate(h),h.baseId=D,e.util.varOccurences(W,v)<2?r+=" "+e.util.varReplace(W,v,q)+" ":r+=" var "+v+" = "+q+"; "+W+" ",c&&(r+=" if (!"+p+") break; ");e.errorPath=V}C&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+p+") { ",m+="}")}var K=e.opts.useDefaults&&!e.compositeRule;if(b.length){var $=b;if($)for(var Y,Q=-1,J=$.length-1;Q<J;){var X=a[Y=$[Q+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){var Z=e.util.getProperty(Y),ee=(q=u+Z,K&&void 0!==X.default);if(h.schema=X,h.schemaPath=s+Z,h.errSchemaPath=l+"/"+e.util.escapeFragment(Y),h.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),h.dataPathArr[y]=e.util.toQuotedString(Y),W=e.validate(h),h.baseId=D,e.util.varOccurences(W,v)<2){W=e.util.varReplace(W,v,q);var te=q}else te=v,r+=" var "+v+" = "+q+"; ";if(ee)r+=" "+W+" ";else{if(I&&I[Y]){r+=" if ( "+te+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+p+" = false; ",V=e.errorPath,G=l;var ie,re=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(V,Y,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(ie=ie||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+re+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",z=r,r=ie.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+z+"]); ":r+=" validate.errors = ["+z+"]; return false; ":r+=" var err = "+z+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=G,e.errorPath=V,r+=" } else { "}else c?(r+=" if ( "+te+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+p+" = true; } else { "):(r+=" if ("+te+" !== undefined ",A&&(r+=" &&   Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=" ) { ");r+=" "+W+" } "}}c&&(r+=" if ("+p+") { ",m+="}")}}if(T.length){var ne=T;if(ne)for(var oe,ae=-1,se=ne.length-1;ae<se;)X=S[oe=ne[ae+=1]],(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all))&&(h.schema=X,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(oe),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(oe),r+=A?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+g+"=0; "+g+"<"+_+".length; "+g+"++) { var "+f+" = "+_+"["+g+"]; ":" for (var "+f+" in "+u+") { ",r+=" if ("+e.usePattern(oe)+".test("+f+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers),q=u+"["+f+"]",h.dataPathArr[y]=f,W=e.validate(h),h.baseId=D,e.util.varOccurences(W,v)<2?r+=" "+e.util.varReplace(W,v,q)+" ":r+=" var "+v+" = "+q+"; "+W+" ",c&&(r+=" if (!"+p+") break; "),r+=" } ",c&&(r+=" else "+p+" = true; "),r+=" }  ",c&&(r+=" if ("+p+") { ",m+="}"))}return c&&(r+=" "+m+" if ("+d+" == errors) {"),r}},58441:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="errs__"+n,h=e.util.copy(e);h.level++;var m="valid"+h.level;if(r+="var "+d+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=l;var p="key"+n,f="idx"+n,g="i"+n,y="' + "+p+" + '",v="data"+(h.dataLevel=e.dataLevel+1),_="dataProperties"+n,b=e.opts.ownProperties,S=e.baseId;b&&(r+=" var "+_+" = undefined; "),r+=b?" "+_+" = "+_+" || Object.keys("+u+"); for (var "+f+"=0; "+f+"<"+_+".length; "+f+"++) { var "+p+" = "+_+"["+f+"]; ":" for (var "+p+" in "+u+") { ",r+=" var startErrs"+n+" = errors; ";var T=p,E=e.compositeRule;e.compositeRule=h.compositeRule=!0;var C=e.validate(h);h.baseId=S,e.util.varOccurences(C,v)<2?r+=" "+e.util.varReplace(C,v,T)+" ":r+=" var "+v+" = "+T+"; "+C+" ",e.compositeRule=h.compositeRule=E,r+=" if (!"+m+") { for (var "+g+"=startErrs"+n+"; "+g+"<errors; "+g+"++) { vErrors["+g+"].propertyName = "+p+"; }   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(r+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),c&&(r+=" break; "),r+=" } }"}return c&&(r+="  if ("+d+" == errors) {"),r}},62392:e=>{"use strict";e.exports=function(e,t,i){var r,n,o=" ",a=e.level,s=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(s||""),h="valid"+a;if("#"==l||"#/"==l)e.isRoot?(r=e.async,n="validate"):(r=!0===e.root.schema.$async,n="root.refVal[0]");else{var m=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===m){var p=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(p),(v=v||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(o+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(o+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ";var f=o;o=v.pop(),!e.compositeRule&&u?e.async?o+=" throw new ValidationError(["+f+"]); ":o+=" validate.errors = ["+f+"]; return false; ":o+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(o+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,p);e.logger.warn(p),u&&(o+=" if (true) { ")}}else if(m.inline){var g=e.util.copy(e);g.level++;var y="valid"+g.level;g.schema=m.schema,g.schemaPath="",g.errSchemaPath=l,o+=" "+e.validate(g).replace(/validate\.schema/g,m.code)+" ",u&&(o+=" if ("+y+") { ")}else r=!0===m.$async||e.async&&!1!==m.$async,n=m.code}if(n){var v;(v=v||[]).push(o),o="",e.opts.passContext?o+=" "+n+".call(this, ":o+=" "+n+"( ",o+=" "+d+", (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var _=o+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";if(o=v.pop(),r){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(o+=" var "+h+"; "),o+=" try { await "+_+"; ",u&&(o+=" "+h+" = true; "),o+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(o+=" "+h+" = false; "),o+=" } ",u&&(o+=" if ("+h+") { ")}else o+=" if (!"+_+") { if (vErrors === null) vErrors = "+n+".errors; else vErrors = vErrors.concat("+n+".errors); errors = vErrors.length; } ",u&&(o+=" else { ")}return o}},71287:e=>{"use strict";e.exports=function(e,t,i){var r=" ",n=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var m="schema"+n;if(!h)if(a.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var p=[],f=a;if(f)for(var g,y=-1,v=f.length-1;y<v;){g=f[y+=1];var _=e.schema.properties[g];_&&(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0||!1===_:e.util.schemaHasRules(_,e.RULES.all))||(p[p.length]=g)}}else p=a;if(h||p.length){var b=e.errorPath,S=h||p.length>=e.opts.loopRequired,T=e.opts.ownProperties;if(c)if(r+=" var missing"+n+"; ",S){h||(r+=" var "+m+" = validate.schema"+s+"; ");var E="' + "+(A="schema"+n+"["+(P="i"+n)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,A,e.opts.jsonPointers)),r+=" var "+d+" = true; ",h&&(r+=" if (schema"+n+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+n+")) "+d+" = false; else {"),r+=" for (var "+P+" = 0; "+P+" < "+m+".length; "+P+"++) { "+d+" = "+u+"["+m+"["+P+"]] !== undefined ",T&&(r+=" &&   Object.prototype.hasOwnProperty.call("+u+", "+m+"["+P+"]) "),r+="; if (!"+d+") break; } ",h&&(r+="  }  "),r+="  if (!"+d+") {   ",(w=w||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var C=r;r=w.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var w,x=p;if(x)for(var P=-1,O=x.length-1;P<O;)R=x[P+=1],P&&(r+=" || "),r+=" ( ( "+(k=u+(L=e.util.getProperty(R)))+" === undefined ",T&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(R)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?R:L)+") ) ";r+=") {  ",E="' + "+(A="missing"+n)+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,A,!0):b+" + "+A),(w=w||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",C=r,r=w.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(S){var A;h||(r+=" var "+m+" = validate.schema"+s+"; "),E="' + "+(A="schema"+n+"["+(P="i"+n)+"]")+" + '",e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,A,e.opts.jsonPointers)),h&&(r+=" if ("+m+" && !Array.isArray("+m+")) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+m+" !== undefined) { "),r+=" for (var "+P+" = 0; "+P+" < "+m+".length; "+P+"++) { if ("+u+"["+m+"["+P+"]] === undefined ",T&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", "+m+"["+P+"]) "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(r+="  }  ")}else{var D=p;if(D)for(var R,I=-1,M=D.length-1;I<M;){R=D[I+=1];var L=e.util.getProperty(R),k=(E=e.util.escapeQuotes(R),u+L);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,R,e.opts.jsonPointers)),r+=" if ( "+k+" === undefined ",T&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(R)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=b}else c&&(r+=" if (true) {");return r}},3603:e=>{"use strict";e.exports=function(e,t,i){var r,n=" ",o=e.level,a=e.dataLevel,s=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h="valid"+o,m=e.opts.$data&&s&&s.$data;if(m?(n+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",r="schema"+o):r=s,(s||m)&&!1!==e.opts.uniqueItems){m&&(n+=" var "+h+"; if ("+r+" === false || "+r+" === undefined) "+h+" = true; else if (typeof "+r+" != 'boolean') "+h+" = false; else { "),n+=" var i = "+d+".length , "+h+" = true , j; if (i > 1) { ";var p=e.schema.items&&e.schema.items.type,f=Array.isArray(p);if(!p||"object"==p||"array"==p||f&&(p.indexOf("object")>=0||p.indexOf("array")>=0))n+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+d+"[i], "+d+"[j])) { "+h+" = false; break outer; } } } ";else{n+=" var itemIndices = {}, item; for (;i--;) { var item = "+d+"[i]; ";var g="checkDataType"+(f?"s":"");n+=" if ("+e.util[g](p,"item",e.opts.strictNumbers,!0)+") continue; ",f&&(n+=" if (typeof item == 'string') item = '\"' + item; "),n+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}n+=" } ",m&&(n+="  }  "),n+=" if (!"+h+") {   ";var y=y||[];y.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(n+=" , schema:  ",n+=m?"validate.schema"+l:""+s,n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var v=n;n=y.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u&&(n+=" else { ")}else u&&(n+=" if (true) { ");return n}},19508:e=>{"use strict";e.exports=function(e,t,i){var r="",n=!0===e.schema.$async,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),a=e.self._getId(e.schema);if(e.opts.strictKeywords){var s=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(s){var l="unknown keyword: "+s;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(r+=" var validate = ",n&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",a&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" /*# sourceURL="+a+" */ ")),"boolean"==typeof e.schema||!o&&!e.schema.$ref){t="false schema";var c=e.level,u=e.dataLevel,d=e.schema[t],h=e.schemaPath+e.util.getProperty(t),m=e.errSchemaPath+"/"+t,p=!e.opts.allErrors,f="data"+(u||""),g="valid"+c;if(!1===e.schema){e.isTop?p=!0:r+=" var "+g+" = false; ",(q=q||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var y=r;r=q.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?r+=n?" return data; ":" validate.errors = null; return true; ":r+=" var "+g+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var v=e.isTop;if(c=e.level=0,u=e.dataLevel=0,f="data",e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var _="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{if(c=e.level,f="data"+((u=e.dataLevel)||""),a&&(e.baseId=e.resolve.url(e.baseId,a)),n&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+c+" = errors;"}g="valid"+c,p=!e.opts.allErrors;var b="",S="",T=e.schema.type,E=Array.isArray(T);if(T&&e.opts.nullable&&!0===e.schema.nullable&&(E?-1==T.indexOf("null")&&(T=T.concat("null")):"null"!=T&&(T=[T,"null"],E=!0)),E&&1==T.length&&(T=T[0],E=!1),e.schema.$ref&&o){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),T){if(e.opts.coerceTypes)var C=e.util.coerceToTypes(e.opts.coerceTypes,T);var w=e.RULES.types[T];if(C||E||!0===w||w&&!J(w)){h=e.schemaPath+".type",m=e.errSchemaPath+"/type",h=e.schemaPath+".type",m=e.errSchemaPath+"/type";var x=E?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[x](T,f,e.opts.strictNumbers,!0)+") { ",C){var P="dataType"+c,O="coerced"+c;r+=" var "+P+" = typeof "+f+"; var "+O+" = undefined; ","array"==e.opts.coerceTypes&&(r+=" if ("+P+" == 'object' && Array.isArray("+f+") && "+f+".length == 1) { "+f+" = "+f+"[0]; "+P+" = typeof "+f+"; if ("+e.util.checkDataType(e.schema.type,f,e.opts.strictNumbers)+") "+O+" = "+f+"; } "),r+=" if ("+O+" !== undefined) ; ";var A=C;if(A)for(var D,R=-1,I=A.length-1;R<I;)"string"==(D=A[R+=1])?r+=" else if ("+P+" == 'number' || "+P+" == 'boolean') "+O+" = '' + "+f+"; else if ("+f+" === null) "+O+" = ''; ":"number"==D||"integer"==D?(r+=" else if ("+P+" == 'boolean' || "+f+" === null || ("+P+" == 'string' && "+f+" && "+f+" == +"+f+" ","integer"==D&&(r+=" && !("+f+" % 1)"),r+=")) "+O+" = +"+f+"; "):"boolean"==D?r+=" else if ("+f+" === 'false' || "+f+" === 0 || "+f+" === null) "+O+" = false; else if ("+f+" === 'true' || "+f+" === 1) "+O+" = true; ":"null"==D?r+=" else if ("+f+" === '' || "+f+" === 0 || "+f+" === false) "+O+" = null; ":"array"==e.opts.coerceTypes&&"array"==D&&(r+=" else if ("+P+" == 'string' || "+P+" == 'number' || "+P+" == 'boolean' || "+f+" == null) "+O+" = ["+f+"]; ");r+=" else {   ",(q=q||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",r+=E?""+T.join(","):""+T,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+T.join(","):""+T,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",y=r,r=q.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+O+" !== undefined) {  ";var M=u?"data"+(u-1||""):"parentData";r+=" "+f+" = "+O+"; ",u||(r+="if ("+M+" !== undefined)"),r+=" "+M+"["+(u?e.dataPathArr[u]:"parentDataProperty")+"] = "+O+"; } "}else(q=q||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",r+=E?""+T.join(","):""+T,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+T.join(","):""+T,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",y=r,r=q.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";r+=" } "}}if(e.schema.$ref&&!o)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",p&&(r+=" } if (errors === ",r+=v?"0":"errs_"+c,r+=") { ",S+="}");else{var L=e.RULES;if(L)for(var k=-1,N=L.length-1;k<N;)if(J(w=L[k+=1])){if(w.type&&(r+=" if ("+e.util.checkDataType(w.type,f,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==w.type&&e.schema.properties){d=e.schema.properties;var U=Object.keys(d);if(U)for(var j,F=-1,V=U.length-1;F<V;)if(void 0!==(z=d[j=U[F+=1]]).default){var B=f+e.util.getProperty(j);if(e.compositeRule){if(e.opts.strictDefaults){if(_="default is ignored for: "+B,"log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else r+=" if ("+B+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+B+" === null || "+B+" === '' "),r+=" ) "+B+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(z.default)+" ":r+=" "+JSON.stringify(z.default)+" ",r+="; "}}else if("array"==w.type&&Array.isArray(e.schema.items)){var G=e.schema.items;if(G){R=-1;for(var z,H=G.length-1;R<H;)if(void 0!==(z=G[R+=1]).default)if(B=f+"["+R+"]",e.compositeRule){if(e.opts.strictDefaults){if(_="default is ignored for: "+B,"log"!==e.opts.strictDefaults)throw new Error(_);e.logger.warn(_)}}else r+=" if ("+B+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+B+" === null || "+B+" === '' "),r+=" ) "+B+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(z.default)+" ":r+=" "+JSON.stringify(z.default)+" ",r+="; "}}var q,W=w.rules;if(W)for(var K,$=-1,Y=W.length-1;$<Y;)if(X(K=W[$+=1])){var Q=K.code(e,K.keyword,w.type);Q&&(r+=" "+Q+" ",p&&(b+="}"))}if(p&&(r+=" "+b+" ",b=""),w.type&&(r+=" } ",T&&T===w.type&&!C))r+=" else { ",h=e.schemaPath+".type",m=e.errSchemaPath+"/type",(q=q||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(m)+" , params: { type: '",r+=E?""+T.join(","):""+T,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+T.join(","):""+T,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ",y=r,r=q.pop(),!e.compositeRule&&p?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ";p&&(r+=" if (errors === ",r+=v?"0":"errs_"+c,r+=") { ",S+="}")}}function J(e){for(var t=e.rules,i=0;i<t.length;i++)if(X(t[i]))return!0}function X(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var i=t.implements,r=0;r<i.length;r++)if(void 0!==e.schema[i[r]])return!0}(t)}return p&&(r+=" "+S+" "),v?(n?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+g+" = errors === errs_"+c+";",r}},14895:(e,t,i)=>{"use strict";var r=/^[a-z_$][a-z0-9_$-]*$/i,n=i(14165),o=i(61128);e.exports={add:function(e,t){var i=this.RULES;if(i.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!r.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var o=t.type;if(Array.isArray(o))for(var a=0;a<o.length;a++)l(e,o[a],t);else l(e,o,t);var s=t.metaSchema;s&&(t.$data&&this._opts.$data&&(s={anyOf:[s,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(s,!0))}function l(e,t,r){for(var o,a=0;a<i.length;a++){var s=i[a];if(s.type==t){o=s;break}}o||(o={type:t,rules:[]},i.push(o));var l={keyword:e,definition:r,custom:!0,code:n,implements:r.implements};o.rules.push(l),i.custom[e]=l}return i.keywords[e]=i.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var i=0;i<t.length;i++)for(var r=t[i].rules,n=0;n<r.length;n++)if(r[n].keyword==e){r.splice(n,1);break}return this},validate:function e(t,i){e.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(o,!0);if(r(t))return!0;if(e.errors=r.errors,i)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}}},45694:(e,t)=>{var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(e){return(e=Math.round(e))<0?0:e>255?255:e}function n(e){return e<0?0:e>1?1:e}function o(e){return"%"===e[e.length-1]?r(parseFloat(e)/100*255):r(parseInt(e))}function a(e){return"%"===e[e.length-1]?n(parseFloat(e)/100):n(parseFloat(e))}function s(e,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?e+(t-e)*i*6:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}try{t.parseCSSColor=function(e){var t,n=e.replace(/ /g,"").toLowerCase();if(n in i)return i[n].slice();if("#"===n[0])return 4===n.length?(t=parseInt(n.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===n.length&&(t=parseInt(n.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=n.indexOf("("),c=n.indexOf(")");if(-1!==l&&c+1===n.length){var u=n.substr(0,l),d=n.substr(l+1,c-(l+1)).split(","),h=1;switch(u){case"rgba":if(4!==d.length)return null;h=a(d.pop());case"rgb":return 3!==d.length?null:[o(d[0]),o(d[1]),o(d[2]),h];case"hsla":if(4!==d.length)return null;h=a(d.pop());case"hsl":if(3!==d.length)return null;var m=(parseFloat(d[0])%360+360)%360/360,p=a(d[1]),f=a(d[2]),g=f<=.5?f*(p+1):f+p-f*p,y=2*f-g;return[r(255*s(y,g,m+1/3)),r(255*s(y,g,m)),r(255*s(y,g,m-1/3)),h];default:return null}}return null}}catch(e){}},9187:e=>{"use strict";function t(e,t,o){o=o||2;var a,s,l,d,h,p,f,g=t&&t.length,y=g?t[0]*o:e.length,v=i(e,0,y,o,!0),_=[];if(!v||v.next===v.prev)return _;if(g&&(v=function(e,t,n,o){var a,s,l,d=[];for(a=0,s=t.length;a<s;a++)(l=i(e,t[a]*o,a<s-1?t[a+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),d.push(m(l));for(d.sort(c),a=0;a<d.length;a++)u(d[a],n),n=r(n,n.next);return n}(e,t,v,o)),e.length>80*o){a=l=e[0],s=d=e[1];for(var b=o;b<y;b+=o)(h=e[b])<a&&(a=h),(p=e[b+1])<s&&(s=p),h>l&&(l=h),p>d&&(d=p);f=0!==(f=Math.max(l-a,d-s))?1/f:0}return n(v,_,o,a,s,f),_}function i(e,t,i,r,n){var o,a;if(n===x(e,t,i,r)>0)for(o=t;o<i;o+=r)a=E(o,e[o],e[o+1],a);else for(o=i-r;o>=t;o-=r)a=E(o,e[o],e[o+1],a);return a&&y(a,a.next)&&(C(a),a=a.next),a}function r(e,t){if(!e)return e;t||(t=e);var i,r=e;do{if(i=!1,r.steiner||!y(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(C(r),(r=t=r.prev)===r.next)break;i=!0}}while(i||r!==t);return t}function n(e,t,i,c,u,d,m){if(e){!m&&d&&function(e,t,i,r){var n=e;do{null===n.z&&(n.z=h(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,r,n,o,a,s,l,c=1;do{for(i=e,e=null,o=null,a=0;i;){for(a++,r=i,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(l=c;s>0||l>0&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,l--),o?o.nextZ=n:e=n,n.prevZ=o,o=n;i=r}o.nextZ=null,c*=2}while(a>1)}(n)}(e,c,u,d);for(var p,f,g=e;e.prev!==e.next;)if(p=e.prev,f=e.next,d?a(e,c,u,d):o(e))t.push(p.i/i),t.push(e.i/i),t.push(f.i/i),C(e),e=f.next,g=f.next;else if((e=f)===g){m?1===m?n(e=s(r(e),t,i),t,i,c,u,d,2):2===m&&l(e,t,i,c,u,d):n(r(e),t,i,c,u,d,1);break}}}function o(e){var t=e.prev,i=e,r=e.next;if(g(t,i,r)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(p(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&g(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function a(e,t,i,r){var n=e.prev,o=e,a=e.next;if(g(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,c=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,u=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,d=h(s,l,t,i,r),m=h(c,u,t,i,r),f=e.prevZ,y=e.nextZ;f&&f.z>=d&&y&&y.z<=m;){if(f!==e.prev&&f!==e.next&&p(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&g(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,y!==e.prev&&y!==e.next&&p(n.x,n.y,o.x,o.y,a.x,a.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&p(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&g(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;y&&y.z<=m;){if(y!==e.prev&&y!==e.next&&p(n.x,n.y,o.x,o.y,a.x,a.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function s(e,t,i){var n=e;do{var o=n.prev,a=n.next.next;!y(o,a)&&v(o,n,n.next,a)&&S(o,a)&&S(a,o)&&(t.push(o.i/i),t.push(n.i/i),t.push(a.i/i),C(n),C(n.next),n=e=a),n=n.next}while(n!==e);return r(n)}function l(e,t,i,o,a,s){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&f(l,c)){var u=T(l,c);return l=r(l,l.next),u=r(u,u.next),n(l,t,i,o,a,s),void n(u,t,i,o,a,s)}c=c.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function u(e,t){if(t=function(e,t){var i,r=t,n=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>a){if(a=s,s===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(n===a)return i;var l,c=i,u=i.x,h=i.y,m=1/0;r=i;do{n>=r.x&&r.x>=u&&n!==r.x&&p(o<h?n:a,o,u,h,o<h?a:n,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(n-r.x),S(r,e)&&(l<m||l===m&&(r.x>i.x||r.x===i.x&&d(i,r)))&&(i=r,m=l)),r=r.next}while(r!==c);return i}(e,t)){var i=T(t,e);r(t,t.next),r(i,i.next)}}function d(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function h(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function p(e,t,i,r,n,o,a,s){return(n-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(i-a)*(t-s)>=0&&(i-a)*(o-s)-(n-a)*(r-s)>=0}function f(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&v(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var i=e,r=!1,n=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,i,r){var n=b(g(e,t,i)),o=b(g(e,t,r)),a=b(g(i,r,e)),s=b(g(i,r,t));return n!==o&&a!==s||!(0!==n||!_(e,i,t))||!(0!==o||!_(e,r,t))||!(0!==a||!_(i,e,r))||!(0!==s||!_(i,t,r))}function _(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function b(e){return e>0?1:e<0?-1:0}function S(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function T(e,t){var i=new w(e.i,e.x,e.y),r=new w(t.i,t.x,t.y),n=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function E(e,t,i,r){var n=new w(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function w(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function x(e,t,i,r){for(var n=0,o=t,a=i-r;o<i;o+=r)n+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return n}e.exports=t,e.exports.default=t,t.deviation=function(e,t,i,r){var n=t&&t.length,o=n?t[0]*i:e.length,a=Math.abs(x(e,0,o,i));if(n)for(var s=0,l=t.length;s<l;s++){var c=t[s]*i,u=s<l-1?t[s+1]*i:e.length;a-=Math.abs(x(e,c,u,i))}var d=0;for(s=0;s<r.length;s+=3){var h=r[s]*i,m=r[s+1]*i,p=r[s+2]*i;d+=Math.abs((e[h]-e[p])*(e[m+1]-e[h+1])-(e[h]-e[m])*(e[p+1]-e[h+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},t.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,n=0;n<e.length;n++){for(var o=0;o<e[n].length;o++)for(var a=0;a<t;a++)i.vertices.push(e[n][o][a]);n>0&&(r+=e[n-1].length,i.holes.push(r))}return i}},64063:e=>{"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var r,n,o;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(n=r;0!=n--;)if(!e(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,o[n]))return!1;for(n=r;0!=n--;){var a=o[n];if(!e(t[a],i[a]))return!1}return!0}return t!=t&&i!=i}},35035:e=>{"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var i,r="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(i=t.cmp,function(e){return function(t,r){var n={key:t,value:e[t]},o={key:r,value:e[r]};return i(n,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var i,a;if(Array.isArray(t)){for(a="[",i=0;i<t.length;i++)i&&(a+=","),a+=e(t[i])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,l=Object.keys(t).sort(n&&n(t));for(a="",i=0;i<l.length;i++){var c=l[i],u=e(t[c]);u&&(a&&(a+=","),a+=JSON.stringify(c)+":"+u)}return o.splice(s,1),"{"+a+"}"}}(e)}},91780:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(39341);function n(e,t,i,n,s,c,u,d){if(n/=t,c>=(i/=t)&&u<n)return e;if(u<i||c>=n)return null;for(var h=[],m=0;m<e.length;m++){var p=e[m],f=p.geometry,g=p.type,y=0===s?p.minX:p.minY,v=0===s?p.maxX:p.maxY;if(y>=i&&v<n)h.push(p);else if(!(v<i||y>=n)){var _=[];if("Point"===g||"MultiPoint"===g)o(f,_,i,n,s);else if("LineString"===g)a(f,_,i,n,s,!1,d.lineMetrics);else if("MultiLineString"===g)l(f,_,i,n,s,!1);else if("Polygon"===g)l(f,_,i,n,s,!0);else if("MultiPolygon"===g)for(var b=0;b<f.length;b++){var S=[];l(f[b],S,i,n,s,!0),S.length&&_.push(S)}if(_.length){if(d.lineMetrics&&"LineString"===g){for(b=0;b<_.length;b++)h.push((0,r.Z)(p.id,g,_[b],p.tags));continue}"LineString"!==g&&"MultiLineString"!==g||(1===_.length?(g="LineString",_=_[0]):g="MultiLineString"),"Point"!==g&&"MultiPoint"!==g||(g=3===_.length?"Point":"MultiPoint"),h.push((0,r.Z)(p.id,g,_,p.tags))}}}return h.length?h:null}function o(e,t,i,r,n){for(var o=0;o<e.length;o+=3){var a=e[o+n];a>=i&&a<=r&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function a(e,t,i,r,n,o,a){for(var l,h,m=s(e),p=0===n?u:d,f=e.start,g=0;g<e.length-3;g+=3){var y=e[g],v=e[g+1],_=e[g+2],b=e[g+3],S=e[g+4],T=0===n?y:v,E=0===n?b:S,C=!1;a&&(l=Math.sqrt(Math.pow(y-b,2)+Math.pow(v-S,2))),T<i?E>i&&(h=p(m,y,v,b,S,i),a&&(m.start=f+l*h)):T>r?E<r&&(h=p(m,y,v,b,S,r),a&&(m.start=f+l*h)):c(m,y,v,_),E<i&&T>=i&&(h=p(m,y,v,b,S,i),C=!0),E>r&&T<=r&&(h=p(m,y,v,b,S,r),C=!0),!o&&C&&(a&&(m.end=f+l*h),t.push(m),m=s(e)),a&&(f+=l)}var w=e.length-3;y=e[w],v=e[w+1],_=e[w+2],(T=0===n?y:v)>=i&&T<=r&&c(m,y,v,_),w=m.length-3,o&&w>=3&&(m[w]!==m[0]||m[w+1]!==m[1])&&c(m,m[0],m[1],m[2]),m.length&&t.push(m)}function s(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function l(e,t,i,r,n,o){for(var s=0;s<e.length;s++)a(e[s],t,i,r,n,o,!1)}function c(e,t,i,r){e.push(t),e.push(i),e.push(r)}function u(e,t,i,r,n,o){var a=(o-t)/(r-t);return e.push(o),e.push(i+(n-i)*a),e.push(1),a}function d(e,t,i,r,n,o){var a=(o-i)/(n-i);return e.push(t+(r-t)*a),e.push(o),e.push(1),a}},84901:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var r=i(22857),n=i(39341);function o(e,t){var i=[];if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)a(i,e.features[r],t,r);else"Feature"===e.type?a(i,e,t):a(i,{geometry:e},t);return i}function a(e,t,i,r){if(t.geometry){var o=t.geometry.coordinates,u=t.geometry.type,d=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),h=[],m=t.id;if(i.promoteId?m=t.properties[i.promoteId]:i.generateId&&(m=r||0),"Point"===u)s(o,h);else if("MultiPoint"===u)for(var p=0;p<o.length;p++)s(o[p],h);else if("LineString"===u)l(o,h,d,!1);else if("MultiLineString"===u){if(i.lineMetrics){for(p=0;p<o.length;p++)h=[],l(o[p],h,d,!1),e.push((0,n.Z)(m,"LineString",h,t.properties));return}c(o,h,d,!1)}else if("Polygon"===u)c(o,h,d,!0);else{if("MultiPolygon"!==u){if("GeometryCollection"===u){for(p=0;p<t.geometry.geometries.length;p++)a(e,{id:m,geometry:t.geometry.geometries[p],properties:t.properties},i,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(p=0;p<o.length;p++){var f=[];c(o[p],f,d,!0),h.push(f)}}e.push((0,n.Z)(m,u,h,t.properties))}}function s(e,t){t.push(u(e[0])),t.push(d(e[1])),t.push(0)}function l(e,t,i,n){for(var o,a,s=0,l=0;l<e.length;l++){var c=u(e[l][0]),h=d(e[l][1]);t.push(c),t.push(h),t.push(0),l>0&&(s+=n?(o*h-c*a)/2:Math.sqrt(Math.pow(c-o,2)+Math.pow(h-a,2))),o=c,a=h}var m=t.length-3;t[2]=1,(0,r.Z)(t,0,m,i),t[m+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function c(e,t,i,r){for(var n=0;n<e.length;n++){var o=[];l(e[n],o,i,r),t.push(o)}}function u(e){return e/360+.5}function d(e){var t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}},39341:(e,t,i)=>{"use strict";function r(e,t,i,r){var o={id:void 0===e?null:e,type:t,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,i=e.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)n(e,t);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<t.length;r++)n(e,t[r]);else if("MultiPolygon"===i)for(r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++)n(e,t[r][o])}(o),o}function n(e,t){for(var i=0;i<t.length;i+=3)e.minX=Math.min(e.minX,t[i]),e.minY=Math.min(e.minY,t[i+1]),e.maxX=Math.max(e.maxX,t[i]),e.maxY=Math.max(e.maxY,t[i+1])}i.d(t,{Z:()=>r})},8305:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var r=i(84901),n=i(91780),o=i(54793),a=i(26603),s=i(62779);function l(e,t){return new c(e,t)}function c(e,t){var i=(t=this.options=function(e,t){for(var i in t)e[i]=t[i];return e}(Object.create(this.options),t)).debug;if(i&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=(0,r.Z)(e,t);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=(0,o.Z)(n,t)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function u(e,t,i){return 32*((1<<e)*i+t)+e}c.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},c.prototype.splitTile=function(e,t,i,r,o,a,l){for(var c=[e,t,i,r],d=this.options,h=d.debug;c.length;){r=c.pop(),i=c.pop(),t=c.pop(),e=c.pop();var m=1<<t,p=u(t,i,r),f=this.tiles[p];if(!f&&(h>1&&console.time("creation"),f=this.tiles[p]=(0,s.Z)(e,t,i,r,d),this.tileCoords.push({z:t,x:i,y:r}),h)){h>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,i,r,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var g="z"+t;this.stats[g]=(this.stats[g]||0)+1,this.total++}if(f.source=e,o){if(t===d.maxZoom||t===o)continue;var y=1<<o-t;if(i!==Math.floor(a/y)||r!==Math.floor(l/y))continue}else if(t===d.indexMaxZoom||f.numPoints<=d.indexMaxPoints)continue;if(f.source=null,0!==e.length){h>1&&console.time("clipping");var v,_,b,S,T,E,C=.5*d.buffer/d.extent,w=.5-C,x=.5+C,P=1+C;v=_=b=S=null,T=(0,n.Z)(e,m,i-C,i+x,0,f.minX,f.maxX,d),E=(0,n.Z)(e,m,i+w,i+P,0,f.minX,f.maxX,d),e=null,T&&(v=(0,n.Z)(T,m,r-C,r+x,1,f.minY,f.maxY,d),_=(0,n.Z)(T,m,r+w,r+P,1,f.minY,f.maxY,d),T=null),E&&(b=(0,n.Z)(E,m,r-C,r+x,1,f.minY,f.maxY,d),S=(0,n.Z)(E,m,r+w,r+P,1,f.minY,f.maxY,d),E=null),h>1&&console.timeEnd("clipping"),c.push(v||[],t+1,2*i,2*r),c.push(_||[],t+1,2*i,2*r+1),c.push(b||[],t+1,2*i+1,2*r),c.push(S||[],t+1,2*i+1,2*r+1)}}},c.prototype.getTile=function(e,t,i){var r=this.options,n=r.extent,o=r.debug;if(e<0||e>24)return null;var s=1<<e,l=u(e,t=(t%s+s)%s,i);if(this.tiles[l])return(0,a.Z)(this.tiles[l],n);o>1&&console.log("drilling down to z%d-%d-%d",e,t,i);for(var c,d=e,h=t,m=i;!c&&d>0;)d--,h=Math.floor(h/2),m=Math.floor(m/2),c=this.tiles[u(d,h,m)];return c&&c.source?(o>1&&console.log("found parent tile z%d-%d-%d",d,h,m),o>1&&console.time("drilling down"),this.splitTile(c.source,d,h,m,e,t,i),o>1&&console.timeEnd("drilling down"),this.tiles[l]?(0,a.Z)(this.tiles[l],n):null):null}},22857:(e,t,i)=>{"use strict";function r(e,t,i,o){for(var a,s=o,l=i-t>>1,c=i-t,u=e[t],d=e[t+1],h=e[i],m=e[i+1],p=t+3;p<i;p+=3){var f=n(e[p],e[p+1],u,d,h,m);if(f>s)a=p,s=f;else if(f===s){var g=Math.abs(p-l);g<c&&(a=p,c=g)}}s>o&&(a-t>3&&r(e,t,a,o),e[a+2]=s,i-a>3&&r(e,a,i,o))}function n(e,t,i,r,n,o){var a=n-i,s=o-r;if(0!==a||0!==s){var l=((e-i)*a+(t-r)*s)/(a*a+s*s);l>1?(i=n,r=o):l>0&&(i+=a*l,r+=s*l)}return(a=e-i)*a+(s=t-r)*s}i.d(t,{Z:()=>r})},62779:(e,t,i)=>{"use strict";function r(e,t,i,r,o){for(var a=t===o.maxZoom?0:o.tolerance/((1<<t)*o.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<e.length;l++){s.numFeatures++,n(s,e[l],a,o);var c=e[l].minX,u=e[l].minY,d=e[l].maxX,h=e[l].maxY;c<s.minX&&(s.minX=c),u<s.minY&&(s.minY=u),d>s.maxX&&(s.maxX=d),h>s.maxY&&(s.maxY=h)}return s}function n(e,t,i,r){var n=t.geometry,a=t.type,s=[];if("Point"===a||"MultiPoint"===a)for(var l=0;l<n.length;l+=3)s.push(n[l]),s.push(n[l+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)o(s,n,e,i,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(l=0;l<n.length;l++)o(s,n[l],e,i,"Polygon"===a,0===l);else if("MultiPolygon"===a)for(var c=0;c<n.length;c++){var u=n[c];for(l=0;l<u.length;l++)o(s,u[l],e,i,!0,0===l)}if(s.length){var d=t.tags||null;if("LineString"===a&&r.lineMetrics){for(var h in d={},t.tags)d[h]=t.tags[h];d.mapbox_clip_start=n.start/n.size,d.mapbox_clip_end=n.end/n.size}var m={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:d};null!==t.id&&(m.id=t.id),e.features.push(m)}}function o(e,t,i,r,n,o){var a=r*r;if(r>0&&t.size<(n?a:r))i.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===r||t[l+2]>a)&&(i.numSimplified++,s.push(t[l]),s.push(t[l+1])),i.numPoints++;n&&function(e,t){for(var i=0,r=0,n=e.length,o=n-2;r<n;o=r,r+=2)i+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(i>0===t)for(r=0,n=e.length;r<n/2;r+=2){var a=e[r],s=e[r+1];e[r]=e[n-2-r],e[r+1]=e[n-1-r],e[n-2-r]=a,e[n-1-r]=s}}(s,o),e.push(s)}}i.d(t,{Z:()=>r})},26603:(e,t,i)=>{"use strict";function r(e,t){if(e.transformed)return e;var i,r,o,a=1<<e.z,s=e.x,l=e.y;for(i=0;i<e.features.length;i++){var c=e.features[i],u=c.geometry,d=c.type;if(c.geometry=[],1===d)for(r=0;r<u.length;r+=2)c.geometry.push(n(u[r],u[r+1],t,a,s,l));else for(r=0;r<u.length;r++){var h=[];for(o=0;o<u[r].length;o+=2)h.push(n(u[r][o],u[r][o+1],t,a,s,l));c.geometry.push(h)}}return e.transformed=!0,e}function n(e,t,i,r,n,o){return[Math.round(i*(e*r-n)),Math.round(i*(t*r-o))]}i.d(t,{Z:()=>r})},54793:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var r=i(91780),n=i(39341);function o(e,t){var i=t.buffer/t.extent,n=e,o=(0,r.Z)(e,1,-1-i,i,0,-1,2,t),s=(0,r.Z)(e,1,1-i,2+i,0,-1,2,t);return(o||s)&&(n=(0,r.Z)(e,1,-i,1+i,0,-1,2,t)||[],o&&(n=a(o,1).concat(n)),s&&(n=n.concat(a(s,-1)))),n}function a(e,t){for(var i=[],r=0;r<e.length;r++){var o,a=e[r],l=a.type;if("Point"===l||"MultiPoint"===l||"LineString"===l)o=s(a.geometry,t);else if("MultiLineString"===l||"Polygon"===l){o=[];for(var c=0;c<a.geometry.length;c++)o.push(s(a.geometry[c],t))}else if("MultiPolygon"===l)for(o=[],c=0;c<a.geometry.length;c++){for(var u=[],d=0;d<a.geometry[c].length;d++)u.push(s(a.geometry[c][d],t));o.push(u)}i.push((0,n.Z)(a.id,l,o,a.tags))}return i}function s(e,t){var i=[];i.size=e.size,void 0!==e.start&&(i.start=e.start,i.end=e.end);for(var r=0;r<e.length;r+=3)i.push(e[r]+t,e[r+1],e[r+2]);return i}},49461:e=>{"use strict";var t=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),i(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function i(e,r,n,o,a,s,l,c,u,d){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var h in r(o,a,s,l,c,u,d),o){var m=o[h];if(Array.isArray(m)){if(h in t.arrayKeywords)for(var p=0;p<m.length;p++)i(e,r,n,m[p],a+"/"+h+"/"+p,s,a,h,o,p)}else if(h in t.propsKeywords){if(m&&"object"==typeof m)for(var f in m)i(e,r,n,m[f],a+"/"+h+"/"+f.replace(/~/g,"~0").replace(/\//g,"~1"),s,a,h,o,f)}else(h in t.keywords||e.allKeys&&!(h in t.skipKeywords))&&i(e,r,n,m,a+"/"+h,s,a,h,o)}n(o,a,s,l,c,u,d)}}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},55733:(e,t,i)=>{e.exports=function e(t,i,r){function n(a,s){if(!i[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};t[a][0].call(c.exports,(function(e){return n(t[a][1][e]||e)}),c,c.exports,e,t,i,r)}return i[a].exports}for(var o=void 0,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){(function(i){!function(e){"object"==typeof r&&void 0!==t?t.exports=e():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).JSZip=e()}((function(){return function t(i,r,n){function o(s,l){if(!r[s]){if(!i[s]){var c="function"==typeof e&&e;if(!l&&c)return c(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[s]={exports:{}};i[s][0].call(d.exports,(function(e){return o(i[s][1][e]||e)}),d,d.exports,t,i,r,n)}return r[s].exports}for(var a="function"==typeof e&&e,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){"use strict";var r=e("./utils"),n=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,n,a,s,l,c,u=[],d=0,h=e.length,m=h,p="string"!==r.getTypeOf(e);d<e.length;)m=h-d,n=p?(t=e[d++],i=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),i=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),a=t>>2,s=(3&t)<<4|i>>4,l=1<m?(15&i)<<2|n>>6:64,c=2<m?63&n:64,u.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(c));return u.join("")},i.decode=function(e){var t,i,r,a,s,l,c=0,u=0;if("data:"===e.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var d,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&h--,e.charAt(e.length-2)===o.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=n.uint8array?new Uint8Array(0|h):new Array(0|h);c<e.length;)t=o.indexOf(e.charAt(c++))<<2|(a=o.indexOf(e.charAt(c++)))>>4,i=(15&a)<<4|(s=o.indexOf(e.charAt(c++)))>>2,r=(3&s)<<6|(l=o.indexOf(e.charAt(c++))),d[u++]=t,64!==s&&(d[u++]=i),64!==l&&(d[u++]=r);return d}},{"./support":30,"./utils":32}],2:[function(e,t,i){"use strict";var r=e("./external"),n=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,i,r,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=r,this.compressedContent=n}s.prototype={getContentWorker:function(){var e=new n(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new n(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,i){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){"use strict";var r=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(e){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){"use strict";var r=e("./utils"),n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,i){var r=n,o=0+i;e^=-1;for(var a=0;a<o;a++)e=e>>>8^r[255&(e^t[a])];return-1^e}(0|t,e,e.length):function(e,t,i){var r=n,o=0+i;e^=-1;for(var a=0;a<o;a++)e=e>>>8^r[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,i){"use strict";i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){"use strict";var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,i){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){"use strict";function r(e,t){var i,r="";for(i=0;i<t;i++)r+=String.fromCharCode(255&e),e>>>=8;return r}function n(e,t,i,n,a,u){var d,h,m=e.file,p=e.compression,f=u!==s.utf8encode,g=o.transformTo("string",u(m.name)),y=o.transformTo("string",s.utf8encode(m.name)),v=m.comment,_=o.transformTo("string",u(v)),b=o.transformTo("string",s.utf8encode(v)),S=y.length!==m.name.length,T=b.length!==v.length,E="",C="",w="",x=m.dir,P=m.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var A=0;t&&(A|=8),f||!S&&!T||(A|=2048);var D,R=0,I=0;x&&(R|=16),"UNIX"===a?(I=798,R|=((D=m.unixPermissions)||(D=x?16893:33204),(65535&D)<<16)):(I=20,R|=63&(m.dosPermissions||0)),d=P.getUTCHours(),d<<=6,d|=P.getUTCMinutes(),d<<=5,d|=P.getUTCSeconds()/2,h=P.getUTCFullYear()-1980,h<<=4,h|=P.getUTCMonth()+1,h<<=5,h|=P.getUTCDate(),S&&(E+="up"+r((C=r(1,1)+r(l(g),4)+y).length,2)+C),T&&(E+="uc"+r((w=r(1,1)+r(l(_),4)+b).length,2)+w);var M="";return M+="\n\0",M+=r(A,2),M+=p.magic,M+=r(d,2),M+=r(h,2),M+=r(O.crc32,4),M+=r(O.compressedSize,4),M+=r(O.uncompressedSize,4),M+=r(g.length,2),M+=r(E.length,2),{fileRecord:c.LOCAL_FILE_HEADER+M+g+E,dirRecord:c.CENTRAL_FILE_HEADER+r(I,2)+M+r(_.length,2)+"\0\0\0\0"+r(R,4)+r(n,4)+g+E+_}}var o=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,i,r){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,a),u.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-r-1))/i:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t,i=this.streamFiles&&!e.file.dir,o=n(e,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(o.dirRecord),i)this.push({data:(t=e,c.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:o.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i,n,a,s,l,u,d=this.bytesWritten-e,h=(i=this.dirRecords.length,n=d,a=e,s=this.zipComment,l=this.encodeFileName,u=o.transformTo("string",l(s)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(i,2)+r(i,2)+r(n,4)+r(a,4)+r(u.length,2)+u);this.push({data:h,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(e){}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){"use strict";var r=e("../compressions"),n=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var o=new n(t.streamFiles,i,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,i){a++;var n=function(e,t){var i=e||t,n=r[i];if(!n)throw new Error(i+" is not a valid compression method !");return n}(i.options.compression,t.compression),s=i.options.compressionOptions||t.compressionOptions||{},l=i.dir,c=i.date;i._compressWorker(n,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.5.0",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){"use strict";var r=e("./utils"),n=e("./external"),o=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new n.Promise((function(t,i){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){i(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new a(t);return i.load(e),i})).then((function(e){var i=[n.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)i.push(c(r[o]));return n.Promise.all(i)})).then((function(e){for(var r=e.shift(),n=r.files,o=0;o<n.length;o++){var a=n[o];i.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders})}return r.zipComment.length&&(i.comment=r.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){"use strict";var r=e("../utils"),n=e("../stream/GenericWorker");function o(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(o,n),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){"use strict";var r=e("readable-stream").Readable;function n(e,t,i){r.call(this,t),this._helper=e;var n=this;e.on("data",(function(e,t){n.push(e)||n._helper.pause(),i&&i(t)})).on("error",(function(e){n.emit("error",e)})).on("end",(function(){n.push(null)}))}e("../utils").inherits(n,r),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){"use strict";function r(e,t,i){var r,o=a.getTypeOf(t),l=a.extend(i||{},c);l.date=l.date||new Date,null!==l.compression&&(l.compression=l.compression.toUpperCase()),"string"==typeof l.unixPermissions&&(l.unixPermissions=parseInt(l.unixPermissions,8)),l.unixPermissions&&16384&l.unixPermissions&&(l.dir=!0),l.dosPermissions&&16&l.dosPermissions&&(l.dir=!0),l.dir&&(e=n(e)),l.createFolders&&(r=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""}(e))&&f.call(this,r,!0);var h,g="string"===o&&!1===l.binary&&!1===l.base64;i&&void 0!==i.binary||(l.binary=!g),(t instanceof u&&0===t.uncompressedSize||l.dir||!t||0===t.length)&&(l.base64=!1,l.binary=!0,t="",l.compression="STORE",o="string"),h=t instanceof u||t instanceof s?t:m.isNode&&m.isStream(t)?new p(e,t):a.prepareContent(e,t,l.binary,l.optimizedBinaryString,l.base64);var y=new d(e,h,l);this.files[e]=y}function n(e){return"/"!==e.slice(-1)&&(e+="/"),e}var o=e("./utf8"),a=e("./utils"),s=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),c=e("./defaults"),u=e("./compressedObject"),d=e("./zipObject"),h=e("./generate"),m=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e,t){return t=void 0!==t?t:c.createFolders,e=n(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,r;for(t in this.files)this.files.hasOwnProperty(t)&&(r=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,r))},filter:function(e){var t=[];return this.forEach((function(i,r){e(i,r)&&t.push(r)})),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,i),this;if(g(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(g(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=f.call(this,t),r=this.clone();return r.root=i.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),r=0;r<i.length;r++)delete this.files[i[r].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");a.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var r=i.comment||this.comment||"";t=h.generateWorker(this,i,r)}catch(e){(t=new s("error")).error(e)}return new l(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){"use strict";var r=e("./DataReader");function n(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,r),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===i&&this.data[o+2]===r&&this.data[o+3]===n)return o-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&i===o[1]&&r===o[2]&&n===o[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){"use strict";var r=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,i){"use strict";var r=e("./Uint8ArrayReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){"use strict";var r=e("./DataReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){"use strict";var r=e("./ArrayReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){"use strict";var r=e("../utils"),n=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new s(e):n.uint8array?new l(r.transformTo("uint8array",e)):new o(r.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){"use strict";i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){"use strict";var r=e("./GenericWorker"),n=e("../utils");function o(e){r.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(o,r),o.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){"use strict";var r=e("./GenericWorker"),n=e("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){"use strict";var r=e("../utils"),n=e("./GenericWorker");function o(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(o,n),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){"use strict";var r=e("../utils"),n=e("./GenericWorker");function o(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(o,n),o.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,i){"use strict";var r=e("../utils"),n=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,i){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=i,r.checkSupport(a),this._worker=e.pipe(new n(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return t=this,i=e,new l.Promise((function(e,n){var o=[],s=t._internalType,l=t._outputType,c=t._mimeType;t.on("data",(function(e,t){o.push(e),i&&i(t)})).on("error",(function(e){o=[],n(e)})).on("end",(function(){try{var t=function(e,t,i){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),i);case"base64":return a.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var i,r=0,n=null,o=0;for(i=0;i<t.length;i++)o+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(o),i=0;i<t.length;i++)n.set(t[i],r),r+=t[i].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),c);e(t)}catch(t){n(t)}o=[]})).resume()}));var t,i},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){r.delay(t,arguments,i)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){"use strict";if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),i.blob=0===n.getBlob("application/zip").size}catch(e){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(e){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){"use strict";for(var r=e("./utils"),n=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,i.utf8encode=function(e){return n.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,i,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=n.uint8array?new Uint8Array(l):new Array(l),o=a=0;a<l;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(r-56320),o++),i<128?t[a++]=i:(i<2048?t[a++]=192|i>>>6:(i<65536?t[a++]=224|i>>>12:(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63),t[a++]=128|i>>>6&63),t[a++]=128|63&i);return t}(e)},i.utf8decode=function(e){return n.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,n,o,a=e.length,l=new Array(2*a);for(t=i=0;t<a;)if((n=e[t++])<128)l[i++]=n;else if(4<(o=s[n]))l[i++]=65533,t+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&t<a;)n=n<<6|63&e[t++],o--;1<o?l[i++]=65533:n<65536?l[i++]=n:(n-=65536,l[i++]=55296|n>>10&1023,l[i++]=56320|1023&n)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),r.applyFromCharCode(l)}(e=r.transformTo(n.uint8array?"uint8array":"array",e))},r.inherits(c,a),c.prototype.processChunk=function(e){var t=r.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+s[e[i]]>t?i:t}(t),l=t;a!==t.length&&(n.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:i.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=c,r.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){"use strict";var r=e("./support"),n=e("./base64"),o=e("./nodejsUtils"),a=e("set-immediate-shim"),s=e("./external");function l(e){return e}function c(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,i){var r=[],n=0,o=e.length;if(o<=i)return String.fromCharCode.apply(null,e);for(;n<o;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+i,o)))):r.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+i,o)))),n+=i;return r.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,r=i.getTypeOf(e),n=!0;if("uint8array"===r?n=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(n=u.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return u.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function h(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=d;var m={};m.string={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return m.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,o.allocBuffer(e.length))}},m.array={string:d,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},m.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},m.uint8array={string:d,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return o.newBufferFrom(e)}},m.nodebuffer={string:d,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return m.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:l},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var r=i.getTypeOf(t);return m[r][e](t)},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&o.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,r="";for(i=0;i<(e||"").length;i++)r+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return r},i.delay=function(e,t,i){a((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,o,a,l){return s.Promise.resolve(t).then((function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise((function(t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){i(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var u,d=i.getTypeOf(t);return d?("arraybuffer"===d?t=i.transformTo("uint8array",t):"string"===d&&(l?t=n.decode(t):o&&!0!==a&&(t=c(u=t,r.uint8array?new Uint8Array(u.length):new Array(u.length)))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,i){"use strict";var r=e("./reader/readerFor"),n=e("./utils"),o=e("./signature"),a=e("./zipEntry"),s=(e("./utf8"),e("./support"));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(i),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",i=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var r=t-i;if(0<r)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){"use strict";var r=e("./reader/readerFor"),n=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=r(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,i,r,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),i=e.readInt(2),r=e.readData(i),this.extraFields[t]={id:t,length:i,value:r};e.setIndex(n)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){"use strict";function r(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var n=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new n(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)r.prototype[c[d]]=u;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var i,r,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var o=0,a=new n(u),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),i=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,i=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;r=!0;for(var i=c.length;i;){for(t=c,c=[],e=-1;++e<i;)t[e]();i=c.length}r=!1}t.exports=function(e){1!==c.push(e)||r||i()}}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){"use strict";var r=e("immediate");function n(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==n&&m(this,e)}function u(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){r((function(){var r;try{r=t(i)}catch(r){return o.reject(e,r)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function m(e,t){var i=!1;function r(t){i||(i=!0,o.reject(e,t))}function n(t){i||(i=!0,o.resolve(e,t))}var a=p((function(){t(n,r)}));"error"===a.status&&r(a.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var i=new this.constructor(n);return this.state!==l?d(i,this.state===s?e:t,this.outcome):this.queue.push(new u(i,e,t)),i},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},o.resolve=function(e,t){var i=p(h,t);if("error"===i.status)return o.reject(e,i.value);var r=i.value;if(r)m(e,r);else{e.state=s,e.outcome=t;for(var n=-1,a=e.queue.length;++n<a;)e.queue[n].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(n),e)},c.reject=function(e){var t=new this(n);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var a=new Array(i),s=0,l=-1,c=new this(n);++l<i;)u(e[l],l);return c;function u(e,n){t.resolve(e).then((function(e){a[n]=e,++s!==i||r||(r=!0,o.resolve(c,a))}),(function(e){r||(r=!0,o.reject(c,e))}))}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,i=!1;if(!t)return this.resolve([]);for(var r,a=-1,s=new this(n);++a<t;)r=e[a],this.resolve(r).then((function(e){i||(i=!0,o.resolve(s,e))}),(function(e){i||(i=!0,o.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,i){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){"use strict";var r=e("./zlib/deflate"),n=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==i)throw new Error(a[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(i=r.deflateSetDictionary(this.strm,u)))throw new Error(a[i]);this._dict_set=!0}}function u(e,t){var i=new c(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}c.prototype.push=function(e,t){var i,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new n.Buf8(c),s.next_out=0,s.avail_out=c),1!==(i=r.deflate(s,a))&&0!==i)return this.onEnd(i),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(n.shrinkBuf(s.output,s.next_out))):this.onData(n.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==i);return 4===a?(i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==a||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=c,i.deflate=u,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){"use strict";var r=e("./zlib/inflate"),n=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,t.windowBits);if(i!==a.Z_OK)throw new Error(s[i]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}d.prototype.push=function(e,t){var i,s,l,c,d,h,m=this.strm,p=this.options.chunkSize,f=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?m.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?m.input=new Uint8Array(e):m.input=e,m.next_in=0,m.avail_in=m.input.length;do{if(0===m.avail_out&&(m.output=new n.Buf8(p),m.next_out=0,m.avail_out=p),(i=r.inflate(m,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&f&&(h="string"==typeof f?o.string2buf(f):"[object ArrayBuffer]"===u.call(f)?new Uint8Array(f):f,i=r.inflateSetDictionary(this.strm,h)),i===a.Z_BUF_ERROR&&!0===g&&(i=a.Z_OK,g=!1),i!==a.Z_STREAM_END&&i!==a.Z_OK)return this.onEnd(i),!(this.ended=!0);m.next_out&&(0!==m.avail_out&&i!==a.Z_STREAM_END&&(0!==m.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(m.output,m.next_out),c=m.next_out-l,d=o.buf2string(m.output,l),m.next_out=c,m.avail_out=p-c,c&&n.arraySet(m.output,m.output,l,c,0),this.onData(d)):this.onData(n.shrinkBuf(m.output,m.next_out)))),0===m.avail_in&&0===m.avail_out&&(g=!0)}while((0<m.avail_in||0===m.avail_out)&&i!==a.Z_STREAM_END);return i===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(m.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=h,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},i.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,i,r,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+r),n);else for(var o=0;o<r;o++)e[n+o]=t[i+o]},flattenChunks:function(e){var t,i,r,n,o,a;for(t=r=0,i=e.length;t<i;t++)r+=e[t].length;for(a=new Uint8Array(r),t=n=0,i=e.length;t<i;t++)o=e[t],a.set(o,n),n+=o.length;return a}},o={arraySet:function(e,t,i,r,n){for(var o=0;o<r;o++)e[n+o]=t[i+o]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(r)},{}],42:[function(e,t,i){"use strict";var r=e("./common"),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",a=0;a<t;a++)i+=String.fromCharCode(e[a]);return i}a[254]=a[254]=1,i.string2buf=function(e){var t,i,n,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(l),o=a=0;a<l;o++)55296==(64512&(i=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(i=65536+(i-55296<<10)+(n-56320),o++),i<128?t[a++]=i:(i<2048?t[a++]=192|i>>>6:(i<65536?t[a++]=224|i>>>12:(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63),t[a++]=128|i>>>6&63),t[a++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,n,o,s=t||e.length,c=new Array(2*s);for(i=r=0;i<s;)if((n=e[i++])<128)c[r++]=n;else if(4<(o=a[n]))c[r++]=65533,i+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&i<s;)n=n<<6|63&e[i++],o--;1<o?c[r++]=65533:n<65536?c[r++]=n:(n-=65536,c[r++]=55296|n>>10&1023,c[r++]=56320|1023&n)}return l(c,r)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+a[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){"use strict";t.exports=function(e,t,i,r){for(var n=65535&e|0,o=e>>>16&65535|0,a=0;0!==i;){for(i-=a=2e3<i?2e3:i;o=o+(n=n+t[r++]|0)|0,--a;);n%=65521,o%=65521}return n|o<<16|0}},{}],44:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){"use strict";var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,n){var o=r,a=n+i;e^=-1;for(var s=n;s<a;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,i){"use strict";var r,n=e("../utils/common"),o=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=-2,u=258,d=262,h=113;function m(e,t){return e.msg=l[t],t}function p(e){return(e<<1)-(4<e?9:0)}function f(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(n.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function y(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function _(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function b(e,t){var i,r,n=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,c=e.window,h=e.w_mask,m=e.prev,p=e.strstart+u,f=c[o+a-1],g=c[o+a];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(i=t)+a]===g&&c[i+a-1]===f&&c[i]===c[o]&&c[++i]===c[o+1]){o+=2,i++;do{}while(c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&c[++o]===c[++i]&&o<p);if(r=u-(p-o),o=p-u,a<r){if(e.match_start=t,s<=(a=r))break;f=c[o+a-1],g=c[o+a]}}}while((t=m[t&h])>l&&0!=--n);return a<=e.lookahead?a:e.lookahead}function S(e){var t,i,r,o,l,c,u,h,m,p,f=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-d)){for(n.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=i=e.hash_size;r=e.head[--t],e.head[t]=f<=r?r-f:0,--i;);for(t=i=f;r=e.prev[--t],e.prev[t]=f<=r?r-f:0,--i;);o+=f}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,h=e.strstart+e.lookahead,p=void 0,(m=o)<(p=c.avail_in)&&(p=m),i=0===p?0:(c.avail_in-=p,n.arraySet(u,c.input,c.next_in,p,h),1===c.state.wrap?c.adler=a(c.adler,u,p,h):2===c.state.wrap&&(c.adler=s(c.adler,u,p,h)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=i,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function T(e,t){for(var i,r;;){if(e.lookahead<d){if(S(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-d&&(e.match_length=b(e,i)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var i,r,n;;){if(e.lookahead<d){if(S(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-d&&(e.match_length=b(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(n=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function C(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function x(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):m(e,c)}function P(e){var t,i=x(e);return 0===i&&((t=e.state).window_size=2*t.w_size,f(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),i}function O(e,t,i,r,o,a){if(!e)return c;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),o<1||9<o||8!==i||r<8||15<r||t<0||9<t||a<0||4<a)return m(e,c);8===r&&(r=9);var l=new w;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=i,P(e)}r=[new C(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(S(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)})),new C(4,4,8,4,T),new C(4,5,16,8,T),new C(4,6,32,32,T),new C(4,4,16,16,E),new C(8,16,32,32,E),new C(8,16,128,128,E),new C(8,32,128,256,E),new C(32,128,258,1024,E),new C(32,258,258,4096,E)],i.deflateInit=function(e,t){return O(e,t,8,15,8,0)},i.deflateInit2=O,i.deflateReset=P,i.deflateResetKeep=x,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},i.deflate=function(e,t){var i,n,a,l;if(!e||!e.state||5<t||t<0)return e?m(e,c):c;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return m(e,0===e.avail_out?-5:c);if(n.strm=e,i=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,v(n,31),v(n,139),v(n,8),n.gzhead?(v(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),v(n,255&n.gzhead.time),v(n,n.gzhead.time>>8&255),v(n,n.gzhead.time>>16&255),v(n,n.gzhead.time>>24&255),v(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),v(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(v(n,255&n.gzhead.extra.length),v(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=s(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(v(n,0),v(n,0),v(n,0),v(n,0),v(n,0),v(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),v(n,3),n.status=h);else{var d=8+(n.w_bits-8<<4)<<8;d|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(d|=32),d+=31-d%31,n.status=h,_(n,d),0!==n.strstart&&(_(n,e.adler>>>16),_(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),g(e),a=n.pending,n.pending!==n.pending_buf_size));)v(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),g(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,v(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),g(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,v(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=s(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&g(e),n.pending+2<=n.pending_buf_size&&(v(n,255&e.adler),v(n,e.adler>>8&255),e.adler=0,n.status=h)):n.status=h),0!==n.pending){if(g(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(i)&&4!==t)return m(e,-5);if(666===n.status&&0!==e.avail_in)return m(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var b=2===n.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(S(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var i,r,n,a,s=e.window;;){if(e.lookahead<=u){if(S(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[n=e.strstart-1])===s[++n]&&r===s[++n]&&r===s[++n]){a=e.strstart+u;do{}while(r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&n<a);e.match_length=u-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(n,t):r[n.level].func(n,t);if(3!==b&&4!==b||(n.status=666),1===b||3===b)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===b&&(1===t?o._tr_align(n):5!==t&&(o._tr_stored_block(n,0,0,!1),3===t&&(f(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),g(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(v(n,255&e.adler),v(n,e.adler>>8&255),v(n,e.adler>>16&255),v(n,e.adler>>24&255),v(n,255&e.total_in),v(n,e.total_in>>8&255),v(n,e.total_in>>16&255),v(n,e.total_in>>24&255)):(_(n,e.adler>>>16),_(n,65535&e.adler)),g(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?0:1)},i.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==h&&666!==t?m(e,c):(e.state=null,t===h?m(e,-3):0):c},i.deflateSetDictionary=function(e,t){var i,r,o,s,l,u,d,h,m=t.length;if(!e||!e.state)return c;if(2===(s=(i=e.state).wrap)||1===s&&42!==i.status||i.lookahead)return c;for(1===s&&(e.adler=a(e.adler,t,m,0)),i.wrap=0,m>=i.w_size&&(0===s&&(f(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new n.Buf8(i.w_size),n.arraySet(h,t,m-i.w_size,i.w_size,0),t=h,m=i.w_size),l=e.avail_in,u=e.next_in,d=e.input,e.avail_in=m,e.next_in=0,e.input=t,S(i);i.lookahead>=3;){for(r=i.strstart,o=i.lookahead-2;i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+3-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,--o;);i.strstart=r,i.lookahead=2,S(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=u,e.input=d,e.avail_in=l,i.wrap=s,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){"use strict";t.exports=function(e,t){var i,r,n,o,a,s,l,c,u,d,h,m,p,f,g,y,v,_,b,S,T,E,C,w,x;i=e.state,r=e.next_in,w=e.input,n=r+(e.avail_in-5),o=e.next_out,x=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=i.dmax,c=i.wsize,u=i.whave,d=i.wnext,h=i.window,m=i.hold,p=i.bits,f=i.lencode,g=i.distcode,y=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;e:do{p<15&&(m+=w[r++]<<p,p+=8,m+=w[r++]<<p,p+=8),_=f[m&y];t:for(;;){if(m>>>=b=_>>>24,p-=b,0==(b=_>>>16&255))x[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=f[(65535&_)+(m&(1<<b)-1)];continue t}if(32&b){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}S=65535&_,(b&=15)&&(p<b&&(m+=w[r++]<<p,p+=8),S+=m&(1<<b)-1,m>>>=b,p-=b),p<15&&(m+=w[r++]<<p,p+=8,m+=w[r++]<<p,p+=8),_=g[m&v];i:for(;;){if(m>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=g[(65535&_)+(m&(1<<b)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(T=65535&_,p<(b&=15)&&(m+=w[r++]<<p,(p+=8)<b&&(m+=w[r++]<<p,p+=8)),l<(T+=m&(1<<b)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(m>>>=b,p-=b,(b=o-a)<T){if(u<(b=T-b)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(C=h,(E=0)===d){if(E+=c-b,b<S){for(S-=b;x[o++]=h[E++],--b;);E=o-T,C=x}}else if(d<b){if(E+=c+d-b,(b-=d)<S){for(S-=b;x[o++]=h[E++],--b;);if(E=0,d<S){for(S-=b=d;x[o++]=h[E++],--b;);E=o-T,C=x}}}else if(E+=d-b,b<S){for(S-=b;x[o++]=h[E++],--b;);E=o-T,C=x}for(;2<S;)x[o++]=C[E++],x[o++]=C[E++],x[o++]=C[E++],S-=3;S&&(x[o++]=C[E++],1<S&&(x[o++]=C[E++]))}else{for(E=o-T;x[o++]=x[E++],x[o++]=x[E++],x[o++]=x[E++],2<(S-=3););S&&(x[o++]=x[E++],1<S&&(x[o++]=x[E++]))}break}}break}}while(r<n&&o<s);r-=S=p>>3,m&=(1<<(p-=S<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=o<s?s-o+257:257-(o-s),i.hold=m,i.bits=p}},{}],49:[function(e,t,i){"use strict";var r=e("../utils/common"),n=e("./adler32"),o=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):l}function m(e,t){var i,r;return e&&e.state?(r=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,h(e))):l}function p(e,t){var i,r;return e?(r=new u,(e.state=r).window=null,0!==(i=m(e,t))&&(e.state=null),i):l}var f,g,y=!0;function v(e){if(y){var t;for(f=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,f,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=f,e.lenbits=9,e.distcode=g,e.distbits=5}function _(e,t,i,n){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),n>=a.wsize?(r.arraySet(a.window,t,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(n<(o=a.wsize-a.wnext)&&(o=n),r.arraySet(a.window,t,i-n,o,a.wnext),(n-=o)?(r.arraySet(a.window,t,i-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}i.inflateReset=h,i.inflateReset2=m,i.inflateResetKeep=d,i.inflateInit=function(e){return p(e,15)},i.inflateInit2=p,i.inflate=function(e,t){var i,u,d,h,m,p,f,g,y,b,S,T,E,C,w,x,P,O,A,D,R,I,M,L,k=0,N=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(i=e.state).mode&&(i.mode=13),m=e.next_out,d=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,g=i.hold,y=i.bits,b=p,S=f,I=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;y<16;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(2&i.wrap&&35615===g){N[i.check=0]=255&g,N[1]=g>>>8&255,i.check=o(i.check,N,2,0),y=g=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",i.mode=30;break}if(y-=4,R=8+(15&(g>>>=4)),0===i.wbits)i.wbits=R;else if(R>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<R,e.adler=i.check=1,i.mode=512&g?10:12,y=g=0;break;case 2:for(;y<16;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(i.flags=g,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=g>>8&1),512&i.flags&&(N[0]=255&g,N[1]=g>>>8&255,i.check=o(i.check,N,2,0)),y=g=0,i.mode=3;case 3:for(;y<32;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.head&&(i.head.time=g),512&i.flags&&(N[0]=255&g,N[1]=g>>>8&255,N[2]=g>>>16&255,N[3]=g>>>24&255,i.check=o(i.check,N,4,0)),y=g=0,i.mode=4;case 4:for(;y<16;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.head&&(i.head.xflags=255&g,i.head.os=g>>8),512&i.flags&&(N[0]=255&g,N[1]=g>>>8&255,i.check=o(i.check,N,2,0)),y=g=0,i.mode=5;case 5:if(1024&i.flags){for(;y<16;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.length=g,i.head&&(i.head.extra_len=g),512&i.flags&&(N[0]=255&g,N[1]=g>>>8&255,i.check=o(i.check,N,2,0)),y=g=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p<(T=i.length)&&(T=p),T&&(i.head&&(R=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),r.arraySet(i.head.extra,u,h,T,R)),512&i.flags&&(i.check=o(i.check,u,T,h)),p-=T,h+=T,i.length-=T),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===p)break e;for(T=0;R=u[h+T++],i.head&&R&&i.length<65536&&(i.head.name+=String.fromCharCode(R)),R&&T<p;);if(512&i.flags&&(i.check=o(i.check,u,T,h)),p-=T,h+=T,R)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===p)break e;for(T=0;R=u[h+T++],i.head&&R&&i.length<65536&&(i.head.comment+=String.fromCharCode(R)),R&&T<p;);if(512&i.flags&&(i.check=o(i.check,u,T,h)),p-=T,h+=T,R)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;y<16;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(g!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}y=g=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;y<32;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}e.adler=i.check=c(g),y=g=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=m,e.avail_out=f,e.next_in=h,e.avail_in=p,i.hold=g,i.bits=y,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){g>>>=7&y,y-=7&y,i.mode=27;break}for(;y<3;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}switch(i.last=1&g,y-=1,3&(g>>>=1)){case 0:i.mode=14;break;case 1:if(v(i),i.mode=20,6!==t)break;g>>>=2,y-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&g,y=g=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(T=i.length){if(p<T&&(T=p),f<T&&(T=f),0===T)break e;r.arraySet(d,u,h,T,m),p-=T,h+=T,f-=T,m+=T,i.length-=T;break}i.mode=12;break;case 17:for(;y<14;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(i.nlen=257+(31&g),g>>>=5,y-=5,i.ndist=1+(31&g),g>>>=5,y-=5,i.ncode=4+(15&g),g>>>=4,y-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;y<3;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.lens[U[i.have++]]=7&g,g>>>=3,y-=3}for(;i.have<19;)i.lens[U[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,M={bits:i.lenbits},I=s(0,i.lens,0,19,i.lencode,0,i.work,M),i.lenbits=M.bits,I){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;x=(k=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,P=65535&k,!((w=k>>>24)<=y);){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(P<16)g>>>=w,y-=w,i.lens[i.have++]=P;else{if(16===P){for(L=w+2;y<L;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(g>>>=w,y-=w,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}R=i.lens[i.have-1],T=3+(3&g),g>>>=2,y-=2}else if(17===P){for(L=w+3;y<L;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}y-=w,R=0,T=3+(7&(g>>>=w)),g>>>=3,y-=3}else{for(L=w+7;y<L;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}y-=w,R=0,T=11+(127&(g>>>=w)),g>>>=7,y-=7}if(i.have+T>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;T--;)i.lens[i.have++]=R}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,M={bits:i.lenbits},I=s(1,i.lens,0,i.nlen,i.lencode,0,i.work,M),i.lenbits=M.bits,I){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,M={bits:i.distbits},I=s(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,M),i.distbits=M.bits,I){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=p&&258<=f){e.next_out=m,e.avail_out=f,e.next_in=h,e.avail_in=p,i.hold=g,i.bits=y,a(e,S),m=e.next_out,d=e.output,f=e.avail_out,h=e.next_in,u=e.input,p=e.avail_in,g=i.hold,y=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;x=(k=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,P=65535&k,!((w=k>>>24)<=y);){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(x&&0==(240&x)){for(O=w,A=x,D=P;x=(k=i.lencode[D+((g&(1<<O+A)-1)>>O)])>>>16&255,P=65535&k,!(O+(w=k>>>24)<=y);){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}g>>>=O,y-=O,i.back+=O}if(g>>>=w,y-=w,i.back+=w,i.length=P,0===x){i.mode=26;break}if(32&x){i.back=-1,i.mode=12;break}if(64&x){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&x,i.mode=22;case 22:if(i.extra){for(L=i.extra;y<L;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.length+=g&(1<<i.extra)-1,g>>>=i.extra,y-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;x=(k=i.distcode[g&(1<<i.distbits)-1])>>>16&255,P=65535&k,!((w=k>>>24)<=y);){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(0==(240&x)){for(O=w,A=x,D=P;x=(k=i.distcode[D+((g&(1<<O+A)-1)>>O)])>>>16&255,P=65535&k,!(O+(w=k>>>24)<=y);){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}g>>>=O,y-=O,i.back+=O}if(g>>>=w,y-=w,i.back+=w,64&x){e.msg="invalid distance code",i.mode=30;break}i.offset=P,i.extra=15&x,i.mode=24;case 24:if(i.extra){for(L=i.extra;y<L;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}i.offset+=g&(1<<i.extra)-1,g>>>=i.extra,y-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===f)break e;if(T=S-f,i.offset>T){if((T=i.offset-T)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}E=T>i.wnext?(T-=i.wnext,i.wsize-T):i.wnext-T,T>i.length&&(T=i.length),C=i.window}else C=d,E=m-i.offset,T=i.length;for(f<T&&(T=f),f-=T,i.length-=T;d[m++]=C[E++],--T;);0===i.length&&(i.mode=21);break;case 26:if(0===f)break e;d[m++]=i.length,f--,i.mode=21;break;case 27:if(i.wrap){for(;y<32;){if(0===p)break e;p--,g|=u[h++]<<y,y+=8}if(S-=f,e.total_out+=S,i.total+=S,S&&(e.adler=i.check=i.flags?o(i.check,d,S,m-S):n(i.check,d,S,m-S)),S=f,(i.flags?g:c(g))!==i.check){e.msg="incorrect data check",i.mode=30;break}y=g=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;y<32;){if(0===p)break e;p--,g+=u[h++]<<y,y+=8}if(g!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}y=g=0}i.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;case 32:default:return l}return e.next_out=m,e.avail_out=f,e.next_in=h,e.avail_in=p,i.hold=g,i.bits=y,(i.wsize||S!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&_(e,e.output,e.next_out,S-e.avail_out)?(i.mode=31,-4):(b-=e.avail_in,S-=e.avail_out,e.total_in+=b,e.total_out+=S,i.total+=S,i.wrap&&S&&(e.adler=i.check=i.flags?o(i.check,d,S,e.next_out-S):n(i.check,d,S,e.next_out-S)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==b&&0===S||4===t)&&0===I&&(I=-5),I)},i.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?l:((i.head=t).done=!1,0):l},i.inflateSetDictionary=function(e,t){var i,r=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?l:11===i.mode&&n(1,t,r,0)!==i.check?-3:_(e,t,r,r)?(i.mode=31,-4):(i.havedict=1,0):l},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){"use strict";var r=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,c,u,d,h){var m,p,f,g,y,v,_,b,S,T=h.bits,E=0,C=0,w=0,x=0,P=0,O=0,A=0,D=0,R=0,I=0,M=null,L=0,k=new r.Buf16(16),N=new r.Buf16(16),U=null,j=0;for(E=0;E<=15;E++)k[E]=0;for(C=0;C<l;C++)k[t[i+C]]++;for(P=T,x=15;1<=x&&0===k[x];x--);if(x<P&&(P=x),0===x)return c[u++]=20971520,c[u++]=20971520,h.bits=1,0;for(w=1;w<x&&0===k[w];w++);for(P<w&&(P=w),E=D=1;E<=15;E++)if(D<<=1,(D-=k[E])<0)return-1;if(0<D&&(0===e||1!==x))return-1;for(N[1]=0,E=1;E<15;E++)N[E+1]=N[E]+k[E];for(C=0;C<l;C++)0!==t[i+C]&&(d[N[t[i+C]]++]=C);if(v=0===e?(M=U=d,19):1===e?(M=n,L-=257,U=o,j-=257,256):(M=a,U=s,-1),E=w,y=u,A=C=I=0,f=-1,g=(R=1<<(O=P))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(_=E-A,S=d[C]<v?(b=0,d[C]):d[C]>v?(b=U[j+d[C]],M[L+d[C]]):(b=96,0),m=1<<E-A,w=p=1<<O;c[y+(I>>A)+(p-=m)]=_<<24|b<<16|S|0,0!==p;);for(m=1<<E-1;I&m;)m>>=1;if(0!==m?(I&=m-1,I+=m):I=0,C++,0==--k[E]){if(E===x)break;E=t[i+d[C]]}if(P<E&&(I&g)!==f){for(0===A&&(A=P),y+=w,D=1<<(O=E-A);O+A<x&&!((D-=k[O+A])<=0);)O++,D<<=1;if(R+=1<<O,1===e&&852<R||2===e&&592<R)return 1;c[f=I&g]=P<<24|O<<16|y-u|0}}return 0!==I&&(c[y+I]=E-A<<24|64<<16|0),h.bits=P,0}},{"../utils/common":41}],51:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){"use strict";var r=e("../utils/common");function n(e){for(var t=e.length;0<=--t;)e[t]=0}var o=15,a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],c=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);n(u);var d=new Array(60);n(d);var h=new Array(512);n(h);var m=new Array(256);n(m);var p=new Array(29);n(p);var f,g,y,v=new Array(30);function _(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function S(e){return e<256?h[e]:h[256+(e>>>7)]}function T(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,T(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function C(e,t,i){E(e,i[2*t],i[2*t+1])}function w(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function x(e,t,i){var r,n,a=new Array(16),s=0;for(r=1;r<=o;r++)a[r]=s=s+i[r-1]<<1;for(n=0;n<=t;n++){var l=e[2*n+1];0!==l&&(e[2*n]=w(a[l]++,l))}}function P(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function O(e){8<e.bi_valid?T(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function A(e,t,i,r){var n=2*t,o=2*i;return e[n]<e[o]||e[n]===e[o]&&r[t]<=r[i]}function D(e,t,i){for(var r=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&A(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!A(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r}function R(e,t,i){var r,n,o,l,c=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],n=e.pending_buf[e.l_buf+c],c++,0===r?C(e,n,t):(C(e,(o=m[n])+256+1,t),0!==(l=a[o])&&E(e,n-=p[o],l),C(e,o=S(--r),i),0!==(l=s[o])&&E(e,r-=v[o],l)),c<e.last_lit;);C(e,256,t)}function I(e,t){var i,r,n,a=t.dyn_tree,s=t.stat_desc.static_tree,l=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<c;i++)0!==a[2*i]?(e.heap[++e.heap_len]=u=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)a[2*(n=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[n]=0,e.opt_len--,l&&(e.static_len-=s[2*n+1]);for(t.max_code=u,i=e.heap_len>>1;1<=i;i--)D(e,a,i);for(n=c;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,a[2*n]=a[2*i]+a[2*r],e.depth[n]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,a[2*i+1]=a[2*r+1]=n,e.heap[1]=n++,D(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,r,n,a,s,l,c=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,h=t.stat_desc.has_stree,m=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(a=0;a<=o;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)f<(a=c[2*c[2*(r=e.heap[i])+1]+1]+1)&&(a=f,g++),c[2*r+1]=a,u<r||(e.bl_count[a]++,s=0,p<=r&&(s=m[r-p]),l=c[2*r],e.opt_len+=l*(a+s),h&&(e.static_len+=l*(d[2*r+1]+s)));if(0!==g){do{for(a=f-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[f]--,g-=2}while(0<g);for(a=f;0!==a;a--)for(r=e.bl_count[a];0!==r;)u<(n=e.heap[--i])||(c[2*n+1]!==a&&(e.opt_len+=(a-c[2*n+1])*c[2*n],c[2*n+1]=a),r--)}}(e,t),x(a,u,e.bl_count)}function M(e,t,i){var r,n,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)n=a,a=t[2*(r+1)+1],++s<l&&n===a||(s<c?e.bl_tree[2*n]+=s:0!==n?(n!==o&&e.bl_tree[2*n]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=n,c=(s=0)===a?(l=138,3):n===a?(l=6,3):(l=7,4))}function L(e,t,i){var r,n,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=i;r++)if(n=a,a=t[2*(r+1)+1],!(++s<l&&n===a)){if(s<c)for(;C(e,n,e.bl_tree),0!=--s;);else 0!==n?(n!==o&&(C(e,n,e.bl_tree),s--),C(e,16,e.bl_tree),E(e,s-3,2)):s<=10?(C(e,17,e.bl_tree),E(e,s-3,3)):(C(e,18,e.bl_tree),E(e,s-11,7));o=n,c=(s=0)===a?(l=138,3):n===a?(l=6,3):(l=7,4)}}n(v);var k=!1;function N(e,t,i,n){var o,a,s;E(e,0+(n?1:0),3),a=t,s=i,O(o=e),T(o,s),T(o,~s),r.arraySet(o.pending_buf,o.window,a,s,o.pending),o.pending+=s}i._tr_init=function(e){k||(function(){var e,t,i,r,n,c=new Array(16);for(r=i=0;r<28;r++)for(p[r]=i,e=0;e<1<<a[r];e++)m[i++]=r;for(m[i-1]=r,r=n=0;r<16;r++)for(v[r]=n,e=0;e<1<<s[r];e++)h[n++]=r;for(n>>=7;r<30;r++)for(v[r]=n<<7,e=0;e<1<<s[r]-7;e++)h[256+n++]=r;for(t=0;t<=o;t++)c[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,c[8]++;for(;e<=255;)u[2*e+1]=9,e++,c[9]++;for(;e<=279;)u[2*e+1]=7,e++,c[7]++;for(;e<=287;)u[2*e+1]=8,e++,c[8]++;for(x(u,287,c),e=0;e<30;e++)d[2*e+1]=5,d[2*e]=w(e,5);f=new _(u,a,257,286,o),g=new _(d,s,0,30,o),y=new _(new Array(0),l,0,19,7)}(),k=!0),e.l_desc=new b(e.dyn_ltree,f),e.d_desc=new b(e.dyn_dtree,g),e.bl_desc=new b(e.bl_tree,y),e.bi_buf=0,e.bi_valid=0,P(e)},i._tr_stored_block=N,i._tr_flush_block=function(e,t,i,r){var n,o,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),a=function(e){var t;for(M(e,e.dyn_ltree,e.l_desc.max_code),M(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*c[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=n&&(n=o)):n=o=i+5,i+4<=n&&-1!==t?N(e,t,i,r):4===e.strategy||o===n?(E(e,2+(r?1:0),3),R(e,u,d)):(E(e,4+(r?1:0),3),function(e,t,i,r){var n;for(E(e,t-257,5),E(e,i-1,5),E(e,r-4,4),n=0;n<r;n++)E(e,e.bl_tree[2*c[n]+1],3);L(e,e.dyn_ltree,t-1),L(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),R(e,e.dyn_ltree,e.dyn_dtree)),P(e),r&&O(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(m[i]+256+1)]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;E(e,2,3),C(e,256,u),16===(t=e).bi_valid?(T(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){"use strict";t.exports="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}))}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)},43720:e=>{e.exports=i;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function r(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=r;var n={},o={};function a(e,t){var i,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=o[e])?r:(i=l(e,(0|e)<0?-1:0,!0),a&&(o[e]=i),i):(a=-128<=(e|=0)&&e<128)&&(r=n[e])?r:(i=l(e,e<0?-1:0,!1),a&&(n[e]=i),i)}function s(e,t){if(isNaN(e))return t?y:g;if(t){if(e<0)return y;if(e>=m)return T}else{if(e<=-p)return E;if(e+1>=p)return S}return e<0?s(-e,t).neg():l(e%h|0,e/h|0,t)}function l(e,t,r){return new i(e,t,r)}i.fromInt=a,i.fromNumber=s,i.fromBits=l;var c=Math.pow;function u(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(i=t,t=!1):t=!!t,(i=i||10)<2||36<i)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,i).neg();for(var n=s(c(i,8)),o=g,a=0;a<e.length;a+=8){var l=Math.min(8,e.length-a),d=parseInt(e.substring(a,a+l),i);if(l<8){var h=s(c(i,l));o=o.mul(h).add(s(d))}else o=(o=o.mul(n)).add(s(d))}return o.unsigned=t,o}function d(e,t){return"number"==typeof e?s(e,t):"string"==typeof e?u(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=u,i.fromValue=d;var h=4294967296,m=h*h,p=m/2,f=a(1<<24),g=a(0);i.ZERO=g;var y=a(0,!0);i.UZERO=y;var v=a(1);i.ONE=v;var _=a(1,!0);i.UONE=_;var b=a(-1);i.NEG_ONE=b;var S=l(-1,2147483647,!1);i.MAX_VALUE=S;var T=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=T;var E=l(0,-2147483648,!1);i.MIN_VALUE=E;var C=i.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(E)){var t=s(e),i=this.div(t),r=i.mul(t).sub(this);return i.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=s(c(e,6),this.unsigned),o=this,a="";;){var l=o.div(n),u=(o.sub(l.mul(n)).toInt()>>>0).toString(e);if((o=l).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return r(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(r(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(v)},C.neg=C.negate,C.add=function(e){r(e)||(e=d(e));var t=this.high>>>16,i=65535&this.high,n=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,h=0,m=0,p=0;return m+=(p+=o+(65535&e.low))>>>16,h+=(m+=n+c)>>>16,u+=(h+=i+s)>>>16,u+=t+a,l((m&=65535)<<16|(p&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},C.subtract=function(e){return r(e)||(e=d(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=d(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(E))return e.isOdd()?E:g;if(e.eq(E))return this.isOdd()?E:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f)&&e.lt(f))return s(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=65535&this.high,o=this.low>>>16,a=65535&this.low,c=e.high>>>16,u=65535&e.high,h=e.low>>>16,m=65535&e.low,p=0,y=0,v=0,_=0;return v+=(_+=a*m)>>>16,y+=(v+=o*m)>>>16,v&=65535,y+=(v+=a*h)>>>16,p+=(y+=n*m)>>>16,y&=65535,p+=(y+=o*h)>>>16,y&=65535,p+=(y+=a*u)>>>16,p+=i*m+n*h+o*u+a*c,l((v&=65535)<<16|(_&=65535),(p&=65535)<<16|(y&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(r(e)||(e=d(e)),e.isZero())throw Error("division by zero");var i,n,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return y;if(e.gt(this.shru(1)))return _;o=y}else{if(this.eq(E))return e.eq(v)||e.eq(b)?E:e.eq(E)?v:(i=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:b:(n=this.sub(e.mul(i)),o=i.add(n.div(e)));if(e.eq(E))return this.unsigned?y:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=g}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),u=a<=48?1:c(2,a-48),h=s(i),m=h.mul(e);m.isNegative()||m.gt(n);)m=(h=s(i-=u,this.unsigned)).mul(e);h.isZero()&&(h=v),o=o.add(h),n=n.sub(m)}return o},C.div=C.divide,C.modulo=function(e){return r(e)||(e=d(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return l(~this.low,~this.high,this.unsigned)},C.and=function(e){return r(e)||(e=d(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return r(e)||(e=d(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return r(e)||(e=d(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,r){return r?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},43281:(e,t,i)=>{"use strict";e.exports=i(99050)},62100:(e,t,i)=>{"use strict";e.exports=i(89482)},42967:e=>{"use strict";e.exports=r;var t,i=/\/|\./;function r(e,t){i.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),r[e]=t}r("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),r("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),r("timestamp",{Timestamp:t}),r("empty",{Empty:{fields:{}}}),r("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),r("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),r("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),r.get=function(e){return r[e]||null}},33996:(e,t,i)=>{"use strict";var r=t,n=i(67025),o=i(9935);function a(e,t,i,r){if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(d%s){",r);for(var o=t.resolvedType.values,a=Object.keys(o),s=0;s<a.length;++s)t.repeated&&o[a[s]]===t.typeDefault&&e("default:"),e("case%j:",a[s])("case %i:",o[a[s]])("m%s=%j",r,o[a[s]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,i,r);else{var l=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,i,r){if(t.resolvedType)t.resolvedType instanceof n?e("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,i,r,r):e("d%s=types[%i].toObject(m%s,o)",r,i,r);else{var o=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,o?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,i=o.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return i("return new this.ctor");i("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),l=o.safeProp(s.name);s.map?(i("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),a(i,s,r,l+"[ks[i]]")("}")("}")):s.repeated?(i("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),a(i,s,r,l+"[i]")("}")("}")):(s.resolvedType instanceof n||i("if(d%s!=null){",l),a(i,s,r,l),s.resolvedType instanceof n||i("}"))}return i("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(o.compareFieldsById);if(!t.length)return o.codegen()("return {}");for(var i=o.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],a=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?r:t[c].map?a:l).push(t[c]);if(r.length){for(i("if(o.arrays||o.defaults){"),c=0;c<r.length;++c)i("d%s=[]",o.safeProp(r[c].name));i("}")}if(a.length){for(i("if(o.objects||o.defaults){"),c=0;c<a.length;++c)i("d%s={}",o.safeProp(a[c].name));i("}")}if(l.length){for(i("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],d=o.safeProp(u.name);if(u.resolvedType instanceof n)i("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var h="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else i("d%s=%j",d,u.typeDefault)}i("}")}var m=!1;for(c=0;c<t.length;++c){u=t[c];var p=e._fieldsArray.indexOf(u);d=o.safeProp(u.name),u.map?(m||(m=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),s(i,u,p,d+"[ks2[j]]")("}")):u.repeated?(i("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),s(i,u,p,d+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),s(i,u,p,d),u.partOf&&i("if(o.oneofs)")("d%s=%j",o.safeProp(u.partOf.name),u.name)),i("}")}return i("return d")}},15305:(e,t,i)=>{"use strict";e.exports=function(e){var t=o.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var i=0;i<e.fieldsArray.length;++i){var s=e._fieldsArray[i].resolve(),l=s.resolvedType instanceof r?"int32":s.type,c="m"+o.safeProp(s.name);t("case %i:",s.id),s.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==n.defaults[s.keyType]?t("k=%j",n.defaults[s.keyType]):t("k=null"),void 0!==n.defaults[l]?t("value=%j",n.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),void 0===n.basic[l]?t("value=types[%i].decode(r,r.uint32())",i):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==n.long[s.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',c):t("%s[k]=value",c)):s.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==n.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===n.basic[l]?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",c,i):t("%s.push(r.%s())",c,l)):void 0===n.basic[l]?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",c,i):t("%s=r.%s()",c,l),t("break")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),i=0;i<e._fieldsArray.length;++i){var u=e._fieldsArray[i];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")};var r=i(67025),n=i(77063),o=i(9935);function a(e){return"missing required '"+e.name+"'"}},44928:(e,t,i)=>{"use strict";e.exports=function(e){for(var t,i=o.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(o.compareFieldsById),l=0;l<s.length;++l){var c=s[l].resolve(),u=e._fieldsArray.indexOf(c),d=c.resolvedType instanceof r?"int32":c.type,h=n.basic[d];t="m"+o.safeProp(c.name),c.map?(i("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|n.mapKey[c.keyType],c.keyType),void 0===h?i("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):i(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),i("}")("}")):c.repeated?(i("if(%s!=null&&%s.length){",t,t),c.packed&&void 0!==n.packed[d]?i("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(i("for(var i=0;i<%s.length;++i)",t),void 0===h?a(i,c,u,t+"[i]"):i("w.uint32(%i).%s(%s[i])",(c.id<<3|h)>>>0,d,t)),i("}")):(c.optional&&i("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,c.name),void 0===h?a(i,c,u,t):i("w.uint32(%i).%s(%s)",(c.id<<3|h)>>>0,d,t))}return i("return w")};var r=i(67025),n=i(77063),o=i(9935);function a(e,t,i,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",i,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",i,r,(t.id<<3|2)>>>0)}},67025:(e,t,i)=>{"use strict";e.exports=a;var r=i(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="Enum";var n=i(69313),o=i(9935);function a(e,t,i,n,o){if(r.call(this,e,i),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=o||{},this.reserved=void 0,t)for(var a=Object.keys(t),s=0;s<a.length;++s)"number"==typeof t[a[s]]&&(this.valuesById[this.values[a[s]]=t[a[s]]]=a[s])}a.fromJSON=function(e,t){var i=new a(e,t.values,t.options,t.comment,t.comments);return i.reserved=t.reserved,i},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,i){if(!o.isString(e))throw TypeError("name must be a string");if(!o.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return this.comments[e]=i||null,this},a.prototype.remove=function(e){if(!o.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this},a.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)}},13548:(e,t,i)=>{"use strict";e.exports=c;var r=i(3243);((c.prototype=Object.create(r.prototype)).constructor=c).className="Field";var n,o=i(67025),a=i(77063),s=i(9935),l=/^required|optional|repeated$/;function c(e,t,i,n,o,c,u){if(s.isObject(n)?(u=o,c=n,n=o=void 0):s.isObject(o)&&(u=c,c=o,o=void 0),r.call(this,e,c),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(i))throw TypeError("type must be a string");if(void 0!==n&&!l.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!s.isString(o))throw TypeError("extend must be a string");this.rule=n&&"optional"!==n?n:void 0,this.type=i,this.id=t,this.extend=o||void 0,this.required="required"===n,this.optional=!this.required,this.repeated="repeated"===n,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==a.long[i],this.bytes="bytes"===i,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,i){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,i)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof n?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof n&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},c.d=function(e,t,i,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(n,o){s.decorateType(n.constructor).add(new c(o,e,t,i,{default:r}))}},c._configure=function(e){n=e}},88836:(e,t,i)=>{"use strict";var r=e.exports=i(89482);r.build="light",r.load=function(e,t,i){return"function"==typeof t?(i=t,t=new r.Root):t||(t=new r.Root),t.load(e,i)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=i(44928),r.decoder=i(15305),r.verifier=i(24497),r.converter=i(33996),r.ReflectionObject=i(3243),r.Namespace=i(69313),r.Root=i(99424),r.Enum=i(67025),r.Type=i(7645),r.Field=i(13548),r.OneOf=i(27598),r.MapField=i(16039),r.Service=i(77513),r.Method=i(94429),r.Message=i(88368),r.wrappers=i(71667),r.types=i(77063),r.util=i(9935),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},89482:(e,t,i)=>{"use strict";var r=t;function n(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=i(41173),r.BufferWriter=i(43155),r.Reader=i(51408),r.BufferReader=i(50593),r.util=i(99693),r.rpc=i(35994),r.roots=i(85054),r.configure=n,n()},99050:(e,t,i)=>{"use strict";var r=e.exports=i(88836);r.build="full",r.tokenize=i(50626),r.parse=i(62228),r.common=i(42967),r.Root._configure(r.Type,r.parse,r.common)},16039:(e,t,i)=>{"use strict";e.exports=a;var r=i(13548);((a.prototype=Object.create(r.prototype)).constructor=a).className="MapField";var n=i(77063),o=i(9935);function a(e,t,i,n,a,s){if(r.call(this,e,t,n,void 0,void 0,a,s),!o.isString(i))throw TypeError("keyType must be a string");this.keyType=i,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===n.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},a.d=function(e,t,i){return"function"==typeof i?i=o.decorateType(i).name:i&&"object"==typeof i&&(i=o.decorateEnum(i).name),function(r,n){o.decorateType(r.constructor).add(new a(n,e,t,i))}}},88368:(e,t,i)=>{"use strict";e.exports=n;var r=i(99693);function n(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)this[t[i]]=e[t[i]]}n.create=function(e){return this.$type.create(e)},n.encode=function(e,t){return this.$type.encode(e,t)},n.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},n.decode=function(e){return this.$type.decode(e)},n.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},n.verify=function(e){return this.$type.verify(e)},n.fromObject=function(e){return this.$type.fromObject(e)},n.toObject=function(e,t){return this.$type.toObject(e,t)},n.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},94429:(e,t,i)=>{"use strict";e.exports=o;var r=i(3243);((o.prototype=Object.create(r.prototype)).constructor=o).className="Method";var n=i(9935);function o(e,t,i,o,a,s,l,c){if(n.isObject(a)?(l=a,a=s=void 0):n.isObject(s)&&(l=s,s=void 0),void 0!==t&&!n.isString(t))throw TypeError("type must be a string");if(!n.isString(i))throw TypeError("requestType must be a string");if(!n.isString(o))throw TypeError("responseType must be a string");r.call(this,e,l),this.type=t||"rpc",this.requestType=i,this.requestStream=!!a||void 0,this.responseType=o,this.responseStream=!!s||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c}o.fromJSON=function(e,t){return new o(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return n.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},69313:(e,t,i)=>{"use strict";e.exports=u;var r=i(3243);((u.prototype=Object.create(r.prototype)).constructor=u).className="Namespace";var n,o,a,s=i(13548),l=i(9935);function c(e,t){if(e&&e.length){for(var i={},r=0;r<e.length;++r)i[e[r].name]=e[r].toJSON(t);return i}}function u(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null}function d(e){return e._nestedArray=null,e}u.fromJSON=function(e,t){return new u(e,t.options).addJSON(t.nested)},u.arrayToJSON=c,u.isReservedId=function(e,t){if(e)for(var i=0;i<e.length;++i)if("string"!=typeof e[i]&&e[i][0]<=t&&e[i][1]>t)return!0;return!1},u.isReservedName=function(e,t){if(e)for(var i=0;i<e.length;++i)if(e[i]===t)return!0;return!1},Object.defineProperty(u.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),u.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",c(this.nestedArray,e)])},u.prototype.addJSON=function(e){if(e)for(var t,i=Object.keys(e),r=0;r<i.length;++r)t=e[i[r]],this.add((void 0!==t.fields?n.fromJSON:void 0!==t.values?a.fromJSON:void 0!==t.methods?o.fromJSON:void 0!==t.id?s.fromJSON:u.fromJSON)(i[r],t));return this},u.prototype.get=function(e){return this.nested&&this.nested[e]||null},u.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof a)return this.nested[e].values;throw Error("no such enum: "+e)},u.prototype.add=function(e){if(!(e instanceof s&&void 0!==e.extend||e instanceof n||e instanceof a||e instanceof o||e instanceof u))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof u&&e instanceof u)||t instanceof n||t instanceof o)throw Error("duplicate name '"+e.name+"' in "+this);for(var i=t.nestedArray,r=0;r<i.length;++r)e.add(i[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),d(this)},u.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},u.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var i=this;e.length>0;){var r=e.shift();if(i.nested&&i.nested[r]){if(!((i=i.nested[r])instanceof u))throw Error("path conflicts with non-namespace objects")}else i.add(i=new u(r))}return t&&i.addJSON(t),i},u.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof u?e[t++].resolveAll():e[t++].resolve();return this.resolve()},u.prototype.lookup=function(e,t,i){if("boolean"==typeof t?(i=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof u&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var n=0;n<this.nestedArray.length;++n)if(this._nestedArray[n]instanceof u&&(r=this._nestedArray[n].lookup(e,t,!0)))return r;return null===this.parent||i?null:this.parent.lookup(e,t)},u.prototype.lookupType=function(e){var t=this.lookup(e,[n]);if(!t)throw Error("no such type: "+e);return t},u.prototype.lookupEnum=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},u.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[n,a]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},u.prototype.lookupService=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},u._configure=function(e,t,i){n=e,o=t,a=i}},3243:(e,t,i)=>{"use strict";e.exports=o,o.className="ReflectionObject";var r,n=i(9935);function o(e,t){if(!n.isString(e))throw TypeError("name must be a string");if(t&&!n.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},o.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},o.prototype.getOption=function(e){if(this.options)return this.options[e]},o.prototype.setOption=function(e,t,i){return i&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},o.prototype.setParsedOption=function(e,t,i){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(i){var o=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(o){var a=o[e];n.setProperty(a,i,t)}else(o={})[e]=n.setProperty({},i,t),r.push(o)}else{var s={};s[e]=t,r.push(s)}return this},o.prototype.setOptions=function(e,t){if(e)for(var i=Object.keys(e),r=0;r<i.length;++r)this.setOption(i[r],e[i[r]],t);return this},o.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},o._configure=function(e){r=e}},27598:(e,t,i)=>{"use strict";e.exports=a;var r=i(3243);((a.prototype=Object.create(r.prototype)).constructor=a).className="OneOf";var n=i(13548),o=i(9935);function a(e,t,i,n){if(Array.isArray(t)||(i=t,t=void 0),r.call(this,e,i),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=n}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},a.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var i=e.get(this.oneof[t]);i&&!i.partOf&&(i.partOf=this,this.fieldsArray.push(i))}s(this)},a.prototype.onRemove=function(e){for(var t,i=0;i<this.fieldsArray.length;++i)(t=this.fieldsArray[i]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},a.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,i){o.decorateType(t.constructor).add(new a(i,e)),Object.defineProperty(t,i,{get:o.oneOfGetter(e),set:o.oneOfSetter(e)})}}},62228:(e,t,i)=>{"use strict";e.exports=C,C.filename=null,C.defaults={keepCase:!1};var r=i(50626),n=i(99424),o=i(7645),a=i(13548),s=i(16039),l=i(27598),c=i(67025),u=i(77513),d=i(94429),h=i(77063),m=i(9935),p=/^[1-9][0-9]*$/,f=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,v=/^0[0-7]+$/,_=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,E=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function C(e,t,i){t instanceof n||(i=t,t=new n),i||(i=C.defaults);var w,x,P,O,A,D=i.preferTrailingComment||!1,R=r(e,i.alternateCommentMode||!1),I=R.next,M=R.push,L=R.peek,k=R.skip,N=R.cmnt,U=!0,j=!1,F=t,V=i.keepCase?function(e){return e}:m.camelCase;function B(e,t,i){var r=C.filename;return i||(C.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+R.line+")")}function G(){var e,t=[];do{if('"'!==(e=I())&&"'"!==e)throw B(e);t.push(I()),k(e),e=L()}while('"'===e||"'"===e);return t.join("")}function z(e){var t=I();switch(t){case"'":case'"':return M(t),G();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var i=1;switch("-"===e.charAt(0)&&(i=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return i*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return i*parseInt(e,10);if(g.test(e))return i*parseInt(e,16);if(v.test(e))return i*parseInt(e,8);if(b.test(e))return i*parseFloat(e);throw B(e,"number",!0)}(t)}catch(i){if(e&&T.test(t))return t;throw B(t,"value")}}function H(e,t){var i,r;do{!t||'"'!==(i=L())&&"'"!==i?e.push([r=q(I()),k("to",!0)?q(I()):r]):e.push(G())}while(k(",",!0));k(";")}function q(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw B(e,"id");if(f.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(_.test(e))return parseInt(e,8);throw B(e,"id")}function W(){if(void 0!==w)throw B("package");if(w=I(),!T.test(w))throw B(w,"name");F=F.define(w),k(";")}function K(){var e,t=L();switch(t){case"weak":e=P||(P=[]),I();break;case"public":I();default:e=x||(x=[])}t=G(),k(";"),e.push(t)}function $(){if(k("="),O=G(),!(j="proto3"===O)&&"proto2"!==O)throw B(O,"syntax");k(";")}function Y(e,t){switch(t){case"option":return X(e,t),k(";"),!0;case"message":return function(e,t){if(!S.test(t=I()))throw B(t,"type name");var i=new o(t);Q(i,(function(e){if(!Y(i,e))switch(e){case"map":!function(e){k("<");var t=I();if(void 0===h.mapKey[t])throw B(t,"type");k(",");var i=I();if(!T.test(i))throw B(i,"type");k(">");var r=I();if(!S.test(r))throw B(r,"name");k("=");var n=new s(V(r),q(I()),t,i);Q(n,(function(e){if("option"!==e)throw B(e);X(n,e),k(";")}),(function(){te(n)})),e.add(n)}(i);break;case"required":case"optional":case"repeated":J(i,e);break;case"oneof":!function(e,t){if(!S.test(t=I()))throw B(t,"name");var i=new l(V(t));Q(i,(function(e){"option"===e?(X(i,e),k(";")):(M(e),J(i,"optional"))})),e.add(i)}(i,e);break;case"extensions":H(i.extensions||(i.extensions=[]));break;case"reserved":H(i.reserved||(i.reserved=[]),!0);break;default:if(!j||!T.test(e))throw B(e);M(e),J(i,"optional")}})),e.add(i)}(e,t),!0;case"enum":return function(e,t){if(!S.test(t=I()))throw B(t,"name");var i=new c(t);Q(i,(function(e){switch(e){case"option":X(i,e),k(";");break;case"reserved":H(i.reserved||(i.reserved=[]),!0);break;default:!function(e,t){if(!S.test(t))throw B(t,"name");k("=");var i=q(I(),!0),r={};Q(r,(function(e){if("option"!==e)throw B(e);X(r,e),k(";")}),(function(){te(r)})),e.add(t,i,r.comment)}(i,e)}})),e.add(i)}(e,t),!0;case"service":return function(e,t){if(!S.test(t=I()))throw B(t,"service name");var i=new u(t);Q(i,(function(e){if(!Y(i,e)){if("rpc"!==e)throw B(e);!function(e,t){var i=N(),r=t;if(!S.test(t=I()))throw B(t,"name");var n,o,a,s,l=t;if(k("("),k("stream",!0)&&(o=!0),!T.test(t=I()))throw B(t);if(n=t,k(")"),k("returns"),k("("),k("stream",!0)&&(s=!0),!T.test(t=I()))throw B(t);a=t,k(")");var c=new d(l,r,n,a,o,s);c.comment=i,Q(c,(function(e){if("option"!==e)throw B(e);X(c,e),k(";")})),e.add(c)}(i,e)}})),e.add(i)}(e,t),!0;case"extend":return function(e,t){if(!T.test(t=I()))throw B(t,"reference");var i=t;Q(null,(function(t){switch(t){case"required":case"repeated":case"optional":J(e,t,i);break;default:if(!j||!T.test(t))throw B(t);M(t),J(e,"optional",i)}}))}(e,t),!0}return!1}function Q(e,t,i){var r=R.line;if(e&&("string"!=typeof e.comment&&(e.comment=N()),e.filename=C.filename),k("{",!0)){for(var n;"}"!==(n=I());)t(n);k(";",!0)}else i&&i(),k(";"),e&&("string"!=typeof e.comment||D)&&(e.comment=N(r)||e.comment)}function J(e,t,i){var r=I();if("group"!==r){if(!T.test(r))throw B(r,"type");var n=I();if(!S.test(n))throw B(n,"name");n=V(n),k("=");var s=new a(n,q(I()),r,t,i);Q(s,(function(e){if("option"!==e)throw B(e);X(s,e),k(";")}),(function(){te(s)})),e.add(s),j||!s.repeated||void 0===h.packed[r]&&void 0!==h.basic[r]||s.setOption("packed",!1,!0)}else!function(e,t){var i=I();if(!S.test(i))throw B(i,"name");var r=m.lcFirst(i);i===r&&(i=m.ucFirst(i)),k("=");var n=q(I()),s=new o(i);s.group=!0;var l=new a(r,n,i,t);l.filename=C.filename,Q(s,(function(e){switch(e){case"option":X(s,e),k(";");break;case"required":case"optional":case"repeated":J(s,e);break;default:throw B(e)}})),e.add(s).add(l)}(e,t)}function X(e,t){var i=k("(",!0);if(!T.test(t=I()))throw B(t,"name");var r,n=t,o=n;i&&(k(")"),o=n="("+n+")",t=L(),E.test(t)&&(r=t.substr(1),n+=t,I())),k("="),function(e,t,i,r){e.setParsedOption&&e.setParsedOption(t,i,r)}(e,o,Z(e,n),r)}function Z(e,t){if(k("{",!0)){for(var i={};!k("}",!0);){if(!S.test(A=I()))throw B(A,"name");var r,n=A;"{"===L()?r=Z(e,t+"."+A):(k(":"),"{"===L()?r=Z(e,t+"."+A):(r=z(!0),ee(e,t+"."+A,r)));var o=i[n];o&&(r=[].concat(o).concat(r)),i[n]=r,k(",",!0)}return i}var a=z(!0);return ee(e,t,a),a}function ee(e,t,i){e.setOption&&e.setOption(t,i)}function te(e){if(k("[",!0)){do{X(e,"option")}while(k(",",!0));k("]")}return e}for(;null!==(A=I());)switch(A){case"package":if(!U)throw B(A);W();break;case"import":if(!U)throw B(A);K();break;case"syntax":if(!U)throw B(A);$();break;case"option":X(F,A),k(";");break;default:if(Y(F,A)){U=!1;continue}throw B(A)}return C.filename=null,{package:w,imports:x,weakImports:P,syntax:O,root:t}}},51408:(e,t,i)=>{"use strict";e.exports=l;var r,n=i(99693),o=n.LongBits,a=n.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},d=function(){return n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new r(e):u(e)})(e)}:u};function h(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function m(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new o(m(this.buf,this.pos+=4),m(this.buf,this.pos+=4))}l.create=d(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return m(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|m(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=d(),r._configure();var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},50593:(e,t,i)=>{"use strict";e.exports=o;var r=i(51408);(o.prototype=Object.create(r.prototype)).constructor=o;var n=i(99693);function o(e){r.call(this,e)}o._configure=function(){n.Buffer&&(o.prototype._slice=n.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},99424:(e,t,i)=>{"use strict";e.exports=d;var r=i(69313);((d.prototype=Object.create(r.prototype)).constructor=d).className="Root";var n,o,a,s=i(13548),l=i(67025),c=i(27598),u=i(9935);function d(e){r.call(this,"",e),this.deferred=[],this.files=[]}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,i,r){"function"==typeof i&&(r=i,i=void 0);var n=this;if(!r)return u.asPromise(e,n,t,i);var s=r===h;function l(e,t){if(r){var i=r;if(r=null,s)throw e;i(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var i=e.substring(t);if(i in a)return i}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){o.filename=e;var r,a=o(t,n,i),d=0;if(a.imports)for(;d<a.imports.length;++d)(r=c(a.imports[d])||n.resolvePath(e,a.imports[d]))&&m(r);if(a.weakImports)for(d=0;d<a.weakImports.length;++d)(r=c(a.weakImports[d])||n.resolvePath(e,a.weakImports[d]))&&m(r,!0)}else n.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}s||p||l(null,n)}function m(e,t){if(!(n.files.indexOf(e)>-1))if(n.files.push(e),e in a)s?d(e,a[e]):(++p,setTimeout((function(){--p,d(e,a[e])})));else if(s){var i;try{i=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||l(e))}d(e,i)}else++p,n.fetch(e,(function(i,o){--p,r&&(i?t?p||l(null,n):l(i):d(e,o))}))}var p=0;u.isString(t)&&(t=[t]);for(var f,g=0;g<t.length;++g)(f=n.resolvePath("",t[g]))&&m(f);if(s)return n;p||l(null,n)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var m=/^[A-Z]/;function p(e,t){var i=t.parent.lookup(t.extend);if(i){var r=new s(t.fullName,t.id,t.type,t.rule,void 0,t.options);return r.declaringField=t,t.extensionField=r,i.add(r),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof s)void 0===e.extend||e.extensionField||p(0,e)||this.deferred.push(e);else if(e instanceof l)m.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof n)for(var t=0;t<this.deferred.length;)p(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);m.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof s){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)m.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);m.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,i){n=e,o=t,a=i}},85054:e=>{"use strict";e.exports={}},35994:(e,t,i)=>{"use strict";t.Service=i(77948)},77948:(e,t,i)=>{"use strict";e.exports=n;var r=i(99693);function n(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(n.prototype=Object.create(r.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,i,n,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,i,n,o);if(s.rpcImpl)try{return s.rpcImpl(t,i[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,i){if(e)return s.emit("error",e,t),a(e);if(null!==i){if(!(i instanceof n))try{i=n[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",i,t),a(null,i)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},77513:(e,t,i)=>{"use strict";e.exports=s;var r=i(69313);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var n=i(94429),o=i(9935),a=i(35994);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var i=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),o=0;o<r.length;++o)i.add(n.fromJSON(r[o],t.methods[r[o]]));return t.nested&&i.addJSON(t.nested),i.comment=t.comment,i},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return o.toObject(["options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=o.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof n?(this.methods[e.name]=e,e.parent=this,l(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof n){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,i){for(var r,n=new a.Service(e,t,i),s=0;s<this.methodsArray.length;++s){var l=o.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");n[l]=o.codegen(["r","c"],o.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return n}},50626:e=>{"use strict";e.exports=d;var t=/[\s{}=;:[\],'"()<>]/g,i=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,n=/^ *[*/]+ */,o=/^\s*\*?\/*/,a=/\n/g,s=/\s/,l=/\\(.?)/g,c={0:"\0",r:"\r",n:"\n",t:"\t"};function u(e){return e.replace(l,(function(e,t){switch(t){case"\\":case"":return t;default:return c[t]||""}}))}function d(e,l){e=e.toString();var c=0,d=e.length,h=1,m=null,p=null,f=0,g=!1,y=!1,v=[],_=null;function b(e){return Error("illegal "+e+" (line "+h+")")}function S(t){return e.charAt(t)}function T(t,i,r){m=e.charAt(t++),f=h,g=!1,y=r;var s,c=t-(l?2:3);do{if(--c<0||"\n"===(s=e.charAt(c))){g=!0;break}}while(" "===s||"\t"===s);for(var u=e.substring(t,i).split(a),d=0;d<u.length;++d)u[d]=u[d].replace(l?o:n,"").trim();p=u.join("\n").trim()}function E(t){var i=C(t),r=e.substring(t,i);return/^\s*\/{1,2}/.test(r)}function C(e){for(var t=e;t<d&&"\n"!==S(t);)t++;return t}function w(){if(v.length>0)return v.shift();if(_)return function(){var t="'"===_?r:i;t.lastIndex=c-1;var n=t.exec(e);if(!n)throw b("string");return c=t.lastIndex,x(_),_=null,u(n[1])}();var n,o,a,m,p,f=0===c;do{if(c===d)return null;for(n=!1;s.test(a=S(c));)if("\n"===a&&(f=!0,++h),++c===d)return null;if("/"===S(c)){if(++c===d)throw b("comment");if("/"===S(c))if(l){if(m=c,p=!1,E(c)){p=!0;do{if((c=C(c))===d)break;c++}while(E(c))}else c=Math.min(d,C(c)+1);p&&T(m,c,f),h++,n=!0}else{for(p="/"===S(m=c+1);"\n"!==S(++c);)if(c===d)return null;++c,p&&T(m,c-1,f),++h,n=!0}else{if("*"!==(a=S(c)))return"/";m=c+1,p=l||"*"===S(m);do{if("\n"===a&&++h,++c===d)throw b("comment");o=a,a=S(c)}while("*"!==o||"/"!==a);++c,p&&T(m,c-2,f),n=!0}}}while(n);var g=c;if(t.lastIndex=0,!t.test(S(g++)))for(;g<d&&!t.test(S(g));)++g;var y=e.substring(c,c=g);return'"'!==y&&"'"!==y||(_=y),y}function x(e){v.push(e)}function P(){if(!v.length){var e=w();if(null===e)return null;x(e)}return v[0]}return Object.defineProperty({next:w,peek:P,push:x,skip:function(e,t){var i=P();if(i===e)return w(),!0;if(!t)throw b("token '"+i+"', '"+e+"' expected");return!1},cmnt:function(e){var t=null;return void 0===e?f===h-1&&(l||"*"===m||g)&&(t=y?p:null):(f<e&&P(),f!==e||g||!l&&"/"!==m||(t=y?null:p)),t}},"line",{get:function(){return h}})}d.unescape=u},7645:(e,t,i)=>{"use strict";e.exports=v;var r=i(69313);((v.prototype=Object.create(r.prototype)).constructor=v).className="Type";var n=i(67025),o=i(27598),a=i(13548),s=i(16039),l=i(77513),c=i(88368),u=i(51408),d=i(41173),h=i(9935),m=i(44928),p=i(15305),f=i(24497),g=i(33996),y=i(71667);function v(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function _(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var i=this.fields[e[t]],r=i.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=i}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,c,!0),this._ctor=e;for(var i=0;i<this.fieldsArray.length;++i)this._fieldsArray[i].resolve();var r={};for(i=0;i<this.oneofsArray.length;++i)r[this._oneofsArray[i].resolve().name]={get:h.oneOfGetter(this._oneofsArray[i].oneof),set:h.oneOfSetter(this._oneofsArray[i].oneof)};i&&Object.defineProperties(e.prototype,r)}}}),v.generateConstructor=function(e){for(var t,i=h.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?i("this%s={}",h.safeProp(t.name)):t.repeated&&i("this%s=[]",h.safeProp(t.name));return i("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var i=new v(e,t.options);i.extensions=t.extensions,i.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)i.add((void 0!==t.fields[c[u]].keyType?s.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)i.add(o.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var d=t.nested[c[u]];i.add((void 0!==d.id?a.fromJSON:void 0!==d.fields?v.fromJSON:void 0!==d.values?n.fromJSON:void 0!==d.methods?l.fromJSON:r.fromJSON)(c[u],d))}return t.extensions&&t.extensions.length&&(i.extensions=t.extensions),t.reserved&&t.reserved.length&&(i.reserved=t.reserved),t.group&&(i.group=!0),t.comment&&(i.comment=t.comment),i},v.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),i=!!e&&Boolean(e.keepComments);return h.toObject(["options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",i?this.comment:void 0])},v.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var i=this.oneofsArray;for(t=0;t<i.length;)i[t++].resolve();return r.prototype.resolveAll.call(this)},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),_(this)}return e instanceof o?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),_(this)):r.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),_(this)}if(e instanceof o){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),_(this)}return r.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],i=0;i<this.fieldsArray.length;++i)t.push(this._fieldsArray[i].resolve().resolvedType);this.encode=m(this)({Writer:d,types:t,util:h}),this.decode=p(this)({Reader:u,types:t,util:h}),this.verify=f(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var r=y[e];if(r){var n=Object.create(this);n.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(n),n.toObject=this.toObject,this.toObject=r.toObject.bind(n)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){h.decorateType(t,e)}}},77063:(e,t,i)=>{"use strict";var r=t,n=i(9935),o=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var i=0,r={};for(t|=0;i<e.length;)r[o[i+t]]=e[i++];return r}r.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",n.emptyArray,null]),r.long=a([0,0,0,1,1],7),r.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},9935:(e,t,i)=>{"use strict";var r,n,o=e.exports=i(99693),a=i(85054);o.codegen=i(75124),o.fetch=i(49054),o.path=i(18626),o.fs=o.inquire("fs"),o.toArray=function(e){if(e){for(var t=Object.keys(e),i=new Array(t.length),r=0;r<t.length;)i[r]=e[t[r++]];return i}return[]},o.toObject=function(e){for(var t={},i=0;i<e.length;){var r=e[i++],n=e[i++];void 0!==n&&(t[r]=n)}return t};var s=/\\/g,l=/"/g;o.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},o.safeProp=function(e){return!/^[$\w_]+$/.test(e)||o.isReserved(e)?'["'+e.replace(s,"\\\\").replace(l,'\\"')+'"]':"."+e},o.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;o.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))},o.compareFieldsById=function(e,t){return e.id-t.id},o.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(o.decorateRoot.remove(e.$type),e.$type.name=t,o.decorateRoot.add(e.$type)),e.$type;r||(r=i(7645));var n=new r(t||e.name);return o.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var u=0;o.decorateEnum=function(e){if(e.$type)return e.$type;n||(n=i(67025));var t=new n("Enum"+u++,e);return o.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},o.setProperty=function(e,t,i){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,i,r){var n=i.shift();if(i.length>0)t[n]=e(t[n]||{},i,r);else{var o=t[n];o&&(r=[].concat(o).concat(r)),t[n]=r}return t}(e,t=t.split("."),i)},Object.defineProperty(o,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(i(99424)))}})},1945:(e,t,i)=>{"use strict";e.exports=n;var r=i(99693);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=n.zero=new n(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var i=e>>>0,r=(e-i)/4294967296>>>0;return t&&(r=~r>>>0,i=~i>>>0,++i>4294967295&&(i=0,++r>4294967295&&(r=0))),new n(i,r)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(r.isString(e)){if(!r.Long)return n.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new n(e.low>>>0,e.high>>>0):o},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},n.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;n.fromHash=function(e){return e===a?o:new n((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},99693:function(e,t,i){"use strict";var r=t;function n(e,t,i){for(var r=Object.keys(t),n=0;n<r.length;++n)void 0!==e[r[n]]&&i||(e[r[n]]=t[r[n]]);return e}function o(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&n(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=i(34537),r.base64=i(97419),r.EventEmitter=i(19211),r.float=i(10945),r.inquire=i(67199),r.utf8=i(94997),r.pool=i(76662),r.LongBits=i(1945),r.isNode=Boolean(void 0!==i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),r.global=r.isNode&&i.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var i=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},r.merge=n,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},r.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},24497:(e,t,i)=>{"use strict";e.exports=function(e){var t=n.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),i={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var l=e._fieldsArray[r].resolve(),c="m"+n.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,l.name),l.map)t("if(!util.isObject(%s))",c)("return%j",o(l,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),s(t,l,"k[i]"),a(t,l,r,c+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",c)("return%j",o(l,"array"))("for(var i=0;i<%s.length;++i){",c),a(t,l,r,c+"[i]")("}");else{if(l.partOf){var u=n.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",u)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",u)}a(t,l,r,c)}l.optional&&t("}")}return t("return null")};var r=i(67025),n=i(9935);function o(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,i,n){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",n)("default:")("return%j",o(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),s=0;s<a.length;++s)e("case %i:",t.resolvedType.values[a[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",i,n)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",n)("return%j",o(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",o(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',n)("return%j",o(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',n)("return%j",o(t,"boolean"));break;case"string":e("if(!util.isString(%s))",n)("return%j",o(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",o(t,"buffer"))}return e}function s(e,t,i){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",i)("return%j",o(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",i)("return%j",o(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",i)("return%j",o(t,"boolean key"))}return e}},71667:(e,t,i)=>{"use strict";var r=t,n=i(88368);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),i=this.lookup(t);if(i){var r="."===e["@type"].charAt(0)?e["@type"].substr(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:i.encode(i.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var i="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var o=this.lookup(r);o&&(e=o.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof n){var a=e.$type.toObject(e,t);return""===i&&(i="type.googleapis.com/"),r=i+("."===e.$type.fullName[0]?e.$type.fullName.substr(1):e.$type.fullName),a["@type"]=r,a}return this.toObject(e,t)}}},41173:(e,t,i)=>{"use strict";e.exports=d;var r,n=i(99693),o=n.LongBits,a=n.base64,s=n.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var h=function(){return n.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function m(e,t,i){t[i]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function g(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}d.create=h(),d.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(d.alloc=n.pool(d.alloc,n.Array.prototype.subarray)),d.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},p.prototype=Object.create(l.prototype),p.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(f,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(f,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(f,t.length(),t)},d.prototype.bool=function(e){return this._push(m,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var y=n.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var r=0;r<e.length;++r)t[i+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(m,1,0);if(n.isString(e)){var i=d.alloc(t=a.length(e));a.decode(e,i,0),e=i}return this.uint32(t)._push(y,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(m,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=h(),r._configure()}},43155:(e,t,i)=>{"use strict";e.exports=o;var r=i(41173);(o.prototype=Object.create(r.prototype)).constructor=o;var n=i(99693);function o(){r.call(this)}function a(e,t,i){e.length<40?n.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}o._configure=function(){o.alloc=n._Buffer_allocUnsafe,o.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var r=0;r<e.length;)t[i++]=e[r++]}},o.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},82582:function(e){e.exports=function(){"use strict";function e(e,r,n,o,a){!function e(i,r,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,l=r-n+1,c=Math.log(s),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(s-u)/s)*(l-s/2<0?-1:1);e(i,r,Math.max(n,Math.floor(r-l*u/s+d)),Math.min(o,Math.floor(r+(s-l)*u/s+d)),a)}var h=i[r],m=n,p=o;for(t(i,n,r),a(i[o],h)>0&&t(i,n,o);m<p;){for(t(i,m,p),m++,p--;a(i[m],h)<0;)m++;for(;a(i[p],h)>0;)p--}0===a(i[n],h)?t(i,n,p):t(i,++p,o),p<=r&&(n=p+1),r<=p&&(o=p-1)}}(e,r,n||0,o||e.length-1,a||i)}function t(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function i(e,t){return e<t?-1:e>t?1:0}var r=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(e,t,i){if(!i)return t.indexOf(e);for(var r=0;r<t.length;r++)if(i(e,t[r]))return r;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,i,r,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o=t;o<i;o++){var a=e.children[o];s(n,e.leaf?r(a):a)}return n}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,i,r,n,o){for(var a=[i,r];a.length;)if(!((r=a.pop())-(i=a.pop())<=n)){var s=i+Math.ceil((r-i)/n/2)*n;e(t,s,i,r,o),a.push(i,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(e){var t=this.data,i=[];if(!m(e,t))return i;for(var r=this.toBBox,n=[];t;){for(var o=0;o<t.children.length;o++){var a=t.children[o],s=t.leaf?r(a):a;m(e,s)&&(t.leaf?i.push(a):h(e,s)?this._all(a,i):n.push(a))}t=n.pop()}return i},r.prototype.collides=function(e){var t=this.data;if(!m(e,t))return!1;for(var i=[];t;){for(var r=0;r<t.children.length;r++){var n=t.children[r],o=t.leaf?this.toBBox(n):n;if(m(e,o)){if(t.leaf||h(e,o))return!0;i.push(n)}}t=i.pop()}return!1},r.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},r.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(e,t){if(!e)return this;for(var i,r,o,a=this.data,s=this.toBBox(e),l=[],c=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],i=c.pop(),o=!0),a.leaf){var u=n(e,a.children,t);if(-1!==u)return a.children.splice(u,1),l.push(a),this._condense(l),this}o||a.leaf||!h(a,s)?r?(i++,a=r.children[i],o=!1):a=null:(l.push(a),c.push(i),i=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(e){return e},r.prototype.compareMinX=function(e,t){return e.minX-t.minX},r.prototype.compareMinY=function(e,t){return e.minY-t.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(e){return this.data=e,this},r.prototype._all=function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},r.prototype._build=function(e,t,i,r){var n,a=i-t+1,s=this._maxEntries;if(a<=s)return o(n=p(e.slice(t,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(n=p([])).leaf=!1,n.height=r;var l=Math.ceil(a/s),c=l*Math.ceil(Math.sqrt(s));f(e,t,i,c,this.compareMinX);for(var u=t;u<=i;u+=c){var d=Math.min(u+c-1,i);f(e,u,d,l,this.compareMinY);for(var h=u;h<=d;h+=l){var m=Math.min(h+l-1,d);n.children.push(this._build(e,h,m,r-1))}}return o(n,this.toBBox),n},r.prototype._chooseSubtree=function(e,t,i,r){for(;r.push(t),!t.leaf&&r.length-1!==i;){for(var n=1/0,o=1/0,a=void 0,s=0;s<t.children.length;s++){var l=t.children[s],c=u(l),d=(h=e,m=l,(Math.max(m.maxX,h.maxX)-Math.min(m.minX,h.minX))*(Math.max(m.maxY,h.maxY)-Math.min(m.minY,h.minY))-c);d<o?(o=d,n=c<n?c:n,a=l):d===o&&c<n&&(n=c,a=l)}t=a||t.children[0]}var h,m;return t},r.prototype._insert=function(e,t,i){var r=i?e:this.toBBox(e),n=[],o=this._chooseSubtree(r,this.data,t,n);for(o.children.push(e),s(o,r);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(r,n,t)},r.prototype._split=function(e,t){var i=e[t],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var a=this._chooseSplitIndex(i,n,r),s=p(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,o(i,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(i,s)},r.prototype._splitRoot=function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(e,t,i){for(var r,n,o,s,l,c,d,h=1/0,m=1/0,p=t;p<=i-t;p++){var f=a(e,0,p,this.toBBox),g=a(e,p,i,this.toBBox),y=(n=f,o=g,void 0,void 0,void 0,void 0,s=Math.max(n.minX,o.minX),l=Math.max(n.minY,o.minY),c=Math.min(n.maxX,o.maxX),d=Math.min(n.maxY,o.maxY),Math.max(0,c-s)*Math.max(0,d-l)),v=u(f)+u(g);y<h?(h=y,r=p,m=v<m?v:m):y===h&&v<m&&(m=v,r=p)}return r||i-t},r.prototype._chooseSplitAxis=function(e,t,i){var r=e.leaf?this.compareMinX:l,n=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,i,r)<this._allDistMargin(e,t,i,n)&&e.children.sort(r)},r.prototype._allDistMargin=function(e,t,i,r){e.children.sort(r);for(var n=this.toBBox,o=a(e,0,t,n),l=a(e,i-t,i,n),c=d(o)+d(l),u=t;u<i-t;u++){var h=e.children[u];s(o,e.leaf?n(h):h),c+=d(o)}for(var m=i-t-1;m>=t;m--){var p=e.children[m];s(l,e.leaf?n(p):p),c+=d(l)}return c},r.prototype._adjustParentBBoxes=function(e,t,i){for(var r=i;r>=0;r--)s(t[r],e)},r.prototype._condense=function(e){for(var t=e.length-1,i=void 0;t>=0;t--)0===e[t].children.length?t>0?(i=e[t-1].children).splice(i.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},r}()},37319:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(18894),t)},18894:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CoverageTileDecoderService=t.CoverageTileDecoder=t.CoverageImageType=t.InfoRequestType=void 0;const r=i(96500),n=i(17550),o=i(32941),a=i(19955),s=i(14352),l=i(84428),c=i(754),u=i(53172);var d,h;!function(e){e.EXTRACTED_HEATMAP="extracted-heat-map"}(d=t.InfoRequestType||(t.InfoRequestType={})),function(e){e.BITMAP="bitmap",e.SIZEMAP="sizemap",e.TIMEMAP="timemap"}(h=t.CoverageImageType||(t.CoverageImageType={}));class m{constructor(e){this.m_config=e,this.m_geometries=[],this.m_tempLineVertices=new Float32Array(24).fill(0),this.m_tempFillVertices=new Float32Array(18).fill(0),this.m_tempTileBounds=new l.Box3,this.GRID_VERTEX_DATA=new Uint8Array([0,0,1,1,2,2,3,3]);const t=this.m_config.tilingScheme.getGeoBox(e.tileKey),i=this.m_config.projection.projectBox(t,new l.Box3);this.m_center=new l.Vector3,i.getCenter(this.m_center)}getDecodedTile(e){var t;return this.createHeatmapGeometry(null!==(t=e.tileKeysHeatmap)&&void 0!==t?t:e.tileKeys,e.sizemapData,e.dataLevel),e.drawStaticObject||this.createTileGrid(e.tileKeys),{geometries:this.m_geometries,techniques:this.m_config.styleSetEvaluator.decodedTechniques}}createTileGrid(e){const t=new Float32Array(24*e.length),i=new Float32Array(18*e.length),a=new Uint16Array(24*e.length),s=new Uint16Array(18*e.length),l=new Uint8Array(8*e.length),c=new Uint16Array(3);for(let r=0;r<e.length;r++){const n=o.TileKey.fromMortonCode(e[r]),u=this.getTileBounds(n);t.set(this.getLineVertices(u),24*r),i.set(this.getFillVertices(u),18*r),c[0]=n.row,c[1]=n.column,c[2]=n.level;for(let e=0;e<8;e++)a.set(c,24*r+3*e);for(let e=0;e<6;e++)s.set(c,18*r+3*e);l.set(this.GRID_VERTEX_DATA,8*r)}const u=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"coverageGrid"}));if(u.length){const e=u[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'coverageGrid'");this.m_geometries.push({type:r.GeometryType.Line,uuid:`${this.m_config.tileKey.mortonCode()}-grid`,vertexAttributes:[{name:"position",buffer:t.buffer,type:"float",itemCount:3},{name:"tileKeyData",buffer:a.buffer,type:"uint16",itemCount:3,normalized:!1},{name:"vertexData",buffer:l.buffer,type:"uint8",itemCount:1,normalized:!1}],groups:[{start:0,count:0,technique:e}],tileCode:this.m_config.tileKey.mortonCode()})}const d=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"coverageFill"}));if(d.length){const e=d[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'coverageFill'");this.m_geometries.push({type:r.GeometryType.Polygon,uuid:`${this.m_config.tileKey.mortonCode()}-fill`,vertexAttributes:[{name:"position",buffer:i.buffer,type:"float",itemCount:3},{name:"tileKeyData",buffer:s.buffer,type:"uint16",itemCount:3,normalized:!1}],groups:[{start:0,count:0,technique:e}],tileCode:this.m_config.tileKey.mortonCode()})}}getTileBounds(e){const t=this.m_config.tilingScheme.getGeoBox(e),i=this.m_config.projection.projectBox(t,this.m_tempTileBounds);return i.min.sub(this.m_center),i.max.sub(this.m_center),i}getLineVertices(e){return this.m_tempLineVertices[0]=e.min.x,this.m_tempLineVertices[1]=e.min.y,this.m_tempLineVertices[3]=e.max.x,this.m_tempLineVertices[4]=e.min.y,this.m_tempLineVertices[6]=e.max.x,this.m_tempLineVertices[7]=e.min.y,this.m_tempLineVertices[9]=e.max.x,this.m_tempLineVertices[10]=e.max.y,this.m_tempLineVertices[12]=e.max.x,this.m_tempLineVertices[13]=e.max.y,this.m_tempLineVertices[15]=e.min.x,this.m_tempLineVertices[16]=e.max.y,this.m_tempLineVertices[18]=e.min.x,this.m_tempLineVertices[19]=e.max.y,this.m_tempLineVertices[21]=e.min.x,this.m_tempLineVertices[22]=e.min.y,this.m_tempLineVertices}getFillVertices(e){return this.m_tempFillVertices[0]=e.min.x,this.m_tempFillVertices[1]=e.min.y,this.m_tempFillVertices[3]=e.max.x,this.m_tempFillVertices[4]=e.min.y,this.m_tempFillVertices[6]=e.max.x,this.m_tempFillVertices[7]=e.max.y,this.m_tempFillVertices[9]=e.max.x,this.m_tempFillVertices[10]=e.max.y,this.m_tempFillVertices[12]=e.min.x,this.m_tempFillVertices[13]=e.max.y,this.m_tempFillVertices[15]=e.min.x,this.m_tempFillVertices[16]=e.min.y,this.m_tempFillVertices}createHeatmapGeometry(e,t,i){if(0===e.length)return;let a,s=!1;const l=o.TileKey.fromMortonCode(e[0]).level,c=new o.TileKey(0,0,l).mortonCode();void 0!==t&&void 0!==t[l]&&(a=t[l].heatMap,void 0!==t[l].min&&t[l].min===t[l].max&&(s=!0));let d=0;l===i&&(d=u.getTileKeysOnLevel(this.m_config.tileKey,o.TileKey.fromMortonCode(e[0]).level)[0].mortonCode()-c);const h=new Float32Array(18*e.length),m=new Uint8Array(6*e.length).fill(255),p=new Uint16Array(18*e.length).fill(0);for(let t=0,i=e.length;t<i;t++){const i=e[t],r=o.TileKey.fromMortonCode(i),n=this.getTileBounds(r),l=this.getFillVertices(n);if(h.set(l,18*t),void 0!==a&&!s){const e=a[i-c-d];m.fill(e,6*t,6*t+6)}p[18*t+0]=r.row,p[18*t+1]=r.column,p[18*t+2]=r.level}const f=[];f.push({name:"position",buffer:h.buffer,type:"float",itemCount:3}),m.length>0&&f.push({name:"sizeData",buffer:m.buffer,type:"uint8",itemCount:1,normalized:!1}),f.push({name:"tileKeyData",buffer:p.buffer,type:"uint16",itemCount:3,normalized:!1});const g=this.m_config.styleSetEvaluator.getMatchingTechniques(new n.MapEnv({type:"heatmap"}));if(g.length){const e=g[0]._index;if(void 0===e)throw new Error("Internal error - No technique index for the 'heatmap'");this.m_geometries.push({uuid:`${this.m_config.tileKey.mortonCode()}-heatmap`,type:r.GeometryType.Polygon,vertexAttributes:f,groups:[{start:0,count:0,technique:e}],tileCode:0})}}}class p extends a.ThemedTileDecoder{constructor(){super(...arguments),this.m_extractedData=new Map,this.m_imageData=new Map,this.m_tilesWithDataMap=new Map,this.m_tileKey4SubTiles=[],this.m_tileKey5SubTiles=[],this.m_imageDataLevel=new Map,this.m_levelsWithData=[]}async connect(){}async decodeTile(e,t,i){const r=e;if(!0===r.drawStaticObject&&r.tileKeys.length){const e=[];4===t.mortonCode()?s.appendToArray(e,this.m_tileKey4SubTiles):s.appendToArray(e,this.m_tileKey5SubTiles),r.tileKeys=e}const o=JSON.parse(JSON.stringify(c.coverageTheme)),a=new n.StyleSetEvaluator({styleSet:o.styles});return this.decodeThemedTile(r,t,a,i)}async decodeThemedTile(e,t,i,r){const n=new m({tileKey:t,projection:r,styleSetEvaluator:i,tilingScheme:o.hereTilingScheme});if(1!==t.level&&this.m_levelsWithData.length>1){e.tileKeysHeatmap=[];for(const i of this.m_levelsWithData)if(i>t.level+3){const r=this.m_tilesWithDataMap.get(i);if(!r||0===r.length)continue;const n=u.getTileKeysOnLevel(t,Math.min(i,u.MAX_LEVEL_WITH_DATA)).map((e=>e.mortonCode()));if(r.length<n.length)for(const t of r)-1!==n.indexOf(t)&&e.tileKeysHeatmap.push(t);else for(const t of n)-1!==r.indexOf(t)&&e.tileKeysHeatmap.push(t)}}else 1!==t.level||e.drawStaticObject||(e.tileKeysHeatmap=[],4===t.mortonCode()?s.appendToArray(e.tileKeysHeatmap,this.m_tileKey4SubTiles):s.appendToArray(e.tileKeysHeatmap,this.m_tileKey5SubTiles));return n.getDecodedTile(e)}async getTileInfo(e,t,i){if(void 0===this.m_extractedData.get(h.SIZEMAP)){const e=this.m_imageData.get(h.SIZEMAP),t=this.m_imageDataLevel.get(h.SIZEMAP);void 0!==e&&void 0!==t&&this.m_extractedData.set(h.SIZEMAP,this.extractData(e,t))}if(void 0===this.m_extractedData.get(h.TIMEMAP)){const e=this.m_imageData.get(h.TIMEMAP),t=this.m_imageDataLevel.get(h.TIMEMAP);void 0!==e&&void 0!==t&&this.m_extractedData.set(h.TIMEMAP,this.extractData(e,t))}let r;if(this.isCoverageTileInfoRequest(e)){if(e.requestType===d.EXTRACTED_HEATMAP){const i=this.m_extractedData.get(e.imageType);r={setupTime:0,numBytes:0,tileKey:t,transferList:void 0!==i?[i.buffer]:void 0}}}else r=await super.getTileInfo(e,t,i);return r}configure(e,t){super.configure(e,t),void 0!==t&&(this.m_imageData.set(t.imageType,t.imageData),this.m_imageDataLevel.set(t.imageType,t.imageDataLevel),this.m_extractedData.delete(t.imageType),t.tilesWithDataMap&&(this.m_tilesWithDataMap=new Map(t.tilesWithDataMap)),t.tileKey4SubTiles&&(this.m_tileKey4SubTiles=t.tileKey4SubTiles),t.tileKey5SubTiles&&(this.m_tileKey5SubTiles=t.tileKey5SubTiles),t.levelsWithData&&(this.m_levelsWithData=t.levelsWithData))}isCoverageTileInfoRequest(e){return"requestType"in e&&"imageType"in e}extractData(e,t){const i=new o.TileKey(0,0,t).mortonCode(),r=o.hereTilingScheme.subdivisionScheme.getLevelDimensionX(t),n=o.hereTilingScheme.subdivisionScheme.getLevelDimensionY(t),a=new o.TileKey(n,r,t).mortonCode(),s=new Uint8ClampedArray(a-i);for(let a=0,l=e.length;a<l;a++){let l=0;a>0&&(l=Math.floor(a/r));const c=a-l*r;s[o.TileKey.fromRowColumnLevel(n-l-1,c,t).mortonCode()-i]=255-e[a]}return s}}t.CoverageTileDecoder=p,p.MORTON_CODE_4_SUB_TILES_FROM=4194304,p.MORTON_CODE_4_SUB_TILES_TO=5242879,p.MORTON_CODE_5_SUB_TILES_FROM=5242880,p.MORTON_CODE_5_SUB_TILES_TO=6291455,t.CoverageTileDecoderService=class{static start(){a.WorkerServiceManager.getInstance().register({serviceType:"coverage-tile-decoder",factory:e=>a.TileDecoderService.start(e,new p)})}}},53172:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTileKeysOnLevel=t.MAX_LEVEL_WITH_DATA=void 0;const r=i(32941);t.MAX_LEVEL_WITH_DATA=11,t.getTileKeysOnLevel=function e(t,i){const n=[],o=r.hereTilingScheme.getSubTileKeys(t);for(const t of o)if(t.level<i)for(const r of e(t,i))n.push(r);else n.push(t);return n}},34568:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCoverageFillShader=void 0;const r=i(84428);t.getCoverageFillShader=function(e){return{transparent:!0,depthTest:!0,depthWrite:!1,vertexShader:"attribute vec3 tileKeyData;\n\n        uniform vec3 uColor;\n        uniform vec3 uHoverColor;\n        uniform vec3 uSelectedColor;\n        uniform vec3 uSelectedHoverColor;\n\n        uniform float uOpacity;\n        uniform float uSelectedOpacity;\n\n        uniform vec3 uHighlightedTile;\n        uniform vec3 uSelectedTiles[256];\n\n        varying vec3 vColor;\n        varying float vOpacity;\n\n        bool isTileSelected(in vec3 tileData) {\n            for (int i = 0; i < 256; ++i) {\n                if (uSelectedTiles[i] == tileData) {\n                    return(true);\n                }\n            }\n\n            return(false);\n        }\n\n        void main() {\n            vColor = uColor;\n            vOpacity = uOpacity;\n\n            if (tileKeyData == uHighlightedTile) {\n                if (isTileSelected(tileKeyData)) {\n                    vColor = uSelectedHoverColor;\n                    vOpacity = uSelectedOpacity;\n                } else {\n                    vColor = uHoverColor;\n                }\n            } else if (isTileSelected(tileKeyData)) {\n                vColor = uSelectedColor;\n                vOpacity = uSelectedOpacity;\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"varying float vOpacity;\n            varying vec3 vColor;\n\n            void main() {\n                gl_FragColor = vec4(vColor, vOpacity);\n            }",uniforms:{uColor:{type:"vec3",value:new r.Color(e.color).toArray()},uHoverColor:{type:"vec3",value:new r.Color(e.hoverColor).toArray()},uOpacity:{type:"f",value:e.opacity},uSelectedColor:{type:"vec3",value:new r.Color(e.selectedColor).toArray()},uSelectedHoverColor:{type:"vec3",value:new r.Color(e.selectedHoverColor).toArray()},uSelectedOpacity:{type:"f",value:e.selectedOpacity},uHighlightedTile:{type:"vec3",value:new r.Vector3(0,0,0)},uSelectedTiles:{type:"fv",value:new Array(768).fill(0)}}}}},96780:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCoverageGridShader=void 0;const r=i(84428);t.getCoverageGridShader=function(e){return{transparent:!0,depthTest:!1,vertexShader:"attribute vec3 tileKeyData;\n        attribute float vertexData;\n\n        uniform vec3 uColor;\n        uniform vec3 uHighlightColor;\n        uniform vec3 uSelectedColor;\n        uniform vec3 uSelectedHoverColor;\n\n        uniform vec3 uHighlightedTile;\n        uniform vec3 uLastSelectedTile;\n\n        varying vec3 vColor;\n\n        bool vertexTouchesTile(vec3 vertex, vec3 tile) {\n            if (vertex.z != tile.z) {\n                return(false);\n            }\n\n            if (vertex.x == tile.x) {\n                // same row\n\n                if (vertex.y == tile.y - 1.0) {\n                    // tile to the left\n                    if (vertexData == 1.0) {\n                        return(true);\n                    }\n                }\n\n                if (vertex.y == tile.y + 1.0) {\n                    // tile to the right\n                    if (vertexData == 3.0) {\n                        return(true);\n                    }\n                }\n            }\n\n            if (vertex.y == tile.y) {\n                // same column\n\n                if (vertex.x == tile.x - 1.0) {\n                    // tile below\n                    if (vertexData == 2.0) {\n                        return(true);\n                    }\n                }\n\n                if (vertex.x == tile.x + 1.0) {\n                    // tile above\n                    if (vertexData == 0.0) {\n                        return(true);\n                    }\n                }\n            }\n\n            return(false);\n        }\n\n        bool isLastSelectedTile(in vec3 tileData) {\n            if (tileData == uLastSelectedTile) {\n                return(true);\n            }\n\n            return(false);\n        }\n\n        bool isTileHighlighted(in vec3 tileData) {\n            if (tileData == uHighlightedTile || vertexTouchesTile(tileData, uHighlightedTile)) {\n                return(true);\n            }\n\n            return(false);\n        }\n\n        void main() {\n            vColor = uColor;\n\n            bool isLastSelected = isLastSelectedTile(tileKeyData);\n            bool isHighlighted = isTileHighlighted(tileKeyData);\n\n            if (isHighlighted) {\n                vColor = uHighlightColor;\n            }\n\n            if (isLastSelected || vertexTouchesTile(tileKeyData, uLastSelectedTile)) {\n                vColor = uSelectedHoverColor;\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"uniform float uOpacity;\n\n            varying vec3 vColor;\n\n            void main() {\n                gl_FragColor = vec4(vColor, uOpacity);\n            }",uniforms:{uColor:{type:"vec3",value:new r.Color(e.borderColor).toArray()},uOpacity:{type:"f",value:e.borderOpacity},uHighlightColor:{type:"vec3",value:new r.Color(e.highlightColor).toArray()},uSelectedColor:{type:"vec3",value:new r.Color(e.selectedColor).toArray()},uSelectedHoverColor:{type:"vec3",value:new r.Color(e.selectedHoverColor).toArray()},uHighlightedTile:{type:"vec3",value:new r.Vector3(0,0,0)},uLastSelectedTile:{type:"vec3",value:new r.Vector3(0,0,0)}}}}},47957:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHeatmapShader=void 0;const r=i(84428);t.getHeatmapShader=function(e){return{transparent:!0,depthTest:!0,vertexShader:"attribute float sizeData;\n\n        uniform vec3 uCoverageColor;\n        uniform float uOpacity;\n        uniform float uSizeMapOpacity;\n        uniform float uMaxSize;\n        uniform int uShowSizeMap;\n        uniform vec3 uGradientColor1;\n        uniform vec3 uGradientColor2;\n        uniform vec3 uGradientColor3;\n        uniform int uGradientMode;\n\n        varying vec4 vColor;\n\n        void main() {\n            vColor = vec4(uCoverageColor, uOpacity);\n\n            if (uShowSizeMap == 1) {\n                if(uGradientMode == 0) {\n                    float red = 1.0;\n                    float green = 1.0;\n                    float blue = 0.0;\n\n                    float scale = uMaxSize / 4.0;\n                    if (sizeData > scale) {\n                        green = 1.0 - (sizeData - scale) / scale / 3.0;\n                    } else {\n                        blue = 1.0 - sizeData / scale;\n                    }\n\n                    vColor = vec4(red, green, blue, uSizeMapOpacity);\n                } else {\n                    vColor = mix(\n                        vec4(0.0, 0.0, 0.0, uSizeMapOpacity),\n                        vec4(1.0, 1.0, 1.0, uSizeMapOpacity),\n                        sizeData / uMaxSize\n                    );\n                }\n            }\n\n            vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n            gl_Position = projectionMatrix * mvPosition;\n        }",fragmentShader:"uniform int uIsHidden;\n            varying vec4 vColor;\n\n            void main() {\n                if (uIsHidden == 1) {\n                    discard;\n                } else {\n                    gl_FragColor = vColor;\n                }\n            }",uniforms:{uCoverageColor:{type:"vec3",value:new r.Color(e.fillColor).toArray()},uGradientColor1:{type:"vec3",value:new r.Color("#FF0000").toArray()},uGradientColor2:{type:"vec3",value:new r.Color("#00FF00").toArray()},uGradientColor3:{type:"vec3",value:new r.Color("#0000FF").toArray()},uMaxSize:{type:"f",value:255},uOpacity:{type:"f",value:e.opacity},uSizeMapOpacity:{type:"f",value:e.opacity},uShowSizeMap:{type:"i",value:0},uIsHidden:{type:"i",value:1},uGradientMode:{type:"i",value:0}}}}},754:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coverageTheme=void 0;const r=i(34568),n=i(96780),o=i(47957);t.coverageTheme={name:"coverage",styles:[{when:"type == 'coverageGrid'",renderOrder:2199,technique:"shader",attr:{params:n.getCoverageGridShader({borderColor:"#48DAD0",borderOpacity:1,highlightColor:"#D1F6F3",selectedColor:"#FBCA40",selectedHoverColor:"#FCDB7F"}),primitive:"segments"}},{when:"type == 'coverageFill'",renderOrder:2190,technique:"shader",attr:{params:r.getCoverageFillShader({color:"#48DAD0",hoverColor:"#48DAD0",opacity:0,selectedColor:"#48DAD0",selectedHoverColor:"#48DAD0",selectedOpacity:.1}),primitive:"mesh"}},{when:"type == 'heatmap'",renderOrder:2191,technique:"shader",attr:{params:o.getHeatmapShader({fillColor:"#49FFDC",opacity:.2}),primitive:"mesh"}}]}},49221:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DecoderService=void 0;const r=i(19955);class n extends r.TileDecoderService{constructor(e,t){super(e,t),this.decoder=t}async handleRequest(e){return this.isDecodingRequest(e)?this.handleDecodingRequest(e):super.handleRequest(e)}async handleDecodingRequest(e){return{response:await this.decoder.decode(e.data)}}isDecodingRequest(e){return e&&"decode"===e.type}}t.DecoderService=n},38233:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},89707:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HmcOmvDependencyHelper=void 0;const r=i(99017),n=i(24762),o=i(76919);class a{static getHmcHrnsCurrentEnvironment(){return this.getHmcHrnsByEnvironment(this.lookupServiceEnvironment)}static getHmcHrnsByEnvironment(e){const t=[],i=this.envHmcOmvDependencies.get(e);if(void 0!==i)for(const e of i)void 0!==e.hmc&&t.push(e.hmc),void 0!==e.hmcWithoutRealm&&t.push(e.hmcWithoutRealm);return t}static getDefaultHmcOmvDependendency(){return a.getDefaultHmcOmvDependency()}static getDefaultHmcOmvDependency(e="here"){const t=this.envHmcOmvDependencies.get(e);if(void 0!==t)for(const e of t)if(!0===e.default)return e}static getDependencyByHmc(e){for(const[,t]of this.envHmcOmvDependencies){const i=t.find((t=>t.hmc===e||t.hmcWithoutRealm===e));if(void 0!==i)return i}}static async getTopologyGeometryDataProviderParams(e,t,i){const{environment:s,token:l}=t,c=a.getDefaultHmcOmvDependency(s);if(e instanceof r.InMemoryDataProvider)return void 0!==c&&void 0!==c.hmc?{hrn:c.hmc,layer:"topology-geometry",environment:s,getToken:l}:void 0;if(!(e instanceof n.PlatformDataProvider))return;e.ready||await e.connect();const{hrn:u,layerId:d,layer:h}=e,m=a.getHmcHrnsByEnvironment(s);let p,f;if(m.includes(u))p=u,f=h instanceof o.VersionedLayer?h.version:-1;else{let t=[];const{catalog:r}=e;if(void 0!==r&&h instanceof o.VersionedLayer){const e=h.version;try{t=(await r.getVersionsInfo(e-1,e))[0].dependencies.filter((e=>m.includes(e.hrn)))}catch(e){i.warn(`Can't get the catalog dependencies: "${u}", layer "${d}"`)}}if(1===t.length)p=t[0].hrn,f=t[0].version;else{let e;void 0!==c&&(e=t.find((e=>e.hrn===c.hmc||e.hrn===c.hmcWithoutRealm))),t.length>1&&void 0===e&&(e=t[0]),void 0!==e&&(p=e.hrn,f=e.version)}}const g={hrn:"",layer:"topology-geometry",catalogVersion:f,environment:s,getToken:l};if(void 0!==p){const e=new n.PlatformDataProvider(Object.assign(Object.assign({},g),{hrn:p}));if(await e.connect(),void 0!==e.layer)return g.hrn=p,g;i.warn(`Can't get the HMC layer: "${p}"`)}if(void 0!==c&&void 0!==c.hmc)return i.warn(`Fallback to the default HMC: ${c.hmc}`),g.hrn=c.hmc,g;i.warn("No HMC is available")}}t.HmcOmvDependencyHelper=a,a.storeKey="di-omv-plus-selection-list",a.oldStoreKey="di-omv-selection-list",a.lookupServiceEnvironment="here",a.envHmcOmvDependencies=new Map([["here",[{omv:"hrn:here:data::olp-here:here-optimized-map-for-visualization-plus-2",omvLayer:"omv-plus-v2",hmc:"hrn:here:data::olp-here:rib-2",hmcWithoutRealm:"hrn:here:data:::rib-2",default:!0},{omv:"hrn:here:data::olp-here:here-optimized-map-for-visualization-plus-japan-2",omvLayer:"omv-plus-v2",hmc:"hrn:here:data::olp-here:here-map-content-japan-2",hmcWithoutRealm:"hrn:here:data:::here-map-content-japan-2"},{omv:"hrn:here:data::olp-here:here-optimized-map-for-visualization-plus-2",omvLayer:"omv-plus-v2",hmc:"hrn:here:data::olp-here:rib-services-2",hmcWithoutRealm:"hrn:here:data:::rib-services-2"}]],["here-dev",[{omv:"hrn:here-dev:data::olp-here:germany-test-omv-2-base",omvLayer:"omv-base-v2",default:!0}]],["here-cn",[{omv:"hrn:here-cn:data::olp-cn-here:here-optimized-map-for-visualization-plus-china-2",omvLayer:"omv-plus-v2",hmc:"hrn:here-cn:data::olp-cn-here:here-map-content-china-2",hmcWithoutRealm:"hrn:here-cn:data:::here-map-content-china-2",default:!0}]]])},48209:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveDataSource=void 0;const r=i(32941),n=i(45772),o=i(19898),a=i(38338),s=i(99017),l=i(81450),c=i(64135),u=i(82246),d=i(42589),h=i(23086),m=i(30860),p=i(19160),f=i(53592),g=i(92533),y=i(76919),v=i(54278);class _ extends o.TileDataSource{constructor(e,t){var i,l;super(new o.TileFactory(e),Object.assign(t,{dataProvider:t.dataProvider||new s.InMemoryDataProvider,styleSetName:t.styleSetName||"",tilingScheme:t.tilingScheme||r.hereTilingScheme,concurrentDecoderScriptUrl:t.decoderUrl})),this.tileType=e,this.params=t,this.cacheable=!1,this.m_partitionsToRender=new Set,this.m_tileCacheSize=64,this.m_tileSelectionLimit=Math.min(this.tileCacheSize,64),this.m_partitionsToRefresh=new Set,this.m_featureFilters=[],this.m_invalidPartitions=new Set,this.m_isInteractiveDataSourceReady=!1,this.m_showGrid=!0,this.m_enable3DRendering=!1,this.m_showLayerGeometry=!0,this.onCatalogVersionChange=()=>{this.refreshTiles(),this.requestUpdate()},this.handleFeatureHighlight=e=>{const t=e;if(t.intersected&&void 0!==t.intersection){const e=t.intersection.object;this.highlightFeature(e,this.getFeatureObject(e),t),this.m_highlightedFeatureIndex=t.intersection.index}else this.unhighlightFeature();this.requestUpdate()},this.handleFeatureSelect=e=>{const t=e;if(t.intersected&&void 0!==t.intersection){const e=t.intersection.object,i=this.getFeatureObject(e);if(void 0!==i){this.selectFeature(i,t);const{partitionId:r}=e;this.m_selectedFeaturePartitionId=r}}else this.deselectFeature();this.requestUpdate()},this.handleFeatureDeselect=e=>{this.deselectFeature(),this.requestUpdate()};const c=this.params.dataProvider;void 0!==c&&(this.decoder instanceof p.InteractiveWorkerDecoder||this.decoder instanceof m.InteractiveTileDecoder)&&c.setDecoder(this.decoder),this.logger=a.LoggerManager.instance.create(this.getLoggerName(),{enabled:!0}),this.m_enableRefresh=t.enableRefresh,this.m_tileCache=new n.LRUCache(this.m_tileCacheSize),this.m_tileCache.evictionCallback=(e,t)=>t.dispose(),void 0!==t.intersectionAgent&&this.setUpIntersectionAgent(t.intersectionAgent),void 0===t.levelsWithData||0===t.levelsWithData.length?void 0!==t.levelWithData?(this.m_levelsWithData=[t.levelWithData],this.m_levelWithData=t.levelWithData):(this.m_levelsWithData=[14],this.m_levelWithData=14,this.logger.warn("Level with data not specified, by default level 14 will be used.")):(this.m_levelWithData=t.levelsWithData[0],this.m_levelsWithData=[...t.levelsWithData]),this.minDisplayLevel=0,this.maxDisplayLevel=24,this.minDataLevel=0,this.maxDataLevel=0,this.useGeometryLoader=!1,this.isSelected=null!==(i=t.isSelected)&&void 0!==i&&i,this.isPrimary=null!==(l=t.isPrimary)&&void 0!==l&&l}set lastSelectedTile(e){this.m_lastSelectedPartition=e}get lastSelectedTile(){return this.m_lastSelectedPartition}set showLayerGeometry(e){this.m_showLayerGeometry=e}get showLayerGeometry(){return this.m_showLayerGeometry}set showGrid(e){this.m_showGrid=e}get showGrid(){return this.m_showGrid}set lastSelectedPartition(e){this.m_lastSelectedPartition=e}get lastSelectedPartition(){return this.m_lastSelectedPartition}get levelWithData(){return this.m_levelWithData}set levelWithData(e){this.m_levelWithData=e,this.levelsWithData=[e]}set levelsWithData(e){this.m_levelsWithData=[...e],Object.freeze(this.m_levelsWithData),this.dispatchEvent({type:_.DATA_LEVEL_CHANGED,level:e[0],levels:e})}get levelsWithData(){return this.m_levelsWithData}get selectedTiles(){return this.m_partitionsToRender}get selectedPartitions(){return this.m_partitionsToRender}get enableRefresh(){return!!this.m_enableRefresh}get featureFilters(){return this.m_featureFilters}get tileCacheSize(){return this.m_tileCacheSize}get tileSelectionLimit(){return this.m_tileSelectionLimit}get enable3DRendering(){return this.m_enable3DRendering}set enable3DRendering(e){this.m_enable3DRendering=e,this.refreshTiles()}dataProvider(){return super.dataProvider()}highlightFeature(e,t,i){this.dispatchEvent({type:_.EVENT_FEATURE_HIGHLIGHT,featureObject:t,intersectionEvent:i})}unhighlightFeature(){this.m_highlightedFeatureId=void 0,this.dispatchEvent({type:_.EVENT_FEATURE_UNHIGHLIGHT})}selectFeature(e,t){this.requestUpdate(),this.dispatchEvent({type:_.EVENT_FEATURE_SELECT,featureObject:e,intersectionEvent:t})}deselectFeature(){this.requestUpdate(),this.dispatchEvent({type:_.EVENT_FEATURE_DESELECT,featureId:this.m_selectedFeatureId}),this.m_selectedFeatureId=void 0}attach(e){super.attach(e),this.dispatchEvent({type:_.EVENT_ATTACHED})}async connect(){await super.connect();const{schemaProviderOptions:e,dataProvider:t}=this.params,i=null==t?void 0:t.layer;if(i instanceof y.VersionedLayer&&i.addEventListener(y.VersionedLayer.ON_VERSION_CHANGE,this.onCatalogVersionChange),t instanceof s.InMemoryDataProvider&&void 0===e||e&&!1===e.enabled)return this.m_isInteractiveDataSourceReady=!0,void this.refreshTiles();this.m_initialSchemaProvider=await this.createSchemaProvider();let r=this.params.schemaProvider;void 0===r&&(r=this.m_initialSchemaProvider);const n=r.getProtobufRoot(),o=r.getSchemaId();if(void 0!==o&&null!==n){const e={schemaId:o,serializedRoot:n.toJSON()};this.configureTileDecoder(void 0,e)}void 0!==t&&t.setSchemaProvider(r),this.m_isInteractiveDataSourceReady=!0,this.refreshTiles()}dispose(){const e=this.m_intersectionAgent;void 0!==e&&(e.removeEventListener(g.InteractiveIntersectionAgent.EVENT_OBJECT_SELECT,this.handleFeatureSelect),e.removeEventListener(g.InteractiveIntersectionAgent.EVENT_NOTHING_SELECTED,this.handleFeatureDeselect),e.removeEventListener(g.InteractiveIntersectionAgent.EVENT_INTERSECTION_CHANGE,this.handleFeatureHighlight)),super.dispose()}ready(){return this.m_isInteractiveDataSourceReady}async resetDataProvider(e,t=!1){e.ready()||await e.connect(),this.params.dataProvider=e,t&&(this.m_tileCache.evictAll(),this.resetComposedTile())}schemaProvider(){return this.dataProvider().getSchemaProvider()}setSchemaProvider(e){this.dataProvider().setSchemaProvider(e),this.m_tileCache.evictAll()}initialSchemaProvider(){return this.m_initialSchemaProvider}isCustomSchemaUsed(){const e=this.schemaProvider();return void 0!==e&&void 0!==this.m_initialSchemaProvider?e.getSchemaId()!==this.m_initialSchemaProvider.getSchemaId():void 0!==e||void 0!==this.m_initialSchemaProvider}hasTileToRender(e){return this.selectedPartitions.has(e)||this.selectedPartitions.has(+e)}getIntersectionAgent(){return this.m_intersectionAgent}getFeatureObject(e){return e}findFeatures(e,t){return this.m_intersectionAgent?this.m_intersectionAgent.raycastIntersections(e,t).map((e=>e.object)):[]}getSelectedFeatureId(){return this.m_selectedFeatureId}getHighlightedFeatureId(){return this.m_highlightedFeatureId}getTile(e){return e instanceof r.TileKey?this.m_levelsWithData.includes(e.level)?this.getDataLevelTile(e):this.getComposedTile(e):this.getDataLevelTile(e)}retrieveTileData(e,t=!0){const i=e instanceof r.TileKey?e.mortonCode():e,n=this.dataProvider();n.getTile(i.toString()).then((async r=>{if(t&&!this.m_tileCache.has(i))return;const o=this.m_tileCache.get(i);let a;void 0!==o&&(o.dataSize=r instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&r instanceof SharedArrayBuffer?r.byteLength:JSON.stringify(r).length);try{a=await this.decodeTile(r,e)}catch(e){this.logger.error(e.message),this.dispatchEvent(Object.assign(Object.assign({type:_.EVENT_TILE_DECODED},this.getPartitionForEvent(i)),{error:l.DecodingError.decodingError(e.message)}))}a&&(n.layer instanceof v.VolatileLayer&&(a.partitionData=r),this.tileDecoded(e,a))})).catch((t=>{this.markPartitionInvalid(i),this.logger.error(t),this.dispatchEvent(Object.assign(Object.assign({type:_.EVENT_TILE_GET},this.getPartitionForEvent(i)),{error:t instanceof d.NotFoundError&&n.layer instanceof v.VolatileLayer?new h.NotFoundVolatilePartitionError(e):new c.EmptyPartitionError(i)}))}))}async decodeTile(e,t,i,n){const o=t instanceof r.TileKey?t:r.TileKey.fromHereTile(t);if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer){const i=this.schemaProvider();if(void 0===i)throw new u.ErrorToTranslate("olpdi.interactiveDS.need-schema-provider");let r;if(this.decoder instanceof p.InteractiveWorkerDecoder){const n=i.getSchemaId(),o=i.getSchemaData();if(void 0===n||void 0===o)throw new u.ErrorToTranslate("olpdi.interactiveDS.cannot-get-schema-details");r=await this.decoder.decodeTileWithSchema(e,n,o.messageName,t,this.projection)}else r=await this.decodeTileWithSchema(e,o,i);return r.partitionData=e,r.dataSize=e.byteLength,r}return this.configureTileDecoder(void 0,{partitionId:"string"==typeof t?t:t.toHereTile(),colorTheme:i,enableCustomColors:n}),this.decoder.decodeTile(e,o,this.projection)}tileDecoded(e,t){this.dispatchEvent(Object.assign(Object.assign({type:_.EVENT_TILE_DECODED},this.getPartitionForEvent(e)),{decodedTile:t}))}getObjectsToRaycast(e){return e.objects.filter((e=>{const t=e.userData.tooltipRanges;return t&&t.size>0}))}canSelectMoreTiles(){return this.selectedPartitions.size<this.tileSelectionLimit}async selectTile(e){return this.isTileValid(e)||(this.markPartitionValid(e),this.m_tileCache.delete(e)),this.m_lastSelectedPartition!==e&&(this.enableRefresh&&this.m_tileCache.delete(e),this.selectedPartitions.add(e),this.m_lastSelectedPartition=e,this.m_isInteractiveDataSourceReady&&(this.resetComposedTile(),this.dispatchEvent(Object.assign({type:_.EVENT_TILE_SELECT},this.getPartitionForEvent(e)))),!0)}deselectTile(e){if(this.hasTileToRender(e)){if(this.selectedPartitions.delete(e),this.m_lastSelectedPartition=null,!this.m_isInteractiveDataSourceReady)return;this.resetComposedTile(),this.dispatchEvent(Object.assign({type:_.EVENT_TILE_DESELECT},this.getPartitionForEvent(e))),this.m_selectedFeaturePartitionId===e&&this.deselectFeature(),this.requestUpdate()}}clearSelectedTiles(e=!1){this.m_lastSelectedPartition=null;for(const t of this.selectedPartitions){const i=+t;e&&!isNaN(i)&&this.m_levelsWithData.includes(r.TileKey.fromMortonCode(i).level)||(this.selectedPartitions.delete(t),this.dispatchEvent(Object.assign({type:_.EVENT_TILE_DESELECT},this.getPartitionForEvent(t))))}this.resetComposedTile(),this.deselectFeature(),this.requestUpdate()}refreshTiles(){this.m_partitionsToRefresh=new Set(this.selectedPartitions),this.m_tileCache.evictAll(),this.resetComposedTile()}addFeatureFilter(e,t){this.removeFeatureFilter(e),this.m_featureFilters.push(e),t&&(this.applyFeatureFilters(),this.requestUpdate())}removeFeatureFilter(e){this.m_featureFilters=this.m_featureFilters.filter((t=>!(t.feature===e.feature&&t.value===e.value)))}clearFilters(){this.m_featureFilters=[],this.applyFeatureFilters()}applyFeatureFilters(e){this.m_featureFilters.forEach((t=>{if(void 0===this.mapView.tileGeometryManager)return;void 0!==t.value&&this.mapView.tileGeometryManager.hideKind(`${this.name}-${t.value}`,t.exclude);const i=[];void 0!==e?i.push(e):void 0!==this.m_composedTile&&(i.push(this.m_composedTile),this.m_composedTile.resetVisibilityCounter()),i.length&&this.mapView.tileGeometryManager.updateTiles(i)}))}setUpIntersectionAgent(e){this.m_intersectionAgent=e,this.m_intersectionAgent.addEventListener(g.InteractiveIntersectionAgent.EVENT_OBJECT_SELECT,this.handleFeatureSelect),this.m_intersectionAgent.addEventListener(g.InteractiveIntersectionAgent.EVENT_NOTHING_SELECTED,this.handleFeatureDeselect),this.m_intersectionAgent.addEventListener(g.InteractiveIntersectionAgent.EVENT_INTERSECTION_CHANGE,this.handleFeatureHighlight)}async getCatalogClient(){const e=this.params.dataProvider;if(void 0!==e)return await e.connect(),e.catalog;this.logger.error("DataSource is not fully initialized - dataProvider is not provided.")}configureTileDecoder(e,t){this.decoder.configure(e,Object.assign(Object.assign({},t),{enable3DRendering:this.m_enable3DRendering}))}async createSchemaProvider(){const e=this.params.schemaProviderOptions;return(e&&e.schemaProviderFactory||f.commonSchemaProviderFactory)(e&&e.source,this.params.dataProvider?this.params.dataProvider.layer:void 0,{loggerName:this.name+" Schema Provider"})}async decodeTileWithSchema(e,t,i){const r=i.getSchemaId(),n=i.getSchemaData();if(void 0===r||void 0===n)throw new u.ErrorToTranslate("olpdi.interactiveDS.cannot-get-schema-details");const o=new Uint32Array([e.byteLength]),a={schemaId:r,typeName:n.messageName,conversionOptions:{defaults:!0,json:!0,enums:"String",bytes:"String"}},s=m.DecoderInfo.encode(a).finish(),l=new ArrayBuffer(o.byteLength+e.byteLength+s.byteLength),c=new Uint8Array(l);c.set(new Uint8Array(o.buffer),0),c.set(new Uint8Array(e),o.byteLength),c.set(s,o.byteLength+e.byteLength);const d=await this.decoder.decodeTile(l,t,this.projection);return d.dataSize=e.byteLength,d}getLoggerName(){return this.name}copyObjectFromTileIntoComposedTile(e){this.m_composedTile&&this.m_composedTile.copyObjectFromTile(e)}getComposedTile(e){if(void 0!==this.m_composedTile&&this.m_composedTile.objects.length>0)return this.m_composedTile;if(void 0===this.m_composedTile&&(this.m_composedTile=new this.tileType(this,e)),this.selectedPartitions.forEach((e=>{const t=this.getDataLevelTile("number"==typeof e?r.TileKey.fromMortonCode(e):e);this.copyObjectFromTileIntoComposedTile(t)})),void 0!==this.m_intersectionAgent){const e=this.getObjectsToRaycast(this.m_composedTile);this.m_intersectionAgent.attachObjects(e,!1)}return this.m_composedTile}getDataLevelTile(e,t=!0){const i=e instanceof r.TileKey?e.mortonCode():e,n=e instanceof r.TileKey?e:r.TileKey.fromMortonCode(_.MORTON_CODE_FOR_GENERIC_PARTITION);let o,a,s=!1;if(t?(o=this.m_tileCache.get(i),s=!o,s&&(o=new this.tileType(this,n),o.partitionId=i,this.m_tileCache.set(i,o))):(o=new this.tileType(this,n),o.partitionId=i),s)try{this.retrieveTileData(e,t)}catch(e){a=e}return this.dispatchEvent(Object.assign(Object.assign({type:s?_.EVENT_TILE_GET:_.EVENT_TILE_GET_FROM_CACHE},this.getPartitionForEvent(e)),{tile:o,error:a})),o}createGeometries(e,t,i){if(e=e instanceof r.TileKey?e.mortonCode():e,void 0!==(i=null!=i?i:this.m_tileCache.get(e))){if(i.decodedTile=t,this.dataProvider()instanceof s.InMemoryDataProvider&&i){const e=new Set(this.m_featureFilters.map((e=>e.value)));for(const t of i.objects)for(const i of t.userData.kind){const t={exclude:!1,feature:"layer",value:i};e.has(i)||(e.add(i),this.m_featureFilters.push(t))}}this.m_partitionsToRefresh.has(e)&&(this.m_partitionsToRefresh.delete(e),0===this.m_partitionsToRefresh.size&&this.dispatchEvent({type:_.EVENT_TILES_REFRESHED})),0===this.m_partitionsToRefresh.size&&(this.resetComposedTile(),this.requestUpdate())}}resetComposedTile(){void 0!==this.m_composedTile&&(this.m_composedTile.objects.length=0)}markTileValid(e){this.markPartitionValid(e)}markTileInvalid(e){this.markPartitionInvalid(e)}markPartitionValid(e){this.m_invalidPartitions.delete(e)}markPartitionInvalid(e){this.m_invalidPartitions.add(e)}isTileValid(e){return!this.m_invalidPartitions.has(e)}getPartitionForEvent(e){return{partitionId:e instanceof r.TileKey||"string"==typeof e?e:r.TileKey.fromMortonCode(e)}}}t.InteractiveDataSource=_,_.EVENT_TILE_SELECT="tileselect",_.EVENT_TILE_DESELECT="tiledeselect",_.EVENT_TILE_GET="tileget",_.EVENT_TILE_GET_FROM_CACHE="tilegetfromcache",_.EVENT_TILE_DECODED="tiledecode",_.EVENT_BEFORE_TILE_DECODE="beforetiledecode",_.EVENT_BEFORE_TILE_RENDERED="beforetilerendered",_.EVENT_TILE_RENDERED="tilerendered",_.EVENT_TILES_REFRESHED="tilesrefreshed",_.EVENT_FEATURE_SELECT="featureselect",_.EVENT_FEATURE_DESELECT="featuredeselect",_.EVENT_FEATURE_HIGHLIGHT="featurehighlight",_.EVENT_FEATURE_UNHIGHLIGHT="featureunhighlight",_.EVENT_ATTACHED="attached",_.EVENT_CONNECTION_ERROR="connection_error",_.DATA_LEVEL_CHANGED="data-level-changed",_.MORTON_CODE_FOR_GENERIC_PARTITION=r.TileKey.fromRowColumnLevel(r.TileKey.rowsAtLevel(26)/2,r.TileKey.columnsAtLevel(26)/2,26).mortonCode()},55146:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveTile=void 0;const r=i(90602),n=i(63498);class o extends r.Tile{constructor(e,t,i,r){super(e,t,i,r),this.objects=[],this.forceHasGeometry(!0)}set decodedTile(e){this.m_decodedInteractiveTile=e,e&&(this.partitionData=e.partitionData,this.dataSize=e.dataSize,this.createGeometries(e))}get decodedTile(){return this.m_decodedInteractiveTile}get jsonData(){if(void 0===this.m_jsonData&&void 0!==this.decodedTile){const e=this.decodedTile;this.m_jsonData=e.jsonData&&e.jsonData.$type?e.jsonData.$type.toObject(e.jsonData,{defaults:!0,enums:String,bytes:String,json:!0}):e.jsonData}return this.m_jsonData}set jsonData(e){this.m_jsonData=e}get geometryBoundaries(){return this.m_geometryBoundaries}set geometryBoundaries(e){this.m_geometryBoundaries=e}copyObjectFromTile(e){e.objects.forEach((t=>{t.displacement=e.center.clone().sub(this.center),this.objects.push(t),t.partitionId=e.partitionId}))}createGeometries(e){n.TileGeometryCreator.instance.processTechniques(this,void 0,void 0),n.TileGeometryCreator.instance.createObjects(this,e,(()=>{}))}}t.InteractiveTile=o},30860:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveTileDecoder=t.DecoderInfo=void 0;const r=i(19955),n=i(43720),o=i(43281),a=i(82246),s=i(10010);o.util.Long!==n&&(o.util.Long=n,o.configure());const l=new o.Root;o.parse('syntax = "proto3";\npackage here;\nmessage ProtobufDecoderInfo {\n    required string schemaId = 1;\n    required string typeName = 2;\n    optional DecoderConversionOptions conversionOptions = 3;\n}\n\nmessage DecoderConversionOptions {\n    optional bool json = 1;\n    optional bool defaults = 2;\n    optional string longs = 3;\n    optional string enums = 4;\n    optional string bytes = 5;\n}',l,{keepCase:!0});const c=l.lookupType("ProtobufDecoderInfo");t.DecoderInfo=c;class u extends r.ThemedTileDecoder{constructor(){super(...arguments),this.m_protoRoots=new Map}async connect(){}configure(e,t){if(super.configure(e,t),void 0===(null==e?void 0:e.styleSet)&&super.configure({styleSet:[]},void 0),"object"!=typeof(i=t)||"string"!=typeof i.schemaId||"object"!=typeof i.serializedRoot&&void 0!==i.serializedRoot)(function(e){return"object"==typeof e&&"string"==typeof e.partitionId})(e)&&(this.m_partitionId=e.partitionId);else if(t.serializedRoot){const e=o.Root.fromJSON(t.serializedRoot);this.m_protoRoots.set(t.schemaId,e)}else this.m_protoRoots.delete(t.schemaId);var i;void 0!==(null==t?void 0:t.enable3DRendering)&&(this.m_enable3DRendering=t.enable3DRendering),void 0!==(null==t?void 0:t.disableGenerateProtobufRef)&&(this.m_disableGenerateProtobufRef=t.disableGenerateProtobufRef),void 0!==(null==t?void 0:t.colorTheme)&&(this.m_colorTheme=t.colorTheme),void 0!==(null==t?void 0:t.enableCustomColors)&&(this.m_enableCustomColors=t.enableCustomColors)}async decodeThemedTile(e,t,i,r){let n;if(e instanceof ArrayBuffer){const o=this.unwrap(e),a=o.info,s=this.pureDecode(o.data,a.schemaId,a.typeName),l=this.convertToPlainObject(s,a.conversionOptions);n=await this.createGeometries(s,t,i,r,this.m_colorTheme,this.m_enableCustomColors),n.jsonData=l}else n=await this.createGeometries(e,t,i,r,this.m_colorTheme,this.m_enableCustomColors);return n}async decode(e,t,i,r){if(void 0===t||void 0===i){const n=this.unwrap(e),o=n.info;e=n.data,t=o.schemaId,i=o.typeName,r=o.conversionOptions}const n=this.pureDecode(e,t,i);return this.convertToPlainObject(n,r)}pureDecode(e,t,i){return this.getProtoDecoder(t,i).decode(new s.DIReader(new Uint8Array(e)))}unwrap(e){const t=new Uint32Array(e,0,Uint32Array.BYTES_PER_ELEMENT)[0],i=new Uint8Array(e,Uint32Array.BYTES_PER_ELEMENT,t),r=new Uint8Array(e,Uint32Array.BYTES_PER_ELEMENT+t);return{info:c.decode(r),data:i}}getProtoDecoder(e,t){const i=this.m_protoRoots.get(e);if(void 0===i)throw new a.ErrorToTranslate("olpdi.interactiveDS.no-protobuf-root-for-schema",{schema:e});return i.lookupType(t)}convertToPlainObject(e,t){let i;if(t){switch(i={defaults:t.defaults,json:t.json,enums:"String"===t.enums?String:void 0},t.longs){case"String":i.longs=String;break;case"Number":i.longs=Number}switch(t.bytes){case"String":i.bytes=String;break;case"Array":i.bytes=Array}}return e.$type.toObject(e,i)}}t.InteractiveTileDecoder=u},19160:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveWorkerDecoder=void 0;const r=i(32941),n=i(90602),o=i(30860);class a extends n.WorkerBasedDecoder{constructor(e,t){super(e,t),this.m_workerSet=e}async decodeTileWithSchema(e,t,i,n,a,s){const l={schemaId:t,typeName:i,conversionOptions:{json:!0,enums:"String",bytes:"String",defaults:!0}},c=new Uint32Array([e.byteLength]),u=o.DecoderInfo.encode(l).finish(),d=new ArrayBuffer(c.byteLength+e.byteLength+u.byteLength),h=new Uint8Array(d);return h.set(new Uint8Array(c.buffer),0),h.set(new Uint8Array(e),c.byteLength),h.set(u,c.byteLength+e.byteLength),this.configure(void 0,{partitionId:"string"==typeof n?n:n.mortonCode().toString()}),this.decodeTile(d,n instanceof r.TileKey?n:r.TileKey.fromHereTile(n),a,s)}async decode(e,t,i,r,n){const a=new Uint32Array([e.byteLength]),s={schemaId:t,typeName:i,conversionOptions:r},l=o.DecoderInfo.encode(s).finish(),c=new ArrayBuffer(a.byteLength+e.byteLength+l.byteLength),u=new Uint8Array(c);u.set(new Uint8Array(a.buffer),0),u.set(new Uint8Array(e),a.byteLength),u.set(l,a.byteLength+e.byteLength);const d={type:"decode",data:c};return this.m_workerSet.invokeRequest(this.serviceId,d,[c],n)}}t.InteractiveWorkerDecoder=a},6308:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MapControlHandler=void 0;const r=i(84428),n=i(72661);class o{constructor(e){this.mapView=e,this.m_touches=[],this.mouseDownLeftEvent=void 0,this.mouseDownRightEvent=void 0,this.touchEvent=void 0,this.eventHandlers=[],this.clickTimeout=0,this.contextMenuTimeout=0,this.contextMenu=e=>{if(2===e.button){if(e.detail>1||this.mouseWasMoved(e,this.mouseDownRightEvent))return e.detail>1&&this.dispatchMouseEvents("rmbdblclick",e),this.mouseDownRightEvent=void 0,void window.clearTimeout(this.contextMenuTimeout);this.mouseDownRightEvent=void 0,this.contextMenuTimeout=window.setTimeout((()=>{this.dispatchMouseEvents("contextmenu",e)}),o.singleClickDelay)}},this.dispatchMouseEvents=(e,t,i=!0)=>{const r=this.getGeoPosByEvent(t);null!==r&&this.eventHandlers.filter((t=>t.eventType===e)).forEach((e=>{e.eventHandler(r,this.keyModifierPressed(t),t)})),i&&this.mapView.update()},this.mouseClick=e=>{if(this.domElement.classList.remove(o.MAP_MOVE_CLASS_NAME),this.domElement.classList.remove(o.MAP_TILT_CLASS_NAME),e.detail>1||this.mouseWasMoved(e,this.mouseDownLeftEvent))return this.mouseDownLeftEvent=void 0,void window.clearTimeout(this.clickTimeout);this.mouseDownLeftEvent=void 0,this.clickTimeout=window.setTimeout(this.dispatchMouseEvents.bind(this,"select",e),o.singleClickDelay)},this.mouseWasMoved=(e,t)=>void 0!==t&&(Math.abs(t.pageX-e.pageX)>1||Math.abs(t.pageY-e.pageY)>1),this.mouseDoubleClick=e=>{window.clearTimeout(this.clickTimeout),this.dispatchMouseEvents("zoom",e)},this.mouseDown=e=>{1&e.buttons?this.mouseDownLeftEvent=e:2&e.buttons&&(this.mouseDownRightEvent=e)},this.getGeoPosByEvent=e=>{const t=n.getRelativeScreenCoordinates(this.mapView,e.pageX,e.pageY,!1);return this.mapView.getGeoCoordinatesAt(t.x,t.y)},this.keyModifierPressed=e=>({altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,shiftKey:e.shiftKey}),this.mouseMoveHandler=e=>{this.domElement.classList.remove(o.MAP_MOVE_CLASS_NAME),this.domElement.classList.remove(o.MAP_TILT_CLASS_NAME),void 0!==this.mouseDownLeftEvent?this.mouseWasMoved(e,this.mouseDownLeftEvent)&&this.domElement.classList.add(this.mouseDownLeftEvent.ctrlKey?o.MAP_TILT_CLASS_NAME:o.MAP_MOVE_CLASS_NAME):void 0!==this.mouseDownRightEvent&&this.mouseWasMoved(e,this.mouseDownRightEvent)&&this.domElement.classList.add(o.MAP_TILT_CLASS_NAME),this.dispatchMouseEvents("hover",e,!1)},this.touchStart=e=>{this.touchEvent=e,this.setTouchState(e.touches),this.domElement.addEventListener("touchend",this.touchEnd),this.domElement.addEventListener("touchmove",this.touchMove,!1)},this.touchMove=e=>{this.cleanupTouchEventListeners()},this.touchEnd=e=>{void 0!==this.touchEvent&&1===this.m_touches.length&&this.eventHandlers.forEach((t=>t.eventHandler(this.m_touches[0].currentGeoCoordinates,this.keyModifierPressed(e)))),this.cleanupTouchEventListeners()},this.domElement=e.renderer.domElement,this.bindInputEvents()}static getInstance(e){const t=this.m_instances.get(e)||new o(e);return this.m_instances.has(e)||this.m_instances.set(e,t),t}addEventHandler(e,t){return this.eventHandlers.push({eventType:e,eventHandler:t}),this}dispose(){this.domElement.removeEventListener("touchstart",this.touchStart),this.domElement.removeEventListener("mousemove",this.mouseMoveHandler),this.domElement.removeEventListener("mousedown",this.mouseDown),this.domElement.removeEventListener("click",this.mouseClick),this.domElement.removeEventListener("dblclick",this.mouseDoubleClick),-1!==navigator.userAgent.indexOf("Safari")&&-1!==navigator.vendor.indexOf("Apple")?this.domElement.removeEventListener("contextmenu",this.contextMenu):this.domElement.removeEventListener("auxclick",this.contextMenu),o.m_instances.clear()}bindInputEvents(){this.domElement.addEventListener("touchstart",this.touchStart),this.domElement.addEventListener("mousemove",this.mouseMoveHandler),this.domElement.addEventListener("mousedown",this.mouseDown),this.domElement.addEventListener("click",this.mouseClick),this.domElement.addEventListener("dblclick",this.mouseDoubleClick),-1!==navigator.userAgent.indexOf("Safari")&&-1!==navigator.vendor.indexOf("Apple")?this.domElement.addEventListener("contextmenu",this.contextMenu):this.domElement.addEventListener("auxclick",this.contextMenu)}setTouchState(e){this.m_touches=[];for(const t of Array.from(e)){const e=new r.Vector2(t.pageX,t.pageY),i=n.getRelativeScreenCoordinates(this.mapView,e.x,e.y),o=this.mapView.getGeoCoordinatesAt(i.x,i.y);o&&this.m_touches.push({currentTouchPoint:e.clone(),currentGeoCoordinates:o.clone()})}}cleanupTouchEventListeners(){this.domElement.removeEventListener("touchend",this.touchEnd),this.domElement.removeEventListener("touchmove",this.touchMove),this.touchEvent=void 0,this.m_touches=[]}}t.MapControlHandler=o,o.singleClickDelay=300,o.MAP_MOVE_CLASS_NAME="map-move",o.MAP_TILT_CLASS_NAME="map-tilt",o.m_instances=new Map},54903:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProvider=void 0;const r=i(24762);t.DataProvider=r.PlatformDataProvider},39863:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseMapDataProvider=void 0;const r=i(42589),n=i(24762);class o extends n.PlatformDataProvider{async getTile(e,t){return super.getTile(e,t).catch((e=>{if(e instanceof r.NotFoundError)return new ArrayBuffer(0);throw e}))}}t.BaseMapDataProvider=o},28072:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataProviderAbstract=void 0;const r=i(19898),n=i(81450),o=i(82246),a=i(10010);class s extends r.DataProvider{constructor(){super(...arguments),this.m_isWorkerDecoderConfigured=!1,this.m_isReady=!1}get catalog(){return this.m_catalog}get layer(){return this.m_layer}ready(){return this.m_isReady}async getTile(e,t){if(void 0===this.layer)throw new o.ErrorToTranslate("olpdi.interactiveDS.data-provider-not-connected");return this.layer.getTile(e,t)}async getTileResponse(e,t){const i="string"==typeof e?e:e.toHereTile();return this.getPartitionResponse(i,t)}async getTileDecoded(e,t,i){const r="string"==typeof e?e:e.toHereTile();return this.getPartitionDecoded(r,t,i)}async getPartition(e,t){return(await this.getPartitionResponse(e,t)).arrayBuffer()}async getPartitionResponse(e,t){if(void 0===this.layer)throw new o.ErrorToTranslate("olpdi.interactiveDS.data-provider-not-connected");return this.layer.getPartition(e,t)}async decodeProtobufData(e,t,i){const r=await this.initSchemaProvider();if(void 0===this.m_decoder){const o=await this.getProtobufDecoder(r,t);try{return this.decode(o,e,i)}catch(e){throw n.DecodingError.decodingError(e.message)}}const o=r.getSchemaId(),a=r.getSchemaData();if(void 0===o||void 0===a)throw new n.DecodingError("olpdi.interactiveDS.cannot-get-schema-details");this.m_isWorkerDecoderConfigured||(await this.configureDecoder(),this.m_isWorkerDecoderConfigured=!0);try{return this.m_decoder.decode(e,o,t||a.messageName,i)}catch(e){throw n.DecodingError.decodingError(e.message)}}setSchemaProvider(e){this.m_schemaProvider=e||null,this.m_schemaProviderError=void 0,this.m_isWorkerDecoderConfigured=!1,this.dispatchEvent({type:s.ON_CHANGE_SCHEMA_PROVIDER})}getSchemaProvider(){return this.m_schemaProvider||void 0}setDecoder(e){this.m_decoder=e,this.m_isWorkerDecoderConfigured=!1}getDecoder(){return this.m_decoder}get connectionError(){return this.m_connectionError}dispose(){}async configureDecoder(){const e=await this.initSchemaProvider();if(void 0===this.m_decoder||void 0===e)return;const t=e.getProtobufRoot(),i=e.getSchemaId();if(void 0===i||null===t)return;const r={schemaId:i,serializedRoot:t.toJSON()};await this.m_decoder.configure(void 0,r)}async getProtobufDecoder(e,t){const i=e.getProtobufDecoder(void 0,t);if(void 0===i)throw new o.ErrorToTranslate("olpdi.interactiveDS.missing-protobuf-decoder");return i}decode(e,t,i){const r=e.decode(new a.DIReader(new Uint8Array(t)));let n;if(void 0!==i){switch(n={defaults:i.defaults,json:i.json,enums:"String"===i.enums?String:void 0},i.longs){case"String":n.longs=String;break;case"Number":n.longs=Number}switch(i.bytes){case"String":n.bytes=String;break;case"Array":n.bytes=Array}}return r.$type.toObject(r,n)}}t.DataProviderAbstract=s,s.ON_CHANGE_SCHEMA_PROVIDER="on-change-schema-provider"},99017:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryDataProvider=void 0;const r=i(81450),n=i(82246),o=i(8386),a=i(5867),s=i(72661),l=i(28072);class c extends l.DataProviderAbstract{get layer(){return this.m_layer}async connect(){return void 0!==this.m_connect||(this.m_connect=new Promise((async(e,t)=>{const i=new a.InMemoryCatalogClient,r=await i.getCatalog();this.m_catalog=new o.Catalog(r,i),this.m_layer=await this.m_catalog.getLayer("in-memory-layer"),this.m_isReady=!0,e()}))),this.m_connect}async detectDataContentType(e){if(void 0===e){if(this.layer){const t=await this.layer.getAllPartitionsInfo();if(t.length>0){const i=await this.layer.getPartition(t[0].partition);e=await i.arrayBuffer()}}if(void 0===e)return}let t;if(s.isDataGeoJSON(e))t="application/geo+json";else if(e instanceof ArrayBuffer)try{await this.decodeProtobufData(e),t="application/x-protobuf"}catch(e){}return t}async getPartitionDecoded(e,t,i){if(void 0===this.layer)throw new n.ErrorToTranslate("olpdi.interactiveDS.data-provider-not-connected");const o=await this.layer.getPartition(e,i),a=await o.arrayBuffer(),l={rawData:a,dataSize:a.byteLength};try{l.decodedData=await this.decodeProtobufData(a,void 0,t)}catch(e){this.m_schemaProvider&&!0===this.m_schemaProvider.isReady()&&(l.error=r.DecodingError.decodingError(e.message));const t=s.arrayBufferToString(a);try{l.decodedData=JSON.parse(t)}catch(e){l.decodedData=t}}return l}async initSchemaProvider(){if(null===this.m_schemaProvider||void 0===this.m_schemaProvider)throw new n.ErrorToTranslate("olpdi.interactiveDS.need-schema-provider");if(!0===this.m_schemaProvider.isReady())return this.m_schemaProvider;throw new n.ErrorToTranslate("olpdi.interactiveDS.schema-provider-not-connected")}}t.InMemoryDataProvider=c},24762:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformDataProvider=t.LookupEnvironment=void 0;const r=i(90546),n=i(81450),o=i(82246),a=i(7354),s=i(8386),l=i(72558),c=i(72661),u=i(28072);var d;(d=t.LookupEnvironment||(t.LookupEnvironment={})).HERE="here",d.HERE_DEV="here-dev",d.HERE_CN="here-cn",d.HERE_CN_DEV="here-cn-dev",d.LOCAL="local";class h extends u.DataProviderAbstract{constructor(e){super(),this.m_hrnError=!1,this.hrn=e.hrn,this.layerId=e.layer,this.catalogVersion=void 0!==e.catalogVersion?e.catalogVersion:-1,this.settings=new r.OlpClientSettings(e)}async connect(){return void 0!==this.m_connect||(this.m_connect=new Promise((async(e,t)=>{try{if(this.m_hrnError=!1,void 0!==this.settings){this.m_catalog=await s.Catalog.getCatalog(r.HRN.fromString(this.hrn),this.settings);try{this.m_layer=await this.m_catalog.getLayer(this.layerId,this.catalogVersion)}catch(e){this.m_hrnError=!0,this.m_connectionError=e}}void 0===this.layer&&void 0===this.m_connectionError&&(this.m_connectionError=new o.ErrorToTranslate("olpdi.interactiveDS.layer-not-found")),this.m_isReady=!0,e()}catch(t){this.m_hrnError=!0,this.m_connectionError="string"==typeof t?new Error(t):t,e()}}))),this.m_connect}get hrnError(){return this.m_hrnError}async getPartitionDecoded(e,t,i){if(void 0===this.layer)throw new o.ErrorToTranslate("olpdi.interactiveDS.data-provider-not-connected");const r=await this.layer.getPartition(e,i),a=await r.arrayBuffer(),s={rawData:a,dataSize:a.byteLength};let u=this.layer.contentType;if(void 0===u&&this.layer instanceof l.ObjectStoreLayer&&(u=await this.layer.getContentType(e)),"application/x-protobuf"===u)try{s.decodedData=await this.decodeProtobufData(a,void 0,t)}catch(e){s.error=e}else if(void 0===u||!u.startsWith("text/")&&"application/geo+json"!==u&&"application/vnd.geo+json"!==u&&"application/json"!==u)s.error=new o.ErrorToTranslate("olpdi.interactiveDS.content-type-not-supported",{contentType:u});else try{const e=c.arrayBufferToString(a);s.decodedData=u.startsWith("text/")?e:JSON.parse(e)}catch(e){s.error=n.DecodingError.decodingError()}return s}async initSchemaProvider(){if(null===this.m_schemaProvider)throw new o.ErrorToTranslate("olpdi.interactiveDS.need-schema-provider");if(void 0===this.layer)throw new o.ErrorToTranslate("olpdi.interactiveDS.data-provider-not-connected");if(void 0!==this.m_schemaProviderError)throw this.m_schemaProviderError;void 0===this.m_schemaProvider&&(this.m_schemaProvider=new a.CatalogSchemaProvider(this.layer,{loggerName:`Schema Provider @ ${this.hrn}:${this.layerId}`}));try{await this.m_schemaProvider.connect()}catch(e){throw this.m_schemaProviderError=e,e}return this.m_schemaProvider}}t.PlatformDataProvider=h},81450:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DecodingError=void 0;const r=i(82246);class n extends r.ErrorToTranslate{static decodingError(e=""){return""===e?new n("olpdi.interactiveDS.decoding-error.generic"):new n("olpdi.interactiveDS.decoding-error.specific",{message:new r.ErrorToTranslate(e)})}}t.DecodingError=n,n.NO_CATALOG_CONNECTION="olpdi.interactiveDS.decoding-error.no-catalog-connection",n.SCHEMA_DOWNLOAD_FAILURE="olpdi.interactiveDS.decoding-error.schema-download-error"},64135:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyPartitionError=void 0;const r=i(82246);class n extends r.ErrorToTranslate{constructor(e){super("olpdi.interactiveDS.empty-partition-error",{partitionId:e})}}t.EmptyPartitionError=n},82246:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorToTranslate=void 0;class i extends Error{constructor(e,t){super(e),this.name="ErrorToTranslate",this.m_payload=t}get payload(){return this.m_payload}}t.ErrorToTranslate=i},15928:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonDecodingError=void 0;const r=i(82246);class n extends r.ErrorToTranslate{constructor(e){super("olpdi.interactiveDS.decoding-error.generic")}}t.JsonDecodingError=n},42589:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=void 0;class i extends Error{}t.NotFoundError=i},23086:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundVolatilePartitionError=void 0;const r=i(32941),n=i(82246);class o extends n.ErrorToTranslate{constructor(e){e instanceof r.TileKey&&(e=e.mortonCode()),super("olpdi.interactiveDS.empty-volatile-partition-error",{partitionId:e})}}t.NotFoundVolatilePartitionError=o},51696:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlainTextError=void 0;const r=i(82246);class n extends r.ErrorToTranslate{constructor(e){super("olpdi.interactiveDS.decoding-error.plain-text-error")}}t.PlainTextError=n},77288:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginError=void 0;const r=i(82246);class n extends r.ErrorToTranslate{}t.PluginError=n,n.LOAD_RENDERER_PLUGIN_FAILURE="olpdi.interactiveDS.plugin-error.load-fail",n.RENDERER_PLUGIN_ERROR="olpdi.interactiveDS.plugin-error.processing-fail",n.RENDERER_PLUGIN_MISSING="olpdi.interactiveDS.plugin-error.plugin-missing",n.RENDERER_PLUGIN_MISSING_IN_SCHEMA="olpdi.interactiveDS.plugin-error.plugin-missing-in-schema",n.RENDERER_PLUGIN_ERROR_BOTH_METHODS="olpdi.interactiveDS.plugin-error.implementation-error",n.INVALID_RESULT="olpdi.interactiveDS.plugin-error.invalid-result",n.RUNTIME_ERROR="olpdi.interactiveDS.plugin-error.runtime-error",n.SYNTAX_ERROR="olpdi.interactiveDS.plugin-error.syntax-error"},7354:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CatalogSchemaProvider=void 0;const r=i(1210);class n extends r.SchemaProviderAbstract{constructor(e,t){super(t),this.layer=e}getSchemaId(){const e=this.getSchemaDetails();if(void 0!==e)return e.hrn}async fetchSchemaDetails(){const e=await this.layer.getSchemaDetails().catch((e=>{this.logger.info(e.message)}));return e?e.schema:void 0}async getSchemaArchive(){return await this.layer.getSchema().catch((e=>{this.logger.info(e.message)}))||void 0}}t.CatalogSchemaProvider=n},53592:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonSchemaProviderFactory=void 0;const r=i(15762),n=i(7354),o=i(44710),a=i(95757);t.commonSchemaProviderFactory=async function(e,t,i){let s;if(e&&Object.keys(e).length>1)throw new Error("It is allowed to set only one schema source.");if(e&&e.schemaArchive)s=new o.FileSchemaProvider(e.schemaArchive,i);else if(t&&e&&e.schemaHRN){if(void 0===t.settings)throw new Error("Cannot connect to schema by HRN without OLP client settings.");s=new a.HRNSchemaProvider(new r.ArtifactClient(t.settings),e.schemaHRN,i)}else t&&(s=new n.CatalogSchemaProvider(t,i));if(void 0===s)throw new Error("Schema source is not defined.");return await s.connect(),s}},44710:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSchemaProvider=void 0;const r=i(1210);class n extends r.SchemaProviderAbstract{constructor(e,t){super(t),this.m_schemaArchive=e,this.m_params=t}async getSchemaArchive(){return this.m_schemaArchive}getSchemaId(){const e=this.getSchemaDetails();if(void 0!==e)return`${e.name}-${e.version}`}async fetchSchemaDetails(){return this.m_params&&this.m_params.schemaDetails?this.m_params.schemaDetails:void 0}}t.FileSchemaProvider=n},95757:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HRNSchemaProvider=void 0;const r=i(90546),n=i(15762),o=i(1210);class a extends o.SchemaProviderAbstract{constructor(e,t,i){super(i),this.artifactClient=e,this.hrn=r.HRN.fromString(t)}getSchemaId(){const e=this.getSchemaDetails();if(void 0!==e)return e.hrn}async fetchSchemaDetails(){const e=(new n.SchemaDetailsRequest).withSchema(this.hrn),t=await this.artifactClient.getSchemaDetails(e).catch((e=>{this.logger.info(e.message)}));return t?t.schema:void 0}async getSchemaArchive(){const e=(new n.SchemaDetailsRequest).withSchema(this.hrn),t=await this.artifactClient.getSchemaDetails(e).catch((e=>{this.logger.info(e.message)}));if(void 0===t||void 0===t.variants)return void this.logger.info("Variants from schema details are not available.");const i=t.variants.find((e=>"ds"===e.id));if(void 0===i)return void this.logger.info('Schema detail variant with id "ds" was not found.');const r=(new n.SchemaRequest).withVariant(i);return await this.artifactClient.getSchema(r).catch((e=>{this.logger.info(e.message)}))||void 0}}t.HRNSchemaProvider=a},49953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1210:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaProviderAbstract=void 0;const r=i(38338),n=i(55733),o=i(43720),a=i(43281);a.util.Long!==o&&(a.util.Long=o,a.configure()),t.SchemaProviderAbstract=class{constructor(e){this.m_params=e,this.logger=r.LoggerManager.instance.create(this.getLoggerName()),this.m_isReady=!1,this.m_loggerName="Schema Provider",this.m_manifestFile="META-INF/layer.manifest.json",this.m_errorsLogLevel="error"}setErrorsLogLevel(e){this.m_errorsLogLevel=e}isReady(){return this.m_isReady}async connect(){void 0===this.m_connectPromise&&(this.m_connectPromise=new Promise((async(e,t)=>{try{this.m_schemaDetails=await this.fetchSchemaDetails();const t=await this.getSchemaArchive();if(void 0===t)return void e();const i=await this.unpackSchemaArchive(t),r=i.get(this.m_manifestFile);if(void 0===r)return this.logger.error(`File '${this.m_manifestFile}' is missing from Protobuf bundle.`),void e();const n=JSON.parse(r).main.message;if("string"!=typeof n)return this.logger.error(`Malformed '${this.m_manifestFile}': main.message must be a string.`),void e();this.m_schemaData={schemaFiles:i,messageName:n},this.m_isReady=!0,this.logger.info("Connected successfully"),e()}catch(e){t(e)}}))),await this.m_connectPromise}getSchemaData(){return this.m_schemaData}getSchemaDetails(){return this.m_schemaDetails}getProtobufDecoder(e=!0,t){const i=this.getProtobufRoot(e);if(null!==i){if(void 0===t){const e=this.getSchemaData();if(void 0===e)return void this.logger[this.m_errorsLogLevel]("A default lookup type is not detected.");t=e.messageName}try{return i.lookupType(t)}catch(e){return void this.logger.error(`Error while looking for a type "${t}" in proto file:`,e.message)}}else this.logger[this.m_errorsLogLevel]("Proto file was not found in the schema.")}getRenderer(){if(void 0!==this.m_renderer)return this.m_renderer;const e=this.getSchemaData();return this.m_renderer=void 0!==e?e.schemaFiles.get(`renderers/${e.messageName}.js`):void 0,this.m_renderer}getProtobufRoot(e=!0){if(void 0!==this.m_protobufRoot)return this.m_protobufRoot;const t=this.getSchemaData();if(void 0===t)return this.m_protobufRoot=null,this.logger.warn("Data is not obtained from the schema."),this.m_protobufRoot;const i=new a.Root;let r=!1;for(const[n,o]of t.schemaFiles)if(n.endsWith(".proto")){r=!0;try{a.parse(o,i,{keepCase:e})}catch(e){this.m_protobufRoot=null,r=!1,this.logger[this.m_errorsLogLevel](`Error while reading proto file '${n}': ${e.message}`);break}}return this.m_protobufRoot=r?i:null,this.m_protobufRoot}async unpackSchemaArchive(e){const t=new n,i=await t.loadAsync(e),r=new Map;for(const e in i.files){if(!i.files[e])continue;const n=i.files[e];if(n.dir)continue;const o=t.file(n.name);if(null!==o){const e=await o.async("text");r.set(n.name,e)}}return r}getLoggerName(){return this.m_params&&this.m_params.loggerName?this.m_params.loggerName:this.m_loggerName}}},25850:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geoJSONSchema=void 0,t.geoJSONSchema={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://geojson.org/schema/GeoJSON.json",title:"GeoJSON",oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},id:{oneOf:[{type:"number"},{type:"string"}]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON FeatureCollection",type:"object",required:["type","features"],properties:{type:{type:"string",enum:["FeatureCollection"]},features:{type:"array",items:{title:"GeoJSON Feature",type:"object",required:["type","properties","geometry"],properties:{type:{type:"string",enum:["Feature"]},id:{oneOf:[{type:"number"},{type:"string"}]},properties:{oneOf:[{type:"null"},{type:"object"}]},geometry:{oneOf:[{type:"null"},{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON GeometryCollection",type:"object",required:["type","geometries"],properties:{type:{type:"string",enum:["GeometryCollection"]},geometries:{type:"array",items:{oneOf:[{title:"GeoJSON Point",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Point"]},coordinates:{type:"array",minItems:2,items:{type:"number"}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON LineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["LineString"]},coordinates:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON Polygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["Polygon"]},coordinates:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPoint",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPoint"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"number"}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiLineString",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiLineString"]},coordinates:{type:"array",items:{type:"array",minItems:2,items:{type:"array",minItems:2,items:{type:"number"}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}},{title:"GeoJSON MultiPolygon",type:"object",required:["type","coordinates"],properties:{type:{type:"string",enum:["MultiPolygon"]},coordinates:{type:"array",items:{type:"array",items:{type:"array",minItems:4,items:{type:"array",minItems:2,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]},bbox:{type:"array",minItems:4,items:{type:"number"}}}}},bbox:{type:"array",minItems:4,items:{type:"number"}}}}]}},50077:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(72661),n=i(47367);t.default=function(e){const t=e===r.Units.pixels,i=`\ngl_PointSize = ${t?"radius":"minRadius"} * 2.0;\n\nif (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n    vColor = vec4(fillColor.rgb, 1.0);\n} else if (uSelectedObject == objectIdentifier && uHoveredObject == objectIdentifier) {\n    vColor = vec4(selectedFillHoverColor.rgb, 1.0);\n} else if (uSelectedObject == objectIdentifier) {\n    vColor = vec4(selectedFillColor.rgb, 1.0);\n} else if (uHoveredObject == objectIdentifier) {\n    vColor = vec4(uHoverColor.rgb, 1.0);\n}\n\nif (uSelectedObject == objectIdentifier) {\n    gl_PointSize *= 1.5;\n}\n`;return{vertexShader:`\nuniform float uDPI;\nuniform vec2 uRendererSize;\n\nattribute float radius;\nattribute float minRadius;\nattribute vec4 borderColor;\nattribute vec4 fillColor;\nattribute vec4 selectedBorderColor;\nattribute vec4 selectedFillColor;\nattribute vec4 selectedFillHoverColor;\n\n${n.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n${t?i:`\n    mat4 viewMatrixFixed = viewMatrix;\n    viewMatrixFixed[3][2] = modelMatrix[3][2];\n    mat4 projMatrix = projectionMatrix * viewMatrixFixed;\n\n    float projectionCoef1 = projMatrix[0][3] * position[0] + projMatrix[1][3] * position[1]\n        + projMatrix[2][3] * position[2] + projMatrix[3][3];\n    float projectionCoef2 = projectionCoef1 + projMatrix[0][3] * radius;\n\n    vec4 projPoint = (projMatrix * vec4(position, 1.0)) / projectionCoef1;\n    vec4 projRadius = (projMatrix * vec4(position[0] + radius, position[1], position[2], 1.0))\n        / projectionCoef2;\n\n    float diff = abs(projRadius[0] - projPoint[0]) * uRendererSize[0] / 2.0;\n\n    if (diff > minRadius) {\n        gl_PointSize = 2.0;\n\n        if (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n            vColor = vec4(borderColor.rgb, 1.0);\n        } else if (uSelectedObject == objectIdentifier) {\n            vColor = vec4(selectedBorderColor.rgb, 1.0);\n        } else if (uHoveredObject == objectIdentifier) {\n            vColor = vec4(uHoverColor.rgb, 1.0);\n        }\n    } else {\n        ${i}\n    }\n`}\n\n    gl_PointSize *= uDPI;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n`,fragmentShader:`\n${n.COMMON_VARYINGS}\n\nvoid main() {\n    vec4 vertColor = vColor;\n    if (length(gl_PointCoord - 0.5) > 0.5) {\n        vertColor.a = 0.0;\n    }\n\n    gl_FragColor = vertColor;\n}\n`,uniforms:{uDPI:{type:"float",value:1},uRendererSize:{type:"vec2",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,vertexColors:!0,userData:{radiusUnits:e}}}},47367:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMMON_FRAGMENT=t.COMMON_VERTEX=t.COMMON_VARYINGS_ATTRS_UNIFORMS=t.COMMON_ATTRUBUTES=t.COMMON_VARYINGS=void 0,t.COMMON_VARYINGS="\nvarying lowp vec4 vColor;\n",t.COMMON_ATTRUBUTES="\nattribute float objectIdentifier;\nattribute lowp vec4 defaultColor;\n",t.COMMON_VARYINGS_ATTRS_UNIFORMS=`\nuniform float uHoveredObject;\nuniform float uSelectedObject;\nuniform lowp vec4 uHoverColor;\nuniform lowp vec4 uSelectColor;\nuniform lowp vec4 uSelectHoverColor;\n\n${t.COMMON_ATTRUBUTES}\n${t.COMMON_VARYINGS}\n`,t.COMMON_VERTEX="\nif (uSelectedObject != objectIdentifier && uHoveredObject != objectIdentifier) {\n    vColor = defaultColor;\n} else if (uSelectedObject == objectIdentifier && uHoveredObject == objectIdentifier) {\n    vColor = uSelectHoverColor;\n} else if (uHoveredObject == objectIdentifier) {\n    vColor = uHoverColor;\n} else if (uSelectedObject == objectIdentifier) {\n    vColor = uSelectColor;\n}\n",t.COMMON_FRAGMENT="\ngl_FragColor = vColor;\n"},14052:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(47367);t.default=function(){return{vertexShader:`\nuniform float uDPI;\nattribute float size;\n\n${r.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nconst float HOVER_Z = 0.98;\nconst float SELECTED_Z = 0.96;\n\nvoid main() {\n    mat4 projMatrix = projectionMatrix * viewMatrix;\n\n    gl_PointSize = uDPI * size;\n\n    ${r.COMMON_VERTEX}\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    gl_Position.z /= 4.0;\n\n    if (uHoveredObject == objectIdentifier) {\n        gl_Position.z = HOVER_Z;\n    }\n    if (uSelectedObject == objectIdentifier) {\n        gl_PointSize *= 1.25;\n        gl_Position.z = SELECTED_Z;\n    }\n}\n`,fragmentShader:`\nconst vec3 COLOR_WHITE = vec3(1.0, 1.0, 1.0);\n${r.COMMON_VARYINGS}\nuniform sampler2D texture;\n\nvoid main() {\n    vec4 textureColor = texture2D(texture, vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y));\n    if (textureColor.a == 0.0) {\n        discard;\n    } else {\n        gl_FragColor = vec4(mix(vColor.rgb * textureColor.r, COLOR_WHITE, textureColor.g), textureColor.a);\n    }\n}\n`,uniforms:{uDPI:{type:"float",value:1},texture:{type:"t",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,depthTest:!0,vertexColors:!0}}},81058:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(84428),n=i(47367);t.default={vertexShader:`\nprecision highp float;\n\n${n.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n    ${n.COMMON_VERTEX}\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`,fragmentShader:`\n${n.COMMON_VARYINGS}\n\nvoid main()\n{\n    ${n.COMMON_FRAGMENT}\n}\n`,uniforms:{uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,side:r.DoubleSide}},58097:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineMaterial=void 0;const r=i(30462),n=i(84428),o=i(72661),a=i(47367);class s extends r.SolidLineMaterial{constructor(e){super(e),this.side=n.DoubleSide;const t=e.scaleByHover,i=e.scaleBySelect,r=void 0===e.units||e.units===o.Units.pixels;this.vertexShader=`\nattribute vec3 extrusionCoord;\nattribute vec3 position;\nattribute vec4 biTangent;\nattribute vec3 tangent;\n//IP: we dont use attrs below, I left them for more smooth comparison with original shader\n//attribute vec2 uv;\n//attribute vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\n//IP: we dont use uniforms below, I left them for more smooth comparison with original shader\n//uniform float extrusionWidth;\n//uniform float outlineWidth;\n//uniform float offset;\n//uniform vec2 drawRange;\n\n//uniform mat4 viewMatrix;\nuniform float uPixelToWorld;\n${r?"":"uniform vec2 uRendererSize;"}\n\n${a.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nattribute float lineWidth;\nattribute float lineMinWidth;\n\nvarying vec3 vRange;\nvarying vec4 vCoords;\n\n#include <fog_pars_vertex>\n#include <extrude_line_vert_func>\n\nvoid main() {\n    ${a.COMMON_VERTEX}\n\n    float pixelMinWidth = lineMinWidth * uPixelToWorld;\n\n${r?"float renderedLineWidth = lineWidth * uPixelToWorld;":"float renderedLineWidth = lineWidth;"}\n\n    float positionZ = 1.0;\n    if (uHoveredObject == objectIdentifier || uSelectedObject == objectIdentifier) {\n        if (uHoveredObject == objectIdentifier && uSelectedObject == objectIdentifier) {\n            ${i||t?"renderedLineWidth *= 2.0; pixelMinWidth *= 2.0;":""}\n            positionZ = 0.6;\n        } else if (uSelectedObject == objectIdentifier) {\n            ${i?"renderedLineWidth *= 2.0; pixelMinWidth *= 2.0;":""}\n            positionZ = 0.7;\n        } else if (uHoveredObject == objectIdentifier) {\n            ${t?"renderedLineWidth *= 2.0; pixelMinWidth *= 2.0;":""}\n            positionZ = 0.5;\n        }\n    }\n\n    // Calculate the segment.\n    vec2 segment = abs(extrusionCoord.xy);\n    float segmentPos = sign(extrusionCoord.x) / 2.0 + 0.5;\n\n    // Calculate the vertex position inside the line (segment) and extrusion direction and factor.\n    float linePos = mix(segment.x, segment.y, segmentPos);\n    vec2 extrusionDir = sign(extrusionCoord.xy);\n    // Precompute to avoid computing multiple times\n    float tanHalfAngle = tan(biTangent.w / 2.0);\n    float extrusionFactor = extrusionDir.y * tanHalfAngle;\n\n    vec3 pos = extrudeLine(\n        position, linePos, renderedLineWidth, biTangent, tangent, tanHalfAngle, extrusionDir);\n\n${r?"":"\n    float sizeUnits = distance(position, pos);\n\n    vec2 extrusionDirPixels = sign(extrusionCoord.xy);\n    vec3 posPixels = extrudeLine(\n        position, linePos, pixelMinWidth, biTangent, tangent, tanHalfAngle,\n         extrusionDirPixels);\n    float sizePixels = distance(position, posPixels);\n\n    if (sizePixels > sizeUnits) {\n        pos = posPixels;\n        extrusionDir = extrusionDirPixels;\n        renderedLineWidth = pixelMinWidth;\n        vColor.a = 1.0;\n    }"}\n\n    // Store the normalized extrusion coordinates in vCoords (with their ranges in vRange).\n    vRange = vec3(extrusionCoord.z, renderedLineWidth, extrusionFactor);\n    vCoords = vec4(extrusionDir / vRange.xy, segment / vRange.x);\n\n    vec4 mvPosition = modelViewMatrix * vec4(pos.xyz, 1.0);\n    gl_Position = projectionMatrix * mvPosition;\n    gl_Position.z = positionZ;\n\n    #include <fog_vertex>\n}`,this.fragmentShader=`\nprecision highp float;\n\n${a.COMMON_VARYINGS}\n\nvarying vec3 vRange;\nvarying vec4 vCoords;\n\n#include <fog_pars_fragment>\n#include <round_edges_and_add_caps>\n\nvoid main()\n{\n    // Calculate distance to center (0.0: lineCenter, 1.0: lineEdge).\n    float distToCenter = roundEdgesAndAddCaps(vCoords, vRange);\n    if (distToCenter > 1.0) {\n        discard;\n    }\n\n    ${a.COMMON_FRAGMENT}\n\n    #include <fog_fragment>\n}`,this.uniforms.uHoveredObject={value:0},this.uniforms.uSelectedObject={value:0},this.uniforms.uHoverColor={value:[0,0,0,0]},this.uniforms.uSelectColor={value:[0,0,0,0]},this.uniforms.uSelectHoverColor={value:[0,0,0,0]},this.uniforms.uPixelToWorld={value:1},this.uniforms.uRendererSize={value:[0,0]}}}t.LineMaterial=s},22275:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(47367);t.default={vertexShader:`\n${r.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nvoid main() {\n    float positionZ = 1.0;\n    if (uHoveredObject == objectIdentifier || uSelectedObject == objectIdentifier) {\n        if (uHoveredObject == objectIdentifier && uSelectedObject == objectIdentifier) {\n            positionZ = 0.6;\n        } else if (uHoveredObject == objectIdentifier) {\n            positionZ = 0.5;\n        } else if (uSelectedObject == objectIdentifier) {\n            positionZ = 0.7;\n        }\n    }\n\n    ${r.COMMON_VERTEX}\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n    gl_Position.z = positionZ;\n}\n`,fragmentShader:`\n${r.COMMON_VARYINGS}\n\nvoid main()\n{\n    ${r.COMMON_FRAGMENT}\n}\n`,uniforms:{uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,depthTest:!0}},78359:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(47367);t.default=function(){return{vertexShader:`\nuniform float uDPI;\nattribute float size;\n\n${r.COMMON_VARYINGS_ATTRS_UNIFORMS}\n\nconst float HOVER_Z = 0.98;\nconst float SELECTED_Z = 0.96;\n\nvoid main() {\n    mat4 projMatrix = projectionMatrix * viewMatrix;\n\n    gl_PointSize = uDPI * size;\n\n    ${r.COMMON_VERTEX}\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    gl_Position.z /= 4.0;\n\n    if (uHoveredObject == objectIdentifier) {\n        gl_Position.z = HOVER_Z;\n    }\n    if (uSelectedObject == objectIdentifier) {\n        gl_PointSize *= 1.25;\n        gl_Position.z = SELECTED_Z;\n    }\n}\n`,fragmentShader:`\n${r.COMMON_VARYINGS}\n\nuniform sampler2D texture;\n\nvoid main() {\n    vec4 textureColor = texture2D(texture, vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y));\n    if (textureColor.a == 0.0) {\n        discard;\n    } else {\n        float mixValue = vColor.rgb != vec3(0) ? 0.7 : 0.0;\n        gl_FragColor = vec4(mix(textureColor.rgb, vColor.rgb, mixValue), textureColor.a);\n    }\n}\n`,uniforms:{uDPI:{type:"float",value:1},texture:{type:"t",value:null},uHoveredObject:{type:"float",value:0},uSelectedObject:{type:"float",value:0},uHoverColor:{type:"vec4",value:[0,0,0,0]},uSelectColor:{type:"vec4",value:[0,0,0,0]},uSelectHoverColor:{type:"vec4",value:[0,0,0,0]}},transparent:!0,depthTest:!0,vertexColors:!0}}},60440:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLayer=t.isLayerWithSchema=t.isObjectstoreLayer=t.isInteractiveMapsLayer=t.isIndexLayer=t.isStreamLayer=t.isVolatileLayer=t.isVersionedLayer=void 0;const r=i(90546),n=i(15762),o=i(84428),a=i(42589);function s(e){return"versioned"===(null==e?void 0:e.layerType)}function l(e){return"volatile"===(null==e?void 0:e.layerType)}function c(e){return"stream"===(null==e?void 0:e.layerType)}function u(e){return"index"===(null==e?void 0:e.layerType)}function d(e){return"interactivemap"===(null==e?void 0:e.layerType)}function h(e){return"objectstore"===(null==e?void 0:e.layerType)}function m(e){return s(e)||l(e)||c(e)||u(e)||h(e)}t.isVersionedLayer=s,t.isVolatileLayer=l,t.isStreamLayer=c,t.isIndexLayer=u,t.isInteractiveMapsLayer=d,t.isObjectstoreLayer=h,t.isLayerWithSchema=m;class p extends o.EventDispatcher{constructor(e,t,i){super(),this.model=e,this.catalog=t,this.settings=i,this.m_requestBuilders=new Map,void 0!==this.settings&&(this.artifactClient=new n.ArtifactClient(this.settings))}async getTile(e,t){let i;const r="string"==typeof e?e:e.toHereTile();try{i=await this.getPartition(r,t)}catch(e){if(404===e.status){const e=`Error downloading tile "${r}" from catalog "${this.catalog.hrn}"`;throw new a.NotFoundError(e)}throw e}return i.arrayBuffer()}async getSchemaDetails(){var e;if(void 0!==this.artifactClient&&m(this.model)&&void 0!==(null===(e=this.model.schema)||void 0===e?void 0:e.hrn)){if(void 0===this.m_schemaDetailsPromise){const e=(new n.SchemaDetailsRequest).withSchema(r.HRN.fromString(this.model.schema.hrn));this.m_schemaDetailsPromise=this.artifactClient.getSchemaDetails(e)}return this.m_schemaDetailsPromise}}async getSchema(){const e=await this.getSchemaDetails();if(void 0===(null==e?void 0:e.variants)||void 0===this.artifactClient)return;const t=e.variants.find((e=>"ds"===e.id));if(void 0!==t){if(void 0===this.m_schemaPromise){const e=(new n.SchemaRequest).withVariant(t);this.m_schemaPromise=this.artifactClient.getSchema(e)}return this.m_schemaPromise}}get contentType(){return d(this.model)||h(this.model)?void 0:s(this.model)||l(this.model)?this.model.contentType:void 0}get partitioning(){return d(this.model)||h(this.model)?void 0:s(this.model)||l(this.model)?this.model.partitioning:void 0}get schema(){return d(this.model)||h(this.model)?void 0:s(this.model)||l(this.model)?this.model.schema:void 0}async getRequestBuilder(e){if(void 0===this.settings)throw new Error("getRequestBuilder cannot work without OlpClientSettings");let t=this.m_requestBuilders.get(e);return void 0===t&&(t=r.RequestFactory.create(e,"v1",this.settings,this.catalog.hrn),this.m_requestBuilders.set(e,t)),t}}t.BaseLayer=p},8386:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Catalog=t.MAX_NUMBER_OF_REQUESTS=t.LIMIT_OF_VERSIONS_TO_FETCH=void 0;const r=i(90546),n=i(65727),o=i(15762),a=i(5867),s=i(1949),l=i(31994),c=i(72558),u=i(72661),d=i(76919),h=i(54278),m=new o.CatalogRequest;t.LIMIT_OF_VERSIONS_TO_FETCH=1e3,t.MAX_NUMBER_OF_REQUESTS=10;class p{constructor(e,t){this.model=e,this.catalogClient=t,this.hrn=r.HRN.fromString(this.model.hrn)}static async getCatalog(e,t){const i=new o.CatalogClient(e,t),r=await i.getCatalog(m);return new p(r,i)}static async getCatalogConfigsBySchema(e,t){const i=new o.ConfigClient(t),r=(new o.CatalogsRequest).withSchema(e);return i.getCatalogs(r)}static async findCatalogs(e,t,i){var o,a,s;t=t.trim().toLowerCase();const l=await r.RequestFactory.create("config","v1",e),c=await n.ConfigApi.getCatalogs(l,{verbose:"false",limit:i,q:t}),d=[];for(const e of null!==(a=null===(o=c.results)||void 0===o?void 0:o.items)&&void 0!==a?a:[]){const t=null!==(s=e.name)&&void 0!==s?s:e.title,i=e.hrn;void 0!==t&&void 0!==i&&d.push({name:t,hrn:i})}return d.sort(((e,i)=>{const n=e.name.toLowerCase(),o=i.name.toLowerCase();let a,s;try{a=r.HRN.fromString(e.hrn).data.resource,s=r.HRN.fromString(i.hrn).data.resource}catch(e){}let l=u.compareStringsForSorting(e.hrn,i.hrn,t);return 0===l&&void 0!==a&&void 0!==s&&(l=u.compareStringsForSorting(a,s,t)),0===l&&(l=u.compareStringsForSorting(n,o,t)),l})),d}static async getCatalogsWithSchema(e,t){const i=await p.getCatalogConfigsBySchema(e,t);return void 0===i.results||void 0===i.results.items?[]:i.results.items.reduce(((t,i)=>(void 0===i.layers||(i.layers=i.layers.filter((t=>{var i;return(null===(i=t.schema)||void 0===i?void 0:i.hrn)===e})),t.push(i)),t)),[])}async getLayer(e,t=-1){const i=this.model.layers.find((t=>t.id===e));if(i){if(this.catalogClient instanceof a.InMemoryCatalogClient){const e=await this.catalogClient.getCatalog();return new s.InMemoryLayer(e.layers[0],this)}switch(i.layerType){case"versioned":const e=await this.getLatestVersion();if(-1===t)t=e;else if(t!==e){if(t>e)return;if(t<await this.getEarliestVersion())return}return new d.VersionedLayer(Object.assign(Object.assign({},i),{version:t}),this,this.catalogClient.settings);case"volatile":return new h.VolatileLayer(i,this,this.catalogClient.settings);case"objectstore":return new c.ObjectStoreLayer(i,this,this.catalogClient.settings);case"interactivemap":return new l.InteractiveLayer(i,this,this.catalogClient.settings);default:return}}}async getEarliestVersion(){var e;return null!==(e=this.m_getEarliestVersionPromise)&&void 0!==e?e:this.m_getEarliestVersionPromise=this.catalogClient.getEarliestVersion(new o.CatalogVersionRequest)}async getLatestVersion(){try{return await this.catalogClient.getLatestVersion(new o.CatalogVersionRequest)}catch(e){throw new Error("Cannot get latest version. Check if catalog is properly configured and has a valid version set.")}}async getVersionsInfo(e,t){if(-1===e&&(e=await this.getEarliestVersion()-1),(t=null!=t?t:await this.getLatestVersion())-e==1)return this.getSpecificVersion(t);const i=await this.getAllVersions(),r=i.filter((i=>i.version>e&&i.version<=t));if(0!==r.length)return r;const n=i.filter((t=>t.version<=e));return 0===n.length?[]:[n[n.length-1]]}async getLayerVersions(e){const t=(new o.LayerVersionsRequest).withVersion(null!=e?e:await this.getLatestVersion());return await this.catalogClient.getLayerVersions(t)}async getSpecificVersion(e){const t=void 0!==this.m_versions?this.m_versions.find((t=>t.version===e)):void 0;if(void 0!==t)return[t];const i=(new o.CatalogVersionRequest).withStartVersion(e-1).withEndVersion(e);return(await this.catalogClient.getVersions(i)).versions}async getAllVersions(){if(void 0!==this.m_versions)return this.m_versions;const[e,i]=await Promise.all([this.getEarliestVersion(),this.getLatestVersion()]),r=[],n=Math.min((i-e+1)/t.LIMIT_OF_VERSIONS_TO_FETCH,t.MAX_NUMBER_OF_REQUESTS);for(let a=0;a<n;a++){const n=(new o.CatalogVersionRequest).withStartVersion(Math.max(i-t.LIMIT_OF_VERSIONS_TO_FETCH*(a+1),e-1)).withEndVersion(i-a*t.LIMIT_OF_VERSIONS_TO_FETCH);r.unshift(this.catalogClient.getVersions(n))}return Promise.all(r).then((e=>(this.m_versions=e.reduce(((e,t)=>e.concat(...t.versions)),[]),this.m_versions)))}}t.Catalog=p},87122:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCoverageDataLayer=void 0,t.isCoverageDataLayer=function(e){return"function"==typeof e.getIndex}},10010:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DIReader=void 0;const r=i(43281);class n extends r.Reader{static create(e){return new n(e)}float(){return parseFloat(super.float().toPrecision(7))}}t.DIReader=n},53439:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DummyDataProvider=void 0;const r=i(19898);class n extends r.DataProvider{async connect(){}ready(){return!0}async getTile(e){return new ArrayBuffer(0)}dispose(){}}t.DummyDataProvider=n},5867:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryCatalogClient=void 0,t.InMemoryCatalogClient=class{constructor(){this.hrn="hrn:here:data:::in-memory-catalog-hrn"}async getCatalog(){return{id:"in-memory-catalog",hrn:this.hrn,layers:[{id:"in-memory-layer",hrn:"",layerType:"volatile",partitioning:{scheme:"heretile"},contentType:void 0}],name:"",created:"",description:"",replication:{},summary:"",tags:[],version:-1}}async getEarliestVersion(){return-1}async getLayerVersions(){return[{layer:"in-memory-layer",version:-1,timestamp:0}]}async getLatestVersion(){return-1}async getVersions(){return{versions:[{dependencies:[],version:-1,timestamp:0}]}}}},1949:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryLayer=void 0;const r=i(60440);class n extends r.BaseLayer{constructor(){super(...arguments),this.m_partitionsStorage=new Map}setModel(e){this.model.contentType=e.contentType,void 0!==e.name&&(this.model.name=e.name),void 0!==e.id&&(this.model.id=e.id),void 0!==e.partitioningScheme&&(this.model.partitioning={scheme:e.partitioningScheme})}setPartition(e,t){this.m_partitionsStorage.set(e,t)}removePartitions(){this.m_partitionsStorage.clear()}async getPartition(e,t){const i=this.m_partitionsStorage.get(e);let r;return i&&(r=i.data),"object"!=typeof r||r instanceof ArrayBuffer||(r=JSON.stringify(r)),new Response(r)}async getPartitionsInfo(e,t,i){const r=[];for(const i of e){if(!this.m_partitionsStorage.has(i))continue;const e={partition:i,dataHandle:"",version:-1};if(t)for(const r of t){let t="";if(-1!==["dataSize","compressedDataSize"].indexOf(r)){const e=await this.getPartition(i);t=(await e.arrayBuffer()).byteLength}e[r]=t}r.push(e)}return r}async getAllPartitionsInfo(e,t){let i=Array.from(this.m_partitionsStorage.keys());return e&&(i=i.slice(0,e)),this.getPartitionsInfo(i,t)}}t.InMemoryLayer=n},92533:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIntersectionIndex=t.InteractiveIntersectionAgent=void 0;const r=i(84428),n=i(6308),o=i(72661);class a extends r.EventDispatcher{constructor(e,t=!0){super(),this.m_objects=new Array,this.m_intersectionFilters=new Map,this.m_intersectionSorters=new Map,this.m_selectionCounter=0,this.m_mapView=e,this.m_mouseMoveHandler=this.onMouseMove.bind(this),this.m_mouseOutHandler=this.onMouseOut.bind(this),t&&(e.canvas.addEventListener("mousemove",this.m_mouseMoveHandler),e.canvas.addEventListener("mouseout",this.m_mouseOutHandler),n.MapControlHandler.getInstance(e).addEventHandler("select",((t,i)=>this.onClick(e,t,i.ctrlKey))))}raycastObjectsAtCoordinates(e,t){void 0!==this.m_raycastTimeout&&window.clearTimeout(this.m_raycastTimeout),this.m_raycastTimeout=window.setTimeout((()=>{const i=o.getCanvasCoordinates(this.m_mapView,e,t),r=this.raycastIntersections(i.x,i.y);this.processIntersections(r,e,t)}),a.DE_BOUNCE_DELAY)}processIntersections(e,t,i){const r=this.m_mapView.canvas.getBoundingClientRect(),n=document.body.getBoundingClientRect(),o=t-r.left+n.left,s=i-r.top+n.top;(null==e?void 0:e.length)?this.dispatchEvent({type:a.EVENT_INTERSECTION_CHANGE,intersected:!0,intersection:e[0],mouseX:o,mouseY:s}):this.dispatchEvent({type:a.EVENT_INTERSECTION_CHANGE,intersected:!1,mouseX:o,mouseY:s})}processMouseOutEvent(e){this.dispatchEvent({type:a.EVENT_MOUSE_OUT_OF_CANVAS,newTargetElement:e.target})}processClick(e,t,i,r){void 0!==e?this.dispatchEvent({type:a.EVENT_OBJECT_SELECT,intersected:!0,intersection:e,ctrlKey:r,mouseX:t,mouseY:i}):this.dispatchEvent({type:a.EVENT_NOTHING_SELECTED})}raycastIntersections(e,t,i=!1){return this.filterAndSortIntersections(this.raycastObjects(this.getRaycaster(e,t),i))}getRaycaster(e=0,t=0){return this.m_mapView.pickHandler.raycasterFromScreenPoint(e,t)}setIntersectionFilter(e,t){this.m_intersectionFilters.set(e,t)}setIntersectionSort(e,t){this.m_intersectionSorters.set(e,t)}attachObjects(e,t=!0){void 0!==e&&(t?o.appendToArray(this.m_objects,e):this.m_objects=e)}detachObject(e){const t=this.m_objects.indexOf(e);t>=0&&this.m_objects.splice(t,1)}dispose(){this.m_mapView.canvas.removeEventListener("mousemove",this.m_mouseMoveHandler),this.m_mapView.canvas.removeEventListener("mouseout",this.m_mouseOutHandler)}onMouseMove(e){e.preventDefault(),this.raycastObjectsAtCoordinates(e.pageX,e.pageY)}onMouseOut(e){e.preventDefault(),void 0!==this.m_mouseOutTimeout&&window.clearTimeout(this.m_mouseOutTimeout),this.m_mouseOutTimeout=window.setTimeout((()=>this.processMouseOutEvent(e)),a.DE_BOUNCE_DELAY)}onClick(e,t,i){const r=e.getScreenPosition(t);if(void 0===r)return;this.m_lastSelectionPoint&&this.m_lastSelectionPoint.equals(r)?this.m_selectionCounter++:this.m_selectionCounter=0;const n=this.raycastIntersections(r.x,r.y),o=n[this.m_selectionCounter%n.length];this.processClick(o,r.x,r.y,i),this.m_lastSelectionPoint=r}filterAndSortIntersections(e){return this.m_intersectionFilters.forEach((t=>e=e.filter(t))),this.m_intersectionSorters.forEach((t=>e.sort(t))),e}raycastObjects(e,t=!1){const i=[],n=this.m_mapView.pixelToWorld,a=n/2;void 0===e.params.Points&&(e.params.Points={threshold:1}),void 0===e.params.Line&&(e.params.Line={threshold:1});const s=e.params.Line.threshold,l=e.params.Points.threshold;for(const c of this.m_objects){const u=c instanceof r.LineSegments&&c.material instanceof r.LineBasicMaterial&&c.material.userData&&c.material.userData.lineWidth?c.material.userData.lineWidthUnits===o.Units.meters?c.material.userData.lineWidth:c.material.userData.lineWidth*a:s;if(e.params.Line.threshold=Math.max(u,n),c instanceof r.Points){const t=c.material instanceof r.ShaderMaterial&&c.material.uniforms.uSize&&c.material.uniforms.uSize.value||c.material instanceof r.PointsMaterial&&c.material.sizeAttenuation&&c.material.size/2||l;e.params.Points.threshold=t*n}const d=e.intersectObject(c,!0);for(const e of d)void 0!==e&&i.push(e);if(t&&i.length>0)break}return i.sort(((e,t)=>e.distance-t.distance)),e.params.Line.threshold=s,e.params.Points.threshold=l,i}}t.InteractiveIntersectionAgent=a,a.EVENT_INTERSECTION_CHANGE="intersectionchange",a.EVENT_OBJECT_SELECT="objectselect",a.EVENT_NOTHING_SELECTED="noselection",a.EVENT_MOUSE_OUT_OF_CANVAS="mouseoutofcanvas",a.DE_BOUNCE_DELAY=40,t.getIntersectionIndex=function(e){if(!e.intersected||!e.intersection)return;let t=e.intersection.faceIndex;return null==t&&(t=e.intersection.index),null!=t?t:void 0}},31994:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveLayer=void 0;const r=i(32941),n=i(90546),o=i(65727),a=i(60440);class s extends a.BaseLayer{constructor(e,t,i){super(e,t,i),this.model=e}async getFeaturesForBoundingBox(e,t){const i=await this.getRequestBuilder(),r=`${i.baseUrl}/layers/${this.model.id}/bbox`,n=new o.UrlBuilder(r);return n.appendQuery("mode","viz"),n.appendQuery("bbox",`${e.west.toFixed(5)},${e.south.toFixed(5)},${e.east.toFixed(5)},${e.north.toFixed(5)}`),n.appendQuery("vizSampling","high"),void 0!==t&&n.appendQuery("limit",t),i.request(n)}async getWebtileInteractive(e,t,i=1e5,n){const a=await this.getRequestBuilder(),s=r.TileKey.fromHereTile(e),{level:l,column:c,row:u}=s,d=`${a.baseUrl}/layers/${this.model.id}/tile/web/${l}_${c}_${u}`,h=new o.UrlBuilder(d);return void 0!==i&&h.appendQuery("limit",i),void 0!==t&&h.appendQuery("vizSampling",t),h.appendQuery("mode","viz"),h.appendQuery("selection","*"),h.appendQuery("clip","true"),a.requestBlob(h)}async getPartition(e,t){return this.getWebtileInteractive(e)}getPartitionsInfo(e,t,i){throw new Error("Method not implemented.")}getAllPartitionsInfo(e,t){throw new Error("Method not implemented.")}async getStatistics(e){return o.InteractiveApi.getStatistics(await this.getRequestBuilder(),{layerId:this.model.id,skipCache:e})}async getFeature(e){const t=await this.getRequestBuilder();let i;try{i=await o.InteractiveApi.getFeature(t,{layerId:this.model.id,featureId:e})}catch(e){}return i}getRequestBuilder(e="v1"){var t;if(void 0===this.settings)throw new Error("InteractiveLayer instance was created without OlpClientSettings.");return null!==(t=this.m_requestBuilder)&&void 0!==t||(this.m_requestBuilder=n.RequestFactory.create("interactive",e,this.settings,this.catalog.hrn)),this.m_requestBuilder}}t.InteractiveLayer=s},72558:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectStoreLayer=t.MAX_AMOUNT_OF_ITEMS_TO_FETCH=void 0;const r=i(90546),n=i(65727),o=i(95757),a=i(60440),s=i(62984);var l;t.MAX_AMOUNT_OF_ITEMS_TO_FETCH=1e5,function(e){e[e.File=0]="File",e[e.Folder=1]="Folder"}(l||(l={}));class c extends a.BaseLayer{constructor(e,t,i){super(e,t,i),this.model=e,this.catalog=t,this.settings=i,this.schemaPluginStorage=new Map,this.m_currentPath="",this.m_isLoadingContent=!1,this.m_pluginPromises=new Map}get isLoadingContent(){return this.m_isLoadingContent}set isLoadingContent(e){this.m_isLoadingContent=e}get currentPath(){return this.m_currentPath}set currentPath(e){this.m_currentPath=e}get partitioning(){return this.model.partitioning}get requestBuilderPromise(){return void 0===this.m_requestBuilder&&(this.m_requestBuilder=r.RequestFactory.getBaseUrl("blob","v2",this.settings,this.catalog.hrn).then((async e=>e?Promise.resolve(new s.RequestBuilderObjectStore(this.settings.downloadManager,e,this.settings.token)):Promise.reject(new Error('Error getting base url to the service: "blob:v2"'))))),this.m_requestBuilder}async getData(e="",t=!1){const i=await this.getAllItemsInFolder(e);let r=[];if(t){const e=i.map((e=>"object"===e.type?this.getContentType(e.name):Promise.resolve(void 0)));r=await Promise.all(e)}return i.map(((t,i)=>Object.assign(Object.assign({},t),{contentType:r[i],name:t.name.replace(`${e}/`,"")})))}async getContentType(e){var t;return void 0!==(null===(t=this.m_activeFolderConfig)||void 0===t?void 0:t.contentType)?this.m_activeFolderConfig.contentType:(e.startsWith(this.currentPath)||(e=this.currentPath+"/"+e),(await n.ObjectStoreApi.checkKeyExists(await this.requestBuilderPromise,{layerId:this.model.id,key:e})).headers.get("Content-Type"))}async checkKeyExists(e){return!!await this.checkFileExists(e)||this.checkFolderExists(e)}async getPartition(e,t){var i,r,o;const a=null!==(o=null===(r=null===(i=this.m_activeFolderConfig)||void 0===i?void 0:i.partitionIndices)||void 0===r?void 0:r.get(e))&&void 0!==o?o:e,s=this.currentPath?this.currentPath+"/"+a:a;return n.ObjectStoreApi.getBlobByKey(await this.requestBuilderPromise,{layerId:this.model.id,key:s})}async getIndex(){var e,t;return"heretile"!==(null===(e=this.model.partitioning)||void 0===e?void 0:e.scheme)||void 0===(null===(t=this.m_activeFolderConfig)||void 0===t?void 0:t.partitionIndices)?new Map:this.m_activeFolderConfig.partitionIndices}async detectMapConfig(){var e,t,i,r,n,o;this.m_activeFolderConfig=void 0;const a=".here/map.json",s=this.currentPath?this.currentPath+"/"+a:a;let l;return await this.checkFileExists(s)&&(l=await(await this.getPartition(a)).json(),l.prefix=null!==(e=l.prefix)&&void 0!==e?e:"",l.suffix=null!==(t=l.suffix)&&void 0!==t?t:"",l.adaptive=null!==(i=l.adaptive)&&void 0!==i&&i,l.folders=null!==(r=l.folders)&&void 0!==r&&r,l.hive=null!==(n=l.hive)&&void 0!==n&&n,l.hive&&(l.folders=!0),l.defaults=null!==(o=l.defaults)&&void 0!==o?o:{}),this.parseMapConfig(l)}checkPartitionExists(e){return void 0!==this.m_activeFolderConfig&&this.m_activeFolderConfig.partitions.some((t=>t.partition===e))}async getObjectsInfo(e){const t=""===this.currentPath?e:`${this.currentPath}/${e}`;try{const i=await n.ObjectStoreApi.checkKeyExists(await this.requestBuilderPromise,{layerId:this.model.id,key:t}),r=i.headers.get("Content-Length"),o=i.headers.get("Content-Type"),a=i.headers.get("Last-Modified");return[{name:e,contentType:null!=o?o:void 0,size:r?+r:void 0,type:"object",lastModified:null!=a?a:void 0}]}catch(i){return await this.checkFolderExists(t)?[{name:e,type:"commonPrefix"}]:[]}}async getPartitionsInfo(e,t,i){return void 0===this.m_activeFolderConfig?[]:this.m_activeFolderConfig.partitions.filter((({partition:t})=>e.includes(t)))}getFolders(){return void 0===this.m_activeFolderConfig?[]:this.m_activeFolderConfig.folders}getOriginalPartitionName(e){var t,i,r;return null!==(r=null===(i=null===(t=this.m_activeFolderConfig)||void 0===t?void 0:t.partitionIndices)||void 0===i?void 0:i.get(e))&&void 0!==r?r:e}getAllPartitionsInfo(e,t){return Promise.reject("Method is not supported by ObjectStoreLayer.")}async getAllItemsInFolder(e=""){const i=[];let r;do{const t=await n.ObjectStoreApi.listKeys(await this.requestBuilderPromise,{layerId:this.model.id,parent:e,pageToken:r});r=t.pageToken,i.push(...t.items)}while(void 0!==r&&i.length<t.MAX_AMOUNT_OF_ITEMS_TO_FETCH);return i}async checkFileExists(e){try{return await n.ObjectStoreApi.checkKeyExists(await this.requestBuilderPromise,{layerId:this.model.id,key:e}),!0}catch(e){return!1}}async checkFolderExists(e){try{return(await n.ObjectStoreApi.listKeys(await this.requestBuilderPromise,{layerId:this.model.id,parent:e,limit:1})).items.length>0}catch(e){return!1}}async parseMapConfig(e){if(void 0===e)return this.model.contentType=void 0,this.model.schema=void 0,this.model.partitioning={scheme:"generic"},this.m_activeFolderConfig=void 0,null;this.model.contentType=e.defaults.contentType,this.model.schema={hrn:e.defaults.schemaHrn},this.model.partitioning={scheme:e.keytype,tileLevels:e.levels};const t=void 0===e.defaults.schemaHrn||""===e.defaults.schemaHrn?void 0:new o.HRNSchemaProvider(this.artifactClient,e.defaults.schemaHrn),{partitions:i,partitionIndices:r}=await this.processPartitions(e),n=i.reduce(((e,t)=>(t.type===l.Folder&&e.push(t.partition),e)),[]);return await(null==t?void 0:t.connect()),this.schemaPluginStorage.set(this.currentPath,Object.assign(Object.assign({},this.schemaPluginStorage.get(this.currentPath)),{initialSchema:t,initialPlugin:t?t.getRenderer():await this.detectRendererPlugin()})),this.m_activeFolderConfig={schemaProvider:t,partitions:i,partitionIndices:r,folders:n,rendererPlugin:await this.detectRendererPlugin(),dataLevels:e.levels,scheme:e.keytype,view:e.defaults.view,contentType:e.defaults.contentType,prefix:e.prefix,suffix:e.suffix},this.m_activeFolderConfig}async detectRendererPlugin(){const e=".here/renderers/default.js",t=this.currentPath?this.currentPath+"/"+e:e;let i=this.m_pluginPromises.get(t);return void 0===i&&(i=new Promise((async(i,r)=>{try{await this.checkFileExists(t)||i(void 0),i((await this.getPartition(e)).text())}catch(e){r()}})),this.m_pluginPromises.set(t,i)),i}async processPartitions(e){const t=new Map;return{partitions:(await this.getAllItemsInFolder(this.currentPath)).filter((e=>".here"!==e.name&&!e.name.endsWith("/.here"))).map((i=>{const r=this.currentPath?i.name.replace(this.currentPath+"/",""):i.name,{prefix:n,suffix:o}=e;if(r.startsWith(n)&&r.endsWith(o)){let e=r.substring(n.length);e=e.substring(0,e.length-o.length),isNaN(+e)||0==+e||t.set(e,r)}return{version:-1,partition:r,dataSize:i.size,type:"commonPrefix"===i.type?l.Folder:l.File}})),partitionIndices:t}}}t.ObjectStoreLayer=c},59678:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartitionDecoder=void 0;const r=i(81450),n=i(82246),o=i(23086),a=i(72661),s=i(54278);t.PartitionDecoder=class{constructor(e){this.dataProvider=e}async decode(e){try{return await this.dataProvider.getTileDecoded(e)}catch(t){if(404===t.status){const t=e.mortonCode();throw this.dataProvider.layer instanceof s.VolatileLayer?new o.NotFoundVolatilePartitionError(t):new n.ErrorToTranslate("olpdi.interactiveDS.empty-partition-error",{partitionId:t})}throw t}}async decodeRawResponse(e){if(void 0===this.dataProvider.layer)return{dataSize:0,rawData:new ArrayBuffer(0)};const t=await e.arrayBuffer(),i={rawData:t,dataSize:t.byteLength},o=this.dataProvider.layer.contentType;if("application/x-protobuf"===o)try{i.decodedData=await this.dataProvider.decodeProtobufData(t)}catch(e){i.error=r.DecodingError.decodingError(e.message)}else if(void 0===o||!o.startsWith("text/")&&"application/geo+json"!==o&&"application/vnd.geo+json"!==o&&"application/json"!==o)i.error=new n.ErrorToTranslate("olpdi.interactiveDS.content-type-not-supported",{contentType:o});else{const e=a.arrayBufferToString(t);i.decodedData=o.startsWith("text/")?e:JSON.parse(e)}return i}async getRawResult(e){const t=await this.dataProvider.getTile(e);if(t instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&t instanceof SharedArrayBuffer)return{dataSize:t.byteLength,rawData:t};throw new n.ErrorToTranslate("olpdi.interactiveDS.only-arraybuffer-is-supported")}}},70900:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartitionInfoStore=void 0,t.PartitionInfoStore=class{constructor(e){this.dataProvider=e,this.m_partitionStore=new Map}async getPartitionsData(e,t=!0){let i=[];const r=[];if(t?e.forEach((e=>{const t=this.m_partitionStore.get(e);void 0===t?i.push(e):null!==t&&r.push(t)})):i=e,0===i.length)return r;if(void 0===this.dataProvider.layer)return[];(await this.dataProvider.layer.getPartitionsInfo(i,["dataSize","compressedDataSize"])).forEach((e=>{this.m_partitionStore.set(e.partition,e),r.push(e)}));for(const e of i)this.m_partitionStore.has(e)||this.m_partitionStore.set(e,null);return r}async getPartitionSize(e,t=!0){const i=await this.getPartitionsData([e],t);return 0===i.length?void 0:i[0].dataSize}}},62984:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestBuilderObjectStore=void 0;const r=i(90546);class n extends r.DataStoreRequestBuilder{async download(e,t){return void 0!==t&&(t.cache="no-cache"),super.download(e,t)}async downloadBlob(e,t){return void 0!==t&&(t.cache="no-cache"),super.downloadBlob(e,t)}}t.RequestBuilderObjectStore=n},32797:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.UserMessageType=void 0,(i=t.UserMessageType||(t.UserMessageType={}))[i.Info=0]="Info",i[i.Warning=1]="Warning",i[i.Error=2]="Error"},72661:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareStringsForSorting=t.isContentTypeGeoJSON=t.isContentTypeJSON=t.isContentTypeProtobuf=t.isContentTypeText=t.nearlyEqual=t.isValidGeoJSON=t.isDataGeoJSON=t.getPlainObject=t.arrayBufferToString=t.extendArrayWithValue=t.appendToArray=t.aggregateRange=t.getValueInRange=t.reconstructLongs=t.LongUtils=t.convertCamelToSnakeCase=t.getCanvasCoordinates=t.getValue=t.getUnits=t.Units=t.getRelativeScreenCoordinates=void 0;const r=i(65096),n=i(43720),o=i(84428),a=i(25850);var s;t.getRelativeScreenCoordinates=function(e,t,i,r=!0){const n=document.body.getBoundingClientRect(),a=e.canvas.getBoundingClientRect();let s=a.left-n.left;const l=a.top-n.top;return!0===r&&e.canvas.parentElement&&(s-=e.canvas.parentElement.offsetLeft),t-=s,i-=l,new o.Vector2(t,i)},function(e){e[e.pixels=0]="pixels",e[e.meters=1]="meters"}(s=t.Units||(t.Units={})),t.getUnits=function(e){return"string"!=typeof e?s.pixels:"m"===(e=e.trim())[e.length-1]?s.meters:s.pixels},t.getValue=function(e){return"number"==typeof e?e:parseFloat(e)},t.getCanvasCoordinates=function(e,t,i){const r=document.body.getBoundingClientRect(),n=e.canvas.getBoundingClientRect();return{x:t-=n.left-r.left,y:i-=n.top-r.top}},t.convertCamelToSnakeCase=function e(t){if(null===t||"object"!=typeof t)return t;const i=new t.constructor;for(const r in t)t.hasOwnProperty(r)&&(i[r.split(/(?=[A-Z])/).join("_").toLowerCase()]=e(t[r]));return i};class l{static isLong(e){return e instanceof n}static isLongLike(e){return"object"==typeof e&&null!=e&&"high"in e&&"low"in e&&"unsigned"in e}static getSame(e){const t=`${e.low.toString(36)}-${e.high.toString(36)}-${e.unsigned?"u":"s"}`;if(!l.m_longs.has(t)){const i=e instanceof n?e:new n(e.low,e.high,e.unsigned);l.m_longs.set(t,i)}return l.m_longs.get(t)}static abs(e){return e.isPositive()?e:l.getSame(e.multiply(-1))}static clear(){l.m_longs.clear()}}function c(e){if("function"==typeof TextDecoder)return(new TextDecoder).decode(e);throw Error("Polyfill for TextDecoder isn't found.")}let u;function d(e){return void 0===u&&(u=r().compile(a.geoJSONSchema)),{isValid:u(e),errors:u.errors}}function h(e){return"application/geo+json"===e||"application/vnd.geo+json"===e}t.LongUtils=l,l.m_longs=new Map,t.reconstructLongs=function e(t){for(const i in t){if(!t.hasOwnProperty(i))continue;const r=t[i];null!=r&&(r instanceof n||!r.hasOwnProperty("high")||!r.hasOwnProperty("low")||!r.hasOwnProperty("unsigned")?"object"==typeof r&&e(r):t[i]=l.getSame(r))}},t.getValueInRange=function(e,t){for(const i of e){const[e,r]=i;for(const i of r)if(t>=i.start&&t<=i.end)return e}},t.aggregateRange=function(e,t,i){let r=e.get(t);void 0===r&&(r=[],e.set(t,r));const n=r[r.length-1];if(void 0!==n){if(n.start===i.start&&n.end===i.end)return;if(n.end+1===i.start)return void(n.end=i.end)}r.push(Object.assign({},i))},t.appendToArray=function(e,t){if(t instanceof Array){const i=e.length,r=t.length;t.length>500&&(e.length=i+r);for(let n=0;n<r;n++)e[i+n]=t[n]}else for(const i of t)e.push(i)},t.extendArrayWithValue=function(e,t,i){t.length+=i,t.fill(e,t.length-i,t.length)},t.arrayBufferToString=c,t.getPlainObject=function e(t){const i=Array.isArray(t)?[]:{};for(const r in t)"function"!=typeof t[r]&&(i[r]=null!==t[r]&&"object"==typeof t[r]?e(t[r]):t[r]);return i},t.isDataGeoJSON=function(e){if(null===e)return!1;let t,i;try{if("string"==typeof e)t=JSON.parse(e);else if(e instanceof ArrayBuffer){const i=c(e);t=JSON.parse(i)}else"object"==typeof e&&(t=e)}catch(e){return!1}return void 0!==t&&(i=d(t)),void 0!==i&&!0===i.isValid},t.isValidGeoJSON=d,t.nearlyEqual=(e,t,i=1e-6)=>Math.abs(e-t)<i,t.isContentTypeText=function(e){return e.startsWith("text/")},t.isContentTypeProtobuf=function(e){return"application/x-protobuf"===e},t.isContentTypeJSON=function(e){return h(e)||"application/json"===e},t.isContentTypeGeoJSON=h,t.compareStringsForSorting=function(e,t,i){return e===i&&t!==i?-1:t===i&&e!==i?1:e.startsWith(i)&&!t.startsWith(i)?-1:t.startsWith(i)&&!e.startsWith(i)?1:e.includes(i)&&!t.includes(i)?-1:t.includes(i)&&!e.includes(i)?1:0}},76919:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VersionedLayer=void 0;const r=i(32941),n=i(90546),o=i(65727),a=i(15762),s=i(82246),l=i(60440);class c extends l.BaseLayer{constructor(e,t,i){if(super(e,t,i),e.version<0)throw new s.ErrorToTranslate("olpdi.interactiveDS.versioned-layer.negative-version-error");this.m_version=e.version,this.layerClient=this.createLayerClient(),this.statisticsClient=new a.StatisticsClient(i)}get version(){return this.m_version}setVersion(e){this.m_version=e,this.layerClient=this.createLayerClient(e),this.model.version=e,this.dispatchEvent({type:c.ON_VERSION_CHANGE})}async getPartition(e,t){const i=(new a.DataRequest).withPartitionId(e);return this.layerClient.getData(i,t)}async getVersionInfo(){return(await this.catalog.getVersionsInfo(this.version-1,this.version))[0]}async getPartitionsInfo(e,t,i){void 0===this.minimalVersion&&(this.minimalVersion=await this.catalog.getEarliestVersion()),void 0===this.minVersionLayerClient&&(this.minVersionLayerClient=this.createLayerClient(this.minimalVersion));const r=this.version<this.minimalVersion?this.minVersionLayerClient:this.layerClient,n=(new a.PartitionsRequest).withPartitionIds(e);return t&&n.withAdditionalFields(t),(await r.getPartitions(n,i)).partitions}async getAllPartitionsInfo(e,t){const i=await this.getRequestBuilder("metadata"),r=`${i.baseUrl}/layers/${this.model.id}/partitions`,n=new o.UrlBuilder(r);return n.appendQuery("version",this.version),n.appendQuery("additionalFields",t),void 0!==e&&n.appendQuery("limit",e),(await i.request(n)).partitions}async getIndex(e,t=0,i){const n=new Map;if("heretile"!==this.model.partitioning.scheme)return n;const o=(new a.QuadKeyPartitionsRequest).withQuadKey(e).withDepth(t),s=await this.layerClient.getPartitions(o,i);if(void 0!==s.subQuads){const t=new r.TileKey(e.row,e.column,e.level);for(const e of s.subQuads){const i=r.TileKey.fromHereTile(e.subQuadKey).toQuadKey(),o=(""===i?t:t.addedSubKey(i)).toHereTile();n.set(o,e.dataHandle)}}if(void 0!==s.parentQuads)for(const e of s.parentQuads)n.set(e.partition,e.dataHandle);return n}async getSummary(){const e=(new a.SummaryRequest).withCatalogHrn(this.catalog.hrn).withLayerId(this.model.id);return this.statisticsClient.getSummary(e)}async getStatistics(e,t=12){const i=(new a.StatisticsRequest).withLayerId(this.model.id).withTypemap(e).withDataLevel(t).withCatalogHrn(this.catalog.hrn);return(await this.statisticsClient.getStatistics(i)).blob()}createLayerClient(e){const t={catalogHrn:n.HRN.fromString(this.catalog.model.hrn),layerId:this.model.id,settings:this.settings,version:null!=e?e:this.version};return new a.VersionedLayerClient(t)}}t.VersionedLayer=c,c.ON_VERSION_CHANGE="on-version-change"},54278:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VolatileLayer=void 0;const r=i(32941),n=i(90546),o=i(65727),a=i(15762),s=i(60440);class l extends s.BaseLayer{constructor(e,t,i){super(e,t,i);const r={catalogHrn:n.HRN.fromString(this.catalog.model.hrn),layerId:this.model.id,settings:i};this.layerClient=new a.VolatileLayerClient(r)}async getPartition(e,t){const i=(new a.DataRequest).withPartitionId(e).withFetchOption(n.FetchOptions.OnlineOnly);return this.layerClient.getData(i,t)}async getPartitionsInfo(e,t,i){const r=(new a.PartitionsRequest).withPartitionIds(e);return t&&r.withAdditionalFields(t),(await this.layerClient.getPartitions(r,i)).partitions}async getAllPartitionsInfo(e,t){const i=await this.getRequestBuilder("metadata"),r=i.baseUrl+`/layers/${this.model.id}/partitions`,n=new o.UrlBuilder(r);return n.appendQuery("additionalFields",t),void 0!==e&&n.appendQuery("limit",e),(await i.request(n)).partitions}async getIndex(e,t=0,i){const n=new Map;if("heretile"!==this.model.partitioning.scheme)return n;const o=(new a.QuadKeyPartitionsRequest).withQuadKey(e).withDepth(t),s=await this.layerClient.getPartitions(o,i);if(void 0!==s.subQuads){const t=new r.TileKey(e.row,e.column,e.level);for(const e of s.subQuads){const i=r.TileKey.fromHereTile(e.subQuadKey).toQuadKey(),o=t.addedSubKey(i).toHereTile();n.set(o,e.dataHandle)}}if(void 0!==s.parentQuads)for(const e of s.parentQuads)n.set(e.partition,e.dataHandle);return n}}t.VolatileLayer=l},48499:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(27532),t),n(i(61899),t),n(i(89121),t),n(i(31800),t)},31800:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MARKER_SYMBOL=void 0,t.DEFAULT_MARKER_SYMBOL="__defaultMarker"},27532:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerGeoJsonWorker=t.GeoJsonWorkerClient=t.GeoJsonTileDecoder=t.GeoJsonGeometryCreator=t.GeometryData=void 0;const r=i(96500),n=i(17550),o=i(32941),a=i(10791),s=i(19955),l=i(38338),c=i(14352),u=i(9187),d=i(84428),h=i(31800),m=i(27636),p=i(61899),f=i(89121),g=i(23305),y={style:{opacity:new p.Normalizer(.6).addValidator(g.opacityValidation),hoverOpacity:new p.Normalizer(1).addValidator(g.opacityValidation)},width:new p.Normalizer(2).addValidator(g.moreThanZeroWithUnits),minWidth:new p.Normalizer(1).addValidator(g.moreThanZeroWithUnits),radius:new p.Normalizer("2.5px").addValidator(g.moreThanZeroWithUnits),minRadius:new p.Normalizer(6).addValidator(g.moreThanZeroWithUnits),"marker-size":new p.Normalizer("medium").addValidator(g.markerValidation),"stroke-opacity":new p.Normalizer(1).addValidator(g.opacityValidation),"stroke-width":new p.Normalizer(2).addValidator(g.moreThanZeroWithUnits),"fill-opacity":new p.Normalizer(.6).addValidator(g.opacityValidation)},v=123.45678,_=132.45678,b=50/255,S=.39215686274509803,T=.5882352941176471;function E(e){return"string"==typeof e&&"px"===(e=e.trim()).slice(-2)?c.Units.pixels:c.Units.meters}class C{constructor(){this.points=new w,this.lines=[],this.polygons=[],this.invisibleLinesInfo=[],this.thinLinesInfo=[],this.identifierRanges=new Map,this.identifiers=[],this.tooltipRanges=new Map,this.infoRanges=new Map,this.protobufRefs=new Map}}t.GeometryData=C;class w{constructor(){this.coordinates=[],this.borderColors=[],this.fillColors=[],this.selectedBorderColors=[],this.selectedFillColors=[],this.selectedFillHoverColors=[],this.hoverColorRanges=new Map,this.selectedColorRanges=new Map,this.selectHoverColorRanges=new Map,this.radiuses=[],this.minRadiuses=[],this.sizes=[]}}class x{constructor(e,t,i,r,a=l.LoggerManager.instance.create("GeoJsonGeometryCreator"),s=!1,u=!1,h){this.m_tileKey=e,this.m_projection=t,this.m_evaluator=r,this.m_logger=a,this.m_geometries=[],this.m_geometryGroups=new Map,this.m_currentObjectIdentifier=1,this.m_colorCache=new Map,this.circlesCache=new Map,this.markersCache=new Map,this.m_tempVector3=new d.Vector3,this.m_tempGeoCoord=new o.GeoCoordinates(0,0),this.m_tempColorArray=new Uint8Array(4),this.m_tempColor=new d.Color,this.m_imagesMap={},this.m_enableCustomColors=!0,this.m_ImlWebTile=void 0;const m=o.hereTilingScheme.getGeoBox(o.TileKey.fromMortonCode(this.m_tileKey.mortonCode())),p=this.m_projection.projectBox(m,new d.Box3);this.m_center=new d.Vector3,p.getCenter(this.m_center),this.m_scaleFactor=this.m_projection.getScaleFactor(this.m_center),this.m_disableGenerateProtobufRef=s,this.m_enable3DRendering=u,"boolean"==typeof h&&(this.m_enableCustomColors=h),this.m_thinLineTechniqueIndex=r.getMatchingTechniques(new n.MapEnv({type:"thin-line"}))[0]._index,this.m_polygonFillTechnique=r.getMatchingTechniques(new n.MapEnv({type:"polygonFillShader"}))[0],this.m_polygonBorderTechnique=r.getMatchingTechniques(new n.MapEnv({type:"polygonBorder"}))[0],this.m_segmentTechnique=r.getMatchingTechniques(new n.MapEnv({type:"lineShader"}))[0],this.m_lineInMetersTechnique=r.getMatchingTechniques(new n.MapEnv({type:"lineShader",units:c.Units.meters}))[0],this.m_markerPointTechnique=r.getMatchingTechniques(new n.MapEnv({type:"point",mode:"markerPoint"}))[0],this.m_circleCenterTechnique=r.getMatchingTechniques(new n.MapEnv({type:"point",mode:"circleCenter",units:c.Units.meters}))[0];const f=c.isValidGeoJSON(i);if(!f.isValid)throw this.m_logger.warn("Invalid GeoJSON",f.errors),new c.ErrorToTranslate("olpdi.geojsonDS.invalid-geojson");this.processData(i)}getDecodedTile(){return{tileMortonCode:this.m_tileKey.mortonCode(),geometries:this.m_geometries,techniques:this.m_evaluator.decodedTechniques,imagesMap:this.m_imagesMap,defaultEnabledFeatureTags:this.m_defaultEnabledFeatureTags}}processData(e){var t;switch(this.m_ImlWebTile=void 0,e.type){case"Feature":this.processFeature(e,".geometry");break;case"FeatureCollection":if((null===(t=e.__decodingOptions)||void 0===t?void 0:t.isIML)&&e.__decodingOptions.partition&&(this.m_ImlWebTile=o.TileKey.fromHereTile(e.__decodingOptions.partition)),void 0!==e["marker-symbol-images"]&&(this.m_imagesMap=e["marker-symbol-images"]),void 0!==e.defaultEnabledFeatureTags){this.m_defaultEnabledFeatureTags=[];for(const t of new Set(e.defaultEnabledFeatureTags))this.m_defaultEnabledFeatureTags.push(t.split(m.GeoJsonTile.FEATURE_TAG_SEPARATOR))}e.features.forEach(((e,t)=>this.processFeature(e,`.features[${t}].geometry`)));break;default:const i={type:"Feature",properties:{},geometry:e};"GeometryCollection"===e.type?this.processFeature(i,""):this.processFeature(i,".coordinates")}this.createGeometry()}processFeature(e,t=""){e.properties=p.Normalizer.run(y,e.properties);const i=this.extractTooltip(e.properties),r=this.extractInfo(e);let n=!1,o=!1;void 0!==e.properties.protobufRef||"GeometryCollection"===e.geometry.type||this.m_disableGenerateProtobufRef||(e.properties.protobufRef=t,n=!0);const a=this.m_currentObjectIdentifier++;let s,l="GeometryCollection"!==e.geometry.type?this.convertGeo2WorldCoordinates(e.geometry.coordinates):[[]];switch(e.geometry.type){case"Point":l=[l];case"MultiPoint":if(void 0!==e.properties.radius)s=this.findTechniqueIndex(e,{type:"point",mode:"circleCenter"}),this.processPointWithRadius(l,e,a,s,i,r);else if(void 0===(e.properties["marker-image"]||e.properties["marker-symbol"]&&this.m_imagesMap[e.properties["marker-symbol"]]))s=this.m_markerPointTechnique._index,e.properties["marker-symbol"]=h.DEFAULT_MARKER_SYMBOL,o=!0,void 0===this.m_imagesMap[h.DEFAULT_MARKER_SYMBOL]&&(this.m_imagesMap[h.DEFAULT_MARKER_SYMBOL]=f.defaultMarkerMask);else{let t;void 0===e.properties["marker-image"]?t=e.properties["marker-symbol"]:(t=this.getMarkerSymbol(e.properties["marker-image"],a),e.properties["marker-symbol"]=t,o=!0),s=this.findTechniqueIndex(e,{type:"point",mode:"customIcon"})}this.processPoint(l,e,a,s,i,r);break;case"LineString":l=[l];case"MultiLineString":l=this.prepareLineCoordinates(l);const n=e.properties["stroke-width"]||e.properties.width;s=c.getUnits(n)===c.Units.meters?this.m_lineInMetersTechnique._index:this.m_segmentTechnique._index,this.processLineString(l,e,a,s),this.processAsLineSegments(l,e,a,i,r);break;case"Polygon":l=[l];case"MultiPolygon":l=this.preparePolygonCoordinates(l),this.processPolygon(l,e,a,i,r);break;case"GeometryCollection":e.geometry.geometries.forEach(((i,r)=>{const n={type:"Feature",properties:e.properties,geometry:i};this.processFeature(n,`${t}.geometries[${r}]`)}))}n&&delete e.properties.protobufRef,o&&delete e.properties["marker-symbol"]}convertGeo2WorldCoordinates(e){const t=e[0],i=e[1],r=e[2];if(t instanceof Array||i instanceof Array||r instanceof Array)return e.map((e=>this.convertGeo2WorldCoordinates(e)));this.m_tempGeoCoord.latitude=i,this.m_tempGeoCoord.longitude=t,this.m_projection.projectPoint(this.m_tempGeoCoord,this.m_tempVector3).sub(this.m_center);const n=this.m_enable3DRendering&&null!=r?r:0;return[this.m_tempVector3.x,this.m_tempVector3.y,n]}extractTooltip(e){let t;const i=void 0!==e.title?e.title:e.tooltip;return"string"==typeof i?t=i.trim():"number"==typeof i&&(t=i.toString()),void 0!==t&&0===t.length&&(t=void 0),t}extractInfo(e){const{id:t,properties:i}=e;if(0===Object.keys(i).length)return void 0!==e.id?{id:t}:void 0;let r=i.infoPopupTitle;if("string"==typeof r?(r=r.trim(),0===r.length&&(r=void 0)):r=void 0,void 0===i.description)return Object.assign(Object.assign({content:i},r?{header:r}:{}),t?{id:t}:{});if("object"==typeof i.description)return Object.assign(Object.assign({content:i.description},r?{header:r}:{}),t?{id:t}:{});if("string"==typeof i.description){const e=i.description.trim(),n=Object.assign(Object.assign(Object.assign({},0!==e.length?{content:e}:{}),r?{header:r}:{}),t?{id:t}:{});return Object.keys(n).length>0?n:void 0}return"number"==typeof i.description?Object.assign(Object.assign({content:i.description.toString()},r?{header:r}:{}),t?{id:t}:{}):void 0}getRGBAColor(e,t){const i=void 0===t?e:`${e}@${t}`;let r=this.m_colorCache.get(i);return void 0===r&&(r=this.m_colorCache.get(e),void 0===r&&(r=this.m_tempColor.set(e).toArray(),this.m_colorCache.set(e,r)),void 0!==t&&(r=r.concat([t]),this.m_colorCache.set(i,r))),r}modifyColor(e,t=0){if(!e)return;const i=e.map(((e,i)=>3===i?e:Math.min(255,Math.round(255*(e+t))))),[r,n,o,a]=i;return a?`rgba(${r},${n},${o},${a})`:`rgb(${r},${n},${o})`}processPoint(e,t,i,r,n,o){const a=this.findOrCreateGeometryBuffer(r,t);a.type="point";const s=this.m_evaluator.decodedTechniques[r],l=this.getMarkerFillDefaultStyle(t,s).color.map((e=>255*e)),u=this.getMarkerHoverStyle(t,s).color,d=this.getMarkerSelectStyle(t,s).color,h=this.getMarkerSelectHoverStyle(t,s).color,m=a.points.coordinates.length/3;c.extendArrayWithValue(i,a.identifiers,e.length),void 0===t.properties.radius&&c.extendArrayWithValue(this.getMarkerSize(t),a.points.sizes,e.length),e.forEach((e=>{var i;a.points.coordinates.push(e[0],e[1],null!==(i=e[2])&&void 0!==i?i:0),void 0===t.properties.radius&&c.appendToArray(a.points.fillColors,l)}));const p={start:m,end:m+e.length-1};c.aggregateRange(a.identifierRanges,i,p),c.aggregateRange(a.points.hoverColorRanges,u,{start:i,end:i}),c.aggregateRange(a.points.selectedColorRanges,d,{start:i,end:i}),c.aggregateRange(a.points.selectHoverColorRanges,h,{start:i,end:i}),void 0!==n&&c.aggregateRange(a.tooltipRanges,n,p),void 0!==o&&c.aggregateRange(a.infoRanges,o,p),void 0!==t.properties.protobufRef&&c.aggregateRange(a.protobufRefs,t.properties.protobufRef,p),a.points.symbol=t.properties["marker-symbol"]}processPointWithRadius(e,t,i,r,n,o){const a=this.getFillDefaultStyle(t).color.map((e=>255*e)),s=this.getBorderDefaultStyle(t).color.map((e=>255*e)),l=this.getFillSelectStyle(t).color.map((e=>255*e)),u=this.getBorderSelectStyle(t).color.map((e=>255*e)),d=this.getFillSelectHoverStyle(t).color.map((e=>255*e)),h=t.properties.radius,m=t.properties.minRadius||this.m_circleCenterTechnique.userData.minRadius,p=parseFloat(h),f=parseFloat(m),g=E(h),y=this.findOrCreateGeometryBuffer(r,t).points;if(g===c.Units.pixels)return c.extendArrayWithValue(p,y.radiuses,e.length),void e.forEach((()=>{c.appendToArray(y.fillColors,a),c.appendToArray(y.selectedFillColors,l),c.appendToArray(y.selectedFillHoverColors,d)}));const v=p>500?p/500:1,_=2*Math.acos(1-v/p),b=Math.max(Math.ceil(2*Math.PI/_),this.m_ImlWebTile?11:16),S=this.generateCircle(b);c.extendArrayWithValue(f,y.minRadiuses,e.length),e.forEach((e=>{var r,h;this.m_tempVector3.x=e[0]+this.m_center.x,this.m_tempVector3.y=e[1]+this.m_center.y,this.m_tempVector3.z=(null!==(r=e[2])&&void 0!==r?r:0)+this.m_center.z;const m=p*this.m_projection.getScaleFactor(this.m_tempVector3);y.radiuses.push(m),c.appendToArray(y.fillColors,a),c.appendToArray(y.borderColors,s),c.appendToArray(y.selectedFillColors,l),c.appendToArray(y.selectedFillHoverColors,d),c.appendToArray(y.selectedBorderColors,u);const f=S.vertices.length/2,g=new Array(f);for(let t=0;t<f;t++){const i=2*t;g[t]=[e[0]+m*S.vertices[i],e[1]+m*S.vertices[i+1],null!==(h=e[2])&&void 0!==h?h:0]}this.processPolygon([[g]],t,i,n,o)}))}generateCircle(e){let t=this.circlesCache.get(e);if(void 0===t){const i=2*Math.PI/e,r=[];for(let t=0;t<e;t++){const e=i*t;r.push(Math.cos(e),Math.sin(e))}r.push(r[0],r[1]),t={vertices:r,triangles:u.default(r,[])},this.circlesCache.set(e,t)}return t}processLineString(e,t,i,r){const n=this.findOrCreateGeometryBuffer(r,t);n.type="solid-line-shader";const o=this.getSegmentDefaultStyle(t),a=o.color,s=this.getSegmentHoverStyle(t).color,l=this.getSegmentSelectStyle(t).color,u=this.getSegmentSelectHoverStyle(t).color;let d=o.lineWidth;o.units===c.Units.meters&&(d*=this.m_scaleFactor);const h=o.lineMinWidth;e.forEach((e=>{const r=[];e.forEach(((t,i)=>{var n;const o=e[i-1];if(void 0===o||t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]&&this.m_enable3DRendering){const e=this.m_enable3DRendering&&null!==(n=t[2])&&void 0!==n?n:0;r.push(t[0],t[1],e)}})),n.lines.push({vertices:r,identifier:i,featureTags:t.properties.featureTags,defaultColor:a,hoverColor:s,selectColor:l,selectHoverColor:u,lineWidth:d,lineMinWidth:h})}))}processPolygon(e,t,i,r,n){var o;const a=this.getFillDefaultStyle(t).color,s=this.getFillHoverStyle(t).color,l=this.getFillSelectStyle(t).color,c=this.getFillSelectHoverStyle(t).color,u=this.findOrCreateGeometryBuffer(this.m_polygonFillTechnique._index,t);u.type="polygon-shader";for(const d of e){const e=[],h=[];for(const t of d){e.length&&h.push(e.length/3);for(const i of t){const t=this.m_enable3DRendering&&null!==(o=i[2])&&void 0!==o?o:0;e.push(i[0],i[1],t)}}u.polygons.push({vertices:e,holes:h,tooltip:r,info:n,identifier:i,defaultColor:a,hoverColor:s,selectColor:l,selectHoverColor:c,protobufRef:t.properties.protobufRef}),.5===this.getBorderDefaultStyle(t).lineWidth?this.processAsLineSegments(d,t,i,void 0,void 0,"thin-line"):this.processLineString(d,t,i,this.m_polygonBorderTechnique._index)}}preparePolygonCoordinates(e){const t=e=>Array.isArray(e)&&e.length>0,i=e.filter(t);return i.forEach(((e,r)=>i[r]=e.filter(t))),i}prepareLineCoordinates(e){const t=e=>Array.isArray(e)&&e.length>0,i=e.filter(t);return i.forEach(((e,r)=>i[r]=e.filter(t))),i}processAsLineSegments(e,t,i,r,n,a="invisible-line"){var s;const l=o.webMercatorTilingScheme.getGeoBox(null!==(s=this.m_ImlWebTile)&&void 0!==s?s:o.TileKey.fromMortonCode(1)),u=this.m_projection.projectBox(l,new d.Box3);u.min.sub(this.m_center),u.max.sub(this.m_center);const h=u.getSize(this.m_tempVector3);h.multiplyScalar(1e-4);const m=e=>c.nearlyEqual(e[0],u.min.x,h.x),p=e=>c.nearlyEqual(e[0],u.max.x,h.x),f=e=>c.nearlyEqual(e[1],u.min.y,h.y),g=e=>c.nearlyEqual(e[1],u.max.y,h.y),y="thin-line"===a?this.m_thinLineTechniqueIndex:this.findTechniqueIndex(t,{type:a}),v=this.findOrCreateGeometryBuffer(y,t);v.type=a;const _=this.getSegmentDefaultStyle(t);let b=_.lineWidth;_.units===c.Units.meters&&(b*=this.m_scaleFactor);const S=[];for(const t of e)for(let e=0;e<t.length-1;e++){const i=t[e],r=t[e+1];this.m_ImlWebTile&&(m(i)&&m(r)||p(i)&&p(r)||f(i)&&f(r)||g(i)&&g(r))||(S.push(i[0],i[1],this.m_enable3DRendering?i[2]:0),S.push(r[0],r[1],this.m_enable3DRendering?r[2]:0))}switch(a){case"invisible-line":v.invisibleLinesInfo.push({vertices:S,identifier:i,tooltip:r,info:n,protobufRef:t.properties.protobufRef,lineWidth:b});break;case"thin-line":v.thinLinesInfo.push({vertices:S,identifier:i,defaultColor:this.getSegmentDefaultStyle(t).color,hoverColor:this.getSegmentHoverStyle(t).color,selectColor:this.getSegmentSelectStyle(t).color,selectHoverColor:this.getSegmentSelectHoverStyle(t).color})}}createGeometry(){this.m_geometryGroups.forEach((e=>{e.forEach(((e,t)=>{e.forEach((e=>{switch(e.type){case"point":this.createPointGeometry(t,e);break;case"solid-line-shader":this.createLineGeometry(t,e);break;case"thin-line":this.createThinLineGeometry(t,e);break;case"invisible-line":this.createInvisibleSegmentsGeometry(t,e);break;case"polygon":case"polygon-shader":this.createPolygonGeometry(t,e);break;case"invisible-polygon":this.createPolygonGeometry(t,e,!0)}}))}))}))}createPointGeometry(e,t){const i=[{name:"position",buffer:new Float32Array(t.points.coordinates).buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:new Float32Array(t.identifiers).buffer,itemCount:1,type:"float"}];t.points.radiuses.length>0&&i.push({name:"radius",buffer:new Float32Array(t.points.radiuses).buffer,itemCount:1,type:"float"}),t.points.minRadiuses.length>0&&i.push({name:"minRadius",buffer:new Float32Array(t.points.minRadiuses).buffer,itemCount:1,type:"float"}),t.points.sizes.length>0&&i.push({name:"size",buffer:new Float32Array(t.points.sizes).buffer,itemCount:1,type:"float"}),t.points.borderColors.length>0&&i.push({name:"borderColor",buffer:new Uint8Array(t.points.borderColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.fillColors.length>0&&i.push({name:0===t.points.radiuses.length?"defaultColor":"fillColor",buffer:new Uint8Array(t.points.fillColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.selectedBorderColors.length>0&&i.push({name:"selectedBorderColor",buffer:new Uint8Array(t.points.selectedBorderColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),t.points.selectedFillColors.length>0&&(i.push({name:"selectedFillColor",buffer:new Uint8Array(t.points.selectedFillColors).buffer,normalized:!0,itemCount:4,type:"uint8"}),i.push({name:"selectedFillHoverColor",buffer:new Uint8Array(t.points.selectedFillHoverColors).buffer,normalized:!0,itemCount:4,type:"uint8"})),this.m_geometries.push({type:r.GeometryType.Point,vertexAttributes:i,groups:[{start:0,count:0,technique:e}],objInfos:{identifierRanges:t.identifierRanges,tooltipRanges:t.tooltipRanges,infoRanges:t.infoRanges,hoverColorRanges:t.points.hoverColorRanges,protobufRefs:t.protobufRefs,featureTags:t.featureTags,uuid:t.uuid,selectColorRanges:t.points.selectedColorRanges,selectHoverColorRanges:t.points.selectHoverColorRanges,symbol:t.points.symbol}})}createLineGeometry(e,t){const i=new a.LineGroup,n=[],o=new Map,s=new Map,l=new Map,u=new d.Vector3(0,0,0);let h=0;t.lines.forEach((e=>{i.add(u,e.vertices,this.m_projection);const t=i.vertices.length/i.stride;n.push({start:h,end:t-1}),h=t}));const m=i.vertices.length/i.stride,p=new Float32Array(m),f=new Float32Array(m),g=new Float32Array(m),y=new Uint8Array(4*m);t.lines.forEach(((e,t)=>{const i=n[t];p.fill(e.identifier,i.start,i.end+1),f.fill(e.lineWidth,i.start,i.end+1),g.fill(e.lineMinWidth,i.start,i.end+1);const r=this.getColorTypedArray(e.defaultColor);for(let e=i.start,t=i.end+1;e<t;e++)y.set(r,4*e);const a={start:e.identifier,end:e.identifier};c.aggregateRange(o,e.hoverColor,a),c.aggregateRange(s,e.selectColor,a),c.aggregateRange(l,e.selectHoverColor,a)}));const{vertices:v,indices:_}=i,b={type:r.GeometryType.SolidLine,index:{name:"index",buffer:new Uint32Array(_).buffer,itemCount:1,type:"uint32"},interleavedVertexAttributes:[{type:"float",stride:i.stride,buffer:new Float32Array(v).buffer,attributes:i.vertexAttributes}],vertexAttributes:[{name:"objectIdentifier",buffer:p.buffer,itemCount:1,type:"float"},{name:"lineWidth",buffer:f.buffer,itemCount:1,type:"float"},{name:"lineMinWidth",buffer:g.buffer,itemCount:1,type:"float"},{name:"defaultColor",buffer:y.buffer,itemCount:4,type:"uint8",normalized:!0}],groups:[{start:0,count:0,technique:e}],objInfos:{hoverColorRanges:o,selectColorRanges:s,selectHoverColorRanges:l,featureTags:t.featureTags},uuid:t.uuid};this.m_geometries.push(b)}createThinLineGeometry(e,t){const i=new Map,n=new Map,o=new Map,a=t.thinLinesInfo.reduce(((e,t)=>e+t.vertices.length),0),s=a/3,l=new Float32Array(a),u=new Float32Array(s),d=new Uint8Array(4*s);let h=0,m=0;t.thinLinesInfo.forEach((e=>{const t=m+e.vertices.length,r={start:m/3,end:t/3-1};m=t,l.set(e.vertices,h),h+=e.vertices.length,u.fill(e.identifier,r.start,r.end+1);const a=this.getColorTypedArray(e.defaultColor);for(let e=r.start,t=r.end+1;e<t;e++)d.set(a,4*e);const s={start:e.identifier,end:e.identifier};c.aggregateRange(i,e.hoverColor,s),c.aggregateRange(n,e.selectColor,s),c.aggregateRange(o,e.selectHoverColor,s)}));const p={type:r.GeometryType.Unspecified,vertexAttributes:[{name:"position",buffer:l.buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:u.buffer,itemCount:1,type:"float"},{name:"defaultColor",buffer:d.buffer,itemCount:4,type:"uint8",normalized:!0}],groups:[{start:0,count:0,technique:e}],objInfos:{hoverColorRanges:i,selectColorRanges:n,selectHoverColorRanges:o,featureTags:t.featureTags},uuid:t.uuid};this.m_geometries.push(p)}createPolygonGeometry(e,t,i=!1){const n=[],o=[],a=new Map,s=new Map,l=new Map,d=new Map,h=new Map,m=new Map,p=new Map,f=t.polygons.reduce(((e,t)=>e+t.vertices.length),0)/3,g=new Float32Array(3*f),y=new Float32Array(f);let b;i||(b=new Uint8Array(4*f));const S=[],T=[],E=[];let C=0;t.polygons.forEach((e=>{const t=C;if(y.fill(e.identifier,C,C+e.vertices.length/2),g.set(e.vertices,3*C),b)for(let t=0;t<e.vertices.length;t+=3,C++){const t=e.defaultColor;if(t){const e=4*C;b[e]=255*t[0],b[e+1]=255*t[1],b[e+2]=255*t[2],b[e+3]=255*t[3]}}let r=e.triangles;if(void 0===r)if(12===e.vertices.length&&this.m_enable3DRendering)r=[0,1,2,2,1,0];else{for(let t=0;t<e.vertices.length;t+=3)e.vertices[t]+=e.vertices[t+2]*v,e.vertices[t+1]+=e.vertices[t+2]*_;r=u.default(e.vertices,e.holes,3);for(let t=0;t<e.vertices.length;t+=3)e.vertices[t]-=e.vertices[t+2]*v,e.vertices[t+1]-=e.vertices[t+2]*_}r.forEach((e=>n.push(e+t)));const o={start:n.length/3-r.length/3,end:n.length/3-1};e.tooltip&&c.aggregateRange(s,e.tooltip,o),e.info&&c.aggregateRange(l,e.info,o),void 0!==e.protobufRef&&c.aggregateRange(d,e.protobufRef,o),c.aggregateRange(a,e.identifier,o);const f={start:e.identifier,end:e.identifier};i||(void 0!==e.hoverColor&&c.aggregateRange(h,e.hoverColor,f),void 0!==e.selectColor&&c.aggregateRange(m,e.selectColor,f),void 0!==e.selectHoverColor&&c.aggregateRange(p,e.selectHoverColor,f)),e.markerCenter&&e.markerShape&&(c.appendToArray(T,e.markerCenter),c.appendToArray(E,e.markerShape))})),S.push({name:"position",buffer:g.buffer,itemCount:3,type:"float"},{name:"objectIdentifier",buffer:y.buffer,itemCount:1,type:"float"}),b&&S.push({name:"defaultColor",buffer:b.buffer,itemCount:4,type:"uint8",normalized:!0}),T.length>0&&E.length>0&&S.push({name:"markerCenter",buffer:new Float32Array(T).buffer,itemCount:3,type:"float"},{name:"markerShape",buffer:new Float32Array(E).buffer,itemCount:3,type:"float"});const w={type:r.GeometryType.Polygon,vertexAttributes:S,groups:o,uuid:t.uuid,objInfos:{tooltipRanges:s,infoRanges:l,identifierRanges:a,protobufRefs:d,hoverColorRanges:h,selectColorRanges:m,selectHoverColorRanges:p,featureTags:t.featureTags}};n.length>0&&(o.push({start:0,count:n.length,technique:e}),w.index={name:"index",buffer:new Uint32Array(n).buffer,itemCount:1,type:"uint32"}),this.m_geometries.push(w)}createInvisibleSegmentsGeometry(e,t){const i=new Map,n=new Map,o=new Map,a=new Map,s=[];let l=0;t.invisibleLinesInfo.forEach((e=>{const t=e.vertices.length,i=l+t;s.push({start:l/3,end:i/3-1}),l=i}));const u=new Float32Array(l),d=new Float32Array(l);let h=0;t.invisibleLinesInfo.forEach(((e,t)=>{const r=s[t];u.set(e.vertices,h),h+=e.vertices.length,c.aggregateRange(i,e.identifier,r),void 0!==e.tooltip&&c.aggregateRange(n,e.tooltip,r),void 0!==e.info&&c.aggregateRange(o,e.info,r),void 0!==e.protobufRef&&c.aggregateRange(a,e.protobufRef,r),void 0!==e.lineWidth&&d.fill(e.lineWidth,r.start,r.end+1)})),this.m_geometries.push({type:r.GeometryType.Unspecified,vertexAttributes:[{name:"position",buffer:u.buffer,itemCount:3,type:"float"},{name:"lineWidth",buffer:d.buffer,itemCount:1,type:"float"}],groups:[{start:0,count:0,technique:e}],objInfos:{identifierRanges:i,tooltipRanges:n,infoRanges:o,protobufRefs:a,featureTags:t.featureTags},uuid:"invisibleLine"})}getFillDefaultStyle(e){const t=e.properties.style,{defaultColor:i,defaultAlpha:r}=this.m_polygonFillTechnique,n=void 0!==e.properties["fill-opacity"]?e.properties["fill-opacity"]:t&&void 0!==t.opacity?t.opacity:r,o=this.m_enableCustomColors?n:r,a=e.properties.fill||(null==t?void 0:t.fill)||(null==t?void 0:t.color),s=this.m_enableCustomColors&&a||i;return{rawColor:s,opacity:o,color:this.getRGBAColor(s,o),customColor:a?this.getRGBAColor(a):void 0,customOpacity:n}}getMarkerFillDefaultStyle(e,t){var i;const r=e.properties.style,n=e.properties["marker-color"]||e.properties.fill||(null==r?void 0:r.fill)||(null==r?void 0:r.color),o=this.m_enableCustomColors&&(n||(null===(i=t.userData)||void 0===i?void 0:i.defaultColor))||this.m_polygonFillTechnique.defaultColor;return{rawColor:o,opacity:1,color:this.getRGBAColor(o,1),customColor:n?this.getRGBAColor(n):void 0}}getFillHoverStyle(e){var t,i,r,n;const o=this.getFillDefaultStyle(e),{hoverColor:a,hoverAlpha:s}=this.m_polygonFillTechnique,l=this.modifyColor(o.customColor,b),c=this.m_enableCustomColors&&((null===(t=e.properties.style)||void 0===t?void 0:t.hoverColor)||l)||a;return o.opacity=this.m_enableCustomColors?null!==(r=null===(i=e.properties.style)||void 0===i?void 0:i.hoverOpacity)&&void 0!==r?r:null!==(n=o.customOpacity)&&void 0!==n?n:s:s,o.color=this.getRGBAColor(c,o.opacity),o}getMarkerHoverStyle(e,t){var i;const r=this.getMarkerFillDefaultStyle(e,t),n=e.properties["marker-symbol"]===h.DEFAULT_MARKER_SYMBOL?this.modifyColor(r.customColor,b):void 0,o=this.m_enableCustomColors&&((null===(i=e.properties.style)||void 0===i?void 0:i.hoverColor)||n)||this.m_markerPointTechnique.userData.hoverColor;return r.color=this.getRGBAColor(o,1),r}getMarkerSelectStyle(e,t){const i=e.properties.style,{selectColor:r}=this.m_markerPointTechnique.userData,n=this.getMarkerFillDefaultStyle(e,t),o=e.properties["marker-symbol"]===h.DEFAULT_MARKER_SYMBOL?this.modifyColor(n.customColor,S):void 0,a=this.m_enableCustomColors&&((null==i?void 0:i.selectedColor)||o)||r;return n.color=this.getRGBAColor(a,1),n}getMarkerSelectHoverStyle(e,t){const i=e.properties.style,r=this.getMarkerSelectStyle(e,t),{selectHoverColor:n}=this.m_markerPointTechnique.userData,o=e.properties["marker-symbol"]===h.DEFAULT_MARKER_SYMBOL?this.modifyColor(r.customColor,T):void 0,a=this.m_enableCustomColors&&((null==i?void 0:i.selectedColor)||o)||n;return r.color=this.getRGBAColor(a,1),r}getFillSelectStyle(e){var t,i;const r=e.properties.style,n=this.getFillDefaultStyle(e),{selectColor:o,selectAlpha:a}=this.m_polygonFillTechnique,s=this.modifyColor(n.customColor,S),l=this.m_enableCustomColors?null!==(t=null==r?void 0:r.selectedOpacity)&&void 0!==t?t:null!==(i=n.customOpacity)&&void 0!==i?i:a:a,c=this.m_enableCustomColors&&((null==r?void 0:r.selectedColor)||s)||o;return n.opacity=l,n.color=this.getRGBAColor(c,l),n}getFillSelectHoverStyle(e){var t,i;const r=this.getFillDefaultStyle(e),n=e.properties.style,{selectHoverColor:o,selectHoverAlpha:a}=this.m_polygonFillTechnique,s=this.modifyColor(r.customColor,T),l=this.m_enableCustomColors&&((null==n?void 0:n.selectedHoverColor)||s)||o;return r.opacity=this.m_enableCustomColors?null!==(t=null==n?void 0:n.selectedOpacity)&&void 0!==t?t:null!==(i=r.customOpacity)&&void 0!==i?i:a:a,r.color=this.getRGBAColor(l,r.opacity),r}getBorderDefaultStyle(e){var t;const i=e.properties.style,{defaultColor:r,defaultAlpha:n}=this.m_polygonBorderTechnique.userData,o=this.m_enableCustomColors&&null!==(t=e.properties["stroke-opacity"])&&void 0!==t?t:n,a=e.properties["stroke-width"]||e.properties.width||1,s=c.getValue(a)/2,l=e.properties.stroke||(null==i?void 0:i.color),u=this.m_enableCustomColors&&l||r;return{rawColor:u,color:this.getRGBAColor(u,o),customColor:l?this.getRGBAColor(l):void 0,opacity:o,lineWidth:s,lineMinWidth:1,units:c.Units.pixels}}getBorderSelectStyle(e){var t;const i=this.getSegmentSelectStyle(e),{selectColor:r,selectAlpha:n}=this.m_polygonBorderTechnique.userData,o=this.modifyColor(i.customColor,S),a=this.m_enableCustomColors&&((null===(t=e.properties.style)||void 0===t?void 0:t.selectedColor)||o)||r;return i.color=this.getRGBAColor(a,n),i}getSegmentDefaultStyle(e){var t;const i=e.properties.style,{defaultColor:r,defaultAlpha:n}=this.m_segmentTechnique.userData,o=null!==(t=e.properties["stroke-opacity"])&&void 0!==t?t:null==i?void 0:i.opacity,a=this.m_enableCustomColors&&null!=o?o:n,s=e.properties["stroke-width"]||e.properties.width||this.m_segmentTechnique.lineWidth,l=c.getUnits(s),u=c.getValue(s)/2,d=(parseFloat(e.properties.minWidth)||this.m_lineInMetersTechnique.lineMinWidth||1)/2,h=e.properties.stroke||(null==i?void 0:i.color),m=this.m_enableCustomColors&&h||r;return{rawColor:m,color:this.getRGBAColor(m,a),customColor:h?this.getRGBAColor(h):void 0,customOpacity:o,opacity:a,lineWidth:u,lineMinWidth:d,units:l}}getSegmentHoverStyle(e){var t,i,r,n;const o=this.getSegmentDefaultStyle(e),{hoverColor:a,hoverAlpha:s}=this.m_segmentTechnique.userData,l=this.modifyColor(o.customColor,b);o.opacity=this.m_enableCustomColors?null!==(i=null===(t=e.properties.style)||void 0===t?void 0:t.hoverOpacity)&&void 0!==i?i:null!==(r=o.customOpacity)&&void 0!==r?r:s:s;const c=this.m_enableCustomColors&&((null===(n=e.properties.style)||void 0===n?void 0:n.hoverColor)||l)||a;return o.color=this.getRGBAColor(c,o.opacity),o}getSegmentSelectStyle(e){const t=e.properties.style,i=this.getSegmentDefaultStyle(e),{selectColor:r,selectAlpha:n}=this.m_segmentTechnique.userData,o=this.modifyColor(i.customColor,S),a=this.m_enableCustomColors&&((null==t?void 0:t.selectedColor)||o)||r;return i.opacity=this.m_enableCustomColors&&(null==t?void 0:t.selectedOpacity)||n,i.color=this.getRGBAColor(a,i.opacity),i}getSegmentSelectHoverStyle(e){var t;const i=this.getSegmentSelectStyle(e),{selectHoverColor:r,selectHoverAlpha:n}=this.m_segmentTechnique.userData,o=this.modifyColor(i.customColor,T),a=this.m_enableCustomColors&&((null===(t=e.properties.style)||void 0===t?void 0:t.selectedHoverColor)||o)||r;return i.opacity=n,i.color=this.getRGBAColor(a,i.opacity),i}getColorTypedArray(e){return this.m_tempColorArray[0]=255*e[0],this.m_tempColorArray[1]=255*e[1],this.m_tempColorArray[2]=255*e[2],this.m_tempColorArray[3]=255*e[3],this.m_tempColorArray}findTechniqueIndex(e,t){const i={};if("circleCenter"===t.mode&&void 0!==e.properties.radius){const t=e.properties.radius,r=c.getValue(t),n=E(t);i.units=n,i.radius=r}else if("invisible-line"===t.type){const t=e.properties["stroke-width"]||e.properties.width,r=c.getValue(t),n=c.getUnits(t);r&&1!==r&&(i.lineWidth=r),i.units=n}Object.assign(t,i);const r=new n.MapEnv(t);return this.m_evaluator.getMatchingTechniques(r)[0]._index}getCombinedTag(e){const t=e.properties.featureTags;return Array.isArray(t)&&t.length>0?t.sort().join("\n"):void 0}findOrCreateGeometryBuffer(e,t){const i=t.properties.featureTags,r=this.getCombinedTag(t);let n=this.m_geometryGroups.get(r);void 0===n&&(n=new Map,this.m_geometryGroups.set(r,n));let o=n.get(e);void 0===o&&(o=[],n.set(e,o));let a=o.find((e=>e.points.symbol===t.properties["marker-symbol"]));return a||(a=new C,a.featureTags=i,void 0!==t.properties["marker-symbol"]&&(a.points.symbol=t.properties["marker-symbol"]),o.push(a),a)}getMarkerSymbol(e,t){let i=Object.keys(this.m_imagesMap).find((t=>this.m_imagesMap[t]===e));return void 0===i&&(i=`__${t}`,this.m_imagesMap[i]=e),i}getMarkerSize(e){const t=e.properties["marker-size"];if("number"==typeof t)return t;const i=parseInt(t,10);if(!isNaN(i))return i;const r=e.properties["marker-symbol"]===h.DEFAULT_MARKER_SYMBOL?128:40;switch(t){case"small":return.75*r;case"large":return 1.25*r;case"medium":default:return r}}}t.GeoJsonGeometryCreator=x;class P extends c.InteractiveTileDecoder{constructor(){super(...arguments),this.m_logger=l.LoggerManager.instance.create("GeoJsonDecoder")}async createGeometries(e,t,i,r,o,a){const s=JSON.parse(JSON.stringify(o)),l=new n.StyleSetEvaluator({styleSet:s.styles.geojson});return new x(t,r,e,l,this.m_logger,this.m_disableGenerateProtobufRef,this.m_enable3DRendering,a).getDecodedTile()}}function O(e="geojson"){s.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>new c.DecoderService(e,new P)})}t.GeoJsonTileDecoder=P,t.GeoJsonWorkerClient=class{constructor(e="geojson"){O(e)}},t.registerGeoJsonWorker=O},27636:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoJsonTile=void 0;const r=i(38125),n=i(14352),o=i(84428),a=i(31800),s=new o.Vector2,l=new o.Vector2,c=new o.Vector3,u=new o.Vector3,d=new o.Vector3,h=new o.Matrix4,m=new o.Ray,p=new o.Vector3,f=new o.Vector3,g=new o.Vector3,y=new o.Vector3;class v extends n.InteractiveTile{constructor(){super(...arguments),this.m_markerMaterials=new Map,this.m_featureTags=new Set}willRender(e){return!0}get featureTags(){return this.m_featureTags}createGeometries(e){const t=this.objects.length;super.createGeometries(e),this.m_featureTags.clear();for(let i=0;i<e.geometries.length;i++){const n=this.objects[t+i];if(!n)break;const a=e.geometries[i];void 0!==a.objInfos&&(n.userData=Object.assign(Object.assign({},n.userData),a.objInfos));const s=n.userData.featureTags;if(Array.isArray(s)){for(const e of s)this.m_featureTags.add(e);n.userData.kind=s.map((e=>`${this.dataSource.name}-${e}`))}else n.userData.kind=[`${this.dataSource.name}-tileGeometry`];n.userData.tileMortonCode=e.tileMortonCode,n instanceof o.Points?this.postCreatePointObject(n,e.imagesMap):n instanceof o.Mesh&&n.material instanceof o.RawShaderMaterial&&"line-shader"===n.material.name?this.postCreateLineObject(n):n instanceof o.LineSegments&&"invisibleLine"===n.userData.geometryId&&this.postCreateInvisibleLineObject(n),r.MapObjectAdapter.create(n,{technique:n.userData.technique,kind:n.userData.kind})}}postCreatePointObject(e,t){const i=e.material;if(i instanceof o.ShaderMaterial)if(void 0!==i.uniforms.texture){this.updateMarkerMaterial(e,t);const i=e.material.uniforms.uDPI;void 0!==e.userData.symbol&&(e.raycast=_),e.onBeforeRender=()=>i.value=window.devicePixelRatio}else if(void 0===i.userData.size){e.raycast=_,i.depthWrite=!1;const t=i.uniforms;e.onBeforeRender=e=>{t.uDPI.value=window.devicePixelRatio;const{width:i,height:r}=e.getSize(s);t.uRendererSize.value instanceof o.Vector2?(t.uRendererSize.value.x=i,t.uRendererSize.value.y=r):t.uRendererSize.value=new o.Vector2(i,r)}}}postCreateLineObject(e){e.userData.technique.lineWidth,e.userData.technique.lineMinWidth;const t=e.userData.technique.userData.lineWidthUnits,i=e.userData.technique.userData.scaleByHover;let r;var o;e.userData.technique.userData.scaleBySelect,r=t===n.Units.meters?i?(o=this.mapView,new n.LineMaterial({rendererCapabilities:o.renderer.capabilities,scaleBySelect:!0,scaleByHover:!0,units:n.Units.meters})):(e=>new n.LineMaterial({rendererCapabilities:e.renderer.capabilities,scaleBySelect:!1,scaleByHover:!1,units:n.Units.meters}))(this.mapView):i?(e=>new n.LineMaterial({rendererCapabilities:e.renderer.capabilities,scaleBySelect:!0,scaleByHover:!0}))(this.mapView):(e=>new n.LineMaterial({rendererCapabilities:e.renderer.capabilities,scaleBySelect:!1,scaleByHover:!1}))(this.mapView);const a=r.uniforms.uPixelToWorld,s=r.uniforms.uRendererSize;e.material=r;const c=e.onBeforeRender;e.onBeforeRender=(e,t,i,r,n,o)=>{c&&c(e,t,i,r,n,o),a.value=this.mapView.pixelToWorld,s.value=e.getSize(l)}}postCreateInvisibleLineObject(e){e.raycast=b}updateMarkerMaterial(e,t){const i=t[e.userData.symbol];if(void 0===i)return;let r=v.m_markerTextures.get(i);void 0===r&&(r=(new o.TextureLoader).load(i,(()=>this.dataSource.requestUpdate())),v.m_markerTextures.set(i,r));let n=this.m_markerMaterials.get(r);void 0===n?(n=e.material.clone(),n.uniforms.texture.value=r,n.depthWrite=!0,n.depthTest=!0,e.material=n,this.m_markerMaterials.set(r,n)):e.material=n}}function _(e,t){const i=this.geometry,r=this.matrixWorld;let o=e.params.Points.threshold;const s=i.attributes,l=s.position.array,p=this.userData.symbol===a.DEFAULT_MARKER_SYMBOL;let f;void 0===this.userData.symbol?f=this.material.userData.radiusUnits===n.Units.meters?s.minRadius.array:s.radius.array:(f=s.size.array,o/=2),h.copy(r).invert(),m.copy(e.ray).applyMatrix4(h);for(let i=0,n=l.length/3;i<n;i++){c.fromArray(l,3*i),u.copy(c);const n=m.distanceSqToPoint(c);if(n>=(o*(p?.5*f[i]:f[i]))**2)continue;m.closestPointToPoint(c,c),c.applyMatrix4(r);const a=e.ray.origin.distanceTo(c);if(!(a<e.near||a>e.far)){if(p){if(d.copy(c),d.project(e.camera),u.applyMatrix4(r),u.project(e.camera),u.y>d.y)continue;const t=Math.atan2(u.x-d.x,u.y-d.y);if(t<0&&t>-2.65)continue;if(t>0&&t<2.65)continue}t.push({distance:a,distanceToRay:Math.sqrt(n),point:c.clone(),index:i,face:null,object:this})}}}function b(e,t){void 0===e.params.Line&&(e.params.Line={threshold:1});const i=e.params.Line.threshold,r=this.geometry,n=this.matrixWorld;h.copy(n).invert(),m.copy(e.ray).applyMatrix4(h);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=this&&this.isLineSegments?2:1,s=r.attributes,l=s.position.array,c=s.lineWidth.array;for(let i=0,r=l.length/3-1;i<r;i+=a){if(p.fromArray(l,3*i),f.fromArray(l,3*i+3),m.distanceSqToSegment(p,f,y,g)>(o*c[i])**2)continue;y.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(y);r<e.near||r>e.far||t.push({distance:r,point:g.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:void 0,object:this})}}t.GeoJsonTile=v,v.FEATURE_TAG_SEPARATOR="|",v.m_markerTextures=new Map},61899:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Normalizer=void 0;const r=i(23305);class n{constructor(e){this.m_validators=[],this.m_default=e}static run(e,t){if(!t)return t;const i=Object.keys(e).reduce(((i,r)=>{const o=e[r],a=t[r];return null==a||(o instanceof n?o.validation(a)?i[r]=a:i[r]=o.getDefault():i[r]=n.run(o,a)),i}),{});return r.mergeDeep({},t,i)}addValidator(e){return this.m_validators.push(e),this}validation(e){return!this.m_validators.some((t=>!1===t(e)))}getDefault(){return this.m_default}}t.Normalizer=n},89121:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePointMarkerShape=t.defaultMarkerMask=void 0;const r=i(84428),n=[[44,21.5344653,44,37.0340915,29.8011135,38.7364679,22.0000435,60],[22.0000435,60,14.1988865,38.7364679,0,37.0340915,0,21.5344653],[0,21.5344653,0,9.64132348,9.84973132,0,22.0000435,0],[22.0000435,0,34.1501817,0,44,9.64132348,44,21.5344653]],o=[n[0][0],n[0][0]],a=[n[0][1],n[0][1]];let s=`M${n[0][0]},${n[0][1]} `;for(const e of n){s+=`C${e[2]},${e[3]} ${e[4]},${e[5]} ${e[6]},${e[7]} `;for(let t=0;t<8;t++)e[t]<o[0]?o[0]=e[t]:e[t]>o[1]&&(o[1]=e[t]),t++,e[t]<a[0]?a[0]=e[t]:e[t]>a[1]&&(a[1]=e[t])}s+="Z";const l=s,c=new r.Vector2(o[0]+(o[1]-o[0])/2,-(a[1]-a[0])),u=1/(a[1]-a[0]),d=n.map((e=>new r.CubicBezierCurve(new r.Vector2(e[0],-e[1]).sub(c).multiplyScalar(u),new r.Vector2(e[2],-e[3]).sub(c).multiplyScalar(u),new r.Vector2(e[4],-e[5]).sub(c).multiplyScalar(u),new r.Vector2(e[6],-e[7]).sub(c).multiplyScalar(u))));t.defaultMarkerMask=`\ndata:image/svg+xml;utf8,<svg width="256px" height="256px" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs>\n        <path d="${l}" id="path-1"></path>\n    </defs>\n    <g id="icons/icon-GeoJSON_Vector_marker" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="marker" transform="translate(106.0, 68.0)">\n            <circle id="point" stroke="rgb(0, 34, 0)" stroke-width="0.5" fill="rgb(0, 255, 0)" cx="22" cy="60" r="2"></circle>\n            <g id="pin">\n                <use fill="rgb(255, 0, 0)" xlink:href="%23path-1"></use>\n                <path stroke="rgba(0, 34, 0, 0.3)" stroke-width="1" d="M22.000041,58.5893777 C24.1093754,53.201768 26.7368945,48.7888978 30.1126352,44.5366657 C31.8413033,42.359159 37.3396557,36.2578728 37.7873826,35.7245988 C41.7852798,30.9628248 43.5,27.1088523 43.5,21.5344653 C43.5,9.91991716 33.8764347,0.5 22.0000435,0.5 C10.1235219,0.5 0.5,9.91987461 0.5,21.5344653 C0.5,27.1088542 2.21472236,30.9628286 6.21262323,35.7245985 C6.66033717,36.257856 12.1587805,42.3592285 13.8874787,44.5367734 C17.2631923,48.7889718 19.8907032,53.2018154 22.000041,58.5893777 Z"></path>\n            </g>\n            <circle id="center" fill="rgb(0, 255, 0)" cx="22" cy="22" r="6"></circle>\n        </g>\n    </g>\n</svg>`;const h=new Map;t.generatePointMarkerShape=function(e,t=1){let i=h.get(`${e}:${t}`);if(i)return i;i=[];const r=e-1;return d.forEach((e=>e.getPoints(r).forEach((e=>i.push(e.x*t,e.y*t,0))))),h.set(`${e}:${t}`,i),i}},23305:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenCoordinates=t.calcBboxFromGeometry=t.getFeaturesBoundingBox=t.mergeDeep=t.b64toBlob=t.markerValidation=t.opacityValidation=t.moreThanZeroWithUnits=t.isObject=void 0;const r=i(14352),n=i(84428);function o(e){const t=new n.Box2;let i=[];return"GeometryCollection"===e.type?(e.geometries.forEach((e=>{const i=o(e);(t.isEmpty()||i.min.x<t.min.x)&&(t.min.x=i.min.x),(t.isEmpty()||i.min.y<t.min.y)&&(t.min.y=i.min.y),(t.isEmpty()||i.max.x>t.max.x)&&(t.max.x=i.max.x),(t.isEmpty()||i.max.y>t.max.y)&&(t.max.y=i.max.y)})),t):(i=a(e),i.forEach((e=>{const[i,r]=e;(t.isEmpty()||r<t.min.x)&&(t.min.x=r),(t.isEmpty()||i<t.min.y)&&(t.min.y=i),(t.isEmpty()||r>t.max.x)&&(t.max.x=r),(t.isEmpty()||i>t.max.y)&&(t.max.y=i)})),t)}function a(e){let t=[];switch(e.type){case"Point":t.push(e.coordinates);break;case"MultiPoint":case"LineString":t=e.coordinates;break;case"MultiLineString":case"Polygon":e.coordinates.forEach((e=>r.appendToArray(t,e)));break;case"MultiPolygon":e.coordinates.forEach((e=>{e.forEach((e=>r.appendToArray(t,e)))}))}return t}t.isObject=e=>e&&"[object Object]"===e.toString(),t.moreThanZeroWithUnits=e=>("number"!=typeof e&&(e=parseFloat(e)),e>0),t.opacityValidation=e=>"number"==typeof e&&e>=0&&e<=1,t.markerValidation=e=>"number"==typeof e||/^\d+(?:\s*px)?$/.test(e)||-1!==["small","medium","large"].indexOf(e),t.b64toBlob=function(e,t=512){const i=atob(e),r=[];for(let e=0;e<i.length;e+=t){const n=i.slice(e,e+t),o=new Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);const a=new Uint8Array(o);r.push(a)}return new Blob(r)},t.mergeDeep=function e(i,...r){if(!r.length)return i;const n=r.shift();if(t.isObject(i)&&t.isObject(n))for(const r in n)n.hasOwnProperty(r)&&t.isObject(n[r])?(i[r]||Object.assign(i,{[r]:{}}),e(i[r],n[r])):Object.assign(i,{[r]:n[r]});return e(i,...r)},t.getFeaturesBoundingBox=function(e){const t=new n.Box2;return e.features.forEach((e=>{const i=o(e.geometry);(t.isEmpty()||i.min.x<t.min.x)&&(t.min.x=i.min.x),(t.isEmpty()||i.min.y<t.min.y)&&(t.min.y=i.min.y),(t.isEmpty()||i.max.x>t.max.x)&&(t.max.x=i.max.x),(t.isEmpty()||i.max.y>t.max.y)&&(t.max.y=i.max.y)})),t},t.calcBboxFromGeometry=o,t.flattenCoordinates=a},40766:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.greenTheme=t.yellowTheme=t.mintTheme=t.pinkTheme=t.redTheme=t.GeometryColorsID=t.GeometryColors=t.geoJsonTheme=void 0;const r=i(14352),n=i(84428),o="#1EE0FF",a="#FCDB7F",s={defaultColor:o,defaultAlpha:1,hoverColor:o,hoverAlpha:1,selectColor:a,selectAlpha:1,selectHoverColor:a,selectHoverAlpha:1};t.geoJsonTheme={styles:{geojson:[{id:"geojson-fill",when:["==",["get","type"],"polygon"],renderOrder:2200,technique:"fill",attr:{color:o,transparent:!0,opacity:.2}},{id:"geojson-circle-center-px",when:["all",["==",["get","type"],"point"],["==",["get","mode"],"circleCenter"],["==",["get","units"],r.Units.pixels]],renderOrder:2203,technique:"shader",attr:{params:r.circleCenterShader(r.Units.pixels),primitive:"point"}},{id:"geojson-circle-center-meters",when:["all",["==",["get","type"],"point"],["==",["get","mode"],"circleCenter"],["==",["get","units"],r.Units.meters]],renderOrder:2203,technique:"shader",attr:{params:r.circleCenterShader(r.Units.meters),primitive:"point",userData:{minRadius:6}}},{id:"geojson-point-marker",when:["all",["==",["get","type"],"point"],["==",["get","mode"],"markerPoint"]],renderOrder:2203,technique:"shader",attr:{params:r.markerShader(),userData:{marker:!0,defaultColor:o,selectColor:a,hoverColor:o,selectHoverColor:o},primitive:"point"}},{id:"geojson-custom-icon",when:["all",["==",["get","type"],"point"],["==",["get","mode"],"customIcon"]],renderOrder:2203,technique:"shader",attr:{params:r.userMarkerShader(),userData:{defaultColor:"#000000",hoverColor:"#000000",selectColor:a,selectHoverColor:a},primitive:"point"}},{id:"geojson-invisible-line-meters",when:["all",["==",["get","type"],"invisible-line"],["==",["get","units"],r.Units.meters]],renderOrder:2203,technique:"segments",attr:{color:"rgb(0, 255, 0)",userData:{lineWidth:1,lineWidthUnits:r.Units.meters},transparent:!0,opacity:.01}},{id:"geojson-invisible-line-px",when:["all",["==",["get","type"],"invisible-line"],["==",["get","units"],r.Units.pixels]],renderOrder:2203,technique:"segments",attr:{color:"rgb(255, 0, 0)",userData:{lineWidth:1,lineWidthUnits:r.Units.pixels},transparent:!0,opacity:.01}},{id:"geojson-polygon-fill",when:["==",["get","type"],"polygonFillShader"],renderOrder:2200,technique:"shader",attr:Object.assign(Object.assign({},s),{id:"polygonFillShader",defaultAlpha:.2,hoverAlpha:.2,selectAlpha:.2,selectHoverAlpha:.2,params:r.polygonShader,primitive:"mesh"})},{id:"geojson-polygon-border",when:["==",["get","type"],"polygonBorder"],renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:1,userData:Object.assign(Object.assign({},s),{scaleByHover:!1})}},{id:"geojson-thin-line",when:["==",["get","type"],"thin-line"],renderOrder:2202,technique:"shader",attr:Object.assign(Object.assign({id:"segment-shader"},s),{params:r.thinLineShader,primitive:"segments"})},{id:"geojson-solid-line-meters",when:["all",["==",["get","type"],"lineShader"],["==",["get","units"],r.Units.meters]],renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:2,lineMinWidth:1,userData:Object.assign(Object.assign({},s),{scaleByHover:!0,scaleBySelect:!0,lineWidthUnits:r.Units.meters})}},{id:"geojson-solid-line-px",when:["==",["get","type"],"lineShader"],renderOrder:2202,technique:"solid-line",attr:{id:"line-shader",lineWidth:2,userData:Object.assign(Object.assign({},s),{scaleByHover:!0,scaleBySelect:!0})}}]}};const l=(e,t)=>{const i=new n.Color;return i.r=Math.min(e.r+t/255,1),i.g=Math.min(e.g+t/255,1),i.b=Math.min(e.b+t/255,1),i.getHex()},c=(e,i)=>{let r,o,a,s,c;return e?(c=e.defaultColor,r=e.defaultColor,o=e.hoverColor,a=e.selectColor,s=e.selectHoverColor):i&&(c=i,r=new n.Color(c),o=l(r,50),a=l(r,100),s=l(r,150)),{styles:{geojson:t.geoJsonTheme.styles.geojson.map((e=>{var t,i;return(null===(t=e.attr)||void 0===t?void 0:t.color)?["geojson-invisible-line-meters","geojson-invisible-line-px"].includes(e.id)?e:Object.assign(Object.assign({},e),{attr:Object.assign(Object.assign({},e.attr),{color:c})}):(null===(i=e.attr.userData)||void 0===i?void 0:i.defaultColor)?Object.assign(Object.assign({},e),{attr:Object.assign(Object.assign({},e.attr),{userData:Object.assign(Object.assign({},e.attr.userData),{defaultColor:"geojson-custom-icon"===e.id?e.attr.userData.defaultColor:c,hoverColor:o,selectColor:a,selectHoverColor:s})})}):e.attr.defaultColor?Object.assign(Object.assign({},e),{attr:Object.assign(Object.assign({},e.attr),{defaultColor:c,hoverColor:o,selectColor:a,selectHoverColor:s})}):e}))}}};var u;t.GeometryColors=[{defaultColor:"#00aac8",hoverColor:"#00c9eb",selectColor:"#86e3ff",selectHoverColor:"#beeeff"},{defaultColor:"#d48e16",hoverColor:"#f9a61c",selectColor:"#fecda1",selectHoverColor:"#fee1cb"},{defaultColor:"#ff6b7e",hoverColor:"#ff9ba5",selectColor:"#ffc9cd",selectHoverColor:"#ffdee1"},{defaultColor:"#00b277",hoverColor:"#00d18d",selectColor:"#00f4a4",selectHoverColor:"#75ffbe"},{defaultColor:"#c57bff",hoverColor:"#d3a4ff",selectColor:"#e5cdff",selectHoverColor:"#eee0ff"}],function(e){e[e.Mint=0]="Mint",e[e.Yellow=1]="Yellow",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Pink=4]="Pink",e[e.Default=0]="Default"}(u=t.GeometryColorsID||(t.GeometryColorsID={}));const d=t.GeometryColors[u.Red],h=t.GeometryColors[u.Pink],m=t.GeometryColors[u.Mint],p=t.GeometryColors[u.Yellow],f=t.GeometryColors[u.Green];t.redTheme=c(d),t.pinkTheme=c(h),t.mintTheme=c(m),t.yellowTheme=c(p),t.greenTheme=c(f)},27061:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(78418),t),n(i(823),t)},823:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.NameType=t.LocationType=void 0,(r=t.LocationType||(t.LocationType={}))[r.LOCATION_TYPE_UNSPECIFIC=0]="LOCATION_TYPE_UNSPECIFIC",r[r.AREA=1]="AREA",r[r.LINE=2]="LINE",r[r.POINT=3]="POINT",r[r.STRUCTURE=4]="STRUCTURE",r[r.CONNECTOR=5]="CONNECTOR",(i=t.NameType||(t.NameType={}))[i.NAME_TYPE_UNKNOWN=0]="NAME_TYPE_UNKNOWN",i[i.BASE_NAME=1]="BASE_NAME",i[i.FULL_NAME=2]="FULL_NAME",i[i.ABBREVIATION=3]="ABBREVIATION",i[i.SYNONYM=4]="SYNONYM"},78418:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerRibWorker=t.RibWorkerClient=t.RibTileDecoder=t.RibGeometryCreator=void 0;const r=i(17550),n=i(19955),o=i(38338),a=i(14352),s=i(48499),l=i(40766);class c{constructor(e,t,i,r,n=o.LoggerManager.instance.create("RibDecoder")){this.m_tileKey=e,this.m_projection=t,this.m_data=i,this.m_evaluator=r,this.m_logger=n,this.m_geometries=[],this.m_topologyFeatures=new Map,this.m_cartoFeatures=new Map,this.m_buildingFeatures=new Map,this.m_imagesMap={},this.processData()}getDecodedTile(){return{geometries:this.m_geometries,techniques:this.m_evaluator.decodedTechniques,topologyFeatures:this.m_topologyFeatures,cartoFeatures:this.m_cartoFeatures,buildingFeatures:this.m_buildingFeatures,rawData:this.m_data,tileMortonCode:this.m_tileKey.mortonCode(),imagesMap:this.m_imagesMap}}processData(){const e=this.m_data["topology-geometry_v2"],t=this.m_data.cartography_v2,i=this.m_data["building-footprints_v2"],r={type:"FeatureCollection",features:[]};void 0!==e&&(this.m_topologyFeatures=new Map,e.forEach((e=>{if(e.segment&&e.segment.length>0){const t="segment";a.appendToArray(r.features,this.processSegments(e.segment,[t])),this.m_topologyFeatures.set(t,"Segments")}if(e.node&&e.node.length>0){const t="node";a.appendToArray(r.features,this.processNodes(e.node,[t])),this.m_topologyFeatures.set(t,"Nodes")}}))),void 0!==t&&(this.m_cartoFeatures=new Map,a.appendToArray(r.features,this.processPlaces(t,this.m_cartoFeatures))),void 0!==i&&(this.m_buildingFeatures=new Map,a.appendToArray(r.features,this.processPlaces(i,this.m_buildingFeatures)));const n=new s.GeoJsonGeometryCreator(this.m_tileKey,this.m_projection,r,this.m_evaluator,this.m_logger,!0).getDecodedTile();a.appendToArray(this.m_geometries,n.geometries),this.m_imagesMap=n.imagesMap}processSegments(e,t){return e.map(((e,i)=>({type:"Feature",properties:{description:{identifier:e.identifier},title:e.identifier,protobufRef:`segment[${i}]`,width:"1px",featureTags:t},geometry:{type:"LineString",coordinates:e.geometry.point.map(this.point2GeoJSONCoordinate)}})))}processNodes(e,t){return e.map(((e,i)=>({type:"Feature",properties:{description:{identifier:e.identifier},title:e.identifier,protobufRef:`node[${i}]`,radius:"5m",minRadius:"2px",featureTags:t},geometry:{type:"Point",coordinates:this.point2GeoJSONCoordinate(e.geometry)}})))}processPlaces(e,t){const i=[];return e.forEach((e=>{const r=new Map(e.location.map((e=>[e.identifier,e])));e.place.forEach(((e,n)=>{const o=r.get(e.location_ref.identifier);if(void 0===o)return void this.m_logger.warn(`Geometry for location "${e.location_ref.identifier}" not found`);const a=o.geometry;if(void 0===a.multi_polygon&&void 0===a.multi_line_string)return void this.m_logger.warn("Unsupported geometry type",a);const s=this.getPlaceCategories(e),l=s,c=this.getPlaceNames(e).join(", "),u={description:{identifier:e.identifier,name:c,category:s.join(", ")},title:`${""!==c?c+"<br>":""}${e.identifier}`,protobufRef:`place[${n}]`,featureTags:l};void 0!==a.multi_polygon&&i.push({type:"Feature",properties:u,geometry:{type:"MultiPolygon",coordinates:a.multi_polygon.polygon.map((e=>{const t=[e.exterior_ring.point.map(this.point2GeoJSONCoordinate)];return e.interior_ring.forEach((e=>t.push(e.point.map(this.point2GeoJSONCoordinate)))),t}))}}),void 0!==a.multi_line_string&&i.push({type:"Feature",properties:u,geometry:{type:"MultiLineString",coordinates:a.multi_line_string.line_string.map((e=>e.point.map(this.point2GeoJSONCoordinate)))}});for(const e of l)t.set(e,e)}))})),i}getPlaceCategories(e){return e.category.map((e=>e.identifier.substring(e.identifier.lastIndexOf(":")+1)))}getPlaceNames(e){return e.name.map((e=>e.text.value))}point2GeoJSONCoordinate(e){return[e.longitude,e.latitude]}}t.RibGeometryCreator=c;class u extends a.InteractiveTileDecoder{constructor(){super(...arguments),this.m_logger=o.LoggerManager.instance.create("HMC Decoder")}async createGeometries(e,t,i,n){const o=JSON.parse(JSON.stringify(l.geoJsonTheme));return new c(t,n,e,new r.StyleSetEvaluator({styleSet:o.styles.geojson}),this.m_logger).getDecodedTile()}}function d(e="rib"){n.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>new a.DecoderService(e,new u)})}t.RibTileDecoder=u,t.RibWorkerClient=class{constructor(e="rib"){d(e)}},t.registerRibWorker=d},28552:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(49802),t),n(i(84711),t),n(i(69973),t),n(i(25287),t),n(i(87305),t),n(i(69464),t),n(i(37440),t),n(i(20091),t),n(i(86169),t)},20091:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerSdiiWorker=t.SensorDataWorkerClient=t.SdiiTileDecoder=t.SdiiGeometryCreator=void 0;const r=i(96500),n=i(17550),o=i(32941),a=i(10791),s=i(19955),l=i(14352),c=i(84428),u=i(87305),d=i(69464),h=i(51506);class m{constructor(e,t,i,r){this.m_tileKey=e,this.m_projection=t,this.m_messageAdapter=i,this.m_evaluator=r,this.m_geometries=[],this.m_permanencyTypes=new Set,this.m_eventTypes=new Set,this.m_hazardWarnings=new Set,this.m_circleVertices=[3,0,0,2.5237605571746826,1.621922492980957,0,0,0,0,2.5237605571746826,1.621922492980957,0,1.24624502658844,2.728895902633667,0,0,0,0,1.24624502658844,2.728895902633667,0,-.4269445240497589,2.9694643020629883,0,0,0,0,-.4269445240497589,2.9694643020629883,0,-1.9645822048187256,2.2672486305236816,0,0,0,0,-1.9645822048187256,2.2672486305236816,0,-2.87847900390625,.8451976776123047,0,0,0,0,-2.87847900390625,.8451976776123047,0,-2.87847900390625,-.8451976776123047,0,0,0,0,-2.87847900390625,-.8451976776123047,0,-1.9645822048187256,-2.2672486305236816,0,0,0,0,-1.9645822048187256,-2.2672486305236816,0,-.4269445240497589,-2.9694643020629883,0,0,0,0,-.4269445240497589,-2.9694643020629883,0,1.24624502658844,-2.728895902633667,0,0,0,0,1.24624502658844,-2.728895902633667,0,2.5237605571746826,-1.621922492980957,0,0,0,0,2.5237605571746826,-1.621922492980957,0,3,0,0,0,0,0],this.m_geoBox=o.hereTilingScheme.getGeoBox(this.m_tileKey),this.m_tileBounds=this.m_projection.projectBox(this.m_geoBox,new c.Box3),this.m_center=new c.Vector3,this.m_tileBounds.getCenter(this.m_center),this.m_messageAdapter.forEach(((e,t,i)=>this.processMessage(e,i))),this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"line-inactive"}))}getDecodedTile(){return{geometries:this.m_geometries,techniques:this.m_evaluator.decodedTechniques,signPermanencyTypes:this.m_permanencyTypes,eventTypes:this.m_eventTypes,hazardWarnings:this.m_hazardWarnings}}processMessage(e,t){if(void 0===e.path.positionEstimate||0===e.path.positionEstimate.length)return;const i=new Array(e.path.positionEstimate.length),s=new Array(3*e.path.positionEstimate.length);let l=new Float32Array(e.path.positionEstimate.length*m.ARROW_VERTICES_SIZE),u=new Float32Array(e.path.positionEstimate.length*m.ARROW_CENTER_SIZE);const h=new Float32Array(e.path.positionEstimate.length*m.CIRCLE_VERTICES_SIZE),p=new Map,f=new Set;e.path.positionEstimate.forEach((e=>f.add(e.timeStampUTC_ms)));const g=new c.Vector3;let y,v=0;const _=new Map;if(e.path.positionEstimate.forEach(((e,r)=>{if(void 0!==y){const t=Math.abs(e.latitude_deg-y.latitude_deg),i=Math.abs(e.longitude_deg-y.longitude_deg);(t<1e-4||i<1e-4)&&(e.latitude_deg+=1e-5,e.longitude_deg+=1e-5)}y=e;const n=new o.GeoCoordinates(e.latitude_deg,e.longitude_deg);this.m_projection.projectPoint(n,g).sub(this.m_center);const a=3*r;s[a]=g.x,s[a+1]=g.y,s[a+2]=0;const c=this.addArrowPositions(l,u,g,e.heading_deg||0,v);void 0!==e.heading_deg&&c&&(_.set(r,v),v+=1),this.addCirclePositions(h,m.CIRCLE_VERTICES_SIZE*r,g),i[r]={timeStampUTC_ms:e.timeStampUTC_ms,longitudeDeg:e.longitude_deg,latitudeDeg:e.latitude_deg,headingDeg:e.heading_deg,speedMps:e.speed_mps},p.set(`Message: ${t}<br>Timestamp: ${e.timeStampUTC_ms}`,[{start:r,end:r}])})),e.pathEvents){const i=new d.PathEventsDecoder(this.m_projection,this.m_center,this.m_evaluator).processEvents(t,e.pathEvents,e.path.positionEstimate,this.m_permanencyTypes,this.m_eventTypes,this.m_hazardWarnings);i.length>0&&this.m_geometries.push(...i)}l=l.slice(m.ARROW_VERTICES_SIZE,v*m.ARROW_VERTICES_SIZE),u=u.slice(m.ARROW_CENTER_SIZE,v*m.ARROW_CENTER_SIZE);let b=new n.MapEnv({type:"line"}),S=this.m_evaluator.getMatchingTechniques(b);if(S.length){const e=new a.LineGroup,n=new c.Vector3(0,0,0);e.add(n,s,this.m_projection);const{vertices:o,indices:l}=e,u={pathData:i,messageId:t,type:r.GeometryType.SolidLine,index:{buffer:new Uint32Array(l).buffer,itemCount:1,type:"uint32",name:"index"},interleavedVertexAttributes:[{buffer:new Float32Array(o).buffer,type:"float",stride:e.stride,attributes:e.vertexAttributes}],vertexAttributes:[{name:"points",buffer:new Float32Array(s).buffer,itemCount:3,type:"float"}],groups:[{start:0,count:0,technique:S[0]._index}],pathArrowMap:_,objectType:"lines",uuid:`lines-${t}`,objInfos:{tooltipRanges:p}};this.m_geometries.push(u)}if(b=new n.MapEnv({type:"arrow"}),S=this.m_evaluator.getMatchingTechniques(b),S.length){const e={messageId:t,type:r.GeometryType.Polygon,vertexAttributes:[{name:"position",buffer:l.buffer,type:"float",itemCount:3},{name:"center",buffer:u.buffer,type:"float",itemCount:3},{name:"originalPosition",buffer:l.buffer.slice(0),type:"float",itemCount:3}],groups:[{start:0,count:0,technique:S[0]._index}],objectType:"arrows",uuid:`arrows-${t}`};this.m_geometries.push(e)}if(b=new n.MapEnv({type:"circle"}),S=this.m_evaluator.getMatchingTechniques(b),S.length){const e={messageId:t,type:r.GeometryType.Polygon,vertexAttributes:[{name:"position",buffer:h.buffer,type:"float",itemCount:3}],groups:[{start:0,count:0,technique:S[0]._index}],objectType:"circles",uuid:`circles-${t}`};this.m_geometries.push(e)}}addArrowPositions(e,t,i,r,n){const o=m.ARROWS_MIN_INTERVAL*m.ARROWS_MIN_INTERVAL;for(let e=0;e<n;e++){const r=t[e*m.ARROW_CENTER_SIZE],n=t[e*m.ARROW_CENTER_SIZE+1],a=t[e*m.ARROW_CENTER_SIZE+2];if((r-i.x)*(r-i.x)+(n-i.y)*(n-i.y)+(a-i.z)*(a-i.z)<o)return!1}t[n*m.ARROW_CENTER_SIZE]=i.x,t[n*m.ARROW_CENTER_SIZE+1]=i.y,t[n*m.ARROW_CENTER_SIZE+2]=i.z;const a=new c.Vector3,s=c.MathUtils.degToRad(r),l=Math.cos(s),u=Math.sin(s),d=new c.Matrix3;d.set(l,u,0,-u,l,0,0,0,1);const h=n*m.ARROW_VERTICES_SIZE;return[[0,10,0],[-10,-10,0],[0,-5,0],[0,-5,0],[10,-10,0],[0,10,0]].forEach(((t,r)=>{const n=t;a.set(...n),a.applyMatrix3(d);const o=h+3*r;e[o]=i.x+a.x,e[o+1]=i.y+a.y,e[o+2]=i.z+a.z})),!0}addCirclePositions(e,t,i){e.set(this.m_circleVertices,t);for(let r=t/3;r<(t+this.m_circleVertices.length)/3;r++)e[3*r]+=i.x,e[3*r+1]+=i.y,e[3*r+2]+=i.z}}t.SdiiGeometryCreator=m,m.ARROW_VERTICES_SIZE=18,m.ARROW_CENTER_SIZE=3,m.CIRCLE_VERTICES_SIZE=99,m.ARROWS_MIN_INTERVAL=400;class p extends l.InteractiveTileDecoder{configure(e,t){super.configure(Object.assign(Object.assign({},e),{styleSet:h.sdiiTheme.styles.sdii}),t)}async createGeometries(e,t,i,r){const n=u.create(e);return new m(t,r,n,i).getDecodedTile()}}function f(e="sdii"){s.WorkerServiceManager.getInstance().register({serviceType:e,factory:e=>new l.DecoderService(e,new p)})}t.SdiiTileDecoder=p,t.SensorDataWorkerClient=class{constructor(e="sdii"){f(e)}},t.registerSdiiWorker=f},86169:(e,t)=>{"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.PathEventType=t.HazardWarningType=void 0,(r=t.HazardWarningType||(t.HazardWarningType={}))[r.HEAVY_RAIN=0]="HEAVY_RAIN",r[r.TRACTION_LOSS=1]="TRACTION_LOSS",r[r.FOG=2]="FOG",r[r.BROKEN_DOWN_VEHICLE=3]="BROKEN_DOWN_VEHICLE",r[r.HARD_BRAKING=4]="HARD_BRAKING",r[r.ACCIDENT=5]="ACCIDENT",r[r.REDUCED_VISIBILITY=6]="REDUCED_VISIBILITY",(i=t.PathEventType||(t.PathEventType={})).AD_SERVICE_AND_SENSOR_STATE="adServiceAndSensorState",i.ENVIRONMENT_STATUS="environmentStatus",i.EXCEPTIONAL_VEHICLE_STATE="exceptionalVehicleState",i.LANE_BOUNDARY_RECOGNITION="laneBoundaryRecognition",i.LOCALIZATION_INFORMATION="localizationInformation",i.OBJECT_DETECTION="objectDetection",i.PASSENGER_ENVIRONMENT="passengerEnvironment",i.PROPRIETARY_DATA_CONTAINER="proprietaryDataContainer",i.PROPRIETARY_INFO="proprietaryInfo",i.ROAD_ATTRIBUTE_RECOGNITION="roadAttributerecognition",i.ROAD_BOUNDARY_RECOGNITION="roadBoundaryRecognition",i.ROAD_CONDITION="roadCondition",i.ROAD_MARKING_RECOGNITION="roadMarkingRecognition",i.SIGN_RECOGNITION="signRecognition",i.SPECIFIC_OBSERVED_EVENT="specificObservedEvent",i.TRAFFIC_SIGNAL_HEAD_DETECTION="trafficSignalHeadDetection",i.VEHICLE_DYNAMICS="vehicleDynamics",i.VEHICLE_MANEUVER="vehicleManeuver",i.VEHICLE_STATUS="vehicleStatus"},25287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdapterAbstract=void 0,t.AdapterAbstract=class{constructor(e){this.m_data=e}getRandomString(){return Math.random().toString(36).slice(2)}}},87305:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=void 0;const r=i(14352),n=i(49802),o=i(84711),a=i(69973);t.create=function(e){let t;if(e.hasOwnProperty("tileId")&&e.hasOwnProperty("messages"))t=new o.MessageArchive(e);else if(e.hasOwnProperty("message")&&!e.hasOwnProperty("tileId"))t=new a.MessageList(e);else{if(!e.hasOwnProperty("envelope")||!e.hasOwnProperty("path"))throw new r.ErrorToTranslate("olpdi.sdiiDS.failed-to-determine-data-type");t=new n.Message(e)}return t}},49802:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Message=void 0;const r=i(25287);class n extends r.AdapterAbstract{forEach(e){e(this.m_data,0,this.getRandomString()+"-0")}}t.Message=n},84711:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageArchive=void 0;const r=i(25287);class n extends r.AdapterAbstract{forEach(e){this.m_data.messages.forEach(((t,i)=>{e(t.message,i,t.messageId)}))}}t.MessageArchive=n},69973:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageList=void 0;const r=i(25287);class n extends r.AdapterAbstract{forEach(e){this.m_data.message.forEach(((t,i)=>{e(t,i,".message."+i)}))}}t.MessageList=n},69464:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathEventsDecoder=void 0;const r=i(96500),n=i(17550),o=i(43720),a=i(84428),s=i(9445),l=i(86169),c=i(24045),u=i(37440);class d{constructor(e,t,i){this.m_projection=e,this.m_center=t,this.m_evaluator=i,this.eventTypeMap=new Map,this.hazardWarningMap=new Map,this.m_positions=[],this.m_atlasOffsets=[],this.m_data=[];let r=this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"sign"}));r.length>0&&(this.m_signTechniqueIndex=r[0]._index),r=this.m_evaluator.getMatchingTechniques(new n.MapEnv({type:"pathEvent"})),r.length>0&&(this.m_otherTechniqueIndex=r[0]._index)}static getAtlasCoordinates(e,t,i){return[e%i/i,Math.floor(e/t)/t]}processEvents(e,t,i,r,n,o){const a=[];let s=0;if(Object.keys(t).forEach((l=>{const c=t[l];if(0!==c.length)if("signRecognition"===l){if(void 0===this.m_signTechniqueIndex)return;const t=new u.SignRecognitionDecoder;c.forEach(((e,n)=>{const o=this.getPosition(e,i);void 0!==o&&t.processEvent(e,n,o,r)}));const n=t.getGeometry(this.m_signTechniqueIndex,e);void 0!==n&&a.push(n)}else void 0!==this.m_otherTechniqueIndex&&c.forEach((e=>{const t=this.getPosition(e,i);void 0!==t&&(this.processEvent(l,e,s,t,n,o),s++)}))})),void 0!==this.m_otherTechniqueIndex){const t=this.getGeometry(this.m_otherTechniqueIndex,e);void 0!==t&&a.push(t)}return a}getPosition(e,t){const i=o.fromValue(this.getEventTimestamp(e));let r,n;const s=t.find((e=>o.fromValue(e.timeStampUTC_ms).equals(i)));if(s)n=s.longitude_deg,r=s.latitude_deg;else{const e=t.findIndex((e=>o.fromValue(e.timeStampUTC_ms).greaterThan(i)));if(-1===e||0===e)return;const a=t[e-1],s=t[e],l=o.fromValue(a.timeStampUTC_ms),c=o.fromValue(s.timeStampUTC_ms),u=i.subtract(l).toNumber()/c.subtract(l).toNumber();r=(s.latitude_deg-a.latitude_deg)*u+a.latitude_deg,n=(s.longitude_deg-a.longitude_deg)*u+a.longitude_deg}const l=new a.Vector3;return this.m_projection.projectPoint({longitude:n,latitude:r},l).sub(this.m_center),e.positionOffset&&(l.x+=e.positionOffset.longitudinalOffset_m||0,l.y+=e.positionOffset.lateralOffset_m||0),l}getGeometry(e,t){if(0===this.m_positions.length)return;const i=new Map;this.m_data.forEach(((e,t)=>i.set(e.eventType||"Path Event",[{start:t,end:t}])));const n=this.m_positions.length/3,o=new Float32Array(n);o.fill(1);const a=new Float32Array(n);a.fill(0);const s=new Float32Array(2*n);for(let e=0;e<s.length;)s[e++]=d.ATLAS_SCALE[0],s[e++]=d.ATLAS_SCALE[1];return{messageId:t,type:r.GeometryType.Point,vertexAttributes:[{name:"position",buffer:new Float32Array(this.m_positions).buffer,type:"float",itemCount:3},{name:"alpha",buffer:a.buffer,type:"float",itemCount:1},{name:"atlasScale",buffer:s.buffer,type:"float",itemCount:2},{name:"atlasOffset",buffer:new Float32Array(this.m_atlasOffsets).buffer,type:"float",itemCount:2},{name:"scale",buffer:o.buffer,type:"float",itemCount:1}],groups:[{start:0,count:0,technique:e}],objectType:"pathEvent",uuid:`pathEvent-${t}`,pathEventsData:this.m_data,eventTypeMap:this.eventTypeMap,hazardWarningMap:this.hazardWarningMap,objInfos:{tooltipRanges:i}}}processEvent(e,t,i,r,n,o){const a=this.m_positions.length;this.m_positions[a]=r.x,this.m_positions[a+1]=r.y,this.m_positions[a+2]=r.z;const u=this.getEventTimestamp(t);let h,m,p,f;switch(e){case l.PathEventType.SPECIFIC_OBSERVED_EVENT:m=t,p=m.cause;const e=s.sdii.here.pb.SpecificObservedEvent.SpecificObservedEventCauseEnum,i=Object.keys(e).find((t=>e[t]===p));let r,n;if(void 0!==i&&m.subcause){const e=i+"SubCause";n=m.subcause[e];const t=s.sdii.here.pb.SpecificObservedEventSubCauseEnum,o=e.charAt(0).toUpperCase()+e.slice(1);let a=t[o+"Code"];void 0===a&&(a=t[o+"Enum"]),void 0!==a&&(r=Object.keys(a).find((e=>a[e]===n)))}f=this.getHazardWarningType(p,n),h={cause:i?c.convertToHumanReadable(i):"",subCause:r?c.convertToHumanReadable(r):""};break;case l.PathEventType.VEHICLE_STATUS:m=t,h={transmissionMode:m.transmissionMode,currentGear:m.currentGear,ignitionState:m.ignitionState,engineState:m.engineState};break;case l.PathEventType.VEHICLE_DYNAMICS:m=t,h={engineSpeed:m.engineSpeed_rpm,engineTorque:m.engineTorque_nm,brakeTorque:m.brakeTorque_nm};break;case l.PathEventType.LANE_BOUNDARY_RECOGNITION:m=t,h={lateralOffset:m.positionOffset.lateralOffset_m,longitudinalOffset:m.positionOffset.longitudinalOffset_m,laneBoundaryColor:m.laneBoundaryColor,laneBoundaryType:m.laneBoundaryType};break;case l.PathEventType.EXCEPTIONAL_VEHICLE_STATE:m=t,m.emergencyBraking&&(f=l.HazardWarningType.HARD_BRAKING),h={crashDetected:void 0!==m.crashDetected,emergencyBraking:void 0!==m.emergencyBraking,electronicStabilityControl:void 0!==m.electronicStabilityControl};break;case l.PathEventType.PROPRIETARY_INFO:if(m=t,void 0!==m.keyValuePairs){const e=new Map;m.keyValuePairs.forEach((t=>e.set(c.convertToHumanReadable(t.key),t.value))),h={properties:e}}break;case l.PathEventType.ENVIRONMENT_STATUS:m=t,h={timeStampUTC_ms:u,lightConditions:m.lightConditions,externalAirTemperature_DegC:m.externalAirTemperature_DegC,precipitation:m.precipitation,visibleDistance_m:m.visibleDistance_m,roadSurfaceTemperature_DegC:m.roadSurfaceTemperature_DegC,roadSurfaceType:m.roadSurfaceType,airPressure_Pa:m.airPressure_Pa,airHumidity_percent:m.airHumidity_percent};break;case l.PathEventType.OBJECT_DETECTION:m=t,h={timeStampUTC_ms:u,detectedObjectID:m.detectedObjectID,objectType:m.objectType};break;case l.PathEventType.AD_SERVICE_AND_SENSOR_STATE:m=t,h={timeStampUTC_ms:u,sensorRoadSurface:m.sensorRoadSurface,sensorEnvironment:m.sensorEnvironment};break;case l.PathEventType.ROAD_CONDITION:m=t,h={timeStampUTC_ms:u,roadRoughnessSegmentLevel:m.roadRoughnessSegmentLevel,roadRoughnessLocalEvent:m.roadRoughnessLocalEvent};break;case l.PathEventType.ROAD_BOUNDARY_RECOGNITION:m=t,h={timeStampUTC_ms:u,roadBoundaryType:m.roadBoundaryType,roadBoundaryRecognitionType:m.roadBoundaryRecognitionType,roadBoundaryChangeType:m.roadBoundaryChangeType,detectedObjectID:m.detectedObjectID};break;case l.PathEventType.VEHICLE_MANEUVER:m=t,h={timeStampUTC_ms:u,vehicleManeuverType:m.vehicleManeuverType};break;case l.PathEventType.LOCALIZATION_INFORMATION:m=t,h={timeStampUTC_ms:u,enhancedByDeadReconning:m.enhancedByDeadReconning,enhancedByMapLocalization:m.enhancedByMapLocalization};break;case l.PathEventType.ROAD_ATTRIBUTE_RECOGNITION:m=t,h={timeStampUTC_ms:u,roadAttribute:m.roadAttribute,roadLaneCount_count:m.roadLaneCount_count,roadLaneCountConfidence_percentage:m.roadLaneCountConfidence_percentage,roadLaneDetectionCount_count:m.roadLaneDetectionCount_count};break;case l.PathEventType.PASSENGER_ENVIRONMENT:m=t,h={timeStampUTC_ms:u,generalPassengerCount:m.generalPassengerCount,currentMediaSource:m.currentMediaSource,radioFrequency_MHz:m.radioFrequency_MHz}}if(void 0===f){n.add(e);let t=this.eventTypeMap.get(e);t||(t=[],this.eventTypeMap.set(e,t)),t.push(i)}else{o.add(f);let e=this.hazardWarningMap.get(f);e||(e=[],this.hazardWarningMap.set(f,e)),e.push(i)}const g=d.getAtlasCoordinates(this.getAtlasIndex(f),d.ATLAS_SIZE_X,d.ATLAS_SIZE_Y);this.m_atlasOffsets.push(...g),this.m_data.push({hazardWarningType:f,timeStampUTCMs:u,eventType:void 0!==f?"Hazard Warning":c.convertToHumanReadable(e||""),eventTypeRaw:e,eventDetails:h})}getEventTimestamp(e){return void 0===e.timeStampUTC_ms?e.timestampUTC_ms:e.timeStampUTC_ms}getHazardWarningType(e,t){let i;return 19===e&&1===t?i=l.HazardWarningType.HEAVY_RAIN:6===e?i=l.HazardWarningType.TRACTION_LOSS:18===e&&1===t?i=l.HazardWarningType.FOG:94===e&&2===t?i=l.HazardWarningType.BROKEN_DOWN_VEHICLE:2===e?i=l.HazardWarningType.ACCIDENT:18===e&&0===t&&(i=l.HazardWarningType.REDUCED_VISIBILITY),i}getAtlasIndex(e){return void 0!==e?e:7}}t.PathEventsDecoder=d,d.ATLAS_SIZE_X=6,d.ATLAS_SIZE_Y=6,d.ATLAS_SCALE=[1/d.ATLAS_SIZE_X,1/d.ATLAS_SIZE_Y]},37440:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignRecognitionDecoder=void 0;const r=i(96500),n=i(72661),o=i(9445);class a{constructor(){this.permanencyMap=new Map,this.m_positions=[],this.m_atlasOffsets=[],this.m_dynamics=[],this.m_data=[]}static getAtlasCoordinates(e){return[e%a.ATLAS_SIZE_Y/a.ATLAS_SIZE_Y,Math.floor(e/a.ATLAS_SIZE_X)/a.ATLAS_SIZE_X]}processEvent(e,t,i,r){this.m_positions.push(i.x,i.y,i.z),0!==e.roadSignPermanency&&void 0!==e.roadSignPermanency||(e.roadSignPermanency=1),r.add(e.roadSignPermanency);let n=this.permanencyMap.get(e.roadSignPermanency);n||(n={signIndexes:[]},this.permanencyMap.set(e.roadSignPermanency,n)),n.signIndexes.push(t);const o=a.getAtlasCoordinates(this.getAtlasIndex(e.roadSignPermanency,e.roadSignType));this.m_atlasOffsets.push(...o);const s=1!==e.roadSignType||1!==e.roadSignPermanency&&2!==e.roadSignPermanency?0:1;this.m_dynamics.push(s),this.m_data.push({timeStampUTC_ms:e.timeStampUTC_ms,roadSignType:e.roadSignType,roadSignValue:e.roadSignValue,roadSignPermanency:e.roadSignPermanency})}getGeometry(e,t){if(0===this.m_positions.length)return;const i=new Map,s=Object.keys(o.sdii.here.pb.SignRecognition.RoadSignTypeEnum).map((e=>e.toLowerCase().replace(/_/g," ").replace(/(\b[a-z](?!\s))/g,(e=>e.toUpperCase()))));this.m_data.forEach(((e,t)=>n.aggregateRange(i,s[e.roadSignType],{start:t,end:t})));const l=this.m_positions.length/3,c=new Float32Array(l);c.fill(1);const u=new Float32Array(l);u.fill(0);const d=new Float32Array(2*l);for(let e=0;e<d.length;)d[e++]=a.ATLAS_SCALE[0],d[e++]=a.ATLAS_SCALE[1];return{messageId:t,vertexAttributes:[{name:"position",buffer:new Float32Array(this.m_positions).buffer,type:"float",itemCount:3},{name:"alpha",buffer:new Float32Array(u).buffer,type:"float",itemCount:1},{name:"atlasScale",buffer:new Float32Array(d).buffer,type:"float",itemCount:2},{name:"atlasOffset",buffer:new Float32Array(this.m_atlasOffsets).buffer,type:"float",itemCount:2},{name:"scale",buffer:new Float32Array(c).buffer,type:"float",itemCount:1},{name:"dynamic",buffer:new Float32Array(this.m_dynamics).buffer,type:"float",itemCount:1}],type:r.GeometryType.Point,groups:[{start:0,count:0,technique:e}],signData:this.m_data,signPermanencyMap:this.permanencyMap,objectType:"signs",uuid:`signs-${t}`,objInfos:{tooltipRanges:i}}}getAtlasIndex(e,t){let i;switch(e){case 1:i=t;break;case 2:i=254;break;default:i=255}return i}}t.SignRecognitionDecoder=a,a.ATLAS_SIZE_X=16,a.ATLAS_SIZE_Y=16,a.ATLAS_SCALE=[1/a.ATLAS_SIZE_X,1/a.ATLAS_SIZE_Y]},38963:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventsShaderCfg=void 0,t.eventsShaderCfg={transparent:!0,depthTest:!0,vertexShader:["attribute float alpha;","attribute float scale;","attribute vec2 atlasScale;","attribute vec2 atlasOffset;","uniform float uSize;","uniform float uDPI;","varying float vAlpha;","varying float vScale;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = uSize * scale * uDPI;","gl_Position = projectionMatrix * mvPosition;","vAtlasOffset = atlasOffset;","vAtlasScale = atlasScale;","vScale = scale;","if (vScale > 1.0) {","gl_Position.z = 0.95;","} else {","gl_Position.z = 1.0;","}","}"].join("\n"),fragmentShader:["varying float vAlpha;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vScale;","uniform sampler2D uTexture;","void main() {","vec2 texCoord = gl_PointCoord;","texCoord *= vAtlasScale;","texCoord += vAtlasOffset;","gl_FragColor = texture2D(uTexture, texCoord);","gl_FragColor.a *= vAlpha;","gl_FragColor.a *= vScale;","if (vScale > 0.5 && gl_FragColor.a < 0.1) { discard; }","}"].join("\n"),uniforms:{uTexture:{type:"t",value:null},uSize:{type:"f",value:32},uDPI:{type:"f",value:1}}}},92031:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signShaderCfg=void 0,t.signShaderCfg={transparent:!0,depthTest:!0,vertexShader:["attribute float alpha;","attribute float scale;","attribute vec2 atlasScale;","attribute vec2 atlasOffset;","attribute float dynamic;","uniform float uSize;","uniform float uDPI;","varying float vAlpha;","varying float vScale;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vDynamic;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = uSize * scale * uDPI;","gl_Position = projectionMatrix * mvPosition;","vAtlasOffset = atlasOffset;","vAtlasScale = atlasScale;","vScale = scale;","vDynamic = dynamic;","if (vScale > 1.0) {","gl_Position.z = 0.95;","} else {","gl_Position.z = 1.0;","}","}"].join("\n"),fragmentShader:["varying float vAlpha;","varying vec2 vAtlasOffset;","varying vec2 vAtlasScale;","varying float vScale;","varying float vDynamic;","uniform sampler2D uTexture;","uniform sampler2D uDynamicTexture;","void main() {","vec2 texCoord = gl_PointCoord;","texCoord *= vAtlasScale;","texCoord += vAtlasOffset;","if (vDynamic == 0.0) {","gl_FragColor = texture2D(uTexture, texCoord);","} else {","gl_FragColor = texture2D(uDynamicTexture, texCoord);","}","gl_FragColor.a *= vAlpha;","gl_FragColor.a *= vScale;","if (vScale > 0.5 && gl_FragColor.a < 0.1) { discard; }","}"].join("\n"),uniforms:{uTexture:{type:"t",value:null},uSize:{type:"f",value:32},uDPI:{type:"f",value:1},uDynamicTexture:{type:"t",value:null}}}},51506:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sdiiTheme=void 0;const r=i(38963),n=i(92031);t.sdiiTheme={styles:{sdii:[{when:"type == 'line'",technique:"solid-line",renderOrder:2200,attr:{id:"line",transparent:!0,lineWidth:{interpolation:"Linear",zoomLevels:[10,11,12,13,14,15,16],values:[300,120,60,24,12,7,3]},color:"rgb(0, 255, 255)"}},{when:"type == 'line-inactive'",technique:"solid-line",renderOrder:2200,attr:{id:"line-inactive",transparent:!0,lineWidth:{interpolation:"Linear",zoomLevels:[10,11,12,13,14,15,16],values:[300,120,60,24,12,7,3]},color:"rgb(255, 255, 255)"}},{when:"type == 'arrow'",technique:"fill",renderOrder:2201,attr:{transparent:!0,color:"rgb(255, 255, 255)"}},{when:"type == 'circle'",technique:"fill",renderOrder:2202,attr:{transparent:!0,color:"rgb(0, 160, 160)"}},{when:"type == 'sign'",technique:"shader",renderOrder:2203,attr:{id:"sign",params:n.signShaderCfg,primitive:"point"}},{when:"type == 'pathEvent'",technique:"shader",renderOrder:2205,attr:{id:"pathEvent",params:r.eventsShaderCfg,primitive:"point"}}]}}},24045:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertToHumanReadable=t.b64toBlob=void 0,t.b64toBlob=function(e,t="",i=512){const r=atob(e),n=[];for(let e=0;e<r.length;e+=i){const t=r.slice(e,e+i),o=[];for(let e=0;e<t.length;e+=1)o[e]=t.charCodeAt(e);const a=new Uint8Array(o);n.push(a)}return new Blob(n,{type:t})},t.convertToHumanReadable=function(e){return e.replace(/([A-Z])/g," $1").toLowerCase().replace(/_/g," ").replace(/(\b[a-z](?!\s))/g,(e=>e.toUpperCase()))}},60540:function(e,t){!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,n=1;n<r;++n)t[n]=t[n].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function i(e){return"(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function n(e){return e.toUpperCase()}function o(e){var r="[A-Za-z]",n="[0-9]",o=t(n,"[A-Fa-f]"),a=i(i("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+i("%[89A-Fa-f]"+o+"%"+o+o)+"|"+i("%"+o+o)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=t("[\\:\\/\\?\\#\\[\\]\\@]",s),c=e?"[\\uE000-\\uF8FF]":"[]",u=t(r,n,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),d=i(r+t(r,n,"[\\+\\-\\.]")+"*"),h=i(i(a+"|"+t(u,s,"[\\:]"))+"*"),m=(i(i("25[0-5]")+"|"+i("2[0-4][0-9]")+"|"+i("1[0-9][0-9]")+"|"+i("[1-9][0-9]")+"|"+n),i(i("25[0-5]")+"|"+i("2[0-4][0-9]")+"|"+i("1[0-9][0-9]")+"|"+i("0?[1-9][0-9]")+"|0?0?"+n)),p=i(m+"\\."+m+"\\."+m+"\\."+m),f=i(o+"{1,4}"),g=i(i(f+"\\:"+f)+"|"+p),y=i(i(f+"\\:")+"{6}"+g),v=i("\\:\\:"+i(f+"\\:")+"{5}"+g),_=i(i(f)+"?\\:\\:"+i(f+"\\:")+"{4}"+g),b=i(i(i(f+"\\:")+"{0,1}"+f)+"?\\:\\:"+i(f+"\\:")+"{3}"+g),S=i(i(i(f+"\\:")+"{0,2}"+f)+"?\\:\\:"+i(f+"\\:")+"{2}"+g),T=i(i(i(f+"\\:")+"{0,3}"+f)+"?\\:\\:"+f+"\\:"+g),E=i(i(i(f+"\\:")+"{0,4}"+f)+"?\\:\\:"+g),C=i(i(i(f+"\\:")+"{0,5}"+f)+"?\\:\\:"+f),w=i(i(i(f+"\\:")+"{0,6}"+f)+"?\\:\\:"),x=i([y,v,_,b,S,T,E,C,w].join("|")),P=i(i(u+"|"+a)+"+"),O=(i(x+"\\%25"+P),i(x+i("\\%25|\\%(?!"+o+"{2})")+P)),A=i("[vV]"+o+"+\\."+t(u,s,"[\\:]")+"+"),D=i("\\["+i(O+"|"+x+"|"+A)+"\\]"),R=i(i(a+"|"+t(u,s))+"*"),I=i(D+"|"+p+"(?!"+R+")|"+R),M=i("[0-9]*"),L=i(i(h+"@")+"?"+I+i("\\:"+M)+"?"),k=i(a+"|"+t(u,s,"[\\:\\@]")),N=i(k+"*"),U=i(k+"+"),j=i(i(a+"|"+t(u,s,"[\\@]"))+"+"),F=i(i("\\/"+N)+"*"),V=i("\\/"+i(U+F)+"?"),B=i(j+F),G=i(U+F),z="(?!"+k+")",H=(i(F+"|"+V+"|"+B+"|"+G+"|"+z),i(i(k+"|"+t("[\\/\\?]",c))+"*")),q=i(i(k+"|[\\/\\?]")+"*"),W=i(i("\\/\\/"+L+F)+"|"+V+"|"+G+"|"+z),K=i(d+"\\:"+W+i("\\?"+H)+"?"+i("\\#"+q)+"?"),$=i(i("\\/\\/"+L+F)+"|"+V+"|"+B+"|"+z),Y=i($+i("\\?"+H)+"?"+i("\\#"+q)+"?");return i(K+"|"+Y),i(d+"\\:"+W+i("\\?"+H)+"?"),i(i("\\/\\/("+i("("+h+")@")+"?("+I+")"+i("\\:("+M+")")+"?)")+"?("+F+"|"+V+"|"+G+"|"+z+")"),i("\\?("+H+")"),i("\\#("+q+")"),i(i("\\/\\/("+i("("+h+")@")+"?("+I+")"+i("\\:("+M+")")+"?)")+"?("+F+"|"+V+"|"+B+"|"+z+")"),i("\\?("+H+")"),i("\\#("+q+")"),i(i("\\/\\/("+i("("+h+")@")+"?("+I+")"+i("\\:("+M+")")+"?)")+"?("+F+"|"+V+"|"+G+"|"+z+")"),i("\\?("+H+")"),i("\\#("+q+")"),i("("+h+")@"),i("\\:("+M+")"),{NOT_SCHEME:new RegExp(t("[^]",r,n,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,s),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,l),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+p+")$"),IPV6ADDRESS:new RegExp("^\\[?("+x+")"+i(i("\\%25|\\%(?!"+o+"{2})")+"("+P+")")+"?\\]?$")}}var a=o(!1),s=o(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,u=36,d=/^xn--/,h=/[^\0-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,g=String.fromCharCode;function y(e){throw new RangeError(p[e])}function v(e,t){var i=e.split("@"),r="";return i.length>1&&(r=i[0]+"@",e=i[1]),r+function(e,t){for(var i=[],r=e.length;r--;)i[r]=t(e[r]);return i}((e=e.replace(m,".")).split("."),t).join(".")}function _(e){for(var t=[],i=0,r=e.length;i<r;){var n=e.charCodeAt(i++);if(n>=55296&&n<=56319&&i<r){var o=e.charCodeAt(i++);56320==(64512&o)?t.push(((1023&n)<<10)+(1023&o)+65536):(t.push(n),i--)}else t.push(n)}return t}var b=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},S=function(e,t,i){var r=0;for(e=i?f(e/700):e>>1,e+=f(e/t);e>455;r+=u)e=f(e/35);return f(r+36*e/(e+38))},T=function(e){var t,i=[],r=e.length,n=0,o=128,a=72,s=e.lastIndexOf("-");s<0&&(s=0);for(var l=0;l<s;++l)e.charCodeAt(l)>=128&&y("not-basic"),i.push(e.charCodeAt(l));for(var d=s>0?s+1:0;d<r;){for(var h=n,m=1,p=u;;p+=u){d>=r&&y("invalid-input");var g=(t=e.charCodeAt(d++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:u;(g>=u||g>f((c-n)/m))&&y("overflow"),n+=g*m;var v=p<=a?1:p>=a+26?26:p-a;if(g<v)break;var _=u-v;m>f(c/_)&&y("overflow"),m*=_}var b=i.length+1;a=S(n-h,b,0==h),f(n/b)>c-o&&y("overflow"),o+=f(n/b),n%=b,i.splice(n++,0,o)}return String.fromCodePoint.apply(String,i)},E=function(e){var t=[],i=(e=_(e)).length,r=128,n=0,o=72,a=!0,s=!1,l=void 0;try{for(var d,h=e[Symbol.iterator]();!(a=(d=h.next()).done);a=!0){var m=d.value;m<128&&t.push(g(m))}}catch(e){s=!0,l=e}finally{try{!a&&h.return&&h.return()}finally{if(s)throw l}}var p=t.length,v=p;for(p&&t.push("-");v<i;){var T=c,E=!0,C=!1,w=void 0;try{for(var x,P=e[Symbol.iterator]();!(E=(x=P.next()).done);E=!0){var O=x.value;O>=r&&O<T&&(T=O)}}catch(e){C=!0,w=e}finally{try{!E&&P.return&&P.return()}finally{if(C)throw w}}var A=v+1;T-r>f((c-n)/A)&&y("overflow"),n+=(T-r)*A,r=T;var D=!0,R=!1,I=void 0;try{for(var M,L=e[Symbol.iterator]();!(D=(M=L.next()).done);D=!0){var k=M.value;if(k<r&&++n>c&&y("overflow"),k==r){for(var N=n,U=u;;U+=u){var j=U<=o?1:U>=o+26?26:U-o;if(N<j)break;var F=N-j,V=u-j;t.push(g(b(j+F%V,0))),N=f(F/V)}t.push(g(b(N,0))),o=S(n,A,v==p),n=0,++v}}}catch(e){R=!0,I=e}finally{try{!D&&L.return&&L.return()}finally{if(R)throw I}}++n,++r}return t.join("")},C=function(e){return v(e,(function(e){return h.test(e)?"xn--"+E(e):e}))},w=function(e){return v(e,(function(e){return d.test(e)?T(e.slice(4).toLowerCase()):e}))},x={};function P(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function O(e){for(var t="",i=0,r=e.length;i<r;){var n=parseInt(e.substr(i+1,2),16);if(n<128)t+=String.fromCharCode(n),i+=3;else if(n>=194&&n<224){if(r-i>=6){var o=parseInt(e.substr(i+4,2),16);t+=String.fromCharCode((31&n)<<6|63&o)}else t+=e.substr(i,6);i+=6}else if(n>=224){if(r-i>=9){var a=parseInt(e.substr(i+4,2),16),s=parseInt(e.substr(i+7,2),16);t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s)}else t+=e.substr(i,9);i+=9}else t+=e.substr(i,3),i+=3}return t}function A(e,t){function i(e){var i=O(e);return i.match(t.UNRESERVED)?i:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,i).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,i).replace(t.NOT_USERINFO,P).replace(t.PCT_ENCODED,n)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,i).toLowerCase().replace(t.NOT_HOST,P).replace(t.PCT_ENCODED,n)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,i).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,P).replace(t.PCT_ENCODED,n)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,i).replace(t.NOT_QUERY,P).replace(t.PCT_ENCODED,n)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,i).replace(t.NOT_FRAGMENT,P).replace(t.PCT_ENCODED,n)),e}function D(e){return e.replace(/^0*(.*)/,"$1")||"0"}function R(e,t){var i=e.match(t.IPV4ADDRESS)||[],r=l(i,2)[1];return r?r.split(".").map(D).join("."):e}function I(e,t){var i=e.match(t.IPV6ADDRESS)||[],r=l(i,3),n=r[1],o=r[2];if(n){for(var a=n.toLowerCase().split("::").reverse(),s=l(a,2),c=s[0],u=s[1],d=u?u.split(":").map(D):[],h=c.split(":").map(D),m=t.IPV4ADDRESS.test(h[h.length-1]),p=m?7:8,f=h.length-p,g=Array(p),y=0;y<p;++y)g[y]=d[y]||h[f+y]||"";m&&(g[p-1]=R(g[p-1],t));var v=g.reduce((function(e,t,i){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===i?r.length++:e.push({index:i,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],_=void 0;if(v&&v.length>1){var b=g.slice(0,v.index),S=g.slice(v.index+v.length);_=b.join(":")+"::"+S.join(":")}else _=g.join(":");return o&&(_+="%"+o),_}return e}var M=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,L=void 0==="".match(/(){0}/)[1];function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={},r=!1!==t.iri?s:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var n=e.match(M);if(n){L?(i.scheme=n[1],i.userinfo=n[3],i.host=n[4],i.port=parseInt(n[5],10),i.path=n[6]||"",i.query=n[7],i.fragment=n[8],isNaN(i.port)&&(i.port=n[5])):(i.scheme=n[1]||void 0,i.userinfo=-1!==e.indexOf("@")?n[3]:void 0,i.host=-1!==e.indexOf("//")?n[4]:void 0,i.port=parseInt(n[5],10),i.path=n[6]||"",i.query=-1!==e.indexOf("?")?n[7]:void 0,i.fragment=-1!==e.indexOf("#")?n[8]:void 0,isNaN(i.port)&&(i.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?n[4]:void 0)),i.host&&(i.host=I(R(i.host,r),r)),void 0!==i.scheme||void 0!==i.userinfo||void 0!==i.host||void 0!==i.port||i.path||void 0!==i.query?void 0===i.scheme?i.reference="relative":void 0===i.fragment?i.reference="absolute":i.reference="uri":i.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==i.reference&&(i.error=i.error||"URI is not a "+t.reference+" reference.");var o=x[(t.scheme||i.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)A(i,r);else{if(i.host&&(t.domainHost||o&&o.domainHost))try{i.host=C(i.host.replace(r.PCT_ENCODED,O).toLowerCase())}catch(e){i.error=i.error||"Host's domain name can not be converted to ASCII via punycode: "+e}A(i,a)}o&&o.parse&&o.parse(i,t)}else i.error=i.error||"URI can not be parsed.";return i}function N(e,t){var i=!1!==t.iri?s:a,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(I(R(String(e.host),i),i).replace(i.IPV6ADDRESS,(function(e,t,i){return"["+t+(i?"%25"+i:"")+"]"}))),"number"==typeof e.port&&(r.push(":"),r.push(e.port.toString(10))),r.length?r.join(""):void 0}var U=/^\.\.?\//,j=/^\/\.(\/|$)/,F=/^\/\.\.(\/|$)/,V=/^\/?(?:.|\n)*?(?=\/|$)/;function B(e){for(var t=[];e.length;)if(e.match(U))e=e.replace(U,"");else if(e.match(j))e=e.replace(j,"/");else if(e.match(F))e=e.replace(F,"/"),t.pop();else if("."===e||".."===e)e="";else{var i=e.match(V);if(!i)throw new Error("Unexpected dot segment condition");var r=i[0];e=e.slice(r.length),t.push(r)}return t.join("")}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.iri?s:a,r=[],n=x[(t.scheme||e.scheme||"").toLowerCase()];if(n&&n.serialize&&n.serialize(e,t),e.host)if(i.IPV6ADDRESS.test(e.host));else if(t.domainHost||n&&n.domainHost)try{e.host=t.iri?w(e.host):C(e.host.replace(i.PCT_ENCODED,O).toLowerCase())}catch(i){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+i}A(e,i),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var o=N(e,t);if(void 0!==o&&("suffix"!==t.reference&&r.push("//"),r.push(o),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||n&&n.absolutePath||(l=B(l)),void 0===o&&(l=l.replace(/^\/\//,"/%2F")),r.push(l)}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function z(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return arguments[3]||(e=k(G(e,i),i),t=k(G(t,i),i)),!(i=i||{}).tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=B(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=B(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=B(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=B(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function H(e,t){return e&&e.toString().replace(t&&t.iri?s.PCT_ENCODED:a.PCT_ENCODED,O)}var q={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},W={scheme:"https",domainHost:q.domainHost,parse:q.parse,serialize:q.serialize},K={},$="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Y="[0-9A-Fa-f]",Q=i(i("%[EFef][0-9A-Fa-f]%"+Y+Y+"%"+Y+Y)+"|"+i("%[89A-Fa-f][0-9A-Fa-f]%"+Y+Y)+"|"+i("%"+Y+Y)),J=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),X=new RegExp($,"g"),Z=new RegExp(Q,"g"),ee=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',J),"g"),te=new RegExp(t("[^]",$,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),ie=te;function re(e){var t=O(e);return t.match(X)?t:e}var ne={scheme:"mailto",parse:function(e,t){var i=e,r=i.to=i.path?i.path.split(","):[];if(i.path=void 0,i.query){for(var n=!1,o={},a=i.query.split("&"),s=0,l=a.length;s<l;++s){var c=a[s].split("=");switch(c[0]){case"to":for(var u=c[1].split(","),d=0,h=u.length;d<h;++d)r.push(u[d]);break;case"subject":i.subject=H(c[1],t);break;case"body":i.body=H(c[1],t);break;default:n=!0,o[H(c[0],t)]=H(c[1],t)}}n&&(i.headers=o)}i.query=void 0;for(var m=0,p=r.length;m<p;++m){var f=r[m].split("@");if(f[0]=H(f[0]),t.unicodeSupport)f[1]=H(f[1],t).toLowerCase();else try{f[1]=C(H(f[1],t).toLowerCase())}catch(e){i.error=i.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}r[m]=f.join("@")}return i},serialize:function(e,t){var i,r=e,o=null!=(i=e.to)?i instanceof Array?i:"number"!=typeof i.length||i.split||i.setInterval||i.call?[i]:Array.prototype.slice.call(i):[];if(o){for(var a=0,s=o.length;a<s;++a){var l=String(o[a]),c=l.lastIndexOf("@"),u=l.slice(0,c).replace(Z,re).replace(Z,n).replace(ee,P),d=l.slice(c+1);try{d=t.iri?w(d):C(H(d,t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}o[a]=u+"@"+d}r.path=o.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var m=[];for(var p in h)h[p]!==K[p]&&m.push(p.replace(Z,re).replace(Z,n).replace(te,P)+"="+h[p].replace(Z,re).replace(Z,n).replace(ie,P));return m.length&&(r.query=m.join("&")),r}},oe=/^([^\:]+)\:(.*)/,ae={scheme:"urn",parse:function(e,t){var i=e.path&&e.path.match(oe),r=e;if(i){var n=t.scheme||r.scheme||"urn",o=i[1].toLowerCase(),a=i[2],s=n+":"+(t.nid||o),l=x[s];r.nid=o,r.nss=a,r.path=void 0,l&&(r=l.parse(r,t))}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var i=t.scheme||e.scheme||"urn",r=e.nid,n=i+":"+(t.nid||r),o=x[n];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(r||t.nid)+":"+s,a}},se=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,le={scheme:"urn:uuid",parse:function(e,t){var i=e;return i.uuid=i.nss,i.nss=void 0,t.tolerant||i.uuid&&i.uuid.match(se)||(i.error=i.error||"UUID is not valid."),i},serialize:function(e,t){var i=e;return i.nss=(e.uuid||"").toLowerCase(),i}};x[q.scheme]=q,x[W.scheme]=W,x[ne.scheme]=ne,x[ae.scheme]=ae,x[le.scheme]=le,e.SCHEMES=x,e.pctEncChar=P,e.pctDecChars=O,e.parse=k,e.removeDotSegments=B,e.serialize=G,e.resolveComponents=z,e.resolve=function(e,t,i){var r=function(e,t){var i=e;if(t)for(var r in t)i[r]=t[r];return i}({scheme:"null"},i);return G(z(k(e,r),k(t,r),r,!0),r)},e.normalize=function(e,t){return"string"==typeof e?e=G(k(e,t),t):"object"===r(e)&&(e=k(G(e,t),t)),e},e.equal=function(e,t,i){return"string"==typeof e?e=G(k(e,i),i):"object"===r(e)&&(e=G(e,i)),"string"==typeof t?t=G(k(t,i),i):"object"===r(t)&&(t=G(t,i)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?s.ESCAPE:a.ESCAPE,P)},e.unescapeComponent=H,Object.defineProperty(e,"__esModule",{value:!0})}(t)},84428:e=>{"use strict";e.exports=THREE},894:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},6680:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";self.importScripts("three.min.js");const e=__webpack_require__(37319),t=__webpack_require__(91758),i=__webpack_require__(48499),r=__webpack_require__(27061),n=__webpack_require__(28552);t.VectorTileDecoderService.start(),e.CoverageTileDecoderService.start(),i.registerGeoJsonWorker(),r.registerRibWorker(),n.registerSdiiWorker()})()})();